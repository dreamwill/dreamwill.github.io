
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="我老婆说我是一个执着的人">
      
      
        <meta name="author" content="许王伟">
      
      
        <link rel="canonical" href="https://xuwangwei.com/blog/2024/07/27/%E5%AE%89%E8%A3%85-mqtt-%E6%9C%8D%E5%8A%A1rocky-linux-9/">
      
      
        <link rel="prev" href="../../../06/14/%E5%AE%89%E8%A3%85-mysql-57centos-7/">
      
      
        <link rel="next" href="../../../12/07/%E4%BD%BF%E7%94%A8-ansible-%E4%B8%80%E9%94%AE%E5%AE%89%E8%A3%85-freeiparocky-linux-9/">
      
      
      <link rel="icon" href="../../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.11">
    
    
      
        <title>安装 MQTT 服务(Rocky Linux 9) - 许王伟的个人网站</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
    
    
      <link rel="stylesheet" href="../../../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-58Y5WB8P5M"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-58Y5WB8P5M",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-58Y5WB8P5M",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="green">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#mqtt-rocky-linux-9" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../../../.." title="许王伟的个人网站" class="md-header__button md-logo" aria-label="许王伟的个人网站" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            许王伟的个人网站
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              安装 MQTT 服务(Rocky Linux 9)
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="green"  aria-label="Light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="Dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../../" class="md-tabs__link">
          
  
  
    
  
  博客

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../mysql/build-env1/" class="md-tabs__link">
          
  
  
    
  
  漫游 MySQL 源码系列

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" hidden>
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../.." title="许王伟的个人网站" class="md-nav__button md-logo" aria-label="许王伟的个人网站" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    许王伟的个人网站
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    博客
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1" id="__nav_1_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            博客
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_2" >
        
          
          <label class="md-nav__link" for="__nav_1_2" id="__nav_1_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    归档
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_2">
            <span class="md-nav__icon md-icon"></span>
            归档
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../archive/2025/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2025
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../archive/2024/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2024
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../archive/2023/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2023
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_3" >
        
          
          <label class="md-nav__link" for="__nav_1_3" id="__nav_1_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    分类
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_3">
            <span class="md-nav__icon md-icon"></span>
            分类
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/%E5%85%B6%E4%BB%96/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    其他
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/%E5%A5%BD%E7%89%A9%E5%88%86%E4%BA%AB/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    好物分享
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/%E5%AE%89%E8%A3%85/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    安装
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    漫游 MySQL 源码系列
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            漫游 MySQL 源码系列
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    搭建 MySQL 源码阅读和调试环境
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            搭建 MySQL 源码阅读和调试环境
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../mysql/build-env1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Rocky Linux 9
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../mysql/build-env2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Debian 12
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../mysql/connect1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    当客户端输入 mysql -h x.x.x.x -u root -p 时，服务端在做什么（上）
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
                
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mqtt-serverbroker" class="md-nav__link">
    <span class="md-ellipsis">
      安装 MQTT server(broker)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      测试客户端是否可以连接服务端
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
  <div class="md-content md-content--post" data-md-component="content">
    <div class="md-sidebar md-sidebar--post" data-md-component="sidebar" data-md-type="navigation">
      <div class="md-sidebar__scrollwrap">
        <div class="md-sidebar__inner md-post">
          <nav class="md-nav md-nav--primary">
            <div class="md-post__back">
              <div class="md-nav__title md-nav__container">
                <a href="../../../../" class="md-nav__link">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
                  <span class="md-ellipsis">
                    回到主页
                  </span>
                </a>
              </div>
            </div>
            
            <ul class="md-post__meta md-nav__list">
              <li class="md-nav__item md-nav__item--section">
                <div class="md-post__title">
                  <span class="md-ellipsis">
                    元数据
                  </span>
                </div>
                <nav class="md-nav">
                  <ul class="md-nav__list">
                    <li class="md-nav__item">
                      <div class="md-nav__link">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 19H5V8h14m-3-7v2H8V1H6v2H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-1V1m-1 11h-5v5h5z"/></svg>
                        <time datetime="2024-07-27 00:00:00+00:00" class="md-ellipsis">2024年7月27日</time>
                      </div>
                    </li>
                    
                    
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 3v15h3V3zm3 2 4 13 3-1-4-13zM5 5v13h3V5zM3 19v2h18v-2z"/></svg>
                          <span class="md-ellipsis">
                            分类于
                            
                              <a href="../../../../category/%E5%AE%89%E8%A3%85/">安装</a></span>
                        </div>
                      </li>
                    
                    
                  </ul>
                </nav>
              </li>
            </ul>
            
          </nav>
          
        </div>
      </div>
    </div>
    <article class="md-content__inner md-typeset">
      
        
  


  <nav class="md-tags" >
    
      
      
      
        <span class="md-tag">Eclipse Mosquitto</span>
      
    
      
      
      
        <span class="md-tag">MQTT</span>
      
    
      
      
      
        <span class="md-tag">Rocky Linux</span>
      
    
  </nav>



<h1 id="mqtt-rocky-linux-9">安装 MQTT 服务(Rocky Linux 9)<a class="headerlink" href="#mqtt-rocky-linux-9" title="Permanent link">&para;</a></h1>
<!-- more -->
<div class="admonition abstract">
<p class="admonition-title">安装目标</p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> 安装一个 MQTT server(broker) 实例，该实例所在主机的 IP 地址为 192.168.2.162。本文以安装 MQTT server(broker)的开源实现 <a href="https://mosquitto.org/">Eclipse Mosquitto</a> 为例，版本号 2.0.18。</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> 使用 MQTT 图形化客户端 <a href="https://mqttx.app/zh">MQTTX</a> 验证是否可以连接 MQTT server(broker)、订阅消息、发布消息。</li>
</ul>
</div>
<hr />
<div class="admonition note">
<p class="admonition-title">前置条件</p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> 无。</li>
</ul>
</div>
<hr />
<h2 id="mqtt-serverbroker">安装 MQTT server(broker)<a class="headerlink" href="#mqtt-serverbroker" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p>安装</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>dnf<span class="w"> </span>install<span class="w"> </span>epel-release<span class="w"> </span>-y
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>dnf<span class="w"> </span>install<span class="w"> </span>mosquitto<span class="w"> </span>-y
</span></code></pre></div>
</li>
<li>
<p>创建数据目录，用于持久化消息</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>mkdir<span class="w"> </span>/var/lib/mosquitto
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>chown<span class="w"> </span>mosquitto:mosquitto<span class="w"> </span>/var/lib/mosquitto
</span></code></pre></div>
</li>
<li>
<p>创建 MQTT 账号 example_user 并设置密码，后面客户端连接服务端时使用</p>
<div class="language-console highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="gp">[root@localhost ~]# </span>mosquitto_passwd<span class="w"> </span>-c<span class="w"> </span>/etc/mosquitto/password_file<span class="w"> </span>example_user
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="go">Password: </span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="go">Reenter password: </span>
</span></code></pre></div>
</li>
<li>
<p>生成自签名 SSL/TLS 证书，给服务端用</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>openssl<span class="w"> </span>req<span class="w"> </span>-newkey<span class="w"> </span>rsa:2048<span class="w"> </span>-keyout<span class="w"> </span>/etc/mosquitto/mqtt_server.key<span class="w"> </span>-x509<span class="w"> </span>-days<span class="w"> </span><span class="m">365</span><span class="w"> </span>-out<span class="w"> </span>/etc/mosquitto/mqtt_server.crt<span class="w"> </span>-subj<span class="o">=</span><span class="s2">&quot;/C=CN/ST=Jiangsu/L=Changzhou&quot;</span><span class="w"> </span>-noenc
</span></code></pre></div>
</li>
<li>
<p>修改配置文件/etc/mosquitto/mosquitto.conf</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">修改前</label><label for="__tabbed_1_2">修改后</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-text highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a># Config file for mosquitto
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>#
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a># See mosquitto.conf(5) for more information.
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>#
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a># Default values are shown, uncomment to change.
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>#
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a># Use the # character to indicate a comment, but only if it is the
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a># very first character on the line.
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a># =================================================================
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a># General configuration
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a># =================================================================
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a># Use per listener security settings.
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a>#
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a># It is recommended this option be set before any other options.
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a>#
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a># If this option is set to true, then all authentication and access control
</span><span id="__span-4-19"><a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a># options are controlled on a per listener basis. The following options are
</span><span id="__span-4-20"><a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a># affected:
</span><span id="__span-4-21"><a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a>#
</span><span id="__span-4-22"><a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a># acl_file
</span><span id="__span-4-23"><a id="__codelineno-4-23" name="__codelineno-4-23" href="#__codelineno-4-23"></a># allow_anonymous
</span><span id="__span-4-24"><a id="__codelineno-4-24" name="__codelineno-4-24" href="#__codelineno-4-24"></a># allow_zero_length_clientid
</span><span id="__span-4-25"><a id="__codelineno-4-25" name="__codelineno-4-25" href="#__codelineno-4-25"></a># auto_id_prefix
</span><span id="__span-4-26"><a id="__codelineno-4-26" name="__codelineno-4-26" href="#__codelineno-4-26"></a># password_file
</span><span id="__span-4-27"><a id="__codelineno-4-27" name="__codelineno-4-27" href="#__codelineno-4-27"></a># plugin
</span><span id="__span-4-28"><a id="__codelineno-4-28" name="__codelineno-4-28" href="#__codelineno-4-28"></a># plugin_opt_*
</span><span id="__span-4-29"><a id="__codelineno-4-29" name="__codelineno-4-29" href="#__codelineno-4-29"></a># psk_file
</span><span id="__span-4-30"><a id="__codelineno-4-30" name="__codelineno-4-30" href="#__codelineno-4-30"></a>#
</span><span id="__span-4-31"><a id="__codelineno-4-31" name="__codelineno-4-31" href="#__codelineno-4-31"></a># Note that if set to true, then a durable client (i.e. with clean session set
</span><span id="__span-4-32"><a id="__codelineno-4-32" name="__codelineno-4-32" href="#__codelineno-4-32"></a># to false) that has disconnected will use the ACL settings defined for the
</span><span id="__span-4-33"><a id="__codelineno-4-33" name="__codelineno-4-33" href="#__codelineno-4-33"></a># listener that it was most recently connected to.
</span><span id="__span-4-34"><a id="__codelineno-4-34" name="__codelineno-4-34" href="#__codelineno-4-34"></a>#
</span><span id="__span-4-35"><a id="__codelineno-4-35" name="__codelineno-4-35" href="#__codelineno-4-35"></a># The default behaviour is for this to be set to false, which maintains the
</span><span id="__span-4-36"><a id="__codelineno-4-36" name="__codelineno-4-36" href="#__codelineno-4-36"></a># setting behaviour from previous versions of mosquitto.
</span><span id="__span-4-37"><a id="__codelineno-4-37" name="__codelineno-4-37" href="#__codelineno-4-37"></a>#per_listener_settings false
</span><span id="__span-4-38"><a id="__codelineno-4-38" name="__codelineno-4-38" href="#__codelineno-4-38"></a>
</span><span id="__span-4-39"><a id="__codelineno-4-39" name="__codelineno-4-39" href="#__codelineno-4-39"></a>
</span><span id="__span-4-40"><a id="__codelineno-4-40" name="__codelineno-4-40" href="#__codelineno-4-40"></a># This option controls whether a client is allowed to connect with a zero
</span><span id="__span-4-41"><a id="__codelineno-4-41" name="__codelineno-4-41" href="#__codelineno-4-41"></a># length client id or not. This option only affects clients using MQTT v3.1.1
</span><span id="__span-4-42"><a id="__codelineno-4-42" name="__codelineno-4-42" href="#__codelineno-4-42"></a># and later. If set to false, clients connecting with a zero length client id
</span><span id="__span-4-43"><a id="__codelineno-4-43" name="__codelineno-4-43" href="#__codelineno-4-43"></a># are disconnected. If set to true, clients will be allocated a client id by
</span><span id="__span-4-44"><a id="__codelineno-4-44" name="__codelineno-4-44" href="#__codelineno-4-44"></a># the broker. This means it is only useful for clients with clean session set
</span><span id="__span-4-45"><a id="__codelineno-4-45" name="__codelineno-4-45" href="#__codelineno-4-45"></a># to true.
</span><span id="__span-4-46"><a id="__codelineno-4-46" name="__codelineno-4-46" href="#__codelineno-4-46"></a>#allow_zero_length_clientid true
</span><span id="__span-4-47"><a id="__codelineno-4-47" name="__codelineno-4-47" href="#__codelineno-4-47"></a>
</span><span id="__span-4-48"><a id="__codelineno-4-48" name="__codelineno-4-48" href="#__codelineno-4-48"></a># If allow_zero_length_clientid is true, this option allows you to set a prefix
</span><span id="__span-4-49"><a id="__codelineno-4-49" name="__codelineno-4-49" href="#__codelineno-4-49"></a># to automatically generated client ids to aid visibility in logs.
</span><span id="__span-4-50"><a id="__codelineno-4-50" name="__codelineno-4-50" href="#__codelineno-4-50"></a># Defaults to &#39;auto-&#39;
</span><span id="__span-4-51"><a id="__codelineno-4-51" name="__codelineno-4-51" href="#__codelineno-4-51"></a>#auto_id_prefix auto-
</span><span id="__span-4-52"><a id="__codelineno-4-52" name="__codelineno-4-52" href="#__codelineno-4-52"></a>
</span><span id="__span-4-53"><a id="__codelineno-4-53" name="__codelineno-4-53" href="#__codelineno-4-53"></a># This option affects the scenario when a client subscribes to a topic that has
</span><span id="__span-4-54"><a id="__codelineno-4-54" name="__codelineno-4-54" href="#__codelineno-4-54"></a># retained messages. It is possible that the client that published the retained
</span><span id="__span-4-55"><a id="__codelineno-4-55" name="__codelineno-4-55" href="#__codelineno-4-55"></a># message to the topic had access at the time they published, but that access
</span><span id="__span-4-56"><a id="__codelineno-4-56" name="__codelineno-4-56" href="#__codelineno-4-56"></a># has been subsequently removed. If check_retain_source is set to true, the
</span><span id="__span-4-57"><a id="__codelineno-4-57" name="__codelineno-4-57" href="#__codelineno-4-57"></a># default, the source of a retained message will be checked for access rights
</span><span id="__span-4-58"><a id="__codelineno-4-58" name="__codelineno-4-58" href="#__codelineno-4-58"></a># before it is republished. When set to false, no check will be made and the
</span><span id="__span-4-59"><a id="__codelineno-4-59" name="__codelineno-4-59" href="#__codelineno-4-59"></a># retained message will always be published. This affects all listeners.
</span><span id="__span-4-60"><a id="__codelineno-4-60" name="__codelineno-4-60" href="#__codelineno-4-60"></a>#check_retain_source true
</span><span id="__span-4-61"><a id="__codelineno-4-61" name="__codelineno-4-61" href="#__codelineno-4-61"></a>
</span><span id="__span-4-62"><a id="__codelineno-4-62" name="__codelineno-4-62" href="#__codelineno-4-62"></a># QoS 1 and 2 messages will be allowed inflight per client until this limit
</span><span id="__span-4-63"><a id="__codelineno-4-63" name="__codelineno-4-63" href="#__codelineno-4-63"></a># is exceeded.  Defaults to 0. (No maximum)
</span><span id="__span-4-64"><a id="__codelineno-4-64" name="__codelineno-4-64" href="#__codelineno-4-64"></a># See also max_inflight_messages
</span><span id="__span-4-65"><a id="__codelineno-4-65" name="__codelineno-4-65" href="#__codelineno-4-65"></a>#max_inflight_bytes 0
</span><span id="__span-4-66"><a id="__codelineno-4-66" name="__codelineno-4-66" href="#__codelineno-4-66"></a>
</span><span id="__span-4-67"><a id="__codelineno-4-67" name="__codelineno-4-67" href="#__codelineno-4-67"></a># The maximum number of QoS 1 and 2 messages currently inflight per
</span><span id="__span-4-68"><a id="__codelineno-4-68" name="__codelineno-4-68" href="#__codelineno-4-68"></a># client.
</span><span id="__span-4-69"><a id="__codelineno-4-69" name="__codelineno-4-69" href="#__codelineno-4-69"></a># This includes messages that are partway through handshakes and
</span><span id="__span-4-70"><a id="__codelineno-4-70" name="__codelineno-4-70" href="#__codelineno-4-70"></a># those that are being retried. Defaults to 20. Set to 0 for no
</span><span id="__span-4-71"><a id="__codelineno-4-71" name="__codelineno-4-71" href="#__codelineno-4-71"></a># maximum. Setting to 1 will guarantee in-order delivery of QoS 1
</span><span id="__span-4-72"><a id="__codelineno-4-72" name="__codelineno-4-72" href="#__codelineno-4-72"></a># and 2 messages.
</span><span id="__span-4-73"><a id="__codelineno-4-73" name="__codelineno-4-73" href="#__codelineno-4-73"></a>#max_inflight_messages 20
</span><span id="__span-4-74"><a id="__codelineno-4-74" name="__codelineno-4-74" href="#__codelineno-4-74"></a>
</span><span id="__span-4-75"><a id="__codelineno-4-75" name="__codelineno-4-75" href="#__codelineno-4-75"></a># For MQTT v5 clients, it is possible to have the server send a &quot;server
</span><span id="__span-4-76"><a id="__codelineno-4-76" name="__codelineno-4-76" href="#__codelineno-4-76"></a># keepalive&quot; value that will override the keepalive value set by the client.
</span><span id="__span-4-77"><a id="__codelineno-4-77" name="__codelineno-4-77" href="#__codelineno-4-77"></a># This is intended to be used as a mechanism to say that the server will
</span><span id="__span-4-78"><a id="__codelineno-4-78" name="__codelineno-4-78" href="#__codelineno-4-78"></a># disconnect the client earlier than it anticipated, and that the client should
</span><span id="__span-4-79"><a id="__codelineno-4-79" name="__codelineno-4-79" href="#__codelineno-4-79"></a># use the new keepalive value. The max_keepalive option allows you to specify
</span><span id="__span-4-80"><a id="__codelineno-4-80" name="__codelineno-4-80" href="#__codelineno-4-80"></a># that clients may only connect with keepalive less than or equal to this
</span><span id="__span-4-81"><a id="__codelineno-4-81" name="__codelineno-4-81" href="#__codelineno-4-81"></a># value, otherwise they will be sent a server keepalive telling them to use
</span><span id="__span-4-82"><a id="__codelineno-4-82" name="__codelineno-4-82" href="#__codelineno-4-82"></a># max_keepalive. This only applies to MQTT v5 clients. The default, and maximum
</span><span id="__span-4-83"><a id="__codelineno-4-83" name="__codelineno-4-83" href="#__codelineno-4-83"></a># value allowable, is 65535.
</span><span id="__span-4-84"><a id="__codelineno-4-84" name="__codelineno-4-84" href="#__codelineno-4-84"></a>#
</span><span id="__span-4-85"><a id="__codelineno-4-85" name="__codelineno-4-85" href="#__codelineno-4-85"></a># Set to 0 to allow clients to set keepalive = 0, which means no keepalive
</span><span id="__span-4-86"><a id="__codelineno-4-86" name="__codelineno-4-86" href="#__codelineno-4-86"></a># checks are made and the client will never be disconnected by the broker if no
</span><span id="__span-4-87"><a id="__codelineno-4-87" name="__codelineno-4-87" href="#__codelineno-4-87"></a># messages are received. You should be very sure this is the behaviour that you
</span><span id="__span-4-88"><a id="__codelineno-4-88" name="__codelineno-4-88" href="#__codelineno-4-88"></a># want.
</span><span id="__span-4-89"><a id="__codelineno-4-89" name="__codelineno-4-89" href="#__codelineno-4-89"></a>#
</span><span id="__span-4-90"><a id="__codelineno-4-90" name="__codelineno-4-90" href="#__codelineno-4-90"></a># For MQTT v3.1.1 and v3.1 clients, there is no mechanism to tell the client
</span><span id="__span-4-91"><a id="__codelineno-4-91" name="__codelineno-4-91" href="#__codelineno-4-91"></a># what keepalive value they should use. If an MQTT v3.1.1 or v3.1 client
</span><span id="__span-4-92"><a id="__codelineno-4-92" name="__codelineno-4-92" href="#__codelineno-4-92"></a># specifies a keepalive time greater than max_keepalive they will be sent a
</span><span id="__span-4-93"><a id="__codelineno-4-93" name="__codelineno-4-93" href="#__codelineno-4-93"></a># CONNACK message with the &quot;identifier rejected&quot; reason code, and disconnected.
</span><span id="__span-4-94"><a id="__codelineno-4-94" name="__codelineno-4-94" href="#__codelineno-4-94"></a>#
</span><span id="__span-4-95"><a id="__codelineno-4-95" name="__codelineno-4-95" href="#__codelineno-4-95"></a>#max_keepalive 65535
</span><span id="__span-4-96"><a id="__codelineno-4-96" name="__codelineno-4-96" href="#__codelineno-4-96"></a>
</span><span id="__span-4-97"><a id="__codelineno-4-97" name="__codelineno-4-97" href="#__codelineno-4-97"></a># For MQTT v5 clients, it is possible to have the server send a &quot;maximum packet
</span><span id="__span-4-98"><a id="__codelineno-4-98" name="__codelineno-4-98" href="#__codelineno-4-98"></a># size&quot; value that will instruct the client it will not accept MQTT packets
</span><span id="__span-4-99"><a id="__codelineno-4-99" name="__codelineno-4-99" href="#__codelineno-4-99"></a># with size greater than max_packet_size bytes. This applies to the full MQTT
</span><span id="__span-4-100"><a id="__codelineno-4-100" name="__codelineno-4-100" href="#__codelineno-4-100"></a># packet, not just the payload. Setting this option to a positive value will
</span><span id="__span-4-101"><a id="__codelineno-4-101" name="__codelineno-4-101" href="#__codelineno-4-101"></a># set the maximum packet size to that number of bytes. If a client sends a
</span><span id="__span-4-102"><a id="__codelineno-4-102" name="__codelineno-4-102" href="#__codelineno-4-102"></a># packet which is larger than this value, it will be disconnected. This applies
</span><span id="__span-4-103"><a id="__codelineno-4-103" name="__codelineno-4-103" href="#__codelineno-4-103"></a># to all clients regardless of the protocol version they are using, but v3.1.1
</span><span id="__span-4-104"><a id="__codelineno-4-104" name="__codelineno-4-104" href="#__codelineno-4-104"></a># and earlier clients will of course not have received the maximum packet size
</span><span id="__span-4-105"><a id="__codelineno-4-105" name="__codelineno-4-105" href="#__codelineno-4-105"></a># information. Defaults to no limit. Setting below 20 bytes is forbidden
</span><span id="__span-4-106"><a id="__codelineno-4-106" name="__codelineno-4-106" href="#__codelineno-4-106"></a># because it is likely to interfere with ordinary client operation, even with
</span><span id="__span-4-107"><a id="__codelineno-4-107" name="__codelineno-4-107" href="#__codelineno-4-107"></a># very small payloads.
</span><span id="__span-4-108"><a id="__codelineno-4-108" name="__codelineno-4-108" href="#__codelineno-4-108"></a>#max_packet_size 0
</span><span id="__span-4-109"><a id="__codelineno-4-109" name="__codelineno-4-109" href="#__codelineno-4-109"></a>
</span><span id="__span-4-110"><a id="__codelineno-4-110" name="__codelineno-4-110" href="#__codelineno-4-110"></a># QoS 1 and 2 messages above those currently in-flight will be queued per
</span><span id="__span-4-111"><a id="__codelineno-4-111" name="__codelineno-4-111" href="#__codelineno-4-111"></a># client until this limit is exceeded.  Defaults to 0. (No maximum)
</span><span id="__span-4-112"><a id="__codelineno-4-112" name="__codelineno-4-112" href="#__codelineno-4-112"></a># See also max_queued_messages.
</span><span id="__span-4-113"><a id="__codelineno-4-113" name="__codelineno-4-113" href="#__codelineno-4-113"></a># If both max_queued_messages and max_queued_bytes are specified, packets will
</span><span id="__span-4-114"><a id="__codelineno-4-114" name="__codelineno-4-114" href="#__codelineno-4-114"></a># be queued until the first limit is reached.
</span><span id="__span-4-115"><a id="__codelineno-4-115" name="__codelineno-4-115" href="#__codelineno-4-115"></a>#max_queued_bytes 0
</span><span id="__span-4-116"><a id="__codelineno-4-116" name="__codelineno-4-116" href="#__codelineno-4-116"></a>
</span><span id="__span-4-117"><a id="__codelineno-4-117" name="__codelineno-4-117" href="#__codelineno-4-117"></a># Set the maximum QoS supported. Clients publishing at a QoS higher than
</span><span id="__span-4-118"><a id="__codelineno-4-118" name="__codelineno-4-118" href="#__codelineno-4-118"></a># specified here will be disconnected.
</span><span id="__span-4-119"><a id="__codelineno-4-119" name="__codelineno-4-119" href="#__codelineno-4-119"></a>#max_qos 2
</span><span id="__span-4-120"><a id="__codelineno-4-120" name="__codelineno-4-120" href="#__codelineno-4-120"></a>
</span><span id="__span-4-121"><a id="__codelineno-4-121" name="__codelineno-4-121" href="#__codelineno-4-121"></a># The maximum number of QoS 1 and 2 messages to hold in a queue per client
</span><span id="__span-4-122"><a id="__codelineno-4-122" name="__codelineno-4-122" href="#__codelineno-4-122"></a># above those that are currently in-flight.  Defaults to 1000. Set
</span><span id="__span-4-123"><a id="__codelineno-4-123" name="__codelineno-4-123" href="#__codelineno-4-123"></a># to 0 for no maximum (not recommended).
</span><span id="__span-4-124"><a id="__codelineno-4-124" name="__codelineno-4-124" href="#__codelineno-4-124"></a># See also queue_qos0_messages.
</span><span id="__span-4-125"><a id="__codelineno-4-125" name="__codelineno-4-125" href="#__codelineno-4-125"></a># See also max_queued_bytes.
</span><span id="__span-4-126"><a id="__codelineno-4-126" name="__codelineno-4-126" href="#__codelineno-4-126"></a>#max_queued_messages 1000
</span><span id="__span-4-127"><a id="__codelineno-4-127" name="__codelineno-4-127" href="#__codelineno-4-127"></a>#
</span><span id="__span-4-128"><a id="__codelineno-4-128" name="__codelineno-4-128" href="#__codelineno-4-128"></a># This option sets the maximum number of heap memory bytes that the broker will
</span><span id="__span-4-129"><a id="__codelineno-4-129" name="__codelineno-4-129" href="#__codelineno-4-129"></a># allocate, and hence sets a hard limit on memory use by the broker.  Memory
</span><span id="__span-4-130"><a id="__codelineno-4-130" name="__codelineno-4-130" href="#__codelineno-4-130"></a># requests that exceed this value will be denied. The effect will vary
</span><span id="__span-4-131"><a id="__codelineno-4-131" name="__codelineno-4-131" href="#__codelineno-4-131"></a># depending on what has been denied. If an incoming message is being processed,
</span><span id="__span-4-132"><a id="__codelineno-4-132" name="__codelineno-4-132" href="#__codelineno-4-132"></a># then the message will be dropped and the publishing client will be
</span><span id="__span-4-133"><a id="__codelineno-4-133" name="__codelineno-4-133" href="#__codelineno-4-133"></a># disconnected. If an outgoing message is being sent, then the individual
</span><span id="__span-4-134"><a id="__codelineno-4-134" name="__codelineno-4-134" href="#__codelineno-4-134"></a># message will be dropped and the receiving client will be disconnected.
</span><span id="__span-4-135"><a id="__codelineno-4-135" name="__codelineno-4-135" href="#__codelineno-4-135"></a># Defaults to no limit.
</span><span id="__span-4-136"><a id="__codelineno-4-136" name="__codelineno-4-136" href="#__codelineno-4-136"></a>#memory_limit 0
</span><span id="__span-4-137"><a id="__codelineno-4-137" name="__codelineno-4-137" href="#__codelineno-4-137"></a>
</span><span id="__span-4-138"><a id="__codelineno-4-138" name="__codelineno-4-138" href="#__codelineno-4-138"></a># This option sets the maximum publish payload size that the broker will allow.
</span><span id="__span-4-139"><a id="__codelineno-4-139" name="__codelineno-4-139" href="#__codelineno-4-139"></a># Received messages that exceed this size will not be accepted by the broker.
</span><span id="__span-4-140"><a id="__codelineno-4-140" name="__codelineno-4-140" href="#__codelineno-4-140"></a># The default value is 0, which means that all valid MQTT messages are
</span><span id="__span-4-141"><a id="__codelineno-4-141" name="__codelineno-4-141" href="#__codelineno-4-141"></a># accepted. MQTT imposes a maximum payload size of 268435455 bytes.
</span><span id="__span-4-142"><a id="__codelineno-4-142" name="__codelineno-4-142" href="#__codelineno-4-142"></a>#message_size_limit 0
</span><span id="__span-4-143"><a id="__codelineno-4-143" name="__codelineno-4-143" href="#__codelineno-4-143"></a>
</span><span id="__span-4-144"><a id="__codelineno-4-144" name="__codelineno-4-144" href="#__codelineno-4-144"></a># This option allows the session of persistent clients (those with clean
</span><span id="__span-4-145"><a id="__codelineno-4-145" name="__codelineno-4-145" href="#__codelineno-4-145"></a># session set to false) that are not currently connected to be removed if they
</span><span id="__span-4-146"><a id="__codelineno-4-146" name="__codelineno-4-146" href="#__codelineno-4-146"></a># do not reconnect within a certain time frame. This is a non-standard option
</span><span id="__span-4-147"><a id="__codelineno-4-147" name="__codelineno-4-147" href="#__codelineno-4-147"></a># in MQTT v3.1. MQTT v3.1.1 and v5.0 allow brokers to remove client sessions.
</span><span id="__span-4-148"><a id="__codelineno-4-148" name="__codelineno-4-148" href="#__codelineno-4-148"></a>#
</span><span id="__span-4-149"><a id="__codelineno-4-149" name="__codelineno-4-149" href="#__codelineno-4-149"></a># Badly designed clients may set clean session to false whilst using a randomly
</span><span id="__span-4-150"><a id="__codelineno-4-150" name="__codelineno-4-150" href="#__codelineno-4-150"></a># generated client id. This leads to persistent clients that connect once and
</span><span id="__span-4-151"><a id="__codelineno-4-151" name="__codelineno-4-151" href="#__codelineno-4-151"></a># never reconnect. This option allows these clients to be removed.  This option
</span><span id="__span-4-152"><a id="__codelineno-4-152" name="__codelineno-4-152" href="#__codelineno-4-152"></a># allows persistent clients (those with clean session set to false) to be
</span><span id="__span-4-153"><a id="__codelineno-4-153" name="__codelineno-4-153" href="#__codelineno-4-153"></a># removed if they do not reconnect within a certain time frame.
</span><span id="__span-4-154"><a id="__codelineno-4-154" name="__codelineno-4-154" href="#__codelineno-4-154"></a>#
</span><span id="__span-4-155"><a id="__codelineno-4-155" name="__codelineno-4-155" href="#__codelineno-4-155"></a># The expiration period should be an integer followed by one of h d w m y for
</span><span id="__span-4-156"><a id="__codelineno-4-156" name="__codelineno-4-156" href="#__codelineno-4-156"></a># hour, day, week, month and year respectively. For example
</span><span id="__span-4-157"><a id="__codelineno-4-157" name="__codelineno-4-157" href="#__codelineno-4-157"></a>#
</span><span id="__span-4-158"><a id="__codelineno-4-158" name="__codelineno-4-158" href="#__codelineno-4-158"></a># persistent_client_expiration 2m
</span><span id="__span-4-159"><a id="__codelineno-4-159" name="__codelineno-4-159" href="#__codelineno-4-159"></a># persistent_client_expiration 14d
</span><span id="__span-4-160"><a id="__codelineno-4-160" name="__codelineno-4-160" href="#__codelineno-4-160"></a># persistent_client_expiration 1y
</span><span id="__span-4-161"><a id="__codelineno-4-161" name="__codelineno-4-161" href="#__codelineno-4-161"></a>#
</span><span id="__span-4-162"><a id="__codelineno-4-162" name="__codelineno-4-162" href="#__codelineno-4-162"></a># The default if not set is to never expire persistent clients.
</span><span id="__span-4-163"><a id="__codelineno-4-163" name="__codelineno-4-163" href="#__codelineno-4-163"></a>#persistent_client_expiration
</span><span id="__span-4-164"><a id="__codelineno-4-164" name="__codelineno-4-164" href="#__codelineno-4-164"></a>
</span><span id="__span-4-165"><a id="__codelineno-4-165" name="__codelineno-4-165" href="#__codelineno-4-165"></a># Write process id to a file. Default is a blank string which means
</span><span id="__span-4-166"><a id="__codelineno-4-166" name="__codelineno-4-166" href="#__codelineno-4-166"></a># a pid file shouldn&#39;t be written.
</span><span id="__span-4-167"><a id="__codelineno-4-167" name="__codelineno-4-167" href="#__codelineno-4-167"></a># This should be set to /var/run/mosquitto/mosquitto.pid if mosquitto is
</span><span id="__span-4-168"><a id="__codelineno-4-168" name="__codelineno-4-168" href="#__codelineno-4-168"></a># being run automatically on boot with an init script and
</span><span id="__span-4-169"><a id="__codelineno-4-169" name="__codelineno-4-169" href="#__codelineno-4-169"></a># start-stop-daemon or similar.
</span><span id="__span-4-170"><a id="__codelineno-4-170" name="__codelineno-4-170" href="#__codelineno-4-170"></a>#pid_file
</span><span id="__span-4-171"><a id="__codelineno-4-171" name="__codelineno-4-171" href="#__codelineno-4-171"></a>
</span><span id="__span-4-172"><a id="__codelineno-4-172" name="__codelineno-4-172" href="#__codelineno-4-172"></a># Set to true to queue messages with QoS 0 when a persistent client is
</span><span id="__span-4-173"><a id="__codelineno-4-173" name="__codelineno-4-173" href="#__codelineno-4-173"></a># disconnected. These messages are included in the limit imposed by
</span><span id="__span-4-174"><a id="__codelineno-4-174" name="__codelineno-4-174" href="#__codelineno-4-174"></a># max_queued_messages and max_queued_bytes
</span><span id="__span-4-175"><a id="__codelineno-4-175" name="__codelineno-4-175" href="#__codelineno-4-175"></a># Defaults to false.
</span><span id="__span-4-176"><a id="__codelineno-4-176" name="__codelineno-4-176" href="#__codelineno-4-176"></a># This is a non-standard option for the MQTT v3.1 spec but is allowed in
</span><span id="__span-4-177"><a id="__codelineno-4-177" name="__codelineno-4-177" href="#__codelineno-4-177"></a># v3.1.1.
</span><span id="__span-4-178"><a id="__codelineno-4-178" name="__codelineno-4-178" href="#__codelineno-4-178"></a>#queue_qos0_messages false
</span><span id="__span-4-179"><a id="__codelineno-4-179" name="__codelineno-4-179" href="#__codelineno-4-179"></a>
</span><span id="__span-4-180"><a id="__codelineno-4-180" name="__codelineno-4-180" href="#__codelineno-4-180"></a># Set to false to disable retained message support. If a client publishes a
</span><span id="__span-4-181"><a id="__codelineno-4-181" name="__codelineno-4-181" href="#__codelineno-4-181"></a># message with the retain bit set, it will be disconnected if this is set to
</span><span id="__span-4-182"><a id="__codelineno-4-182" name="__codelineno-4-182" href="#__codelineno-4-182"></a># false.
</span><span id="__span-4-183"><a id="__codelineno-4-183" name="__codelineno-4-183" href="#__codelineno-4-183"></a>#retain_available true
</span><span id="__span-4-184"><a id="__codelineno-4-184" name="__codelineno-4-184" href="#__codelineno-4-184"></a>
</span><span id="__span-4-185"><a id="__codelineno-4-185" name="__codelineno-4-185" href="#__codelineno-4-185"></a># Disable Nagle&#39;s algorithm on client sockets. This has the effect of reducing
</span><span id="__span-4-186"><a id="__codelineno-4-186" name="__codelineno-4-186" href="#__codelineno-4-186"></a># latency of individual messages at the potential cost of increasing the number
</span><span id="__span-4-187"><a id="__codelineno-4-187" name="__codelineno-4-187" href="#__codelineno-4-187"></a># of packets being sent.
</span><span id="__span-4-188"><a id="__codelineno-4-188" name="__codelineno-4-188" href="#__codelineno-4-188"></a>#set_tcp_nodelay false
</span><span id="__span-4-189"><a id="__codelineno-4-189" name="__codelineno-4-189" href="#__codelineno-4-189"></a>
</span><span id="__span-4-190"><a id="__codelineno-4-190" name="__codelineno-4-190" href="#__codelineno-4-190"></a># Time in seconds between updates of the $SYS tree.
</span><span id="__span-4-191"><a id="__codelineno-4-191" name="__codelineno-4-191" href="#__codelineno-4-191"></a># Set to 0 to disable the publishing of the $SYS tree.
</span><span id="__span-4-192"><a id="__codelineno-4-192" name="__codelineno-4-192" href="#__codelineno-4-192"></a>#sys_interval 10
</span><span id="__span-4-193"><a id="__codelineno-4-193" name="__codelineno-4-193" href="#__codelineno-4-193"></a>
</span><span id="__span-4-194"><a id="__codelineno-4-194" name="__codelineno-4-194" href="#__codelineno-4-194"></a># The MQTT specification requires that the QoS of a message delivered to a
</span><span id="__span-4-195"><a id="__codelineno-4-195" name="__codelineno-4-195" href="#__codelineno-4-195"></a># subscriber is never upgraded to match the QoS of the subscription. Enabling
</span><span id="__span-4-196"><a id="__codelineno-4-196" name="__codelineno-4-196" href="#__codelineno-4-196"></a># this option changes this behaviour. If upgrade_outgoing_qos is set true,
</span><span id="__span-4-197"><a id="__codelineno-4-197" name="__codelineno-4-197" href="#__codelineno-4-197"></a># messages sent to a subscriber will always match the QoS of its subscription.
</span><span id="__span-4-198"><a id="__codelineno-4-198" name="__codelineno-4-198" href="#__codelineno-4-198"></a># This is a non-standard option explicitly disallowed by the spec.
</span><span id="__span-4-199"><a id="__codelineno-4-199" name="__codelineno-4-199" href="#__codelineno-4-199"></a>#upgrade_outgoing_qos false
</span><span id="__span-4-200"><a id="__codelineno-4-200" name="__codelineno-4-200" href="#__codelineno-4-200"></a>
</span><span id="__span-4-201"><a id="__codelineno-4-201" name="__codelineno-4-201" href="#__codelineno-4-201"></a># When run as root, drop privileges to this user and its primary
</span><span id="__span-4-202"><a id="__codelineno-4-202" name="__codelineno-4-202" href="#__codelineno-4-202"></a># group.
</span><span id="__span-4-203"><a id="__codelineno-4-203" name="__codelineno-4-203" href="#__codelineno-4-203"></a># Set to root to stay as root, but this is not recommended.
</span><span id="__span-4-204"><a id="__codelineno-4-204" name="__codelineno-4-204" href="#__codelineno-4-204"></a># If set to &quot;mosquitto&quot;, or left unset, and the &quot;mosquitto&quot; user does not exist
</span><span id="__span-4-205"><a id="__codelineno-4-205" name="__codelineno-4-205" href="#__codelineno-4-205"></a># then it will drop privileges to the &quot;nobody&quot; user instead.
</span><span id="__span-4-206"><a id="__codelineno-4-206" name="__codelineno-4-206" href="#__codelineno-4-206"></a># If run as a non-root user, this setting has no effect.
</span><span id="__span-4-207"><a id="__codelineno-4-207" name="__codelineno-4-207" href="#__codelineno-4-207"></a># Note that on Windows this has no effect and so mosquitto should be started by
</span><span id="__span-4-208"><a id="__codelineno-4-208" name="__codelineno-4-208" href="#__codelineno-4-208"></a># the user you wish it to run as.
</span><span id="__span-4-209"><a id="__codelineno-4-209" name="__codelineno-4-209" href="#__codelineno-4-209"></a>#user mosquitto
</span><span id="__span-4-210"><a id="__codelineno-4-210" name="__codelineno-4-210" href="#__codelineno-4-210"></a>
</span><span id="__span-4-211"><a id="__codelineno-4-211" name="__codelineno-4-211" href="#__codelineno-4-211"></a># =================================================================
</span><span id="__span-4-212"><a id="__codelineno-4-212" name="__codelineno-4-212" href="#__codelineno-4-212"></a># Listeners
</span><span id="__span-4-213"><a id="__codelineno-4-213" name="__codelineno-4-213" href="#__codelineno-4-213"></a># =================================================================
</span><span id="__span-4-214"><a id="__codelineno-4-214" name="__codelineno-4-214" href="#__codelineno-4-214"></a>
</span><span id="__span-4-215"><a id="__codelineno-4-215" name="__codelineno-4-215" href="#__codelineno-4-215"></a># Listen on a port/ip address combination. By using this variable
</span><span id="__span-4-216"><a id="__codelineno-4-216" name="__codelineno-4-216" href="#__codelineno-4-216"></a># multiple times, mosquitto can listen on more than one port. If
</span><span id="__span-4-217"><a id="__codelineno-4-217" name="__codelineno-4-217" href="#__codelineno-4-217"></a># this variable is used and neither bind_address nor port given,
</span><span id="__span-4-218"><a id="__codelineno-4-218" name="__codelineno-4-218" href="#__codelineno-4-218"></a># then the default listener will not be started.
</span><span id="__span-4-219"><a id="__codelineno-4-219" name="__codelineno-4-219" href="#__codelineno-4-219"></a># The port number to listen on must be given. Optionally, an ip
</span><span id="__span-4-220"><a id="__codelineno-4-220" name="__codelineno-4-220" href="#__codelineno-4-220"></a># address or host name may be supplied as a second argument. In
</span><span id="__span-4-221"><a id="__codelineno-4-221" name="__codelineno-4-221" href="#__codelineno-4-221"></a># this case, mosquitto will attempt to bind the listener to that
</span><span id="__span-4-222"><a id="__codelineno-4-222" name="__codelineno-4-222" href="#__codelineno-4-222"></a># address and so restrict access to the associated network and
</span><span id="__span-4-223"><a id="__codelineno-4-223" name="__codelineno-4-223" href="#__codelineno-4-223"></a># interface. By default, mosquitto will listen on all interfaces.
</span><span id="__span-4-224"><a id="__codelineno-4-224" name="__codelineno-4-224" href="#__codelineno-4-224"></a># Note that for a websockets listener it is not possible to bind to a host
</span><span id="__span-4-225"><a id="__codelineno-4-225" name="__codelineno-4-225" href="#__codelineno-4-225"></a># name.
</span><span id="__span-4-226"><a id="__codelineno-4-226" name="__codelineno-4-226" href="#__codelineno-4-226"></a>#
</span><span id="__span-4-227"><a id="__codelineno-4-227" name="__codelineno-4-227" href="#__codelineno-4-227"></a># On systems that support Unix Domain Sockets, it is also possible
</span><span id="__span-4-228"><a id="__codelineno-4-228" name="__codelineno-4-228" href="#__codelineno-4-228"></a># to create a # Unix socket rather than opening a TCP socket. In
</span><span id="__span-4-229"><a id="__codelineno-4-229" name="__codelineno-4-229" href="#__codelineno-4-229"></a># this case, the port number should be set to 0 and a unix socket
</span><span id="__span-4-230"><a id="__codelineno-4-230" name="__codelineno-4-230" href="#__codelineno-4-230"></a># path must be provided, e.g.
</span><span id="__span-4-231"><a id="__codelineno-4-231" name="__codelineno-4-231" href="#__codelineno-4-231"></a># listener 0 /tmp/mosquitto.sock
</span><span id="__span-4-232"><a id="__codelineno-4-232" name="__codelineno-4-232" href="#__codelineno-4-232"></a>#
</span><span id="__span-4-233"><a id="__codelineno-4-233" name="__codelineno-4-233" href="#__codelineno-4-233"></a># listener port-number [ip address/host name/unix socket path]
</span><span id="__span-4-234"><a id="__codelineno-4-234" name="__codelineno-4-234" href="#__codelineno-4-234"></a>#listener
</span><span id="__span-4-235"><a id="__codelineno-4-235" name="__codelineno-4-235" href="#__codelineno-4-235"></a>
</span><span id="__span-4-236"><a id="__codelineno-4-236" name="__codelineno-4-236" href="#__codelineno-4-236"></a># By default, a listener will attempt to listen on all supported IP protocol
</span><span id="__span-4-237"><a id="__codelineno-4-237" name="__codelineno-4-237" href="#__codelineno-4-237"></a># versions. If you do not have an IPv4 or IPv6 interface you may wish to
</span><span id="__span-4-238"><a id="__codelineno-4-238" name="__codelineno-4-238" href="#__codelineno-4-238"></a># disable support for either of those protocol versions. In particular, note
</span><span id="__span-4-239"><a id="__codelineno-4-239" name="__codelineno-4-239" href="#__codelineno-4-239"></a># that due to the limitations of the websockets library, it will only ever
</span><span id="__span-4-240"><a id="__codelineno-4-240" name="__codelineno-4-240" href="#__codelineno-4-240"></a># attempt to open IPv6 sockets if IPv6 support is compiled in, and so will fail
</span><span id="__span-4-241"><a id="__codelineno-4-241" name="__codelineno-4-241" href="#__codelineno-4-241"></a># if IPv6 is not available.
</span><span id="__span-4-242"><a id="__codelineno-4-242" name="__codelineno-4-242" href="#__codelineno-4-242"></a>#
</span><span id="__span-4-243"><a id="__codelineno-4-243" name="__codelineno-4-243" href="#__codelineno-4-243"></a># Set to `ipv4` to force the listener to only use IPv4, or set to `ipv6` to
</span><span id="__span-4-244"><a id="__codelineno-4-244" name="__codelineno-4-244" href="#__codelineno-4-244"></a># force the listener to only use IPv6. If you want support for both IPv4 and
</span><span id="__span-4-245"><a id="__codelineno-4-245" name="__codelineno-4-245" href="#__codelineno-4-245"></a># IPv6, then do not use the socket_domain option.
</span><span id="__span-4-246"><a id="__codelineno-4-246" name="__codelineno-4-246" href="#__codelineno-4-246"></a>#
</span><span id="__span-4-247"><a id="__codelineno-4-247" name="__codelineno-4-247" href="#__codelineno-4-247"></a>#socket_domain
</span><span id="__span-4-248"><a id="__codelineno-4-248" name="__codelineno-4-248" href="#__codelineno-4-248"></a>
</span><span id="__span-4-249"><a id="__codelineno-4-249" name="__codelineno-4-249" href="#__codelineno-4-249"></a># Bind the listener to a specific interface. This is similar to
</span><span id="__span-4-250"><a id="__codelineno-4-250" name="__codelineno-4-250" href="#__codelineno-4-250"></a># the [ip address/host name] part of the listener definition, but is useful
</span><span id="__span-4-251"><a id="__codelineno-4-251" name="__codelineno-4-251" href="#__codelineno-4-251"></a># when an interface has multiple addresses or the address may change. If used
</span><span id="__span-4-252"><a id="__codelineno-4-252" name="__codelineno-4-252" href="#__codelineno-4-252"></a># with the [ip address/host name] part of the listener definition, then the
</span><span id="__span-4-253"><a id="__codelineno-4-253" name="__codelineno-4-253" href="#__codelineno-4-253"></a># bind_interface option will take priority.
</span><span id="__span-4-254"><a id="__codelineno-4-254" name="__codelineno-4-254" href="#__codelineno-4-254"></a># Not available on Windows.
</span><span id="__span-4-255"><a id="__codelineno-4-255" name="__codelineno-4-255" href="#__codelineno-4-255"></a>#
</span><span id="__span-4-256"><a id="__codelineno-4-256" name="__codelineno-4-256" href="#__codelineno-4-256"></a># Example: bind_interface eth0
</span><span id="__span-4-257"><a id="__codelineno-4-257" name="__codelineno-4-257" href="#__codelineno-4-257"></a>#bind_interface
</span><span id="__span-4-258"><a id="__codelineno-4-258" name="__codelineno-4-258" href="#__codelineno-4-258"></a>
</span><span id="__span-4-259"><a id="__codelineno-4-259" name="__codelineno-4-259" href="#__codelineno-4-259"></a># When a listener is using the websockets protocol, it is possible to serve
</span><span id="__span-4-260"><a id="__codelineno-4-260" name="__codelineno-4-260" href="#__codelineno-4-260"></a># http data as well. Set http_dir to a directory which contains the files you
</span><span id="__span-4-261"><a id="__codelineno-4-261" name="__codelineno-4-261" href="#__codelineno-4-261"></a># wish to serve. If this option is not specified, then no normal http
</span><span id="__span-4-262"><a id="__codelineno-4-262" name="__codelineno-4-262" href="#__codelineno-4-262"></a># connections will be possible.
</span><span id="__span-4-263"><a id="__codelineno-4-263" name="__codelineno-4-263" href="#__codelineno-4-263"></a>#http_dir
</span><span id="__span-4-264"><a id="__codelineno-4-264" name="__codelineno-4-264" href="#__codelineno-4-264"></a>
</span><span id="__span-4-265"><a id="__codelineno-4-265" name="__codelineno-4-265" href="#__codelineno-4-265"></a># The maximum number of client connections to allow. This is
</span><span id="__span-4-266"><a id="__codelineno-4-266" name="__codelineno-4-266" href="#__codelineno-4-266"></a># a per listener setting.
</span><span id="__span-4-267"><a id="__codelineno-4-267" name="__codelineno-4-267" href="#__codelineno-4-267"></a># Default is -1, which means unlimited connections.
</span><span id="__span-4-268"><a id="__codelineno-4-268" name="__codelineno-4-268" href="#__codelineno-4-268"></a># Note that other process limits mean that unlimited connections
</span><span id="__span-4-269"><a id="__codelineno-4-269" name="__codelineno-4-269" href="#__codelineno-4-269"></a># are not really possible. Typically the default maximum number of
</span><span id="__span-4-270"><a id="__codelineno-4-270" name="__codelineno-4-270" href="#__codelineno-4-270"></a># connections possible is around 1024.
</span><span id="__span-4-271"><a id="__codelineno-4-271" name="__codelineno-4-271" href="#__codelineno-4-271"></a>#max_connections -1
</span><span id="__span-4-272"><a id="__codelineno-4-272" name="__codelineno-4-272" href="#__codelineno-4-272"></a>
</span><span id="__span-4-273"><a id="__codelineno-4-273" name="__codelineno-4-273" href="#__codelineno-4-273"></a># The listener can be restricted to operating within a topic hierarchy using
</span><span id="__span-4-274"><a id="__codelineno-4-274" name="__codelineno-4-274" href="#__codelineno-4-274"></a># the mount_point option. This is achieved be prefixing the mount_point string
</span><span id="__span-4-275"><a id="__codelineno-4-275" name="__codelineno-4-275" href="#__codelineno-4-275"></a># to all topics for any clients connected to this listener. This prefixing only
</span><span id="__span-4-276"><a id="__codelineno-4-276" name="__codelineno-4-276" href="#__codelineno-4-276"></a># happens internally to the broker; the client will not see the prefix.
</span><span id="__span-4-277"><a id="__codelineno-4-277" name="__codelineno-4-277" href="#__codelineno-4-277"></a>#mount_point
</span><span id="__span-4-278"><a id="__codelineno-4-278" name="__codelineno-4-278" href="#__codelineno-4-278"></a>
</span><span id="__span-4-279"><a id="__codelineno-4-279" name="__codelineno-4-279" href="#__codelineno-4-279"></a># Choose the protocol to use when listening.
</span><span id="__span-4-280"><a id="__codelineno-4-280" name="__codelineno-4-280" href="#__codelineno-4-280"></a># This can be either mqtt or websockets.
</span><span id="__span-4-281"><a id="__codelineno-4-281" name="__codelineno-4-281" href="#__codelineno-4-281"></a># Certificate based TLS may be used with websockets, except that only the
</span><span id="__span-4-282"><a id="__codelineno-4-282" name="__codelineno-4-282" href="#__codelineno-4-282"></a># cafile, certfile, keyfile, ciphers, and ciphers_tls13 options are supported.
</span><span id="__span-4-283"><a id="__codelineno-4-283" name="__codelineno-4-283" href="#__codelineno-4-283"></a>#protocol mqtt
</span><span id="__span-4-284"><a id="__codelineno-4-284" name="__codelineno-4-284" href="#__codelineno-4-284"></a>
</span><span id="__span-4-285"><a id="__codelineno-4-285" name="__codelineno-4-285" href="#__codelineno-4-285"></a># Set use_username_as_clientid to true to replace the clientid that a client
</span><span id="__span-4-286"><a id="__codelineno-4-286" name="__codelineno-4-286" href="#__codelineno-4-286"></a># connected with with its username. This allows authentication to be tied to
</span><span id="__span-4-287"><a id="__codelineno-4-287" name="__codelineno-4-287" href="#__codelineno-4-287"></a># the clientid, which means that it is possible to prevent one client
</span><span id="__span-4-288"><a id="__codelineno-4-288" name="__codelineno-4-288" href="#__codelineno-4-288"></a># disconnecting another by using the same clientid.
</span><span id="__span-4-289"><a id="__codelineno-4-289" name="__codelineno-4-289" href="#__codelineno-4-289"></a># If a client connects with no username it will be disconnected as not
</span><span id="__span-4-290"><a id="__codelineno-4-290" name="__codelineno-4-290" href="#__codelineno-4-290"></a># authorised when this option is set to true.
</span><span id="__span-4-291"><a id="__codelineno-4-291" name="__codelineno-4-291" href="#__codelineno-4-291"></a># Do not use in conjunction with clientid_prefixes.
</span><span id="__span-4-292"><a id="__codelineno-4-292" name="__codelineno-4-292" href="#__codelineno-4-292"></a># See also use_identity_as_username.
</span><span id="__span-4-293"><a id="__codelineno-4-293" name="__codelineno-4-293" href="#__codelineno-4-293"></a># This does not apply globally, but on a per-listener basis.
</span><span id="__span-4-294"><a id="__codelineno-4-294" name="__codelineno-4-294" href="#__codelineno-4-294"></a>#use_username_as_clientid
</span><span id="__span-4-295"><a id="__codelineno-4-295" name="__codelineno-4-295" href="#__codelineno-4-295"></a>
</span><span id="__span-4-296"><a id="__codelineno-4-296" name="__codelineno-4-296" href="#__codelineno-4-296"></a># Change the websockets headers size. This is a global option, it is not
</span><span id="__span-4-297"><a id="__codelineno-4-297" name="__codelineno-4-297" href="#__codelineno-4-297"></a># possible to set per listener. This option sets the size of the buffer used in
</span><span id="__span-4-298"><a id="__codelineno-4-298" name="__codelineno-4-298" href="#__codelineno-4-298"></a># the libwebsockets library when reading HTTP headers. If you are passing large
</span><span id="__span-4-299"><a id="__codelineno-4-299" name="__codelineno-4-299" href="#__codelineno-4-299"></a># header data such as cookies then you may need to increase this value. If left
</span><span id="__span-4-300"><a id="__codelineno-4-300" name="__codelineno-4-300" href="#__codelineno-4-300"></a># unset, or set to 0, then the default of 1024 bytes will be used.
</span><span id="__span-4-301"><a id="__codelineno-4-301" name="__codelineno-4-301" href="#__codelineno-4-301"></a>#websockets_headers_size
</span><span id="__span-4-302"><a id="__codelineno-4-302" name="__codelineno-4-302" href="#__codelineno-4-302"></a>
</span><span id="__span-4-303"><a id="__codelineno-4-303" name="__codelineno-4-303" href="#__codelineno-4-303"></a># -----------------------------------------------------------------
</span><span id="__span-4-304"><a id="__codelineno-4-304" name="__codelineno-4-304" href="#__codelineno-4-304"></a># Certificate based SSL/TLS support
</span><span id="__span-4-305"><a id="__codelineno-4-305" name="__codelineno-4-305" href="#__codelineno-4-305"></a># -----------------------------------------------------------------
</span><span id="__span-4-306"><a id="__codelineno-4-306" name="__codelineno-4-306" href="#__codelineno-4-306"></a># The following options can be used to enable certificate based SSL/TLS support
</span><span id="__span-4-307"><a id="__codelineno-4-307" name="__codelineno-4-307" href="#__codelineno-4-307"></a># for this listener. Note that the recommended port for MQTT over TLS is 8883,
</span><span id="__span-4-308"><a id="__codelineno-4-308" name="__codelineno-4-308" href="#__codelineno-4-308"></a># but this must be set manually.
</span><span id="__span-4-309"><a id="__codelineno-4-309" name="__codelineno-4-309" href="#__codelineno-4-309"></a>#
</span><span id="__span-4-310"><a id="__codelineno-4-310" name="__codelineno-4-310" href="#__codelineno-4-310"></a># See also the mosquitto-tls man page and the &quot;Pre-shared-key based SSL/TLS
</span><span id="__span-4-311"><a id="__codelineno-4-311" name="__codelineno-4-311" href="#__codelineno-4-311"></a># support&quot; section. Only one of certificate or PSK encryption support can be
</span><span id="__span-4-312"><a id="__codelineno-4-312" name="__codelineno-4-312" href="#__codelineno-4-312"></a># enabled for any listener.
</span><span id="__span-4-313"><a id="__codelineno-4-313" name="__codelineno-4-313" href="#__codelineno-4-313"></a>
</span><span id="__span-4-314"><a id="__codelineno-4-314" name="__codelineno-4-314" href="#__codelineno-4-314"></a># Both of certfile and keyfile must be defined to enable certificate based
</span><span id="__span-4-315"><a id="__codelineno-4-315" name="__codelineno-4-315" href="#__codelineno-4-315"></a># TLS encryption.
</span><span id="__span-4-316"><a id="__codelineno-4-316" name="__codelineno-4-316" href="#__codelineno-4-316"></a>
</span><span id="__span-4-317"><a id="__codelineno-4-317" name="__codelineno-4-317" href="#__codelineno-4-317"></a># Path to the PEM encoded server certificate.
</span><span id="__span-4-318"><a id="__codelineno-4-318" name="__codelineno-4-318" href="#__codelineno-4-318"></a>#certfile
</span><span id="__span-4-319"><a id="__codelineno-4-319" name="__codelineno-4-319" href="#__codelineno-4-319"></a>
</span><span id="__span-4-320"><a id="__codelineno-4-320" name="__codelineno-4-320" href="#__codelineno-4-320"></a># Path to the PEM encoded keyfile.
</span><span id="__span-4-321"><a id="__codelineno-4-321" name="__codelineno-4-321" href="#__codelineno-4-321"></a>#keyfile
</span><span id="__span-4-322"><a id="__codelineno-4-322" name="__codelineno-4-322" href="#__codelineno-4-322"></a>
</span><span id="__span-4-323"><a id="__codelineno-4-323" name="__codelineno-4-323" href="#__codelineno-4-323"></a># If you wish to control which encryption ciphers are used, use the ciphers
</span><span id="__span-4-324"><a id="__codelineno-4-324" name="__codelineno-4-324" href="#__codelineno-4-324"></a># option. The list of available ciphers can be optained using the &quot;openssl
</span><span id="__span-4-325"><a id="__codelineno-4-325" name="__codelineno-4-325" href="#__codelineno-4-325"></a># ciphers&quot; command and should be provided in the same format as the output of
</span><span id="__span-4-326"><a id="__codelineno-4-326" name="__codelineno-4-326" href="#__codelineno-4-326"></a># that command. This applies to TLS 1.2 and earlier versions only. Use
</span><span id="__span-4-327"><a id="__codelineno-4-327" name="__codelineno-4-327" href="#__codelineno-4-327"></a># ciphers_tls1.3 for TLS v1.3.
</span><span id="__span-4-328"><a id="__codelineno-4-328" name="__codelineno-4-328" href="#__codelineno-4-328"></a>#ciphers
</span><span id="__span-4-329"><a id="__codelineno-4-329" name="__codelineno-4-329" href="#__codelineno-4-329"></a>
</span><span id="__span-4-330"><a id="__codelineno-4-330" name="__codelineno-4-330" href="#__codelineno-4-330"></a># Choose which TLS v1.3 ciphersuites are used for this listener.
</span><span id="__span-4-331"><a id="__codelineno-4-331" name="__codelineno-4-331" href="#__codelineno-4-331"></a># Defaults to &quot;TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256&quot;
</span><span id="__span-4-332"><a id="__codelineno-4-332" name="__codelineno-4-332" href="#__codelineno-4-332"></a>#ciphers_tls1.3
</span><span id="__span-4-333"><a id="__codelineno-4-333" name="__codelineno-4-333" href="#__codelineno-4-333"></a>
</span><span id="__span-4-334"><a id="__codelineno-4-334" name="__codelineno-4-334" href="#__codelineno-4-334"></a># If you have require_certificate set to true, you can create a certificate
</span><span id="__span-4-335"><a id="__codelineno-4-335" name="__codelineno-4-335" href="#__codelineno-4-335"></a># revocation list file to revoke access to particular client certificates. If
</span><span id="__span-4-336"><a id="__codelineno-4-336" name="__codelineno-4-336" href="#__codelineno-4-336"></a># you have done this, use crlfile to point to the PEM encoded revocation file.
</span><span id="__span-4-337"><a id="__codelineno-4-337" name="__codelineno-4-337" href="#__codelineno-4-337"></a>#crlfile
</span><span id="__span-4-338"><a id="__codelineno-4-338" name="__codelineno-4-338" href="#__codelineno-4-338"></a>
</span><span id="__span-4-339"><a id="__codelineno-4-339" name="__codelineno-4-339" href="#__codelineno-4-339"></a># To allow the use of ephemeral DH key exchange, which provides forward
</span><span id="__span-4-340"><a id="__codelineno-4-340" name="__codelineno-4-340" href="#__codelineno-4-340"></a># security, the listener must load DH parameters. This can be specified with
</span><span id="__span-4-341"><a id="__codelineno-4-341" name="__codelineno-4-341" href="#__codelineno-4-341"></a># the dhparamfile option. The dhparamfile can be generated with the command
</span><span id="__span-4-342"><a id="__codelineno-4-342" name="__codelineno-4-342" href="#__codelineno-4-342"></a># e.g. &quot;openssl dhparam -out dhparam.pem 2048&quot;
</span><span id="__span-4-343"><a id="__codelineno-4-343" name="__codelineno-4-343" href="#__codelineno-4-343"></a>#dhparamfile
</span><span id="__span-4-344"><a id="__codelineno-4-344" name="__codelineno-4-344" href="#__codelineno-4-344"></a>
</span><span id="__span-4-345"><a id="__codelineno-4-345" name="__codelineno-4-345" href="#__codelineno-4-345"></a># By default an TLS enabled listener will operate in a similar fashion to a
</span><span id="__span-4-346"><a id="__codelineno-4-346" name="__codelineno-4-346" href="#__codelineno-4-346"></a># https enabled web server, in that the server has a certificate signed by a CA
</span><span id="__span-4-347"><a id="__codelineno-4-347" name="__codelineno-4-347" href="#__codelineno-4-347"></a># and the client will verify that it is a trusted certificate. The overall aim
</span><span id="__span-4-348"><a id="__codelineno-4-348" name="__codelineno-4-348" href="#__codelineno-4-348"></a># is encryption of the network traffic. By setting require_certificate to true,
</span><span id="__span-4-349"><a id="__codelineno-4-349" name="__codelineno-4-349" href="#__codelineno-4-349"></a># the client must provide a valid certificate in order for the network
</span><span id="__span-4-350"><a id="__codelineno-4-350" name="__codelineno-4-350" href="#__codelineno-4-350"></a># connection to proceed. This allows access to the broker to be controlled
</span><span id="__span-4-351"><a id="__codelineno-4-351" name="__codelineno-4-351" href="#__codelineno-4-351"></a># outside of the mechanisms provided by MQTT.
</span><span id="__span-4-352"><a id="__codelineno-4-352" name="__codelineno-4-352" href="#__codelineno-4-352"></a>#require_certificate false
</span><span id="__span-4-353"><a id="__codelineno-4-353" name="__codelineno-4-353" href="#__codelineno-4-353"></a>
</span><span id="__span-4-354"><a id="__codelineno-4-354" name="__codelineno-4-354" href="#__codelineno-4-354"></a># cafile and capath define methods of accessing the PEM encoded
</span><span id="__span-4-355"><a id="__codelineno-4-355" name="__codelineno-4-355" href="#__codelineno-4-355"></a># Certificate Authority certificates that will be considered trusted when
</span><span id="__span-4-356"><a id="__codelineno-4-356" name="__codelineno-4-356" href="#__codelineno-4-356"></a># checking incoming client certificates.
</span><span id="__span-4-357"><a id="__codelineno-4-357" name="__codelineno-4-357" href="#__codelineno-4-357"></a># cafile defines the path to a file containing the CA certificates.
</span><span id="__span-4-358"><a id="__codelineno-4-358" name="__codelineno-4-358" href="#__codelineno-4-358"></a># capath defines a directory that will be searched for files
</span><span id="__span-4-359"><a id="__codelineno-4-359" name="__codelineno-4-359" href="#__codelineno-4-359"></a># containing the CA certificates. For capath to work correctly, the
</span><span id="__span-4-360"><a id="__codelineno-4-360" name="__codelineno-4-360" href="#__codelineno-4-360"></a># certificate files must have &quot;.crt&quot; as the file ending and you must run
</span><span id="__span-4-361"><a id="__codelineno-4-361" name="__codelineno-4-361" href="#__codelineno-4-361"></a># &quot;openssl rehash &lt;path to capath&gt;&quot; each time you add/remove a certificate.
</span><span id="__span-4-362"><a id="__codelineno-4-362" name="__codelineno-4-362" href="#__codelineno-4-362"></a>#cafile
</span><span id="__span-4-363"><a id="__codelineno-4-363" name="__codelineno-4-363" href="#__codelineno-4-363"></a>#capath
</span><span id="__span-4-364"><a id="__codelineno-4-364" name="__codelineno-4-364" href="#__codelineno-4-364"></a>
</span><span id="__span-4-365"><a id="__codelineno-4-365" name="__codelineno-4-365" href="#__codelineno-4-365"></a>
</span><span id="__span-4-366"><a id="__codelineno-4-366" name="__codelineno-4-366" href="#__codelineno-4-366"></a># If require_certificate is true, you may set use_identity_as_username to true
</span><span id="__span-4-367"><a id="__codelineno-4-367" name="__codelineno-4-367" href="#__codelineno-4-367"></a># to use the CN value from the client certificate as a username. If this is
</span><span id="__span-4-368"><a id="__codelineno-4-368" name="__codelineno-4-368" href="#__codelineno-4-368"></a># true, the password_file option will not be used for this listener.
</span><span id="__span-4-369"><a id="__codelineno-4-369" name="__codelineno-4-369" href="#__codelineno-4-369"></a>#use_identity_as_username false
</span><span id="__span-4-370"><a id="__codelineno-4-370" name="__codelineno-4-370" href="#__codelineno-4-370"></a>
</span><span id="__span-4-371"><a id="__codelineno-4-371" name="__codelineno-4-371" href="#__codelineno-4-371"></a># -----------------------------------------------------------------
</span><span id="__span-4-372"><a id="__codelineno-4-372" name="__codelineno-4-372" href="#__codelineno-4-372"></a># Pre-shared-key based SSL/TLS support
</span><span id="__span-4-373"><a id="__codelineno-4-373" name="__codelineno-4-373" href="#__codelineno-4-373"></a># -----------------------------------------------------------------
</span><span id="__span-4-374"><a id="__codelineno-4-374" name="__codelineno-4-374" href="#__codelineno-4-374"></a># The following options can be used to enable PSK based SSL/TLS support for
</span><span id="__span-4-375"><a id="__codelineno-4-375" name="__codelineno-4-375" href="#__codelineno-4-375"></a># this listener. Note that the recommended port for MQTT over TLS is 8883, but
</span><span id="__span-4-376"><a id="__codelineno-4-376" name="__codelineno-4-376" href="#__codelineno-4-376"></a># this must be set manually.
</span><span id="__span-4-377"><a id="__codelineno-4-377" name="__codelineno-4-377" href="#__codelineno-4-377"></a>#
</span><span id="__span-4-378"><a id="__codelineno-4-378" name="__codelineno-4-378" href="#__codelineno-4-378"></a># See also the mosquitto-tls man page and the &quot;Certificate based SSL/TLS
</span><span id="__span-4-379"><a id="__codelineno-4-379" name="__codelineno-4-379" href="#__codelineno-4-379"></a># support&quot; section. Only one of certificate or PSK encryption support can be
</span><span id="__span-4-380"><a id="__codelineno-4-380" name="__codelineno-4-380" href="#__codelineno-4-380"></a># enabled for any listener.
</span><span id="__span-4-381"><a id="__codelineno-4-381" name="__codelineno-4-381" href="#__codelineno-4-381"></a>
</span><span id="__span-4-382"><a id="__codelineno-4-382" name="__codelineno-4-382" href="#__codelineno-4-382"></a># The psk_hint option enables pre-shared-key support for this listener and also
</span><span id="__span-4-383"><a id="__codelineno-4-383" name="__codelineno-4-383" href="#__codelineno-4-383"></a># acts as an identifier for this listener. The hint is sent to clients and may
</span><span id="__span-4-384"><a id="__codelineno-4-384" name="__codelineno-4-384" href="#__codelineno-4-384"></a># be used locally to aid authentication. The hint is a free form string that
</span><span id="__span-4-385"><a id="__codelineno-4-385" name="__codelineno-4-385" href="#__codelineno-4-385"></a># doesn&#39;t have much meaning in itself, so feel free to be creative.
</span><span id="__span-4-386"><a id="__codelineno-4-386" name="__codelineno-4-386" href="#__codelineno-4-386"></a># If this option is provided, see psk_file to define the pre-shared keys to be
</span><span id="__span-4-387"><a id="__codelineno-4-387" name="__codelineno-4-387" href="#__codelineno-4-387"></a># used or create a security plugin to handle them.
</span><span id="__span-4-388"><a id="__codelineno-4-388" name="__codelineno-4-388" href="#__codelineno-4-388"></a>#psk_hint
</span><span id="__span-4-389"><a id="__codelineno-4-389" name="__codelineno-4-389" href="#__codelineno-4-389"></a>
</span><span id="__span-4-390"><a id="__codelineno-4-390" name="__codelineno-4-390" href="#__codelineno-4-390"></a># When using PSK, the encryption ciphers used will be chosen from the list of
</span><span id="__span-4-391"><a id="__codelineno-4-391" name="__codelineno-4-391" href="#__codelineno-4-391"></a># available PSK ciphers. If you want to control which ciphers are available,
</span><span id="__span-4-392"><a id="__codelineno-4-392" name="__codelineno-4-392" href="#__codelineno-4-392"></a># use the &quot;ciphers&quot; option.  The list of available ciphers can be optained
</span><span id="__span-4-393"><a id="__codelineno-4-393" name="__codelineno-4-393" href="#__codelineno-4-393"></a># using the &quot;openssl ciphers&quot; command and should be provided in the same format
</span><span id="__span-4-394"><a id="__codelineno-4-394" name="__codelineno-4-394" href="#__codelineno-4-394"></a># as the output of that command.
</span><span id="__span-4-395"><a id="__codelineno-4-395" name="__codelineno-4-395" href="#__codelineno-4-395"></a>#ciphers
</span><span id="__span-4-396"><a id="__codelineno-4-396" name="__codelineno-4-396" href="#__codelineno-4-396"></a>
</span><span id="__span-4-397"><a id="__codelineno-4-397" name="__codelineno-4-397" href="#__codelineno-4-397"></a># Set use_identity_as_username to have the psk identity sent by the client used
</span><span id="__span-4-398"><a id="__codelineno-4-398" name="__codelineno-4-398" href="#__codelineno-4-398"></a># as its username. Authentication will be carried out using the PSK rather than
</span><span id="__span-4-399"><a id="__codelineno-4-399" name="__codelineno-4-399" href="#__codelineno-4-399"></a># the MQTT username/password and so password_file will not be used for this
</span><span id="__span-4-400"><a id="__codelineno-4-400" name="__codelineno-4-400" href="#__codelineno-4-400"></a># listener.
</span><span id="__span-4-401"><a id="__codelineno-4-401" name="__codelineno-4-401" href="#__codelineno-4-401"></a>#use_identity_as_username false
</span><span id="__span-4-402"><a id="__codelineno-4-402" name="__codelineno-4-402" href="#__codelineno-4-402"></a>
</span><span id="__span-4-403"><a id="__codelineno-4-403" name="__codelineno-4-403" href="#__codelineno-4-403"></a>
</span><span id="__span-4-404"><a id="__codelineno-4-404" name="__codelineno-4-404" href="#__codelineno-4-404"></a># =================================================================
</span><span id="__span-4-405"><a id="__codelineno-4-405" name="__codelineno-4-405" href="#__codelineno-4-405"></a># Persistence
</span><span id="__span-4-406"><a id="__codelineno-4-406" name="__codelineno-4-406" href="#__codelineno-4-406"></a># =================================================================
</span><span id="__span-4-407"><a id="__codelineno-4-407" name="__codelineno-4-407" href="#__codelineno-4-407"></a>
</span><span id="__span-4-408"><a id="__codelineno-4-408" name="__codelineno-4-408" href="#__codelineno-4-408"></a># If persistence is enabled, save the in-memory database to disk
</span><span id="__span-4-409"><a id="__codelineno-4-409" name="__codelineno-4-409" href="#__codelineno-4-409"></a># every autosave_interval seconds. If set to 0, the persistence
</span><span id="__span-4-410"><a id="__codelineno-4-410" name="__codelineno-4-410" href="#__codelineno-4-410"></a># database will only be written when mosquitto exits. See also
</span><span id="__span-4-411"><a id="__codelineno-4-411" name="__codelineno-4-411" href="#__codelineno-4-411"></a># autosave_on_changes.
</span><span id="__span-4-412"><a id="__codelineno-4-412" name="__codelineno-4-412" href="#__codelineno-4-412"></a># Note that writing of the persistence database can be forced by
</span><span id="__span-4-413"><a id="__codelineno-4-413" name="__codelineno-4-413" href="#__codelineno-4-413"></a># sending mosquitto a SIGUSR1 signal.
</span><span id="__span-4-414"><a id="__codelineno-4-414" name="__codelineno-4-414" href="#__codelineno-4-414"></a>#autosave_interval 1800
</span><span id="__span-4-415"><a id="__codelineno-4-415" name="__codelineno-4-415" href="#__codelineno-4-415"></a>
</span><span id="__span-4-416"><a id="__codelineno-4-416" name="__codelineno-4-416" href="#__codelineno-4-416"></a># If true, mosquitto will count the number of subscription changes, retained
</span><span id="__span-4-417"><a id="__codelineno-4-417" name="__codelineno-4-417" href="#__codelineno-4-417"></a># messages received and queued messages and if the total exceeds
</span><span id="__span-4-418"><a id="__codelineno-4-418" name="__codelineno-4-418" href="#__codelineno-4-418"></a># autosave_interval then the in-memory database will be saved to disk.
</span><span id="__span-4-419"><a id="__codelineno-4-419" name="__codelineno-4-419" href="#__codelineno-4-419"></a># If false, mosquitto will save the in-memory database to disk by treating
</span><span id="__span-4-420"><a id="__codelineno-4-420" name="__codelineno-4-420" href="#__codelineno-4-420"></a># autosave_interval as a time in seconds.
</span><span id="__span-4-421"><a id="__codelineno-4-421" name="__codelineno-4-421" href="#__codelineno-4-421"></a>#autosave_on_changes false
</span><span id="__span-4-422"><a id="__codelineno-4-422" name="__codelineno-4-422" href="#__codelineno-4-422"></a>
</span><span id="__span-4-423"><a id="__codelineno-4-423" name="__codelineno-4-423" href="#__codelineno-4-423"></a># Save persistent message data to disk (true/false).
</span><span id="__span-4-424"><a id="__codelineno-4-424" name="__codelineno-4-424" href="#__codelineno-4-424"></a># This saves information about all messages, including
</span><span id="__span-4-425"><a id="__codelineno-4-425" name="__codelineno-4-425" href="#__codelineno-4-425"></a># subscriptions, currently in-flight messages and retained
</span><span id="__span-4-426"><a id="__codelineno-4-426" name="__codelineno-4-426" href="#__codelineno-4-426"></a># messages.
</span><span id="__span-4-427"><a id="__codelineno-4-427" name="__codelineno-4-427" href="#__codelineno-4-427"></a># retained_persistence is a synonym for this option.
</span><span id="__span-4-428"><a id="__codelineno-4-428" name="__codelineno-4-428" href="#__codelineno-4-428"></a>#persistence false
</span><span id="__span-4-429"><a id="__codelineno-4-429" name="__codelineno-4-429" href="#__codelineno-4-429"></a>
</span><span id="__span-4-430"><a id="__codelineno-4-430" name="__codelineno-4-430" href="#__codelineno-4-430"></a># The filename to use for the persistent database, not including
</span><span id="__span-4-431"><a id="__codelineno-4-431" name="__codelineno-4-431" href="#__codelineno-4-431"></a># the path.
</span><span id="__span-4-432"><a id="__codelineno-4-432" name="__codelineno-4-432" href="#__codelineno-4-432"></a>#persistence_file mosquitto.db
</span><span id="__span-4-433"><a id="__codelineno-4-433" name="__codelineno-4-433" href="#__codelineno-4-433"></a>
</span><span id="__span-4-434"><a id="__codelineno-4-434" name="__codelineno-4-434" href="#__codelineno-4-434"></a># Location for persistent database.
</span><span id="__span-4-435"><a id="__codelineno-4-435" name="__codelineno-4-435" href="#__codelineno-4-435"></a># Default is an empty string (current directory).
</span><span id="__span-4-436"><a id="__codelineno-4-436" name="__codelineno-4-436" href="#__codelineno-4-436"></a># Set to e.g. /var/lib/mosquitto if running as a proper service on Linux or
</span><span id="__span-4-437"><a id="__codelineno-4-437" name="__codelineno-4-437" href="#__codelineno-4-437"></a># similar.
</span><span id="__span-4-438"><a id="__codelineno-4-438" name="__codelineno-4-438" href="#__codelineno-4-438"></a>#persistence_location
</span><span id="__span-4-439"><a id="__codelineno-4-439" name="__codelineno-4-439" href="#__codelineno-4-439"></a>
</span><span id="__span-4-440"><a id="__codelineno-4-440" name="__codelineno-4-440" href="#__codelineno-4-440"></a>
</span><span id="__span-4-441"><a id="__codelineno-4-441" name="__codelineno-4-441" href="#__codelineno-4-441"></a># =================================================================
</span><span id="__span-4-442"><a id="__codelineno-4-442" name="__codelineno-4-442" href="#__codelineno-4-442"></a># Logging
</span><span id="__span-4-443"><a id="__codelineno-4-443" name="__codelineno-4-443" href="#__codelineno-4-443"></a># =================================================================
</span><span id="__span-4-444"><a id="__codelineno-4-444" name="__codelineno-4-444" href="#__codelineno-4-444"></a>
</span><span id="__span-4-445"><a id="__codelineno-4-445" name="__codelineno-4-445" href="#__codelineno-4-445"></a># Places to log to. Use multiple log_dest lines for multiple
</span><span id="__span-4-446"><a id="__codelineno-4-446" name="__codelineno-4-446" href="#__codelineno-4-446"></a># logging destinations.
</span><span id="__span-4-447"><a id="__codelineno-4-447" name="__codelineno-4-447" href="#__codelineno-4-447"></a># Possible destinations are: stdout stderr syslog topic file dlt
</span><span id="__span-4-448"><a id="__codelineno-4-448" name="__codelineno-4-448" href="#__codelineno-4-448"></a>#
</span><span id="__span-4-449"><a id="__codelineno-4-449" name="__codelineno-4-449" href="#__codelineno-4-449"></a># stdout and stderr log to the console on the named output.
</span><span id="__span-4-450"><a id="__codelineno-4-450" name="__codelineno-4-450" href="#__codelineno-4-450"></a>#
</span><span id="__span-4-451"><a id="__codelineno-4-451" name="__codelineno-4-451" href="#__codelineno-4-451"></a># syslog uses the userspace syslog facility which usually ends up
</span><span id="__span-4-452"><a id="__codelineno-4-452" name="__codelineno-4-452" href="#__codelineno-4-452"></a># in /var/log/messages or similar.
</span><span id="__span-4-453"><a id="__codelineno-4-453" name="__codelineno-4-453" href="#__codelineno-4-453"></a>#
</span><span id="__span-4-454"><a id="__codelineno-4-454" name="__codelineno-4-454" href="#__codelineno-4-454"></a># topic logs to the broker topic &#39;$SYS/broker/log/&lt;severity&gt;&#39;,
</span><span id="__span-4-455"><a id="__codelineno-4-455" name="__codelineno-4-455" href="#__codelineno-4-455"></a># where severity is one of D, E, W, N, I, M which are debug, error,
</span><span id="__span-4-456"><a id="__codelineno-4-456" name="__codelineno-4-456" href="#__codelineno-4-456"></a># warning, notice, information and message. Message type severity is used by
</span><span id="__span-4-457"><a id="__codelineno-4-457" name="__codelineno-4-457" href="#__codelineno-4-457"></a># the subscribe/unsubscribe log_types and publishes log messages to
</span><span id="__span-4-458"><a id="__codelineno-4-458" name="__codelineno-4-458" href="#__codelineno-4-458"></a># $SYS/broker/log/M/susbcribe or $SYS/broker/log/M/unsubscribe.
</span><span id="__span-4-459"><a id="__codelineno-4-459" name="__codelineno-4-459" href="#__codelineno-4-459"></a>#
</span><span id="__span-4-460"><a id="__codelineno-4-460" name="__codelineno-4-460" href="#__codelineno-4-460"></a># The file destination requires an additional parameter which is the file to be
</span><span id="__span-4-461"><a id="__codelineno-4-461" name="__codelineno-4-461" href="#__codelineno-4-461"></a># logged to, e.g. &quot;log_dest file /var/log/mosquitto.log&quot;. The file will be
</span><span id="__span-4-462"><a id="__codelineno-4-462" name="__codelineno-4-462" href="#__codelineno-4-462"></a># closed and reopened when the broker receives a HUP signal. Only a single file
</span><span id="__span-4-463"><a id="__codelineno-4-463" name="__codelineno-4-463" href="#__codelineno-4-463"></a># destination may be configured.
</span><span id="__span-4-464"><a id="__codelineno-4-464" name="__codelineno-4-464" href="#__codelineno-4-464"></a>#
</span><span id="__span-4-465"><a id="__codelineno-4-465" name="__codelineno-4-465" href="#__codelineno-4-465"></a># The dlt destination is for the automotive `Diagnostic Log and Trace` tool.
</span><span id="__span-4-466"><a id="__codelineno-4-466" name="__codelineno-4-466" href="#__codelineno-4-466"></a># This requires that Mosquitto has been compiled with DLT support.
</span><span id="__span-4-467"><a id="__codelineno-4-467" name="__codelineno-4-467" href="#__codelineno-4-467"></a>#
</span><span id="__span-4-468"><a id="__codelineno-4-468" name="__codelineno-4-468" href="#__codelineno-4-468"></a># Note that if the broker is running as a Windows service it will default to
</span><span id="__span-4-469"><a id="__codelineno-4-469" name="__codelineno-4-469" href="#__codelineno-4-469"></a># &quot;log_dest none&quot; and neither stdout nor stderr logging is available.
</span><span id="__span-4-470"><a id="__codelineno-4-470" name="__codelineno-4-470" href="#__codelineno-4-470"></a># Use &quot;log_dest none&quot; if you wish to disable logging.
</span><span id="__span-4-471"><a id="__codelineno-4-471" name="__codelineno-4-471" href="#__codelineno-4-471"></a>#log_dest stderr
</span><span id="__span-4-472"><a id="__codelineno-4-472" name="__codelineno-4-472" href="#__codelineno-4-472"></a>
</span><span id="__span-4-473"><a id="__codelineno-4-473" name="__codelineno-4-473" href="#__codelineno-4-473"></a># Types of messages to log. Use multiple log_type lines for logging
</span><span id="__span-4-474"><a id="__codelineno-4-474" name="__codelineno-4-474" href="#__codelineno-4-474"></a># multiple types of messages.
</span><span id="__span-4-475"><a id="__codelineno-4-475" name="__codelineno-4-475" href="#__codelineno-4-475"></a># Possible types are: debug, error, warning, notice, information,
</span><span id="__span-4-476"><a id="__codelineno-4-476" name="__codelineno-4-476" href="#__codelineno-4-476"></a># none, subscribe, unsubscribe, websockets, all.
</span><span id="__span-4-477"><a id="__codelineno-4-477" name="__codelineno-4-477" href="#__codelineno-4-477"></a># Note that debug type messages are for decoding the incoming/outgoing
</span><span id="__span-4-478"><a id="__codelineno-4-478" name="__codelineno-4-478" href="#__codelineno-4-478"></a># network packets. They are not logged in &quot;topics&quot;.
</span><span id="__span-4-479"><a id="__codelineno-4-479" name="__codelineno-4-479" href="#__codelineno-4-479"></a>#log_type error
</span><span id="__span-4-480"><a id="__codelineno-4-480" name="__codelineno-4-480" href="#__codelineno-4-480"></a>#log_type warning
</span><span id="__span-4-481"><a id="__codelineno-4-481" name="__codelineno-4-481" href="#__codelineno-4-481"></a>#log_type notice
</span><span id="__span-4-482"><a id="__codelineno-4-482" name="__codelineno-4-482" href="#__codelineno-4-482"></a>#log_type information
</span><span id="__span-4-483"><a id="__codelineno-4-483" name="__codelineno-4-483" href="#__codelineno-4-483"></a>
</span><span id="__span-4-484"><a id="__codelineno-4-484" name="__codelineno-4-484" href="#__codelineno-4-484"></a>
</span><span id="__span-4-485"><a id="__codelineno-4-485" name="__codelineno-4-485" href="#__codelineno-4-485"></a># If set to true, client connection and disconnection messages will be included
</span><span id="__span-4-486"><a id="__codelineno-4-486" name="__codelineno-4-486" href="#__codelineno-4-486"></a># in the log.
</span><span id="__span-4-487"><a id="__codelineno-4-487" name="__codelineno-4-487" href="#__codelineno-4-487"></a>#connection_messages true
</span><span id="__span-4-488"><a id="__codelineno-4-488" name="__codelineno-4-488" href="#__codelineno-4-488"></a>
</span><span id="__span-4-489"><a id="__codelineno-4-489" name="__codelineno-4-489" href="#__codelineno-4-489"></a># If using syslog logging (not on Windows), messages will be logged to the
</span><span id="__span-4-490"><a id="__codelineno-4-490" name="__codelineno-4-490" href="#__codelineno-4-490"></a># &quot;daemon&quot; facility by default. Use the log_facility option to choose which of
</span><span id="__span-4-491"><a id="__codelineno-4-491" name="__codelineno-4-491" href="#__codelineno-4-491"></a># local0 to local7 to log to instead. The option value should be an integer
</span><span id="__span-4-492"><a id="__codelineno-4-492" name="__codelineno-4-492" href="#__codelineno-4-492"></a># value, e.g. &quot;log_facility 5&quot; to use local5.
</span><span id="__span-4-493"><a id="__codelineno-4-493" name="__codelineno-4-493" href="#__codelineno-4-493"></a>#log_facility
</span><span id="__span-4-494"><a id="__codelineno-4-494" name="__codelineno-4-494" href="#__codelineno-4-494"></a>
</span><span id="__span-4-495"><a id="__codelineno-4-495" name="__codelineno-4-495" href="#__codelineno-4-495"></a># If set to true, add a timestamp value to each log message.
</span><span id="__span-4-496"><a id="__codelineno-4-496" name="__codelineno-4-496" href="#__codelineno-4-496"></a>#log_timestamp true
</span><span id="__span-4-497"><a id="__codelineno-4-497" name="__codelineno-4-497" href="#__codelineno-4-497"></a>
</span><span id="__span-4-498"><a id="__codelineno-4-498" name="__codelineno-4-498" href="#__codelineno-4-498"></a># Set the format of the log timestamp. If left unset, this is the number of
</span><span id="__span-4-499"><a id="__codelineno-4-499" name="__codelineno-4-499" href="#__codelineno-4-499"></a># seconds since the Unix epoch.
</span><span id="__span-4-500"><a id="__codelineno-4-500" name="__codelineno-4-500" href="#__codelineno-4-500"></a># This is a free text string which will be passed to the strftime function. To
</span><span id="__span-4-501"><a id="__codelineno-4-501" name="__codelineno-4-501" href="#__codelineno-4-501"></a># get an ISO 8601 datetime, for example:
</span><span id="__span-4-502"><a id="__codelineno-4-502" name="__codelineno-4-502" href="#__codelineno-4-502"></a># log_timestamp_format %Y-%m-%dT%H:%M:%S
</span><span id="__span-4-503"><a id="__codelineno-4-503" name="__codelineno-4-503" href="#__codelineno-4-503"></a>#log_timestamp_format
</span><span id="__span-4-504"><a id="__codelineno-4-504" name="__codelineno-4-504" href="#__codelineno-4-504"></a>
</span><span id="__span-4-505"><a id="__codelineno-4-505" name="__codelineno-4-505" href="#__codelineno-4-505"></a># Change the websockets logging level. This is a global option, it is not
</span><span id="__span-4-506"><a id="__codelineno-4-506" name="__codelineno-4-506" href="#__codelineno-4-506"></a># possible to set per listener. This is an integer that is interpreted by
</span><span id="__span-4-507"><a id="__codelineno-4-507" name="__codelineno-4-507" href="#__codelineno-4-507"></a># libwebsockets as a bit mask for its lws_log_levels enum. See the
</span><span id="__span-4-508"><a id="__codelineno-4-508" name="__codelineno-4-508" href="#__codelineno-4-508"></a># libwebsockets documentation for more details. &quot;log_type websockets&quot; must also
</span><span id="__span-4-509"><a id="__codelineno-4-509" name="__codelineno-4-509" href="#__codelineno-4-509"></a># be enabled.
</span><span id="__span-4-510"><a id="__codelineno-4-510" name="__codelineno-4-510" href="#__codelineno-4-510"></a>#websockets_log_level 0
</span><span id="__span-4-511"><a id="__codelineno-4-511" name="__codelineno-4-511" href="#__codelineno-4-511"></a>
</span><span id="__span-4-512"><a id="__codelineno-4-512" name="__codelineno-4-512" href="#__codelineno-4-512"></a>
</span><span id="__span-4-513"><a id="__codelineno-4-513" name="__codelineno-4-513" href="#__codelineno-4-513"></a># =================================================================
</span><span id="__span-4-514"><a id="__codelineno-4-514" name="__codelineno-4-514" href="#__codelineno-4-514"></a># Security
</span><span id="__span-4-515"><a id="__codelineno-4-515" name="__codelineno-4-515" href="#__codelineno-4-515"></a># =================================================================
</span><span id="__span-4-516"><a id="__codelineno-4-516" name="__codelineno-4-516" href="#__codelineno-4-516"></a>
</span><span id="__span-4-517"><a id="__codelineno-4-517" name="__codelineno-4-517" href="#__codelineno-4-517"></a># If set, only clients that have a matching prefix on their
</span><span id="__span-4-518"><a id="__codelineno-4-518" name="__codelineno-4-518" href="#__codelineno-4-518"></a># clientid will be allowed to connect to the broker. By default,
</span><span id="__span-4-519"><a id="__codelineno-4-519" name="__codelineno-4-519" href="#__codelineno-4-519"></a># all clients may connect.
</span><span id="__span-4-520"><a id="__codelineno-4-520" name="__codelineno-4-520" href="#__codelineno-4-520"></a># For example, setting &quot;secure-&quot; here would mean a client &quot;secure-
</span><span id="__span-4-521"><a id="__codelineno-4-521" name="__codelineno-4-521" href="#__codelineno-4-521"></a># client&quot; could connect but another with clientid &quot;mqtt&quot; couldn&#39;t.
</span><span id="__span-4-522"><a id="__codelineno-4-522" name="__codelineno-4-522" href="#__codelineno-4-522"></a>#clientid_prefixes
</span><span id="__span-4-523"><a id="__codelineno-4-523" name="__codelineno-4-523" href="#__codelineno-4-523"></a>
</span><span id="__span-4-524"><a id="__codelineno-4-524" name="__codelineno-4-524" href="#__codelineno-4-524"></a># Boolean value that determines whether clients that connect
</span><span id="__span-4-525"><a id="__codelineno-4-525" name="__codelineno-4-525" href="#__codelineno-4-525"></a># without providing a username are allowed to connect. If set to
</span><span id="__span-4-526"><a id="__codelineno-4-526" name="__codelineno-4-526" href="#__codelineno-4-526"></a># false then a password file should be created (see the
</span><span id="__span-4-527"><a id="__codelineno-4-527" name="__codelineno-4-527" href="#__codelineno-4-527"></a># password_file option) to control authenticated client access.
</span><span id="__span-4-528"><a id="__codelineno-4-528" name="__codelineno-4-528" href="#__codelineno-4-528"></a>#
</span><span id="__span-4-529"><a id="__codelineno-4-529" name="__codelineno-4-529" href="#__codelineno-4-529"></a># Defaults to false, unless there are no listeners defined in the configuration
</span><span id="__span-4-530"><a id="__codelineno-4-530" name="__codelineno-4-530" href="#__codelineno-4-530"></a># file, in which case it is set to true, but connections are only allowed from
</span><span id="__span-4-531"><a id="__codelineno-4-531" name="__codelineno-4-531" href="#__codelineno-4-531"></a># the local machine.
</span><span id="__span-4-532"><a id="__codelineno-4-532" name="__codelineno-4-532" href="#__codelineno-4-532"></a>#allow_anonymous false
</span><span id="__span-4-533"><a id="__codelineno-4-533" name="__codelineno-4-533" href="#__codelineno-4-533"></a>
</span><span id="__span-4-534"><a id="__codelineno-4-534" name="__codelineno-4-534" href="#__codelineno-4-534"></a># -----------------------------------------------------------------
</span><span id="__span-4-535"><a id="__codelineno-4-535" name="__codelineno-4-535" href="#__codelineno-4-535"></a># Default authentication and topic access control
</span><span id="__span-4-536"><a id="__codelineno-4-536" name="__codelineno-4-536" href="#__codelineno-4-536"></a># -----------------------------------------------------------------
</span><span id="__span-4-537"><a id="__codelineno-4-537" name="__codelineno-4-537" href="#__codelineno-4-537"></a>
</span><span id="__span-4-538"><a id="__codelineno-4-538" name="__codelineno-4-538" href="#__codelineno-4-538"></a># Control access to the broker using a password file. This file can be
</span><span id="__span-4-539"><a id="__codelineno-4-539" name="__codelineno-4-539" href="#__codelineno-4-539"></a># generated using the mosquitto_passwd utility. If TLS support is not compiled
</span><span id="__span-4-540"><a id="__codelineno-4-540" name="__codelineno-4-540" href="#__codelineno-4-540"></a># into mosquitto (it is recommended that TLS support should be included) then
</span><span id="__span-4-541"><a id="__codelineno-4-541" name="__codelineno-4-541" href="#__codelineno-4-541"></a># plain text passwords are used, in which case the file should be a text file
</span><span id="__span-4-542"><a id="__codelineno-4-542" name="__codelineno-4-542" href="#__codelineno-4-542"></a># with lines in the format:
</span><span id="__span-4-543"><a id="__codelineno-4-543" name="__codelineno-4-543" href="#__codelineno-4-543"></a># username:password
</span><span id="__span-4-544"><a id="__codelineno-4-544" name="__codelineno-4-544" href="#__codelineno-4-544"></a># The password (and colon) may be omitted if desired, although this
</span><span id="__span-4-545"><a id="__codelineno-4-545" name="__codelineno-4-545" href="#__codelineno-4-545"></a># offers very little in the way of security.
</span><span id="__span-4-546"><a id="__codelineno-4-546" name="__codelineno-4-546" href="#__codelineno-4-546"></a>#
</span><span id="__span-4-547"><a id="__codelineno-4-547" name="__codelineno-4-547" href="#__codelineno-4-547"></a># See the TLS client require_certificate and use_identity_as_username options
</span><span id="__span-4-548"><a id="__codelineno-4-548" name="__codelineno-4-548" href="#__codelineno-4-548"></a># for alternative authentication options. If a plugin is used as well as
</span><span id="__span-4-549"><a id="__codelineno-4-549" name="__codelineno-4-549" href="#__codelineno-4-549"></a># password_file, the plugin check will be made first.
</span><span id="__span-4-550"><a id="__codelineno-4-550" name="__codelineno-4-550" href="#__codelineno-4-550"></a>#password_file
</span><span id="__span-4-551"><a id="__codelineno-4-551" name="__codelineno-4-551" href="#__codelineno-4-551"></a>
</span><span id="__span-4-552"><a id="__codelineno-4-552" name="__codelineno-4-552" href="#__codelineno-4-552"></a># Access may also be controlled using a pre-shared-key file. This requires
</span><span id="__span-4-553"><a id="__codelineno-4-553" name="__codelineno-4-553" href="#__codelineno-4-553"></a># TLS-PSK support and a listener configured to use it. The file should be text
</span><span id="__span-4-554"><a id="__codelineno-4-554" name="__codelineno-4-554" href="#__codelineno-4-554"></a># lines in the format:
</span><span id="__span-4-555"><a id="__codelineno-4-555" name="__codelineno-4-555" href="#__codelineno-4-555"></a># identity:key
</span><span id="__span-4-556"><a id="__codelineno-4-556" name="__codelineno-4-556" href="#__codelineno-4-556"></a># The key should be in hexadecimal format without a leading &quot;0x&quot;.
</span><span id="__span-4-557"><a id="__codelineno-4-557" name="__codelineno-4-557" href="#__codelineno-4-557"></a># If an plugin is used as well, the plugin check will be made first.
</span><span id="__span-4-558"><a id="__codelineno-4-558" name="__codelineno-4-558" href="#__codelineno-4-558"></a>#psk_file
</span><span id="__span-4-559"><a id="__codelineno-4-559" name="__codelineno-4-559" href="#__codelineno-4-559"></a>
</span><span id="__span-4-560"><a id="__codelineno-4-560" name="__codelineno-4-560" href="#__codelineno-4-560"></a># Control access to topics on the broker using an access control list
</span><span id="__span-4-561"><a id="__codelineno-4-561" name="__codelineno-4-561" href="#__codelineno-4-561"></a># file. If this parameter is defined then only the topics listed will
</span><span id="__span-4-562"><a id="__codelineno-4-562" name="__codelineno-4-562" href="#__codelineno-4-562"></a># have access.
</span><span id="__span-4-563"><a id="__codelineno-4-563" name="__codelineno-4-563" href="#__codelineno-4-563"></a># If the first character of a line of the ACL file is a # it is treated as a
</span><span id="__span-4-564"><a id="__codelineno-4-564" name="__codelineno-4-564" href="#__codelineno-4-564"></a># comment.
</span><span id="__span-4-565"><a id="__codelineno-4-565" name="__codelineno-4-565" href="#__codelineno-4-565"></a># Topic access is added with lines of the format:
</span><span id="__span-4-566"><a id="__codelineno-4-566" name="__codelineno-4-566" href="#__codelineno-4-566"></a>#
</span><span id="__span-4-567"><a id="__codelineno-4-567" name="__codelineno-4-567" href="#__codelineno-4-567"></a># topic [read|write|readwrite|deny] &lt;topic&gt;
</span><span id="__span-4-568"><a id="__codelineno-4-568" name="__codelineno-4-568" href="#__codelineno-4-568"></a>#
</span><span id="__span-4-569"><a id="__codelineno-4-569" name="__codelineno-4-569" href="#__codelineno-4-569"></a># The access type is controlled using &quot;read&quot;, &quot;write&quot;, &quot;readwrite&quot; or &quot;deny&quot;.
</span><span id="__span-4-570"><a id="__codelineno-4-570" name="__codelineno-4-570" href="#__codelineno-4-570"></a># This parameter is optional (unless &lt;topic&gt; contains a space character) - if
</span><span id="__span-4-571"><a id="__codelineno-4-571" name="__codelineno-4-571" href="#__codelineno-4-571"></a># not given then the access is read/write.  &lt;topic&gt; can contain the + or #
</span><span id="__span-4-572"><a id="__codelineno-4-572" name="__codelineno-4-572" href="#__codelineno-4-572"></a># wildcards as in subscriptions.
</span><span id="__span-4-573"><a id="__codelineno-4-573" name="__codelineno-4-573" href="#__codelineno-4-573"></a>#
</span><span id="__span-4-574"><a id="__codelineno-4-574" name="__codelineno-4-574" href="#__codelineno-4-574"></a># The &quot;deny&quot; option can used to explicity deny access to a topic that would
</span><span id="__span-4-575"><a id="__codelineno-4-575" name="__codelineno-4-575" href="#__codelineno-4-575"></a># otherwise be granted by a broader read/write/readwrite statement. Any &quot;deny&quot;
</span><span id="__span-4-576"><a id="__codelineno-4-576" name="__codelineno-4-576" href="#__codelineno-4-576"></a># topics are handled before topics that grant read/write access.
</span><span id="__span-4-577"><a id="__codelineno-4-577" name="__codelineno-4-577" href="#__codelineno-4-577"></a>#
</span><span id="__span-4-578"><a id="__codelineno-4-578" name="__codelineno-4-578" href="#__codelineno-4-578"></a># The first set of topics are applied to anonymous clients, assuming
</span><span id="__span-4-579"><a id="__codelineno-4-579" name="__codelineno-4-579" href="#__codelineno-4-579"></a># allow_anonymous is true. User specific topic ACLs are added after a
</span><span id="__span-4-580"><a id="__codelineno-4-580" name="__codelineno-4-580" href="#__codelineno-4-580"></a># user line as follows:
</span><span id="__span-4-581"><a id="__codelineno-4-581" name="__codelineno-4-581" href="#__codelineno-4-581"></a>#
</span><span id="__span-4-582"><a id="__codelineno-4-582" name="__codelineno-4-582" href="#__codelineno-4-582"></a># user &lt;username&gt;
</span><span id="__span-4-583"><a id="__codelineno-4-583" name="__codelineno-4-583" href="#__codelineno-4-583"></a>#
</span><span id="__span-4-584"><a id="__codelineno-4-584" name="__codelineno-4-584" href="#__codelineno-4-584"></a># The username referred to here is the same as in password_file. It is
</span><span id="__span-4-585"><a id="__codelineno-4-585" name="__codelineno-4-585" href="#__codelineno-4-585"></a># not the clientid.
</span><span id="__span-4-586"><a id="__codelineno-4-586" name="__codelineno-4-586" href="#__codelineno-4-586"></a>#
</span><span id="__span-4-587"><a id="__codelineno-4-587" name="__codelineno-4-587" href="#__codelineno-4-587"></a>#
</span><span id="__span-4-588"><a id="__codelineno-4-588" name="__codelineno-4-588" href="#__codelineno-4-588"></a># If is also possible to define ACLs based on pattern substitution within the
</span><span id="__span-4-589"><a id="__codelineno-4-589" name="__codelineno-4-589" href="#__codelineno-4-589"></a># topic. The patterns available for substition are:
</span><span id="__span-4-590"><a id="__codelineno-4-590" name="__codelineno-4-590" href="#__codelineno-4-590"></a>#
</span><span id="__span-4-591"><a id="__codelineno-4-591" name="__codelineno-4-591" href="#__codelineno-4-591"></a># %c to match the client id of the client
</span><span id="__span-4-592"><a id="__codelineno-4-592" name="__codelineno-4-592" href="#__codelineno-4-592"></a># %u to match the username of the client
</span><span id="__span-4-593"><a id="__codelineno-4-593" name="__codelineno-4-593" href="#__codelineno-4-593"></a>#
</span><span id="__span-4-594"><a id="__codelineno-4-594" name="__codelineno-4-594" href="#__codelineno-4-594"></a># The substitution pattern must be the only text for that level of hierarchy.
</span><span id="__span-4-595"><a id="__codelineno-4-595" name="__codelineno-4-595" href="#__codelineno-4-595"></a>#
</span><span id="__span-4-596"><a id="__codelineno-4-596" name="__codelineno-4-596" href="#__codelineno-4-596"></a># The form is the same as for the topic keyword, but using pattern as the
</span><span id="__span-4-597"><a id="__codelineno-4-597" name="__codelineno-4-597" href="#__codelineno-4-597"></a># keyword.
</span><span id="__span-4-598"><a id="__codelineno-4-598" name="__codelineno-4-598" href="#__codelineno-4-598"></a># Pattern ACLs apply to all users even if the &quot;user&quot; keyword has previously
</span><span id="__span-4-599"><a id="__codelineno-4-599" name="__codelineno-4-599" href="#__codelineno-4-599"></a># been given.
</span><span id="__span-4-600"><a id="__codelineno-4-600" name="__codelineno-4-600" href="#__codelineno-4-600"></a>#
</span><span id="__span-4-601"><a id="__codelineno-4-601" name="__codelineno-4-601" href="#__codelineno-4-601"></a># If using bridges with usernames and ACLs, connection messages can be allowed
</span><span id="__span-4-602"><a id="__codelineno-4-602" name="__codelineno-4-602" href="#__codelineno-4-602"></a># with the following pattern:
</span><span id="__span-4-603"><a id="__codelineno-4-603" name="__codelineno-4-603" href="#__codelineno-4-603"></a># pattern write $SYS/broker/connection/%c/state
</span><span id="__span-4-604"><a id="__codelineno-4-604" name="__codelineno-4-604" href="#__codelineno-4-604"></a>#
</span><span id="__span-4-605"><a id="__codelineno-4-605" name="__codelineno-4-605" href="#__codelineno-4-605"></a># pattern [read|write|readwrite] &lt;topic&gt;
</span><span id="__span-4-606"><a id="__codelineno-4-606" name="__codelineno-4-606" href="#__codelineno-4-606"></a>#
</span><span id="__span-4-607"><a id="__codelineno-4-607" name="__codelineno-4-607" href="#__codelineno-4-607"></a># Example:
</span><span id="__span-4-608"><a id="__codelineno-4-608" name="__codelineno-4-608" href="#__codelineno-4-608"></a>#
</span><span id="__span-4-609"><a id="__codelineno-4-609" name="__codelineno-4-609" href="#__codelineno-4-609"></a># pattern write sensor/%u/data
</span><span id="__span-4-610"><a id="__codelineno-4-610" name="__codelineno-4-610" href="#__codelineno-4-610"></a>#
</span><span id="__span-4-611"><a id="__codelineno-4-611" name="__codelineno-4-611" href="#__codelineno-4-611"></a># If an plugin is used as well as acl_file, the plugin check will be
</span><span id="__span-4-612"><a id="__codelineno-4-612" name="__codelineno-4-612" href="#__codelineno-4-612"></a># made first.
</span><span id="__span-4-613"><a id="__codelineno-4-613" name="__codelineno-4-613" href="#__codelineno-4-613"></a>#acl_file
</span><span id="__span-4-614"><a id="__codelineno-4-614" name="__codelineno-4-614" href="#__codelineno-4-614"></a>
</span><span id="__span-4-615"><a id="__codelineno-4-615" name="__codelineno-4-615" href="#__codelineno-4-615"></a># -----------------------------------------------------------------
</span><span id="__span-4-616"><a id="__codelineno-4-616" name="__codelineno-4-616" href="#__codelineno-4-616"></a># External authentication and topic access plugin options
</span><span id="__span-4-617"><a id="__codelineno-4-617" name="__codelineno-4-617" href="#__codelineno-4-617"></a># -----------------------------------------------------------------
</span><span id="__span-4-618"><a id="__codelineno-4-618" name="__codelineno-4-618" href="#__codelineno-4-618"></a>
</span><span id="__span-4-619"><a id="__codelineno-4-619" name="__codelineno-4-619" href="#__codelineno-4-619"></a># External authentication and access control can be supported with the
</span><span id="__span-4-620"><a id="__codelineno-4-620" name="__codelineno-4-620" href="#__codelineno-4-620"></a># plugin option. This is a path to a loadable plugin. See also the
</span><span id="__span-4-621"><a id="__codelineno-4-621" name="__codelineno-4-621" href="#__codelineno-4-621"></a># plugin_opt_* options described below.
</span><span id="__span-4-622"><a id="__codelineno-4-622" name="__codelineno-4-622" href="#__codelineno-4-622"></a>#
</span><span id="__span-4-623"><a id="__codelineno-4-623" name="__codelineno-4-623" href="#__codelineno-4-623"></a># The plugin option can be specified multiple times to load multiple
</span><span id="__span-4-624"><a id="__codelineno-4-624" name="__codelineno-4-624" href="#__codelineno-4-624"></a># plugins. The plugins will be processed in the order that they are specified
</span><span id="__span-4-625"><a id="__codelineno-4-625" name="__codelineno-4-625" href="#__codelineno-4-625"></a># here. If the plugin option is specified alongside either of
</span><span id="__span-4-626"><a id="__codelineno-4-626" name="__codelineno-4-626" href="#__codelineno-4-626"></a># password_file or acl_file then the plugin checks will be made first.
</span><span id="__span-4-627"><a id="__codelineno-4-627" name="__codelineno-4-627" href="#__codelineno-4-627"></a>#
</span><span id="__span-4-628"><a id="__codelineno-4-628" name="__codelineno-4-628" href="#__codelineno-4-628"></a># If the per_listener_settings option is false, the plugin will be apply to all
</span><span id="__span-4-629"><a id="__codelineno-4-629" name="__codelineno-4-629" href="#__codelineno-4-629"></a># listeners. If per_listener_settings is true, then the plugin will apply to
</span><span id="__span-4-630"><a id="__codelineno-4-630" name="__codelineno-4-630" href="#__codelineno-4-630"></a># the current listener being defined only.
</span><span id="__span-4-631"><a id="__codelineno-4-631" name="__codelineno-4-631" href="#__codelineno-4-631"></a>#
</span><span id="__span-4-632"><a id="__codelineno-4-632" name="__codelineno-4-632" href="#__codelineno-4-632"></a># This option is also available as `auth_plugin`, but this use is deprecated
</span><span id="__span-4-633"><a id="__codelineno-4-633" name="__codelineno-4-633" href="#__codelineno-4-633"></a># and will be removed in the future.
</span><span id="__span-4-634"><a id="__codelineno-4-634" name="__codelineno-4-634" href="#__codelineno-4-634"></a>#
</span><span id="__span-4-635"><a id="__codelineno-4-635" name="__codelineno-4-635" href="#__codelineno-4-635"></a>#plugin
</span><span id="__span-4-636"><a id="__codelineno-4-636" name="__codelineno-4-636" href="#__codelineno-4-636"></a>
</span><span id="__span-4-637"><a id="__codelineno-4-637" name="__codelineno-4-637" href="#__codelineno-4-637"></a># If the plugin option above is used, define options to pass to the
</span><span id="__span-4-638"><a id="__codelineno-4-638" name="__codelineno-4-638" href="#__codelineno-4-638"></a># plugin here as described by the plugin instructions. All options named
</span><span id="__span-4-639"><a id="__codelineno-4-639" name="__codelineno-4-639" href="#__codelineno-4-639"></a># using the format plugin_opt_* will be passed to the plugin, for example:
</span><span id="__span-4-640"><a id="__codelineno-4-640" name="__codelineno-4-640" href="#__codelineno-4-640"></a>#
</span><span id="__span-4-641"><a id="__codelineno-4-641" name="__codelineno-4-641" href="#__codelineno-4-641"></a># This option is also available as `auth_opt_*`, but this use is deprecated
</span><span id="__span-4-642"><a id="__codelineno-4-642" name="__codelineno-4-642" href="#__codelineno-4-642"></a># and will be removed in the future.
</span><span id="__span-4-643"><a id="__codelineno-4-643" name="__codelineno-4-643" href="#__codelineno-4-643"></a>#
</span><span id="__span-4-644"><a id="__codelineno-4-644" name="__codelineno-4-644" href="#__codelineno-4-644"></a># plugin_opt_db_host
</span><span id="__span-4-645"><a id="__codelineno-4-645" name="__codelineno-4-645" href="#__codelineno-4-645"></a># plugin_opt_db_port
</span><span id="__span-4-646"><a id="__codelineno-4-646" name="__codelineno-4-646" href="#__codelineno-4-646"></a># plugin_opt_db_username
</span><span id="__span-4-647"><a id="__codelineno-4-647" name="__codelineno-4-647" href="#__codelineno-4-647"></a># plugin_opt_db_password
</span><span id="__span-4-648"><a id="__codelineno-4-648" name="__codelineno-4-648" href="#__codelineno-4-648"></a>
</span><span id="__span-4-649"><a id="__codelineno-4-649" name="__codelineno-4-649" href="#__codelineno-4-649"></a>
</span><span id="__span-4-650"><a id="__codelineno-4-650" name="__codelineno-4-650" href="#__codelineno-4-650"></a># =================================================================
</span><span id="__span-4-651"><a id="__codelineno-4-651" name="__codelineno-4-651" href="#__codelineno-4-651"></a># Bridges
</span><span id="__span-4-652"><a id="__codelineno-4-652" name="__codelineno-4-652" href="#__codelineno-4-652"></a># =================================================================
</span><span id="__span-4-653"><a id="__codelineno-4-653" name="__codelineno-4-653" href="#__codelineno-4-653"></a>
</span><span id="__span-4-654"><a id="__codelineno-4-654" name="__codelineno-4-654" href="#__codelineno-4-654"></a># A bridge is a way of connecting multiple MQTT brokers together.
</span><span id="__span-4-655"><a id="__codelineno-4-655" name="__codelineno-4-655" href="#__codelineno-4-655"></a># Create a new bridge using the &quot;connection&quot; option as described below. Set
</span><span id="__span-4-656"><a id="__codelineno-4-656" name="__codelineno-4-656" href="#__codelineno-4-656"></a># options for the bridges using the remaining parameters. You must specify the
</span><span id="__span-4-657"><a id="__codelineno-4-657" name="__codelineno-4-657" href="#__codelineno-4-657"></a># address and at least one topic to subscribe to.
</span><span id="__span-4-658"><a id="__codelineno-4-658" name="__codelineno-4-658" href="#__codelineno-4-658"></a>#
</span><span id="__span-4-659"><a id="__codelineno-4-659" name="__codelineno-4-659" href="#__codelineno-4-659"></a># Each connection must have a unique name.
</span><span id="__span-4-660"><a id="__codelineno-4-660" name="__codelineno-4-660" href="#__codelineno-4-660"></a>#
</span><span id="__span-4-661"><a id="__codelineno-4-661" name="__codelineno-4-661" href="#__codelineno-4-661"></a># The address line may have multiple host address and ports specified. See
</span><span id="__span-4-662"><a id="__codelineno-4-662" name="__codelineno-4-662" href="#__codelineno-4-662"></a># below in the round_robin description for more details on bridge behaviour if
</span><span id="__span-4-663"><a id="__codelineno-4-663" name="__codelineno-4-663" href="#__codelineno-4-663"></a># multiple addresses are used. Note that if you use an IPv6 address, then you
</span><span id="__span-4-664"><a id="__codelineno-4-664" name="__codelineno-4-664" href="#__codelineno-4-664"></a># are required to specify a port.
</span><span id="__span-4-665"><a id="__codelineno-4-665" name="__codelineno-4-665" href="#__codelineno-4-665"></a>#
</span><span id="__span-4-666"><a id="__codelineno-4-666" name="__codelineno-4-666" href="#__codelineno-4-666"></a># The direction that the topic will be shared can be chosen by
</span><span id="__span-4-667"><a id="__codelineno-4-667" name="__codelineno-4-667" href="#__codelineno-4-667"></a># specifying out, in or both, where the default value is out.
</span><span id="__span-4-668"><a id="__codelineno-4-668" name="__codelineno-4-668" href="#__codelineno-4-668"></a># The QoS level of the bridged communication can be specified with the next
</span><span id="__span-4-669"><a id="__codelineno-4-669" name="__codelineno-4-669" href="#__codelineno-4-669"></a># topic option. The default QoS level is 0, to change the QoS the topic
</span><span id="__span-4-670"><a id="__codelineno-4-670" name="__codelineno-4-670" href="#__codelineno-4-670"></a># direction must also be given.
</span><span id="__span-4-671"><a id="__codelineno-4-671" name="__codelineno-4-671" href="#__codelineno-4-671"></a>#
</span><span id="__span-4-672"><a id="__codelineno-4-672" name="__codelineno-4-672" href="#__codelineno-4-672"></a># The local and remote prefix options allow a topic to be remapped when it is
</span><span id="__span-4-673"><a id="__codelineno-4-673" name="__codelineno-4-673" href="#__codelineno-4-673"></a># bridged to/from the remote broker. This provides the ability to place a topic
</span><span id="__span-4-674"><a id="__codelineno-4-674" name="__codelineno-4-674" href="#__codelineno-4-674"></a># tree in an appropriate location.
</span><span id="__span-4-675"><a id="__codelineno-4-675" name="__codelineno-4-675" href="#__codelineno-4-675"></a>#
</span><span id="__span-4-676"><a id="__codelineno-4-676" name="__codelineno-4-676" href="#__codelineno-4-676"></a># For more details see the mosquitto.conf man page.
</span><span id="__span-4-677"><a id="__codelineno-4-677" name="__codelineno-4-677" href="#__codelineno-4-677"></a>#
</span><span id="__span-4-678"><a id="__codelineno-4-678" name="__codelineno-4-678" href="#__codelineno-4-678"></a># Multiple topics can be specified per connection, but be careful
</span><span id="__span-4-679"><a id="__codelineno-4-679" name="__codelineno-4-679" href="#__codelineno-4-679"></a># not to create any loops.
</span><span id="__span-4-680"><a id="__codelineno-4-680" name="__codelineno-4-680" href="#__codelineno-4-680"></a>#
</span><span id="__span-4-681"><a id="__codelineno-4-681" name="__codelineno-4-681" href="#__codelineno-4-681"></a># If you are using bridges with cleansession set to false (the default), then
</span><span id="__span-4-682"><a id="__codelineno-4-682" name="__codelineno-4-682" href="#__codelineno-4-682"></a># you may get unexpected behaviour from incoming topics if you change what
</span><span id="__span-4-683"><a id="__codelineno-4-683" name="__codelineno-4-683" href="#__codelineno-4-683"></a># topics you are subscribing to. This is because the remote broker keeps the
</span><span id="__span-4-684"><a id="__codelineno-4-684" name="__codelineno-4-684" href="#__codelineno-4-684"></a># subscription for the old topic. If you have this problem, connect your bridge
</span><span id="__span-4-685"><a id="__codelineno-4-685" name="__codelineno-4-685" href="#__codelineno-4-685"></a># with cleansession set to true, then reconnect with cleansession set to false
</span><span id="__span-4-686"><a id="__codelineno-4-686" name="__codelineno-4-686" href="#__codelineno-4-686"></a># as normal.
</span><span id="__span-4-687"><a id="__codelineno-4-687" name="__codelineno-4-687" href="#__codelineno-4-687"></a>#connection &lt;name&gt;
</span><span id="__span-4-688"><a id="__codelineno-4-688" name="__codelineno-4-688" href="#__codelineno-4-688"></a>#address &lt;host&gt;[:&lt;port&gt;] [&lt;host&gt;[:&lt;port&gt;]]
</span><span id="__span-4-689"><a id="__codelineno-4-689" name="__codelineno-4-689" href="#__codelineno-4-689"></a>#topic &lt;topic&gt; [[[out | in | both] qos-level] local-prefix remote-prefix]
</span><span id="__span-4-690"><a id="__codelineno-4-690" name="__codelineno-4-690" href="#__codelineno-4-690"></a>
</span><span id="__span-4-691"><a id="__codelineno-4-691" name="__codelineno-4-691" href="#__codelineno-4-691"></a># If you need to have the bridge connect over a particular network interface,
</span><span id="__span-4-692"><a id="__codelineno-4-692" name="__codelineno-4-692" href="#__codelineno-4-692"></a># use bridge_bind_address to tell the bridge which local IP address the socket
</span><span id="__span-4-693"><a id="__codelineno-4-693" name="__codelineno-4-693" href="#__codelineno-4-693"></a># should bind to, e.g. `bridge_bind_address 192.168.1.10`
</span><span id="__span-4-694"><a id="__codelineno-4-694" name="__codelineno-4-694" href="#__codelineno-4-694"></a>#bridge_bind_address
</span><span id="__span-4-695"><a id="__codelineno-4-695" name="__codelineno-4-695" href="#__codelineno-4-695"></a>
</span><span id="__span-4-696"><a id="__codelineno-4-696" name="__codelineno-4-696" href="#__codelineno-4-696"></a># If a bridge has topics that have &quot;out&quot; direction, the default behaviour is to
</span><span id="__span-4-697"><a id="__codelineno-4-697" name="__codelineno-4-697" href="#__codelineno-4-697"></a># send an unsubscribe request to the remote broker on that topic. This means
</span><span id="__span-4-698"><a id="__codelineno-4-698" name="__codelineno-4-698" href="#__codelineno-4-698"></a># that changing a topic direction from &quot;in&quot; to &quot;out&quot; will not keep receiving
</span><span id="__span-4-699"><a id="__codelineno-4-699" name="__codelineno-4-699" href="#__codelineno-4-699"></a># incoming messages. Sending these unsubscribe requests is not always
</span><span id="__span-4-700"><a id="__codelineno-4-700" name="__codelineno-4-700" href="#__codelineno-4-700"></a># desirable, setting bridge_attempt_unsubscribe to false will disable sending
</span><span id="__span-4-701"><a id="__codelineno-4-701" name="__codelineno-4-701" href="#__codelineno-4-701"></a># the unsubscribe request.
</span><span id="__span-4-702"><a id="__codelineno-4-702" name="__codelineno-4-702" href="#__codelineno-4-702"></a>#bridge_attempt_unsubscribe true
</span><span id="__span-4-703"><a id="__codelineno-4-703" name="__codelineno-4-703" href="#__codelineno-4-703"></a>
</span><span id="__span-4-704"><a id="__codelineno-4-704" name="__codelineno-4-704" href="#__codelineno-4-704"></a># Set the version of the MQTT protocol to use with for this bridge. Can be one
</span><span id="__span-4-705"><a id="__codelineno-4-705" name="__codelineno-4-705" href="#__codelineno-4-705"></a># of mqttv50, mqttv311 or mqttv31. Defaults to mqttv311.
</span><span id="__span-4-706"><a id="__codelineno-4-706" name="__codelineno-4-706" href="#__codelineno-4-706"></a>#bridge_protocol_version mqttv311
</span><span id="__span-4-707"><a id="__codelineno-4-707" name="__codelineno-4-707" href="#__codelineno-4-707"></a>
</span><span id="__span-4-708"><a id="__codelineno-4-708" name="__codelineno-4-708" href="#__codelineno-4-708"></a># Set the clean session variable for this bridge.
</span><span id="__span-4-709"><a id="__codelineno-4-709" name="__codelineno-4-709" href="#__codelineno-4-709"></a># When set to true, when the bridge disconnects for any reason, all
</span><span id="__span-4-710"><a id="__codelineno-4-710" name="__codelineno-4-710" href="#__codelineno-4-710"></a># messages and subscriptions will be cleaned up on the remote
</span><span id="__span-4-711"><a id="__codelineno-4-711" name="__codelineno-4-711" href="#__codelineno-4-711"></a># broker. Note that with cleansession set to true, there may be a
</span><span id="__span-4-712"><a id="__codelineno-4-712" name="__codelineno-4-712" href="#__codelineno-4-712"></a># significant amount of retained messages sent when the bridge
</span><span id="__span-4-713"><a id="__codelineno-4-713" name="__codelineno-4-713" href="#__codelineno-4-713"></a># reconnects after losing its connection.
</span><span id="__span-4-714"><a id="__codelineno-4-714" name="__codelineno-4-714" href="#__codelineno-4-714"></a># When set to false, the subscriptions and messages are kept on the
</span><span id="__span-4-715"><a id="__codelineno-4-715" name="__codelineno-4-715" href="#__codelineno-4-715"></a># remote broker, and delivered when the bridge reconnects.
</span><span id="__span-4-716"><a id="__codelineno-4-716" name="__codelineno-4-716" href="#__codelineno-4-716"></a>#cleansession false
</span><span id="__span-4-717"><a id="__codelineno-4-717" name="__codelineno-4-717" href="#__codelineno-4-717"></a>
</span><span id="__span-4-718"><a id="__codelineno-4-718" name="__codelineno-4-718" href="#__codelineno-4-718"></a># Set the amount of time a bridge using the lazy start type must be idle before
</span><span id="__span-4-719"><a id="__codelineno-4-719" name="__codelineno-4-719" href="#__codelineno-4-719"></a># it will be stopped. Defaults to 60 seconds.
</span><span id="__span-4-720"><a id="__codelineno-4-720" name="__codelineno-4-720" href="#__codelineno-4-720"></a>#idle_timeout 60
</span><span id="__span-4-721"><a id="__codelineno-4-721" name="__codelineno-4-721" href="#__codelineno-4-721"></a>
</span><span id="__span-4-722"><a id="__codelineno-4-722" name="__codelineno-4-722" href="#__codelineno-4-722"></a># Set the keepalive interval for this bridge connection, in
</span><span id="__span-4-723"><a id="__codelineno-4-723" name="__codelineno-4-723" href="#__codelineno-4-723"></a># seconds.
</span><span id="__span-4-724"><a id="__codelineno-4-724" name="__codelineno-4-724" href="#__codelineno-4-724"></a>#keepalive_interval 60
</span><span id="__span-4-725"><a id="__codelineno-4-725" name="__codelineno-4-725" href="#__codelineno-4-725"></a>
</span><span id="__span-4-726"><a id="__codelineno-4-726" name="__codelineno-4-726" href="#__codelineno-4-726"></a># Set the clientid to use on the local broker. If not defined, this defaults to
</span><span id="__span-4-727"><a id="__codelineno-4-727" name="__codelineno-4-727" href="#__codelineno-4-727"></a># &#39;local.&lt;clientid&gt;&#39;. If you are bridging a broker to itself, it is important
</span><span id="__span-4-728"><a id="__codelineno-4-728" name="__codelineno-4-728" href="#__codelineno-4-728"></a># that local_clientid and clientid do not match.
</span><span id="__span-4-729"><a id="__codelineno-4-729" name="__codelineno-4-729" href="#__codelineno-4-729"></a>#local_clientid
</span><span id="__span-4-730"><a id="__codelineno-4-730" name="__codelineno-4-730" href="#__codelineno-4-730"></a>
</span><span id="__span-4-731"><a id="__codelineno-4-731" name="__codelineno-4-731" href="#__codelineno-4-731"></a># If set to true, publish notification messages to the local and remote brokers
</span><span id="__span-4-732"><a id="__codelineno-4-732" name="__codelineno-4-732" href="#__codelineno-4-732"></a># giving information about the state of the bridge connection. Retained
</span><span id="__span-4-733"><a id="__codelineno-4-733" name="__codelineno-4-733" href="#__codelineno-4-733"></a># messages are published to the topic $SYS/broker/connection/&lt;clientid&gt;/state
</span><span id="__span-4-734"><a id="__codelineno-4-734" name="__codelineno-4-734" href="#__codelineno-4-734"></a># unless the notification_topic option is used.
</span><span id="__span-4-735"><a id="__codelineno-4-735" name="__codelineno-4-735" href="#__codelineno-4-735"></a># If the message is 1 then the connection is active, or 0 if the connection has
</span><span id="__span-4-736"><a id="__codelineno-4-736" name="__codelineno-4-736" href="#__codelineno-4-736"></a># failed.
</span><span id="__span-4-737"><a id="__codelineno-4-737" name="__codelineno-4-737" href="#__codelineno-4-737"></a># This uses the last will and testament feature.
</span><span id="__span-4-738"><a id="__codelineno-4-738" name="__codelineno-4-738" href="#__codelineno-4-738"></a>#notifications true
</span><span id="__span-4-739"><a id="__codelineno-4-739" name="__codelineno-4-739" href="#__codelineno-4-739"></a>
</span><span id="__span-4-740"><a id="__codelineno-4-740" name="__codelineno-4-740" href="#__codelineno-4-740"></a># Choose the topic on which notification messages for this bridge are
</span><span id="__span-4-741"><a id="__codelineno-4-741" name="__codelineno-4-741" href="#__codelineno-4-741"></a># published. If not set, messages are published on the topic
</span><span id="__span-4-742"><a id="__codelineno-4-742" name="__codelineno-4-742" href="#__codelineno-4-742"></a># $SYS/broker/connection/&lt;clientid&gt;/state
</span><span id="__span-4-743"><a id="__codelineno-4-743" name="__codelineno-4-743" href="#__codelineno-4-743"></a>#notification_topic
</span><span id="__span-4-744"><a id="__codelineno-4-744" name="__codelineno-4-744" href="#__codelineno-4-744"></a>
</span><span id="__span-4-745"><a id="__codelineno-4-745" name="__codelineno-4-745" href="#__codelineno-4-745"></a># Set the client id to use on the remote end of this bridge connection. If not
</span><span id="__span-4-746"><a id="__codelineno-4-746" name="__codelineno-4-746" href="#__codelineno-4-746"></a># defined, this defaults to &#39;name.hostname&#39; where name is the connection name
</span><span id="__span-4-747"><a id="__codelineno-4-747" name="__codelineno-4-747" href="#__codelineno-4-747"></a># and hostname is the hostname of this computer.
</span><span id="__span-4-748"><a id="__codelineno-4-748" name="__codelineno-4-748" href="#__codelineno-4-748"></a># This replaces the old &quot;clientid&quot; option to avoid confusion. &quot;clientid&quot;
</span><span id="__span-4-749"><a id="__codelineno-4-749" name="__codelineno-4-749" href="#__codelineno-4-749"></a># remains valid for the time being.
</span><span id="__span-4-750"><a id="__codelineno-4-750" name="__codelineno-4-750" href="#__codelineno-4-750"></a>#remote_clientid
</span><span id="__span-4-751"><a id="__codelineno-4-751" name="__codelineno-4-751" href="#__codelineno-4-751"></a>
</span><span id="__span-4-752"><a id="__codelineno-4-752" name="__codelineno-4-752" href="#__codelineno-4-752"></a># Set the password to use when connecting to a broker that requires
</span><span id="__span-4-753"><a id="__codelineno-4-753" name="__codelineno-4-753" href="#__codelineno-4-753"></a># authentication. This option is only used if remote_username is also set.
</span><span id="__span-4-754"><a id="__codelineno-4-754" name="__codelineno-4-754" href="#__codelineno-4-754"></a># This replaces the old &quot;password&quot; option to avoid confusion. &quot;password&quot;
</span><span id="__span-4-755"><a id="__codelineno-4-755" name="__codelineno-4-755" href="#__codelineno-4-755"></a># remains valid for the time being.
</span><span id="__span-4-756"><a id="__codelineno-4-756" name="__codelineno-4-756" href="#__codelineno-4-756"></a>#remote_password
</span><span id="__span-4-757"><a id="__codelineno-4-757" name="__codelineno-4-757" href="#__codelineno-4-757"></a>
</span><span id="__span-4-758"><a id="__codelineno-4-758" name="__codelineno-4-758" href="#__codelineno-4-758"></a># Set the username to use when connecting to a broker that requires
</span><span id="__span-4-759"><a id="__codelineno-4-759" name="__codelineno-4-759" href="#__codelineno-4-759"></a># authentication.
</span><span id="__span-4-760"><a id="__codelineno-4-760" name="__codelineno-4-760" href="#__codelineno-4-760"></a># This replaces the old &quot;username&quot; option to avoid confusion. &quot;username&quot;
</span><span id="__span-4-761"><a id="__codelineno-4-761" name="__codelineno-4-761" href="#__codelineno-4-761"></a># remains valid for the time being.
</span><span id="__span-4-762"><a id="__codelineno-4-762" name="__codelineno-4-762" href="#__codelineno-4-762"></a>#remote_username
</span><span id="__span-4-763"><a id="__codelineno-4-763" name="__codelineno-4-763" href="#__codelineno-4-763"></a>
</span><span id="__span-4-764"><a id="__codelineno-4-764" name="__codelineno-4-764" href="#__codelineno-4-764"></a># Set the amount of time a bridge using the automatic start type will wait
</span><span id="__span-4-765"><a id="__codelineno-4-765" name="__codelineno-4-765" href="#__codelineno-4-765"></a># until attempting to reconnect.
</span><span id="__span-4-766"><a id="__codelineno-4-766" name="__codelineno-4-766" href="#__codelineno-4-766"></a># This option can be configured to use a constant delay time in seconds, or to
</span><span id="__span-4-767"><a id="__codelineno-4-767" name="__codelineno-4-767" href="#__codelineno-4-767"></a># use a backoff mechanism based on &quot;Decorrelated Jitter&quot;, which adds a degree
</span><span id="__span-4-768"><a id="__codelineno-4-768" name="__codelineno-4-768" href="#__codelineno-4-768"></a># of randomness to when the restart occurs.
</span><span id="__span-4-769"><a id="__codelineno-4-769" name="__codelineno-4-769" href="#__codelineno-4-769"></a>#
</span><span id="__span-4-770"><a id="__codelineno-4-770" name="__codelineno-4-770" href="#__codelineno-4-770"></a># Set a constant timeout of 20 seconds:
</span><span id="__span-4-771"><a id="__codelineno-4-771" name="__codelineno-4-771" href="#__codelineno-4-771"></a># restart_timeout 20
</span><span id="__span-4-772"><a id="__codelineno-4-772" name="__codelineno-4-772" href="#__codelineno-4-772"></a>#
</span><span id="__span-4-773"><a id="__codelineno-4-773" name="__codelineno-4-773" href="#__codelineno-4-773"></a># Set backoff with a base (start value) of 10 seconds and a cap (upper limit) of
</span><span id="__span-4-774"><a id="__codelineno-4-774" name="__codelineno-4-774" href="#__codelineno-4-774"></a># 60 seconds:
</span><span id="__span-4-775"><a id="__codelineno-4-775" name="__codelineno-4-775" href="#__codelineno-4-775"></a># restart_timeout 10 30
</span><span id="__span-4-776"><a id="__codelineno-4-776" name="__codelineno-4-776" href="#__codelineno-4-776"></a>#
</span><span id="__span-4-777"><a id="__codelineno-4-777" name="__codelineno-4-777" href="#__codelineno-4-777"></a># Defaults to jitter with a base of 5 and cap of 30
</span><span id="__span-4-778"><a id="__codelineno-4-778" name="__codelineno-4-778" href="#__codelineno-4-778"></a>#restart_timeout 5 30
</span><span id="__span-4-779"><a id="__codelineno-4-779" name="__codelineno-4-779" href="#__codelineno-4-779"></a>
</span><span id="__span-4-780"><a id="__codelineno-4-780" name="__codelineno-4-780" href="#__codelineno-4-780"></a># If the bridge has more than one address given in the address/addresses
</span><span id="__span-4-781"><a id="__codelineno-4-781" name="__codelineno-4-781" href="#__codelineno-4-781"></a># configuration, the round_robin option defines the behaviour of the bridge on
</span><span id="__span-4-782"><a id="__codelineno-4-782" name="__codelineno-4-782" href="#__codelineno-4-782"></a># a failure of the bridge connection. If round_robin is false, the default
</span><span id="__span-4-783"><a id="__codelineno-4-783" name="__codelineno-4-783" href="#__codelineno-4-783"></a># value, then the first address is treated as the main bridge connection. If
</span><span id="__span-4-784"><a id="__codelineno-4-784" name="__codelineno-4-784" href="#__codelineno-4-784"></a># the connection fails, the other secondary addresses will be attempted in
</span><span id="__span-4-785"><a id="__codelineno-4-785" name="__codelineno-4-785" href="#__codelineno-4-785"></a># turn. Whilst connected to a secondary bridge, the bridge will periodically
</span><span id="__span-4-786"><a id="__codelineno-4-786" name="__codelineno-4-786" href="#__codelineno-4-786"></a># attempt to reconnect to the main bridge until successful.
</span><span id="__span-4-787"><a id="__codelineno-4-787" name="__codelineno-4-787" href="#__codelineno-4-787"></a># If round_robin is true, then all addresses are treated as equals. If a
</span><span id="__span-4-788"><a id="__codelineno-4-788" name="__codelineno-4-788" href="#__codelineno-4-788"></a># connection fails, the next address will be tried and if successful will
</span><span id="__span-4-789"><a id="__codelineno-4-789" name="__codelineno-4-789" href="#__codelineno-4-789"></a># remain connected until it fails
</span><span id="__span-4-790"><a id="__codelineno-4-790" name="__codelineno-4-790" href="#__codelineno-4-790"></a>#round_robin false
</span><span id="__span-4-791"><a id="__codelineno-4-791" name="__codelineno-4-791" href="#__codelineno-4-791"></a>
</span><span id="__span-4-792"><a id="__codelineno-4-792" name="__codelineno-4-792" href="#__codelineno-4-792"></a># Set the start type of the bridge. This controls how the bridge starts and
</span><span id="__span-4-793"><a id="__codelineno-4-793" name="__codelineno-4-793" href="#__codelineno-4-793"></a># can be one of three types: automatic, lazy and once. Note that RSMB provides
</span><span id="__span-4-794"><a id="__codelineno-4-794" name="__codelineno-4-794" href="#__codelineno-4-794"></a># a fourth start type &quot;manual&quot; which isn&#39;t currently supported by mosquitto.
</span><span id="__span-4-795"><a id="__codelineno-4-795" name="__codelineno-4-795" href="#__codelineno-4-795"></a>#
</span><span id="__span-4-796"><a id="__codelineno-4-796" name="__codelineno-4-796" href="#__codelineno-4-796"></a># &quot;automatic&quot; is the default start type and means that the bridge connection
</span><span id="__span-4-797"><a id="__codelineno-4-797" name="__codelineno-4-797" href="#__codelineno-4-797"></a># will be started automatically when the broker starts and also restarted
</span><span id="__span-4-798"><a id="__codelineno-4-798" name="__codelineno-4-798" href="#__codelineno-4-798"></a># after a short delay (30 seconds) if the connection fails.
</span><span id="__span-4-799"><a id="__codelineno-4-799" name="__codelineno-4-799" href="#__codelineno-4-799"></a>#
</span><span id="__span-4-800"><a id="__codelineno-4-800" name="__codelineno-4-800" href="#__codelineno-4-800"></a># Bridges using the &quot;lazy&quot; start type will be started automatically when the
</span><span id="__span-4-801"><a id="__codelineno-4-801" name="__codelineno-4-801" href="#__codelineno-4-801"></a># number of queued messages exceeds the number set with the &quot;threshold&quot;
</span><span id="__span-4-802"><a id="__codelineno-4-802" name="__codelineno-4-802" href="#__codelineno-4-802"></a># parameter. It will be stopped automatically after the time set by the
</span><span id="__span-4-803"><a id="__codelineno-4-803" name="__codelineno-4-803" href="#__codelineno-4-803"></a># &quot;idle_timeout&quot; parameter. Use this start type if you wish the connection to
</span><span id="__span-4-804"><a id="__codelineno-4-804" name="__codelineno-4-804" href="#__codelineno-4-804"></a># only be active when it is needed.
</span><span id="__span-4-805"><a id="__codelineno-4-805" name="__codelineno-4-805" href="#__codelineno-4-805"></a>#
</span><span id="__span-4-806"><a id="__codelineno-4-806" name="__codelineno-4-806" href="#__codelineno-4-806"></a># A bridge using the &quot;once&quot; start type will be started automatically when the
</span><span id="__span-4-807"><a id="__codelineno-4-807" name="__codelineno-4-807" href="#__codelineno-4-807"></a># broker starts but will not be restarted if the connection fails.
</span><span id="__span-4-808"><a id="__codelineno-4-808" name="__codelineno-4-808" href="#__codelineno-4-808"></a>#start_type automatic
</span><span id="__span-4-809"><a id="__codelineno-4-809" name="__codelineno-4-809" href="#__codelineno-4-809"></a>
</span><span id="__span-4-810"><a id="__codelineno-4-810" name="__codelineno-4-810" href="#__codelineno-4-810"></a># Set the number of messages that need to be queued for a bridge with lazy
</span><span id="__span-4-811"><a id="__codelineno-4-811" name="__codelineno-4-811" href="#__codelineno-4-811"></a># start type to be restarted. Defaults to 10 messages.
</span><span id="__span-4-812"><a id="__codelineno-4-812" name="__codelineno-4-812" href="#__codelineno-4-812"></a># Must be less than max_queued_messages.
</span><span id="__span-4-813"><a id="__codelineno-4-813" name="__codelineno-4-813" href="#__codelineno-4-813"></a>#threshold 10
</span><span id="__span-4-814"><a id="__codelineno-4-814" name="__codelineno-4-814" href="#__codelineno-4-814"></a>
</span><span id="__span-4-815"><a id="__codelineno-4-815" name="__codelineno-4-815" href="#__codelineno-4-815"></a># If try_private is set to true, the bridge will attempt to indicate to the
</span><span id="__span-4-816"><a id="__codelineno-4-816" name="__codelineno-4-816" href="#__codelineno-4-816"></a># remote broker that it is a bridge not an ordinary client. If successful, this
</span><span id="__span-4-817"><a id="__codelineno-4-817" name="__codelineno-4-817" href="#__codelineno-4-817"></a># means that loop detection will be more effective and that retained messages
</span><span id="__span-4-818"><a id="__codelineno-4-818" name="__codelineno-4-818" href="#__codelineno-4-818"></a># will be propagated correctly. Not all brokers support this feature so it may
</span><span id="__span-4-819"><a id="__codelineno-4-819" name="__codelineno-4-819" href="#__codelineno-4-819"></a># be necessary to set try_private to false if your bridge does not connect
</span><span id="__span-4-820"><a id="__codelineno-4-820" name="__codelineno-4-820" href="#__codelineno-4-820"></a># properly.
</span><span id="__span-4-821"><a id="__codelineno-4-821" name="__codelineno-4-821" href="#__codelineno-4-821"></a>#try_private true
</span><span id="__span-4-822"><a id="__codelineno-4-822" name="__codelineno-4-822" href="#__codelineno-4-822"></a>
</span><span id="__span-4-823"><a id="__codelineno-4-823" name="__codelineno-4-823" href="#__codelineno-4-823"></a># Some MQTT brokers do not allow retained messages. MQTT v5 gives a mechanism
</span><span id="__span-4-824"><a id="__codelineno-4-824" name="__codelineno-4-824" href="#__codelineno-4-824"></a># for brokers to tell clients that they do not support retained messages, but
</span><span id="__span-4-825"><a id="__codelineno-4-825" name="__codelineno-4-825" href="#__codelineno-4-825"></a># this is not possible for MQTT v3.1.1 or v3.1. If you need to bridge to a
</span><span id="__span-4-826"><a id="__codelineno-4-826" name="__codelineno-4-826" href="#__codelineno-4-826"></a># v3.1.1 or v3.1 broker that does not support retained messages, set the
</span><span id="__span-4-827"><a id="__codelineno-4-827" name="__codelineno-4-827" href="#__codelineno-4-827"></a># bridge_outgoing_retain option to false. This will remove the retain bit on
</span><span id="__span-4-828"><a id="__codelineno-4-828" name="__codelineno-4-828" href="#__codelineno-4-828"></a># all outgoing messages to that bridge, regardless of any other setting.
</span><span id="__span-4-829"><a id="__codelineno-4-829" name="__codelineno-4-829" href="#__codelineno-4-829"></a>#bridge_outgoing_retain true
</span><span id="__span-4-830"><a id="__codelineno-4-830" name="__codelineno-4-830" href="#__codelineno-4-830"></a>
</span><span id="__span-4-831"><a id="__codelineno-4-831" name="__codelineno-4-831" href="#__codelineno-4-831"></a># If you wish to restrict the size of messages sent to a remote bridge, use the
</span><span id="__span-4-832"><a id="__codelineno-4-832" name="__codelineno-4-832" href="#__codelineno-4-832"></a># bridge_max_packet_size option. This sets the maximum number of bytes for
</span><span id="__span-4-833"><a id="__codelineno-4-833" name="__codelineno-4-833" href="#__codelineno-4-833"></a># the total message, including headers and payload.
</span><span id="__span-4-834"><a id="__codelineno-4-834" name="__codelineno-4-834" href="#__codelineno-4-834"></a># Note that MQTT v5 brokers may provide their own maximum-packet-size property.
</span><span id="__span-4-835"><a id="__codelineno-4-835" name="__codelineno-4-835" href="#__codelineno-4-835"></a># In this case, the smaller of the two limits will be used.
</span><span id="__span-4-836"><a id="__codelineno-4-836" name="__codelineno-4-836" href="#__codelineno-4-836"></a># Set to 0 for &quot;unlimited&quot;.
</span><span id="__span-4-837"><a id="__codelineno-4-837" name="__codelineno-4-837" href="#__codelineno-4-837"></a>#bridge_max_packet_size 0
</span><span id="__span-4-838"><a id="__codelineno-4-838" name="__codelineno-4-838" href="#__codelineno-4-838"></a>
</span><span id="__span-4-839"><a id="__codelineno-4-839" name="__codelineno-4-839" href="#__codelineno-4-839"></a>
</span><span id="__span-4-840"><a id="__codelineno-4-840" name="__codelineno-4-840" href="#__codelineno-4-840"></a># -----------------------------------------------------------------
</span><span id="__span-4-841"><a id="__codelineno-4-841" name="__codelineno-4-841" href="#__codelineno-4-841"></a># Certificate based SSL/TLS support
</span><span id="__span-4-842"><a id="__codelineno-4-842" name="__codelineno-4-842" href="#__codelineno-4-842"></a># -----------------------------------------------------------------
</span><span id="__span-4-843"><a id="__codelineno-4-843" name="__codelineno-4-843" href="#__codelineno-4-843"></a># Either bridge_cafile or bridge_capath must be defined to enable TLS support
</span><span id="__span-4-844"><a id="__codelineno-4-844" name="__codelineno-4-844" href="#__codelineno-4-844"></a># for this bridge.
</span><span id="__span-4-845"><a id="__codelineno-4-845" name="__codelineno-4-845" href="#__codelineno-4-845"></a># bridge_cafile defines the path to a file containing the
</span><span id="__span-4-846"><a id="__codelineno-4-846" name="__codelineno-4-846" href="#__codelineno-4-846"></a># Certificate Authority certificates that have signed the remote broker
</span><span id="__span-4-847"><a id="__codelineno-4-847" name="__codelineno-4-847" href="#__codelineno-4-847"></a># certificate.
</span><span id="__span-4-848"><a id="__codelineno-4-848" name="__codelineno-4-848" href="#__codelineno-4-848"></a># bridge_capath defines a directory that will be searched for files containing
</span><span id="__span-4-849"><a id="__codelineno-4-849" name="__codelineno-4-849" href="#__codelineno-4-849"></a># the CA certificates. For bridge_capath to work correctly, the certificate
</span><span id="__span-4-850"><a id="__codelineno-4-850" name="__codelineno-4-850" href="#__codelineno-4-850"></a># files must have &quot;.crt&quot; as the file ending and you must run &quot;openssl rehash
</span><span id="__span-4-851"><a id="__codelineno-4-851" name="__codelineno-4-851" href="#__codelineno-4-851"></a># &lt;path to capath&gt;&quot; each time you add/remove a certificate.
</span><span id="__span-4-852"><a id="__codelineno-4-852" name="__codelineno-4-852" href="#__codelineno-4-852"></a>#bridge_cafile
</span><span id="__span-4-853"><a id="__codelineno-4-853" name="__codelineno-4-853" href="#__codelineno-4-853"></a>#bridge_capath
</span><span id="__span-4-854"><a id="__codelineno-4-854" name="__codelineno-4-854" href="#__codelineno-4-854"></a>
</span><span id="__span-4-855"><a id="__codelineno-4-855" name="__codelineno-4-855" href="#__codelineno-4-855"></a>
</span><span id="__span-4-856"><a id="__codelineno-4-856" name="__codelineno-4-856" href="#__codelineno-4-856"></a># If the remote broker has more than one protocol available on its port, e.g.
</span><span id="__span-4-857"><a id="__codelineno-4-857" name="__codelineno-4-857" href="#__codelineno-4-857"></a># MQTT and WebSockets, then use bridge_alpn to configure which protocol is
</span><span id="__span-4-858"><a id="__codelineno-4-858" name="__codelineno-4-858" href="#__codelineno-4-858"></a># requested. Note that WebSockets support for bridges is not yet available.
</span><span id="__span-4-859"><a id="__codelineno-4-859" name="__codelineno-4-859" href="#__codelineno-4-859"></a>#bridge_alpn
</span><span id="__span-4-860"><a id="__codelineno-4-860" name="__codelineno-4-860" href="#__codelineno-4-860"></a>
</span><span id="__span-4-861"><a id="__codelineno-4-861" name="__codelineno-4-861" href="#__codelineno-4-861"></a># When using certificate based encryption, bridge_insecure disables
</span><span id="__span-4-862"><a id="__codelineno-4-862" name="__codelineno-4-862" href="#__codelineno-4-862"></a># verification of the server hostname in the server certificate. This can be
</span><span id="__span-4-863"><a id="__codelineno-4-863" name="__codelineno-4-863" href="#__codelineno-4-863"></a># useful when testing initial server configurations, but makes it possible for
</span><span id="__span-4-864"><a id="__codelineno-4-864" name="__codelineno-4-864" href="#__codelineno-4-864"></a># a malicious third party to impersonate your server through DNS spoofing, for
</span><span id="__span-4-865"><a id="__codelineno-4-865" name="__codelineno-4-865" href="#__codelineno-4-865"></a># example. Use this option in testing only. If you need to resort to using this
</span><span id="__span-4-866"><a id="__codelineno-4-866" name="__codelineno-4-866" href="#__codelineno-4-866"></a># option in a production environment, your setup is at fault and there is no
</span><span id="__span-4-867"><a id="__codelineno-4-867" name="__codelineno-4-867" href="#__codelineno-4-867"></a># point using encryption.
</span><span id="__span-4-868"><a id="__codelineno-4-868" name="__codelineno-4-868" href="#__codelineno-4-868"></a>#bridge_insecure false
</span><span id="__span-4-869"><a id="__codelineno-4-869" name="__codelineno-4-869" href="#__codelineno-4-869"></a>
</span><span id="__span-4-870"><a id="__codelineno-4-870" name="__codelineno-4-870" href="#__codelineno-4-870"></a># Path to the PEM encoded client certificate, if required by the remote broker.
</span><span id="__span-4-871"><a id="__codelineno-4-871" name="__codelineno-4-871" href="#__codelineno-4-871"></a>#bridge_certfile
</span><span id="__span-4-872"><a id="__codelineno-4-872" name="__codelineno-4-872" href="#__codelineno-4-872"></a>
</span><span id="__span-4-873"><a id="__codelineno-4-873" name="__codelineno-4-873" href="#__codelineno-4-873"></a># Path to the PEM encoded client private key, if required by the remote broker.
</span><span id="__span-4-874"><a id="__codelineno-4-874" name="__codelineno-4-874" href="#__codelineno-4-874"></a>#bridge_keyfile
</span><span id="__span-4-875"><a id="__codelineno-4-875" name="__codelineno-4-875" href="#__codelineno-4-875"></a>
</span><span id="__span-4-876"><a id="__codelineno-4-876" name="__codelineno-4-876" href="#__codelineno-4-876"></a># -----------------------------------------------------------------
</span><span id="__span-4-877"><a id="__codelineno-4-877" name="__codelineno-4-877" href="#__codelineno-4-877"></a># PSK based SSL/TLS support
</span><span id="__span-4-878"><a id="__codelineno-4-878" name="__codelineno-4-878" href="#__codelineno-4-878"></a># -----------------------------------------------------------------
</span><span id="__span-4-879"><a id="__codelineno-4-879" name="__codelineno-4-879" href="#__codelineno-4-879"></a># Pre-shared-key encryption provides an alternative to certificate based
</span><span id="__span-4-880"><a id="__codelineno-4-880" name="__codelineno-4-880" href="#__codelineno-4-880"></a># encryption. A bridge can be configured to use PSK with the bridge_identity
</span><span id="__span-4-881"><a id="__codelineno-4-881" name="__codelineno-4-881" href="#__codelineno-4-881"></a># and bridge_psk options. These are the client PSK identity, and pre-shared-key
</span><span id="__span-4-882"><a id="__codelineno-4-882" name="__codelineno-4-882" href="#__codelineno-4-882"></a># in hexadecimal format with no &quot;0x&quot;. Only one of certificate and PSK based
</span><span id="__span-4-883"><a id="__codelineno-4-883" name="__codelineno-4-883" href="#__codelineno-4-883"></a># encryption can be used on one
</span><span id="__span-4-884"><a id="__codelineno-4-884" name="__codelineno-4-884" href="#__codelineno-4-884"></a># bridge at once.
</span><span id="__span-4-885"><a id="__codelineno-4-885" name="__codelineno-4-885" href="#__codelineno-4-885"></a>#bridge_identity
</span><span id="__span-4-886"><a id="__codelineno-4-886" name="__codelineno-4-886" href="#__codelineno-4-886"></a>#bridge_psk
</span><span id="__span-4-887"><a id="__codelineno-4-887" name="__codelineno-4-887" href="#__codelineno-4-887"></a>
</span><span id="__span-4-888"><a id="__codelineno-4-888" name="__codelineno-4-888" href="#__codelineno-4-888"></a>
</span><span id="__span-4-889"><a id="__codelineno-4-889" name="__codelineno-4-889" href="#__codelineno-4-889"></a># =================================================================
</span><span id="__span-4-890"><a id="__codelineno-4-890" name="__codelineno-4-890" href="#__codelineno-4-890"></a># External config files
</span><span id="__span-4-891"><a id="__codelineno-4-891" name="__codelineno-4-891" href="#__codelineno-4-891"></a># =================================================================
</span><span id="__span-4-892"><a id="__codelineno-4-892" name="__codelineno-4-892" href="#__codelineno-4-892"></a>
</span><span id="__span-4-893"><a id="__codelineno-4-893" name="__codelineno-4-893" href="#__codelineno-4-893"></a># External configuration files may be included by using the
</span><span id="__span-4-894"><a id="__codelineno-4-894" name="__codelineno-4-894" href="#__codelineno-4-894"></a># include_dir option. This defines a directory that will be searched
</span><span id="__span-4-895"><a id="__codelineno-4-895" name="__codelineno-4-895" href="#__codelineno-4-895"></a># for config files. All files that end in &#39;.conf&#39; will be loaded as
</span><span id="__span-4-896"><a id="__codelineno-4-896" name="__codelineno-4-896" href="#__codelineno-4-896"></a># a configuration file. It is best to have this as the last option
</span><span id="__span-4-897"><a id="__codelineno-4-897" name="__codelineno-4-897" href="#__codelineno-4-897"></a># in the main file. This option will only be processed from the main
</span><span id="__span-4-898"><a id="__codelineno-4-898" name="__codelineno-4-898" href="#__codelineno-4-898"></a># configuration file. The directory specified must not contain the
</span><span id="__span-4-899"><a id="__codelineno-4-899" name="__codelineno-4-899" href="#__codelineno-4-899"></a># main configuration file.
</span><span id="__span-4-900"><a id="__codelineno-4-900" name="__codelineno-4-900" href="#__codelineno-4-900"></a># Files within include_dir will be loaded sorted in case-sensitive
</span><span id="__span-4-901"><a id="__codelineno-4-901" name="__codelineno-4-901" href="#__codelineno-4-901"></a># alphabetical order, with capital letters ordered first. If this option is
</span><span id="__span-4-902"><a id="__codelineno-4-902" name="__codelineno-4-902" href="#__codelineno-4-902"></a># given multiple times, all of the files from the first instance will be
</span><span id="__span-4-903"><a id="__codelineno-4-903" name="__codelineno-4-903" href="#__codelineno-4-903"></a># processed before the next instance. See the man page for examples.
</span><span id="__span-4-904"><a id="__codelineno-4-904" name="__codelineno-4-904" href="#__codelineno-4-904"></a>#include_dir
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-text highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a># Config file for mosquitto
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>#
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a># See mosquitto.conf(5) for more information.
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>#
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a># Default values are shown, uncomment to change.
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>#
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a># Use the # character to indicate a comment, but only if it is the
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a># very first character on the line.
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a># =================================================================
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a># General configuration
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a># =================================================================
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a>
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a># Use per listener security settings.
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a>#
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a># It is recommended this option be set before any other options.
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a>#
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a># If this option is set to true, then all authentication and access control
</span><span id="__span-5-19"><a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a># options are controlled on a per listener basis. The following options are
</span><span id="__span-5-20"><a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a># affected:
</span><span id="__span-5-21"><a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a>#
</span><span id="__span-5-22"><a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a># acl_file
</span><span id="__span-5-23"><a id="__codelineno-5-23" name="__codelineno-5-23" href="#__codelineno-5-23"></a># allow_anonymous
</span><span id="__span-5-24"><a id="__codelineno-5-24" name="__codelineno-5-24" href="#__codelineno-5-24"></a># allow_zero_length_clientid
</span><span id="__span-5-25"><a id="__codelineno-5-25" name="__codelineno-5-25" href="#__codelineno-5-25"></a># auto_id_prefix
</span><span id="__span-5-26"><a id="__codelineno-5-26" name="__codelineno-5-26" href="#__codelineno-5-26"></a># password_file
</span><span id="__span-5-27"><a id="__codelineno-5-27" name="__codelineno-5-27" href="#__codelineno-5-27"></a># plugin
</span><span id="__span-5-28"><a id="__codelineno-5-28" name="__codelineno-5-28" href="#__codelineno-5-28"></a># plugin_opt_*
</span><span id="__span-5-29"><a id="__codelineno-5-29" name="__codelineno-5-29" href="#__codelineno-5-29"></a># psk_file
</span><span id="__span-5-30"><a id="__codelineno-5-30" name="__codelineno-5-30" href="#__codelineno-5-30"></a>#
</span><span id="__span-5-31"><a id="__codelineno-5-31" name="__codelineno-5-31" href="#__codelineno-5-31"></a># Note that if set to true, then a durable client (i.e. with clean session set
</span><span id="__span-5-32"><a id="__codelineno-5-32" name="__codelineno-5-32" href="#__codelineno-5-32"></a># to false) that has disconnected will use the ACL settings defined for the
</span><span id="__span-5-33"><a id="__codelineno-5-33" name="__codelineno-5-33" href="#__codelineno-5-33"></a># listener that it was most recently connected to.
</span><span id="__span-5-34"><a id="__codelineno-5-34" name="__codelineno-5-34" href="#__codelineno-5-34"></a>#
</span><span id="__span-5-35"><a id="__codelineno-5-35" name="__codelineno-5-35" href="#__codelineno-5-35"></a># The default behaviour is for this to be set to false, which maintains the
</span><span id="__span-5-36"><a id="__codelineno-5-36" name="__codelineno-5-36" href="#__codelineno-5-36"></a># setting behaviour from previous versions of mosquitto.
</span><span id="__span-5-37"><a id="__codelineno-5-37" name="__codelineno-5-37" href="#__codelineno-5-37"></a>#per_listener_settings false
</span><span id="__span-5-38"><a id="__codelineno-5-38" name="__codelineno-5-38" href="#__codelineno-5-38"></a>
</span><span id="__span-5-39"><a id="__codelineno-5-39" name="__codelineno-5-39" href="#__codelineno-5-39"></a>
</span><span id="__span-5-40"><a id="__codelineno-5-40" name="__codelineno-5-40" href="#__codelineno-5-40"></a># This option controls whether a client is allowed to connect with a zero
</span><span id="__span-5-41"><a id="__codelineno-5-41" name="__codelineno-5-41" href="#__codelineno-5-41"></a># length client id or not. This option only affects clients using MQTT v3.1.1
</span><span id="__span-5-42"><a id="__codelineno-5-42" name="__codelineno-5-42" href="#__codelineno-5-42"></a># and later. If set to false, clients connecting with a zero length client id
</span><span id="__span-5-43"><a id="__codelineno-5-43" name="__codelineno-5-43" href="#__codelineno-5-43"></a># are disconnected. If set to true, clients will be allocated a client id by
</span><span id="__span-5-44"><a id="__codelineno-5-44" name="__codelineno-5-44" href="#__codelineno-5-44"></a># the broker. This means it is only useful for clients with clean session set
</span><span id="__span-5-45"><a id="__codelineno-5-45" name="__codelineno-5-45" href="#__codelineno-5-45"></a># to true.
</span><span id="__span-5-46"><a id="__codelineno-5-46" name="__codelineno-5-46" href="#__codelineno-5-46"></a>#allow_zero_length_clientid true
</span><span id="__span-5-47"><a id="__codelineno-5-47" name="__codelineno-5-47" href="#__codelineno-5-47"></a>
</span><span id="__span-5-48"><a id="__codelineno-5-48" name="__codelineno-5-48" href="#__codelineno-5-48"></a># If allow_zero_length_clientid is true, this option allows you to set a prefix
</span><span id="__span-5-49"><a id="__codelineno-5-49" name="__codelineno-5-49" href="#__codelineno-5-49"></a># to automatically generated client ids to aid visibility in logs.
</span><span id="__span-5-50"><a id="__codelineno-5-50" name="__codelineno-5-50" href="#__codelineno-5-50"></a># Defaults to &#39;auto-&#39;
</span><span id="__span-5-51"><a id="__codelineno-5-51" name="__codelineno-5-51" href="#__codelineno-5-51"></a>#auto_id_prefix auto-
</span><span id="__span-5-52"><a id="__codelineno-5-52" name="__codelineno-5-52" href="#__codelineno-5-52"></a>
</span><span id="__span-5-53"><a id="__codelineno-5-53" name="__codelineno-5-53" href="#__codelineno-5-53"></a># This option affects the scenario when a client subscribes to a topic that has
</span><span id="__span-5-54"><a id="__codelineno-5-54" name="__codelineno-5-54" href="#__codelineno-5-54"></a># retained messages. It is possible that the client that published the retained
</span><span id="__span-5-55"><a id="__codelineno-5-55" name="__codelineno-5-55" href="#__codelineno-5-55"></a># message to the topic had access at the time they published, but that access
</span><span id="__span-5-56"><a id="__codelineno-5-56" name="__codelineno-5-56" href="#__codelineno-5-56"></a># has been subsequently removed. If check_retain_source is set to true, the
</span><span id="__span-5-57"><a id="__codelineno-5-57" name="__codelineno-5-57" href="#__codelineno-5-57"></a># default, the source of a retained message will be checked for access rights
</span><span id="__span-5-58"><a id="__codelineno-5-58" name="__codelineno-5-58" href="#__codelineno-5-58"></a># before it is republished. When set to false, no check will be made and the
</span><span id="__span-5-59"><a id="__codelineno-5-59" name="__codelineno-5-59" href="#__codelineno-5-59"></a># retained message will always be published. This affects all listeners.
</span><span id="__span-5-60"><a id="__codelineno-5-60" name="__codelineno-5-60" href="#__codelineno-5-60"></a>#check_retain_source true
</span><span id="__span-5-61"><a id="__codelineno-5-61" name="__codelineno-5-61" href="#__codelineno-5-61"></a>
</span><span id="__span-5-62"><a id="__codelineno-5-62" name="__codelineno-5-62" href="#__codelineno-5-62"></a># QoS 1 and 2 messages will be allowed inflight per client until this limit
</span><span id="__span-5-63"><a id="__codelineno-5-63" name="__codelineno-5-63" href="#__codelineno-5-63"></a># is exceeded.  Defaults to 0. (No maximum)
</span><span id="__span-5-64"><a id="__codelineno-5-64" name="__codelineno-5-64" href="#__codelineno-5-64"></a># See also max_inflight_messages
</span><span id="__span-5-65"><a id="__codelineno-5-65" name="__codelineno-5-65" href="#__codelineno-5-65"></a>#max_inflight_bytes 0
</span><span id="__span-5-66"><a id="__codelineno-5-66" name="__codelineno-5-66" href="#__codelineno-5-66"></a>
</span><span id="__span-5-67"><a id="__codelineno-5-67" name="__codelineno-5-67" href="#__codelineno-5-67"></a># The maximum number of QoS 1 and 2 messages currently inflight per
</span><span id="__span-5-68"><a id="__codelineno-5-68" name="__codelineno-5-68" href="#__codelineno-5-68"></a># client.
</span><span id="__span-5-69"><a id="__codelineno-5-69" name="__codelineno-5-69" href="#__codelineno-5-69"></a># This includes messages that are partway through handshakes and
</span><span id="__span-5-70"><a id="__codelineno-5-70" name="__codelineno-5-70" href="#__codelineno-5-70"></a># those that are being retried. Defaults to 20. Set to 0 for no
</span><span id="__span-5-71"><a id="__codelineno-5-71" name="__codelineno-5-71" href="#__codelineno-5-71"></a># maximum. Setting to 1 will guarantee in-order delivery of QoS 1
</span><span id="__span-5-72"><a id="__codelineno-5-72" name="__codelineno-5-72" href="#__codelineno-5-72"></a># and 2 messages.
</span><span id="__span-5-73"><a id="__codelineno-5-73" name="__codelineno-5-73" href="#__codelineno-5-73"></a>#max_inflight_messages 20
</span><span id="__span-5-74"><a id="__codelineno-5-74" name="__codelineno-5-74" href="#__codelineno-5-74"></a>
</span><span id="__span-5-75"><a id="__codelineno-5-75" name="__codelineno-5-75" href="#__codelineno-5-75"></a># For MQTT v5 clients, it is possible to have the server send a &quot;server
</span><span id="__span-5-76"><a id="__codelineno-5-76" name="__codelineno-5-76" href="#__codelineno-5-76"></a># keepalive&quot; value that will override the keepalive value set by the client.
</span><span id="__span-5-77"><a id="__codelineno-5-77" name="__codelineno-5-77" href="#__codelineno-5-77"></a># This is intended to be used as a mechanism to say that the server will
</span><span id="__span-5-78"><a id="__codelineno-5-78" name="__codelineno-5-78" href="#__codelineno-5-78"></a># disconnect the client earlier than it anticipated, and that the client should
</span><span id="__span-5-79"><a id="__codelineno-5-79" name="__codelineno-5-79" href="#__codelineno-5-79"></a># use the new keepalive value. The max_keepalive option allows you to specify
</span><span id="__span-5-80"><a id="__codelineno-5-80" name="__codelineno-5-80" href="#__codelineno-5-80"></a># that clients may only connect with keepalive less than or equal to this
</span><span id="__span-5-81"><a id="__codelineno-5-81" name="__codelineno-5-81" href="#__codelineno-5-81"></a># value, otherwise they will be sent a server keepalive telling them to use
</span><span id="__span-5-82"><a id="__codelineno-5-82" name="__codelineno-5-82" href="#__codelineno-5-82"></a># max_keepalive. This only applies to MQTT v5 clients. The default, and maximum
</span><span id="__span-5-83"><a id="__codelineno-5-83" name="__codelineno-5-83" href="#__codelineno-5-83"></a># value allowable, is 65535.
</span><span id="__span-5-84"><a id="__codelineno-5-84" name="__codelineno-5-84" href="#__codelineno-5-84"></a>#
</span><span id="__span-5-85"><a id="__codelineno-5-85" name="__codelineno-5-85" href="#__codelineno-5-85"></a># Set to 0 to allow clients to set keepalive = 0, which means no keepalive
</span><span id="__span-5-86"><a id="__codelineno-5-86" name="__codelineno-5-86" href="#__codelineno-5-86"></a># checks are made and the client will never be disconnected by the broker if no
</span><span id="__span-5-87"><a id="__codelineno-5-87" name="__codelineno-5-87" href="#__codelineno-5-87"></a># messages are received. You should be very sure this is the behaviour that you
</span><span id="__span-5-88"><a id="__codelineno-5-88" name="__codelineno-5-88" href="#__codelineno-5-88"></a># want.
</span><span id="__span-5-89"><a id="__codelineno-5-89" name="__codelineno-5-89" href="#__codelineno-5-89"></a>#
</span><span id="__span-5-90"><a id="__codelineno-5-90" name="__codelineno-5-90" href="#__codelineno-5-90"></a># For MQTT v3.1.1 and v3.1 clients, there is no mechanism to tell the client
</span><span id="__span-5-91"><a id="__codelineno-5-91" name="__codelineno-5-91" href="#__codelineno-5-91"></a># what keepalive value they should use. If an MQTT v3.1.1 or v3.1 client
</span><span id="__span-5-92"><a id="__codelineno-5-92" name="__codelineno-5-92" href="#__codelineno-5-92"></a># specifies a keepalive time greater than max_keepalive they will be sent a
</span><span id="__span-5-93"><a id="__codelineno-5-93" name="__codelineno-5-93" href="#__codelineno-5-93"></a># CONNACK message with the &quot;identifier rejected&quot; reason code, and disconnected.
</span><span id="__span-5-94"><a id="__codelineno-5-94" name="__codelineno-5-94" href="#__codelineno-5-94"></a>#
</span><span id="__span-5-95"><a id="__codelineno-5-95" name="__codelineno-5-95" href="#__codelineno-5-95"></a>#max_keepalive 65535
</span><span id="__span-5-96"><a id="__codelineno-5-96" name="__codelineno-5-96" href="#__codelineno-5-96"></a>
</span><span id="__span-5-97"><a id="__codelineno-5-97" name="__codelineno-5-97" href="#__codelineno-5-97"></a># For MQTT v5 clients, it is possible to have the server send a &quot;maximum packet
</span><span id="__span-5-98"><a id="__codelineno-5-98" name="__codelineno-5-98" href="#__codelineno-5-98"></a># size&quot; value that will instruct the client it will not accept MQTT packets
</span><span id="__span-5-99"><a id="__codelineno-5-99" name="__codelineno-5-99" href="#__codelineno-5-99"></a># with size greater than max_packet_size bytes. This applies to the full MQTT
</span><span id="__span-5-100"><a id="__codelineno-5-100" name="__codelineno-5-100" href="#__codelineno-5-100"></a># packet, not just the payload. Setting this option to a positive value will
</span><span id="__span-5-101"><a id="__codelineno-5-101" name="__codelineno-5-101" href="#__codelineno-5-101"></a># set the maximum packet size to that number of bytes. If a client sends a
</span><span id="__span-5-102"><a id="__codelineno-5-102" name="__codelineno-5-102" href="#__codelineno-5-102"></a># packet which is larger than this value, it will be disconnected. This applies
</span><span id="__span-5-103"><a id="__codelineno-5-103" name="__codelineno-5-103" href="#__codelineno-5-103"></a># to all clients regardless of the protocol version they are using, but v3.1.1
</span><span id="__span-5-104"><a id="__codelineno-5-104" name="__codelineno-5-104" href="#__codelineno-5-104"></a># and earlier clients will of course not have received the maximum packet size
</span><span id="__span-5-105"><a id="__codelineno-5-105" name="__codelineno-5-105" href="#__codelineno-5-105"></a># information. Defaults to no limit. Setting below 20 bytes is forbidden
</span><span id="__span-5-106"><a id="__codelineno-5-106" name="__codelineno-5-106" href="#__codelineno-5-106"></a># because it is likely to interfere with ordinary client operation, even with
</span><span id="__span-5-107"><a id="__codelineno-5-107" name="__codelineno-5-107" href="#__codelineno-5-107"></a># very small payloads.
</span><span id="__span-5-108"><a id="__codelineno-5-108" name="__codelineno-5-108" href="#__codelineno-5-108"></a>#max_packet_size 0
</span><span id="__span-5-109"><a id="__codelineno-5-109" name="__codelineno-5-109" href="#__codelineno-5-109"></a>
</span><span id="__span-5-110"><a id="__codelineno-5-110" name="__codelineno-5-110" href="#__codelineno-5-110"></a># QoS 1 and 2 messages above those currently in-flight will be queued per
</span><span id="__span-5-111"><a id="__codelineno-5-111" name="__codelineno-5-111" href="#__codelineno-5-111"></a># client until this limit is exceeded.  Defaults to 0. (No maximum)
</span><span id="__span-5-112"><a id="__codelineno-5-112" name="__codelineno-5-112" href="#__codelineno-5-112"></a># See also max_queued_messages.
</span><span id="__span-5-113"><a id="__codelineno-5-113" name="__codelineno-5-113" href="#__codelineno-5-113"></a># If both max_queued_messages and max_queued_bytes are specified, packets will
</span><span id="__span-5-114"><a id="__codelineno-5-114" name="__codelineno-5-114" href="#__codelineno-5-114"></a># be queued until the first limit is reached.
</span><span id="__span-5-115"><a id="__codelineno-5-115" name="__codelineno-5-115" href="#__codelineno-5-115"></a>#max_queued_bytes 0
</span><span id="__span-5-116"><a id="__codelineno-5-116" name="__codelineno-5-116" href="#__codelineno-5-116"></a>
</span><span id="__span-5-117"><a id="__codelineno-5-117" name="__codelineno-5-117" href="#__codelineno-5-117"></a># Set the maximum QoS supported. Clients publishing at a QoS higher than
</span><span id="__span-5-118"><a id="__codelineno-5-118" name="__codelineno-5-118" href="#__codelineno-5-118"></a># specified here will be disconnected.
</span><span id="__span-5-119"><a id="__codelineno-5-119" name="__codelineno-5-119" href="#__codelineno-5-119"></a>#max_qos 2
</span><span id="__span-5-120"><a id="__codelineno-5-120" name="__codelineno-5-120" href="#__codelineno-5-120"></a>
</span><span id="__span-5-121"><a id="__codelineno-5-121" name="__codelineno-5-121" href="#__codelineno-5-121"></a># The maximum number of QoS 1 and 2 messages to hold in a queue per client
</span><span id="__span-5-122"><a id="__codelineno-5-122" name="__codelineno-5-122" href="#__codelineno-5-122"></a># above those that are currently in-flight.  Defaults to 1000. Set
</span><span id="__span-5-123"><a id="__codelineno-5-123" name="__codelineno-5-123" href="#__codelineno-5-123"></a># to 0 for no maximum (not recommended).
</span><span id="__span-5-124"><a id="__codelineno-5-124" name="__codelineno-5-124" href="#__codelineno-5-124"></a># See also queue_qos0_messages.
</span><span id="__span-5-125"><a id="__codelineno-5-125" name="__codelineno-5-125" href="#__codelineno-5-125"></a># See also max_queued_bytes.
</span><span id="__span-5-126"><a id="__codelineno-5-126" name="__codelineno-5-126" href="#__codelineno-5-126"></a>#max_queued_messages 1000
</span><span id="__span-5-127"><a id="__codelineno-5-127" name="__codelineno-5-127" href="#__codelineno-5-127"></a>#
</span><span id="__span-5-128"><a id="__codelineno-5-128" name="__codelineno-5-128" href="#__codelineno-5-128"></a># This option sets the maximum number of heap memory bytes that the broker will
</span><span id="__span-5-129"><a id="__codelineno-5-129" name="__codelineno-5-129" href="#__codelineno-5-129"></a># allocate, and hence sets a hard limit on memory use by the broker.  Memory
</span><span id="__span-5-130"><a id="__codelineno-5-130" name="__codelineno-5-130" href="#__codelineno-5-130"></a># requests that exceed this value will be denied. The effect will vary
</span><span id="__span-5-131"><a id="__codelineno-5-131" name="__codelineno-5-131" href="#__codelineno-5-131"></a># depending on what has been denied. If an incoming message is being processed,
</span><span id="__span-5-132"><a id="__codelineno-5-132" name="__codelineno-5-132" href="#__codelineno-5-132"></a># then the message will be dropped and the publishing client will be
</span><span id="__span-5-133"><a id="__codelineno-5-133" name="__codelineno-5-133" href="#__codelineno-5-133"></a># disconnected. If an outgoing message is being sent, then the individual
</span><span id="__span-5-134"><a id="__codelineno-5-134" name="__codelineno-5-134" href="#__codelineno-5-134"></a># message will be dropped and the receiving client will be disconnected.
</span><span id="__span-5-135"><a id="__codelineno-5-135" name="__codelineno-5-135" href="#__codelineno-5-135"></a># Defaults to no limit.
</span><span id="__span-5-136"><a id="__codelineno-5-136" name="__codelineno-5-136" href="#__codelineno-5-136"></a>#memory_limit 0
</span><span id="__span-5-137"><a id="__codelineno-5-137" name="__codelineno-5-137" href="#__codelineno-5-137"></a>
</span><span id="__span-5-138"><a id="__codelineno-5-138" name="__codelineno-5-138" href="#__codelineno-5-138"></a># This option sets the maximum publish payload size that the broker will allow.
</span><span id="__span-5-139"><a id="__codelineno-5-139" name="__codelineno-5-139" href="#__codelineno-5-139"></a># Received messages that exceed this size will not be accepted by the broker.
</span><span id="__span-5-140"><a id="__codelineno-5-140" name="__codelineno-5-140" href="#__codelineno-5-140"></a># The default value is 0, which means that all valid MQTT messages are
</span><span id="__span-5-141"><a id="__codelineno-5-141" name="__codelineno-5-141" href="#__codelineno-5-141"></a># accepted. MQTT imposes a maximum payload size of 268435455 bytes.
</span><span id="__span-5-142"><a id="__codelineno-5-142" name="__codelineno-5-142" href="#__codelineno-5-142"></a>#message_size_limit 0
</span><span id="__span-5-143"><a id="__codelineno-5-143" name="__codelineno-5-143" href="#__codelineno-5-143"></a>
</span><span id="__span-5-144"><a id="__codelineno-5-144" name="__codelineno-5-144" href="#__codelineno-5-144"></a># This option allows the session of persistent clients (those with clean
</span><span id="__span-5-145"><a id="__codelineno-5-145" name="__codelineno-5-145" href="#__codelineno-5-145"></a># session set to false) that are not currently connected to be removed if they
</span><span id="__span-5-146"><a id="__codelineno-5-146" name="__codelineno-5-146" href="#__codelineno-5-146"></a># do not reconnect within a certain time frame. This is a non-standard option
</span><span id="__span-5-147"><a id="__codelineno-5-147" name="__codelineno-5-147" href="#__codelineno-5-147"></a># in MQTT v3.1. MQTT v3.1.1 and v5.0 allow brokers to remove client sessions.
</span><span id="__span-5-148"><a id="__codelineno-5-148" name="__codelineno-5-148" href="#__codelineno-5-148"></a>#
</span><span id="__span-5-149"><a id="__codelineno-5-149" name="__codelineno-5-149" href="#__codelineno-5-149"></a># Badly designed clients may set clean session to false whilst using a randomly
</span><span id="__span-5-150"><a id="__codelineno-5-150" name="__codelineno-5-150" href="#__codelineno-5-150"></a># generated client id. This leads to persistent clients that connect once and
</span><span id="__span-5-151"><a id="__codelineno-5-151" name="__codelineno-5-151" href="#__codelineno-5-151"></a># never reconnect. This option allows these clients to be removed.  This option
</span><span id="__span-5-152"><a id="__codelineno-5-152" name="__codelineno-5-152" href="#__codelineno-5-152"></a># allows persistent clients (those with clean session set to false) to be
</span><span id="__span-5-153"><a id="__codelineno-5-153" name="__codelineno-5-153" href="#__codelineno-5-153"></a># removed if they do not reconnect within a certain time frame.
</span><span id="__span-5-154"><a id="__codelineno-5-154" name="__codelineno-5-154" href="#__codelineno-5-154"></a>#
</span><span id="__span-5-155"><a id="__codelineno-5-155" name="__codelineno-5-155" href="#__codelineno-5-155"></a># The expiration period should be an integer followed by one of h d w m y for
</span><span id="__span-5-156"><a id="__codelineno-5-156" name="__codelineno-5-156" href="#__codelineno-5-156"></a># hour, day, week, month and year respectively. For example
</span><span id="__span-5-157"><a id="__codelineno-5-157" name="__codelineno-5-157" href="#__codelineno-5-157"></a>#
</span><span id="__span-5-158"><a id="__codelineno-5-158" name="__codelineno-5-158" href="#__codelineno-5-158"></a># persistent_client_expiration 2m
</span><span id="__span-5-159"><a id="__codelineno-5-159" name="__codelineno-5-159" href="#__codelineno-5-159"></a># persistent_client_expiration 14d
</span><span id="__span-5-160"><a id="__codelineno-5-160" name="__codelineno-5-160" href="#__codelineno-5-160"></a># persistent_client_expiration 1y
</span><span id="__span-5-161"><a id="__codelineno-5-161" name="__codelineno-5-161" href="#__codelineno-5-161"></a>#
</span><span id="__span-5-162"><a id="__codelineno-5-162" name="__codelineno-5-162" href="#__codelineno-5-162"></a># The default if not set is to never expire persistent clients.
</span><span id="__span-5-163"><a id="__codelineno-5-163" name="__codelineno-5-163" href="#__codelineno-5-163"></a>persistent_client_expiration 1d
</span><span id="__span-5-164"><a id="__codelineno-5-164" name="__codelineno-5-164" href="#__codelineno-5-164"></a>
</span><span id="__span-5-165"><a id="__codelineno-5-165" name="__codelineno-5-165" href="#__codelineno-5-165"></a># Write process id to a file. Default is a blank string which means
</span><span id="__span-5-166"><a id="__codelineno-5-166" name="__codelineno-5-166" href="#__codelineno-5-166"></a># a pid file shouldn&#39;t be written.
</span><span id="__span-5-167"><a id="__codelineno-5-167" name="__codelineno-5-167" href="#__codelineno-5-167"></a># This should be set to /var/run/mosquitto/mosquitto.pid if mosquitto is
</span><span id="__span-5-168"><a id="__codelineno-5-168" name="__codelineno-5-168" href="#__codelineno-5-168"></a># being run automatically on boot with an init script and
</span><span id="__span-5-169"><a id="__codelineno-5-169" name="__codelineno-5-169" href="#__codelineno-5-169"></a># start-stop-daemon or similar.
</span><span id="__span-5-170"><a id="__codelineno-5-170" name="__codelineno-5-170" href="#__codelineno-5-170"></a>pid_file /run/mosquitto/mosquitto.pid
</span><span id="__span-5-171"><a id="__codelineno-5-171" name="__codelineno-5-171" href="#__codelineno-5-171"></a>
</span><span id="__span-5-172"><a id="__codelineno-5-172" name="__codelineno-5-172" href="#__codelineno-5-172"></a># Set to true to queue messages with QoS 0 when a persistent client is
</span><span id="__span-5-173"><a id="__codelineno-5-173" name="__codelineno-5-173" href="#__codelineno-5-173"></a># disconnected. These messages are included in the limit imposed by
</span><span id="__span-5-174"><a id="__codelineno-5-174" name="__codelineno-5-174" href="#__codelineno-5-174"></a># max_queued_messages and max_queued_bytes
</span><span id="__span-5-175"><a id="__codelineno-5-175" name="__codelineno-5-175" href="#__codelineno-5-175"></a># Defaults to false.
</span><span id="__span-5-176"><a id="__codelineno-5-176" name="__codelineno-5-176" href="#__codelineno-5-176"></a># This is a non-standard option for the MQTT v3.1 spec but is allowed in
</span><span id="__span-5-177"><a id="__codelineno-5-177" name="__codelineno-5-177" href="#__codelineno-5-177"></a># v3.1.1.
</span><span id="__span-5-178"><a id="__codelineno-5-178" name="__codelineno-5-178" href="#__codelineno-5-178"></a>#queue_qos0_messages false
</span><span id="__span-5-179"><a id="__codelineno-5-179" name="__codelineno-5-179" href="#__codelineno-5-179"></a>
</span><span id="__span-5-180"><a id="__codelineno-5-180" name="__codelineno-5-180" href="#__codelineno-5-180"></a># Set to false to disable retained message support. If a client publishes a
</span><span id="__span-5-181"><a id="__codelineno-5-181" name="__codelineno-5-181" href="#__codelineno-5-181"></a># message with the retain bit set, it will be disconnected if this is set to
</span><span id="__span-5-182"><a id="__codelineno-5-182" name="__codelineno-5-182" href="#__codelineno-5-182"></a># false.
</span><span id="__span-5-183"><a id="__codelineno-5-183" name="__codelineno-5-183" href="#__codelineno-5-183"></a>#retain_available true
</span><span id="__span-5-184"><a id="__codelineno-5-184" name="__codelineno-5-184" href="#__codelineno-5-184"></a>
</span><span id="__span-5-185"><a id="__codelineno-5-185" name="__codelineno-5-185" href="#__codelineno-5-185"></a># Disable Nagle&#39;s algorithm on client sockets. This has the effect of reducing
</span><span id="__span-5-186"><a id="__codelineno-5-186" name="__codelineno-5-186" href="#__codelineno-5-186"></a># latency of individual messages at the potential cost of increasing the number
</span><span id="__span-5-187"><a id="__codelineno-5-187" name="__codelineno-5-187" href="#__codelineno-5-187"></a># of packets being sent.
</span><span id="__span-5-188"><a id="__codelineno-5-188" name="__codelineno-5-188" href="#__codelineno-5-188"></a>set_tcp_nodelay true
</span><span id="__span-5-189"><a id="__codelineno-5-189" name="__codelineno-5-189" href="#__codelineno-5-189"></a>
</span><span id="__span-5-190"><a id="__codelineno-5-190" name="__codelineno-5-190" href="#__codelineno-5-190"></a># Time in seconds between updates of the $SYS tree.
</span><span id="__span-5-191"><a id="__codelineno-5-191" name="__codelineno-5-191" href="#__codelineno-5-191"></a># Set to 0 to disable the publishing of the $SYS tree.
</span><span id="__span-5-192"><a id="__codelineno-5-192" name="__codelineno-5-192" href="#__codelineno-5-192"></a>#sys_interval 10
</span><span id="__span-5-193"><a id="__codelineno-5-193" name="__codelineno-5-193" href="#__codelineno-5-193"></a>
</span><span id="__span-5-194"><a id="__codelineno-5-194" name="__codelineno-5-194" href="#__codelineno-5-194"></a># The MQTT specification requires that the QoS of a message delivered to a
</span><span id="__span-5-195"><a id="__codelineno-5-195" name="__codelineno-5-195" href="#__codelineno-5-195"></a># subscriber is never upgraded to match the QoS of the subscription. Enabling
</span><span id="__span-5-196"><a id="__codelineno-5-196" name="__codelineno-5-196" href="#__codelineno-5-196"></a># this option changes this behaviour. If upgrade_outgoing_qos is set true,
</span><span id="__span-5-197"><a id="__codelineno-5-197" name="__codelineno-5-197" href="#__codelineno-5-197"></a># messages sent to a subscriber will always match the QoS of its subscription.
</span><span id="__span-5-198"><a id="__codelineno-5-198" name="__codelineno-5-198" href="#__codelineno-5-198"></a># This is a non-standard option explicitly disallowed by the spec.
</span><span id="__span-5-199"><a id="__codelineno-5-199" name="__codelineno-5-199" href="#__codelineno-5-199"></a>#upgrade_outgoing_qos false
</span><span id="__span-5-200"><a id="__codelineno-5-200" name="__codelineno-5-200" href="#__codelineno-5-200"></a>
</span><span id="__span-5-201"><a id="__codelineno-5-201" name="__codelineno-5-201" href="#__codelineno-5-201"></a># When run as root, drop privileges to this user and its primary
</span><span id="__span-5-202"><a id="__codelineno-5-202" name="__codelineno-5-202" href="#__codelineno-5-202"></a># group.
</span><span id="__span-5-203"><a id="__codelineno-5-203" name="__codelineno-5-203" href="#__codelineno-5-203"></a># Set to root to stay as root, but this is not recommended.
</span><span id="__span-5-204"><a id="__codelineno-5-204" name="__codelineno-5-204" href="#__codelineno-5-204"></a># If set to &quot;mosquitto&quot;, or left unset, and the &quot;mosquitto&quot; user does not exist
</span><span id="__span-5-205"><a id="__codelineno-5-205" name="__codelineno-5-205" href="#__codelineno-5-205"></a># then it will drop privileges to the &quot;nobody&quot; user instead.
</span><span id="__span-5-206"><a id="__codelineno-5-206" name="__codelineno-5-206" href="#__codelineno-5-206"></a># If run as a non-root user, this setting has no effect.
</span><span id="__span-5-207"><a id="__codelineno-5-207" name="__codelineno-5-207" href="#__codelineno-5-207"></a># Note that on Windows this has no effect and so mosquitto should be started by
</span><span id="__span-5-208"><a id="__codelineno-5-208" name="__codelineno-5-208" href="#__codelineno-5-208"></a># the user you wish it to run as.
</span><span id="__span-5-209"><a id="__codelineno-5-209" name="__codelineno-5-209" href="#__codelineno-5-209"></a>user mosquitto
</span><span id="__span-5-210"><a id="__codelineno-5-210" name="__codelineno-5-210" href="#__codelineno-5-210"></a>
</span><span id="__span-5-211"><a id="__codelineno-5-211" name="__codelineno-5-211" href="#__codelineno-5-211"></a># =================================================================
</span><span id="__span-5-212"><a id="__codelineno-5-212" name="__codelineno-5-212" href="#__codelineno-5-212"></a># Listeners
</span><span id="__span-5-213"><a id="__codelineno-5-213" name="__codelineno-5-213" href="#__codelineno-5-213"></a># =================================================================
</span><span id="__span-5-214"><a id="__codelineno-5-214" name="__codelineno-5-214" href="#__codelineno-5-214"></a>
</span><span id="__span-5-215"><a id="__codelineno-5-215" name="__codelineno-5-215" href="#__codelineno-5-215"></a># Listen on a port/ip address combination. By using this variable
</span><span id="__span-5-216"><a id="__codelineno-5-216" name="__codelineno-5-216" href="#__codelineno-5-216"></a># multiple times, mosquitto can listen on more than one port. If
</span><span id="__span-5-217"><a id="__codelineno-5-217" name="__codelineno-5-217" href="#__codelineno-5-217"></a># this variable is used and neither bind_address nor port given,
</span><span id="__span-5-218"><a id="__codelineno-5-218" name="__codelineno-5-218" href="#__codelineno-5-218"></a># then the default listener will not be started.
</span><span id="__span-5-219"><a id="__codelineno-5-219" name="__codelineno-5-219" href="#__codelineno-5-219"></a># The port number to listen on must be given. Optionally, an ip
</span><span id="__span-5-220"><a id="__codelineno-5-220" name="__codelineno-5-220" href="#__codelineno-5-220"></a># address or host name may be supplied as a second argument. In
</span><span id="__span-5-221"><a id="__codelineno-5-221" name="__codelineno-5-221" href="#__codelineno-5-221"></a># this case, mosquitto will attempt to bind the listener to that
</span><span id="__span-5-222"><a id="__codelineno-5-222" name="__codelineno-5-222" href="#__codelineno-5-222"></a># address and so restrict access to the associated network and
</span><span id="__span-5-223"><a id="__codelineno-5-223" name="__codelineno-5-223" href="#__codelineno-5-223"></a># interface. By default, mosquitto will listen on all interfaces.
</span><span id="__span-5-224"><a id="__codelineno-5-224" name="__codelineno-5-224" href="#__codelineno-5-224"></a># Note that for a websockets listener it is not possible to bind to a host
</span><span id="__span-5-225"><a id="__codelineno-5-225" name="__codelineno-5-225" href="#__codelineno-5-225"></a># name.
</span><span id="__span-5-226"><a id="__codelineno-5-226" name="__codelineno-5-226" href="#__codelineno-5-226"></a>#
</span><span id="__span-5-227"><a id="__codelineno-5-227" name="__codelineno-5-227" href="#__codelineno-5-227"></a># On systems that support Unix Domain Sockets, it is also possible
</span><span id="__span-5-228"><a id="__codelineno-5-228" name="__codelineno-5-228" href="#__codelineno-5-228"></a># to create a # Unix socket rather than opening a TCP socket. In
</span><span id="__span-5-229"><a id="__codelineno-5-229" name="__codelineno-5-229" href="#__codelineno-5-229"></a># this case, the port number should be set to 0 and a unix socket
</span><span id="__span-5-230"><a id="__codelineno-5-230" name="__codelineno-5-230" href="#__codelineno-5-230"></a># path must be provided, e.g.
</span><span id="__span-5-231"><a id="__codelineno-5-231" name="__codelineno-5-231" href="#__codelineno-5-231"></a># listener 0 /tmp/mosquitto.sock
</span><span id="__span-5-232"><a id="__codelineno-5-232" name="__codelineno-5-232" href="#__codelineno-5-232"></a>#
</span><span id="__span-5-233"><a id="__codelineno-5-233" name="__codelineno-5-233" href="#__codelineno-5-233"></a># listener port-number [ip address/host name/unix socket path]
</span><span id="__span-5-234"><a id="__codelineno-5-234" name="__codelineno-5-234" href="#__codelineno-5-234"></a>listener 1883
</span><span id="__span-5-235"><a id="__codelineno-5-235" name="__codelineno-5-235" href="#__codelineno-5-235"></a>listener 8883
</span><span id="__span-5-236"><a id="__codelineno-5-236" name="__codelineno-5-236" href="#__codelineno-5-236"></a>
</span><span id="__span-5-237"><a id="__codelineno-5-237" name="__codelineno-5-237" href="#__codelineno-5-237"></a># By default, a listener will attempt to listen on all supported IP protocol
</span><span id="__span-5-238"><a id="__codelineno-5-238" name="__codelineno-5-238" href="#__codelineno-5-238"></a># versions. If you do not have an IPv4 or IPv6 interface you may wish to
</span><span id="__span-5-239"><a id="__codelineno-5-239" name="__codelineno-5-239" href="#__codelineno-5-239"></a># disable support for either of those protocol versions. In particular, note
</span><span id="__span-5-240"><a id="__codelineno-5-240" name="__codelineno-5-240" href="#__codelineno-5-240"></a># that due to the limitations of the websockets library, it will only ever
</span><span id="__span-5-241"><a id="__codelineno-5-241" name="__codelineno-5-241" href="#__codelineno-5-241"></a># attempt to open IPv6 sockets if IPv6 support is compiled in, and so will fail
</span><span id="__span-5-242"><a id="__codelineno-5-242" name="__codelineno-5-242" href="#__codelineno-5-242"></a># if IPv6 is not available.
</span><span id="__span-5-243"><a id="__codelineno-5-243" name="__codelineno-5-243" href="#__codelineno-5-243"></a>#
</span><span id="__span-5-244"><a id="__codelineno-5-244" name="__codelineno-5-244" href="#__codelineno-5-244"></a># Set to `ipv4` to force the listener to only use IPv4, or set to `ipv6` to
</span><span id="__span-5-245"><a id="__codelineno-5-245" name="__codelineno-5-245" href="#__codelineno-5-245"></a># force the listener to only use IPv6. If you want support for both IPv4 and
</span><span id="__span-5-246"><a id="__codelineno-5-246" name="__codelineno-5-246" href="#__codelineno-5-246"></a># IPv6, then do not use the socket_domain option.
</span><span id="__span-5-247"><a id="__codelineno-5-247" name="__codelineno-5-247" href="#__codelineno-5-247"></a>#
</span><span id="__span-5-248"><a id="__codelineno-5-248" name="__codelineno-5-248" href="#__codelineno-5-248"></a>#socket_domain
</span><span id="__span-5-249"><a id="__codelineno-5-249" name="__codelineno-5-249" href="#__codelineno-5-249"></a>
</span><span id="__span-5-250"><a id="__codelineno-5-250" name="__codelineno-5-250" href="#__codelineno-5-250"></a># Bind the listener to a specific interface. This is similar to
</span><span id="__span-5-251"><a id="__codelineno-5-251" name="__codelineno-5-251" href="#__codelineno-5-251"></a># the [ip address/host name] part of the listener definition, but is useful
</span><span id="__span-5-252"><a id="__codelineno-5-252" name="__codelineno-5-252" href="#__codelineno-5-252"></a># when an interface has multiple addresses or the address may change. If used
</span><span id="__span-5-253"><a id="__codelineno-5-253" name="__codelineno-5-253" href="#__codelineno-5-253"></a># with the [ip address/host name] part of the listener definition, then the
</span><span id="__span-5-254"><a id="__codelineno-5-254" name="__codelineno-5-254" href="#__codelineno-5-254"></a># bind_interface option will take priority.
</span><span id="__span-5-255"><a id="__codelineno-5-255" name="__codelineno-5-255" href="#__codelineno-5-255"></a># Not available on Windows.
</span><span id="__span-5-256"><a id="__codelineno-5-256" name="__codelineno-5-256" href="#__codelineno-5-256"></a>#
</span><span id="__span-5-257"><a id="__codelineno-5-257" name="__codelineno-5-257" href="#__codelineno-5-257"></a># Example: bind_interface eth0
</span><span id="__span-5-258"><a id="__codelineno-5-258" name="__codelineno-5-258" href="#__codelineno-5-258"></a>#bind_interface
</span><span id="__span-5-259"><a id="__codelineno-5-259" name="__codelineno-5-259" href="#__codelineno-5-259"></a>
</span><span id="__span-5-260"><a id="__codelineno-5-260" name="__codelineno-5-260" href="#__codelineno-5-260"></a># When a listener is using the websockets protocol, it is possible to serve
</span><span id="__span-5-261"><a id="__codelineno-5-261" name="__codelineno-5-261" href="#__codelineno-5-261"></a># http data as well. Set http_dir to a directory which contains the files you
</span><span id="__span-5-262"><a id="__codelineno-5-262" name="__codelineno-5-262" href="#__codelineno-5-262"></a># wish to serve. If this option is not specified, then no normal http
</span><span id="__span-5-263"><a id="__codelineno-5-263" name="__codelineno-5-263" href="#__codelineno-5-263"></a># connections will be possible.
</span><span id="__span-5-264"><a id="__codelineno-5-264" name="__codelineno-5-264" href="#__codelineno-5-264"></a>#http_dir
</span><span id="__span-5-265"><a id="__codelineno-5-265" name="__codelineno-5-265" href="#__codelineno-5-265"></a>
</span><span id="__span-5-266"><a id="__codelineno-5-266" name="__codelineno-5-266" href="#__codelineno-5-266"></a># The maximum number of client connections to allow. This is
</span><span id="__span-5-267"><a id="__codelineno-5-267" name="__codelineno-5-267" href="#__codelineno-5-267"></a># a per listener setting.
</span><span id="__span-5-268"><a id="__codelineno-5-268" name="__codelineno-5-268" href="#__codelineno-5-268"></a># Default is -1, which means unlimited connections.
</span><span id="__span-5-269"><a id="__codelineno-5-269" name="__codelineno-5-269" href="#__codelineno-5-269"></a># Note that other process limits mean that unlimited connections
</span><span id="__span-5-270"><a id="__codelineno-5-270" name="__codelineno-5-270" href="#__codelineno-5-270"></a># are not really possible. Typically the default maximum number of
</span><span id="__span-5-271"><a id="__codelineno-5-271" name="__codelineno-5-271" href="#__codelineno-5-271"></a># connections possible is around 1024.
</span><span id="__span-5-272"><a id="__codelineno-5-272" name="__codelineno-5-272" href="#__codelineno-5-272"></a>#max_connections -1
</span><span id="__span-5-273"><a id="__codelineno-5-273" name="__codelineno-5-273" href="#__codelineno-5-273"></a>
</span><span id="__span-5-274"><a id="__codelineno-5-274" name="__codelineno-5-274" href="#__codelineno-5-274"></a># The listener can be restricted to operating within a topic hierarchy using
</span><span id="__span-5-275"><a id="__codelineno-5-275" name="__codelineno-5-275" href="#__codelineno-5-275"></a># the mount_point option. This is achieved be prefixing the mount_point string
</span><span id="__span-5-276"><a id="__codelineno-5-276" name="__codelineno-5-276" href="#__codelineno-5-276"></a># to all topics for any clients connected to this listener. This prefixing only
</span><span id="__span-5-277"><a id="__codelineno-5-277" name="__codelineno-5-277" href="#__codelineno-5-277"></a># happens internally to the broker; the client will not see the prefix.
</span><span id="__span-5-278"><a id="__codelineno-5-278" name="__codelineno-5-278" href="#__codelineno-5-278"></a>#mount_point
</span><span id="__span-5-279"><a id="__codelineno-5-279" name="__codelineno-5-279" href="#__codelineno-5-279"></a>
</span><span id="__span-5-280"><a id="__codelineno-5-280" name="__codelineno-5-280" href="#__codelineno-5-280"></a># Choose the protocol to use when listening.
</span><span id="__span-5-281"><a id="__codelineno-5-281" name="__codelineno-5-281" href="#__codelineno-5-281"></a># This can be either mqtt or websockets.
</span><span id="__span-5-282"><a id="__codelineno-5-282" name="__codelineno-5-282" href="#__codelineno-5-282"></a># Certificate based TLS may be used with websockets, except that only the
</span><span id="__span-5-283"><a id="__codelineno-5-283" name="__codelineno-5-283" href="#__codelineno-5-283"></a># cafile, certfile, keyfile, ciphers, and ciphers_tls13 options are supported.
</span><span id="__span-5-284"><a id="__codelineno-5-284" name="__codelineno-5-284" href="#__codelineno-5-284"></a>#protocol mqtt
</span><span id="__span-5-285"><a id="__codelineno-5-285" name="__codelineno-5-285" href="#__codelineno-5-285"></a>
</span><span id="__span-5-286"><a id="__codelineno-5-286" name="__codelineno-5-286" href="#__codelineno-5-286"></a># Set use_username_as_clientid to true to replace the clientid that a client
</span><span id="__span-5-287"><a id="__codelineno-5-287" name="__codelineno-5-287" href="#__codelineno-5-287"></a># connected with with its username. This allows authentication to be tied to
</span><span id="__span-5-288"><a id="__codelineno-5-288" name="__codelineno-5-288" href="#__codelineno-5-288"></a># the clientid, which means that it is possible to prevent one client
</span><span id="__span-5-289"><a id="__codelineno-5-289" name="__codelineno-5-289" href="#__codelineno-5-289"></a># disconnecting another by using the same clientid.
</span><span id="__span-5-290"><a id="__codelineno-5-290" name="__codelineno-5-290" href="#__codelineno-5-290"></a># If a client connects with no username it will be disconnected as not
</span><span id="__span-5-291"><a id="__codelineno-5-291" name="__codelineno-5-291" href="#__codelineno-5-291"></a># authorised when this option is set to true.
</span><span id="__span-5-292"><a id="__codelineno-5-292" name="__codelineno-5-292" href="#__codelineno-5-292"></a># Do not use in conjunction with clientid_prefixes.
</span><span id="__span-5-293"><a id="__codelineno-5-293" name="__codelineno-5-293" href="#__codelineno-5-293"></a># See also use_identity_as_username.
</span><span id="__span-5-294"><a id="__codelineno-5-294" name="__codelineno-5-294" href="#__codelineno-5-294"></a># This does not apply globally, but on a per-listener basis.
</span><span id="__span-5-295"><a id="__codelineno-5-295" name="__codelineno-5-295" href="#__codelineno-5-295"></a>#use_username_as_clientid
</span><span id="__span-5-296"><a id="__codelineno-5-296" name="__codelineno-5-296" href="#__codelineno-5-296"></a>
</span><span id="__span-5-297"><a id="__codelineno-5-297" name="__codelineno-5-297" href="#__codelineno-5-297"></a># Change the websockets headers size. This is a global option, it is not
</span><span id="__span-5-298"><a id="__codelineno-5-298" name="__codelineno-5-298" href="#__codelineno-5-298"></a># possible to set per listener. This option sets the size of the buffer used in
</span><span id="__span-5-299"><a id="__codelineno-5-299" name="__codelineno-5-299" href="#__codelineno-5-299"></a># the libwebsockets library when reading HTTP headers. If you are passing large
</span><span id="__span-5-300"><a id="__codelineno-5-300" name="__codelineno-5-300" href="#__codelineno-5-300"></a># header data such as cookies then you may need to increase this value. If left
</span><span id="__span-5-301"><a id="__codelineno-5-301" name="__codelineno-5-301" href="#__codelineno-5-301"></a># unset, or set to 0, then the default of 1024 bytes will be used.
</span><span id="__span-5-302"><a id="__codelineno-5-302" name="__codelineno-5-302" href="#__codelineno-5-302"></a>#websockets_headers_size
</span><span id="__span-5-303"><a id="__codelineno-5-303" name="__codelineno-5-303" href="#__codelineno-5-303"></a>
</span><span id="__span-5-304"><a id="__codelineno-5-304" name="__codelineno-5-304" href="#__codelineno-5-304"></a># -----------------------------------------------------------------
</span><span id="__span-5-305"><a id="__codelineno-5-305" name="__codelineno-5-305" href="#__codelineno-5-305"></a># Certificate based SSL/TLS support
</span><span id="__span-5-306"><a id="__codelineno-5-306" name="__codelineno-5-306" href="#__codelineno-5-306"></a># -----------------------------------------------------------------
</span><span id="__span-5-307"><a id="__codelineno-5-307" name="__codelineno-5-307" href="#__codelineno-5-307"></a># The following options can be used to enable certificate based SSL/TLS support
</span><span id="__span-5-308"><a id="__codelineno-5-308" name="__codelineno-5-308" href="#__codelineno-5-308"></a># for this listener. Note that the recommended port for MQTT over TLS is 8883,
</span><span id="__span-5-309"><a id="__codelineno-5-309" name="__codelineno-5-309" href="#__codelineno-5-309"></a># but this must be set manually.
</span><span id="__span-5-310"><a id="__codelineno-5-310" name="__codelineno-5-310" href="#__codelineno-5-310"></a>#
</span><span id="__span-5-311"><a id="__codelineno-5-311" name="__codelineno-5-311" href="#__codelineno-5-311"></a># See also the mosquitto-tls man page and the &quot;Pre-shared-key based SSL/TLS
</span><span id="__span-5-312"><a id="__codelineno-5-312" name="__codelineno-5-312" href="#__codelineno-5-312"></a># support&quot; section. Only one of certificate or PSK encryption support can be
</span><span id="__span-5-313"><a id="__codelineno-5-313" name="__codelineno-5-313" href="#__codelineno-5-313"></a># enabled for any listener.
</span><span id="__span-5-314"><a id="__codelineno-5-314" name="__codelineno-5-314" href="#__codelineno-5-314"></a>
</span><span id="__span-5-315"><a id="__codelineno-5-315" name="__codelineno-5-315" href="#__codelineno-5-315"></a># Both of certfile and keyfile must be defined to enable certificate based
</span><span id="__span-5-316"><a id="__codelineno-5-316" name="__codelineno-5-316" href="#__codelineno-5-316"></a># TLS encryption.
</span><span id="__span-5-317"><a id="__codelineno-5-317" name="__codelineno-5-317" href="#__codelineno-5-317"></a>
</span><span id="__span-5-318"><a id="__codelineno-5-318" name="__codelineno-5-318" href="#__codelineno-5-318"></a># Path to the PEM encoded server certificate.
</span><span id="__span-5-319"><a id="__codelineno-5-319" name="__codelineno-5-319" href="#__codelineno-5-319"></a>certfile /etc/mosquitto/mqtt_server.crt
</span><span id="__span-5-320"><a id="__codelineno-5-320" name="__codelineno-5-320" href="#__codelineno-5-320"></a>
</span><span id="__span-5-321"><a id="__codelineno-5-321" name="__codelineno-5-321" href="#__codelineno-5-321"></a># Path to the PEM encoded keyfile.
</span><span id="__span-5-322"><a id="__codelineno-5-322" name="__codelineno-5-322" href="#__codelineno-5-322"></a>keyfile /etc/mosquitto/mqtt_server.key
</span><span id="__span-5-323"><a id="__codelineno-5-323" name="__codelineno-5-323" href="#__codelineno-5-323"></a>
</span><span id="__span-5-324"><a id="__codelineno-5-324" name="__codelineno-5-324" href="#__codelineno-5-324"></a># If you wish to control which encryption ciphers are used, use the ciphers
</span><span id="__span-5-325"><a id="__codelineno-5-325" name="__codelineno-5-325" href="#__codelineno-5-325"></a># option. The list of available ciphers can be optained using the &quot;openssl
</span><span id="__span-5-326"><a id="__codelineno-5-326" name="__codelineno-5-326" href="#__codelineno-5-326"></a># ciphers&quot; command and should be provided in the same format as the output of
</span><span id="__span-5-327"><a id="__codelineno-5-327" name="__codelineno-5-327" href="#__codelineno-5-327"></a># that command. This applies to TLS 1.2 and earlier versions only. Use
</span><span id="__span-5-328"><a id="__codelineno-5-328" name="__codelineno-5-328" href="#__codelineno-5-328"></a># ciphers_tls1.3 for TLS v1.3.
</span><span id="__span-5-329"><a id="__codelineno-5-329" name="__codelineno-5-329" href="#__codelineno-5-329"></a>#ciphers
</span><span id="__span-5-330"><a id="__codelineno-5-330" name="__codelineno-5-330" href="#__codelineno-5-330"></a>
</span><span id="__span-5-331"><a id="__codelineno-5-331" name="__codelineno-5-331" href="#__codelineno-5-331"></a># Choose which TLS v1.3 ciphersuites are used for this listener.
</span><span id="__span-5-332"><a id="__codelineno-5-332" name="__codelineno-5-332" href="#__codelineno-5-332"></a># Defaults to &quot;TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256&quot;
</span><span id="__span-5-333"><a id="__codelineno-5-333" name="__codelineno-5-333" href="#__codelineno-5-333"></a>#ciphers_tls1.3
</span><span id="__span-5-334"><a id="__codelineno-5-334" name="__codelineno-5-334" href="#__codelineno-5-334"></a>
</span><span id="__span-5-335"><a id="__codelineno-5-335" name="__codelineno-5-335" href="#__codelineno-5-335"></a># If you have require_certificate set to true, you can create a certificate
</span><span id="__span-5-336"><a id="__codelineno-5-336" name="__codelineno-5-336" href="#__codelineno-5-336"></a># revocation list file to revoke access to particular client certificates. If
</span><span id="__span-5-337"><a id="__codelineno-5-337" name="__codelineno-5-337" href="#__codelineno-5-337"></a># you have done this, use crlfile to point to the PEM encoded revocation file.
</span><span id="__span-5-338"><a id="__codelineno-5-338" name="__codelineno-5-338" href="#__codelineno-5-338"></a>#crlfile
</span><span id="__span-5-339"><a id="__codelineno-5-339" name="__codelineno-5-339" href="#__codelineno-5-339"></a>
</span><span id="__span-5-340"><a id="__codelineno-5-340" name="__codelineno-5-340" href="#__codelineno-5-340"></a># To allow the use of ephemeral DH key exchange, which provides forward
</span><span id="__span-5-341"><a id="__codelineno-5-341" name="__codelineno-5-341" href="#__codelineno-5-341"></a># security, the listener must load DH parameters. This can be specified with
</span><span id="__span-5-342"><a id="__codelineno-5-342" name="__codelineno-5-342" href="#__codelineno-5-342"></a># the dhparamfile option. The dhparamfile can be generated with the command
</span><span id="__span-5-343"><a id="__codelineno-5-343" name="__codelineno-5-343" href="#__codelineno-5-343"></a># e.g. &quot;openssl dhparam -out dhparam.pem 2048&quot;
</span><span id="__span-5-344"><a id="__codelineno-5-344" name="__codelineno-5-344" href="#__codelineno-5-344"></a>#dhparamfile
</span><span id="__span-5-345"><a id="__codelineno-5-345" name="__codelineno-5-345" href="#__codelineno-5-345"></a>
</span><span id="__span-5-346"><a id="__codelineno-5-346" name="__codelineno-5-346" href="#__codelineno-5-346"></a># By default an TLS enabled listener will operate in a similar fashion to a
</span><span id="__span-5-347"><a id="__codelineno-5-347" name="__codelineno-5-347" href="#__codelineno-5-347"></a># https enabled web server, in that the server has a certificate signed by a CA
</span><span id="__span-5-348"><a id="__codelineno-5-348" name="__codelineno-5-348" href="#__codelineno-5-348"></a># and the client will verify that it is a trusted certificate. The overall aim
</span><span id="__span-5-349"><a id="__codelineno-5-349" name="__codelineno-5-349" href="#__codelineno-5-349"></a># is encryption of the network traffic. By setting require_certificate to true,
</span><span id="__span-5-350"><a id="__codelineno-5-350" name="__codelineno-5-350" href="#__codelineno-5-350"></a># the client must provide a valid certificate in order for the network
</span><span id="__span-5-351"><a id="__codelineno-5-351" name="__codelineno-5-351" href="#__codelineno-5-351"></a># connection to proceed. This allows access to the broker to be controlled
</span><span id="__span-5-352"><a id="__codelineno-5-352" name="__codelineno-5-352" href="#__codelineno-5-352"></a># outside of the mechanisms provided by MQTT.
</span><span id="__span-5-353"><a id="__codelineno-5-353" name="__codelineno-5-353" href="#__codelineno-5-353"></a>require_certificate false
</span><span id="__span-5-354"><a id="__codelineno-5-354" name="__codelineno-5-354" href="#__codelineno-5-354"></a>
</span><span id="__span-5-355"><a id="__codelineno-5-355" name="__codelineno-5-355" href="#__codelineno-5-355"></a># cafile and capath define methods of accessing the PEM encoded
</span><span id="__span-5-356"><a id="__codelineno-5-356" name="__codelineno-5-356" href="#__codelineno-5-356"></a># Certificate Authority certificates that will be considered trusted when
</span><span id="__span-5-357"><a id="__codelineno-5-357" name="__codelineno-5-357" href="#__codelineno-5-357"></a># checking incoming client certificates.
</span><span id="__span-5-358"><a id="__codelineno-5-358" name="__codelineno-5-358" href="#__codelineno-5-358"></a># cafile defines the path to a file containing the CA certificates.
</span><span id="__span-5-359"><a id="__codelineno-5-359" name="__codelineno-5-359" href="#__codelineno-5-359"></a># capath defines a directory that will be searched for files
</span><span id="__span-5-360"><a id="__codelineno-5-360" name="__codelineno-5-360" href="#__codelineno-5-360"></a># containing the CA certificates. For capath to work correctly, the
</span><span id="__span-5-361"><a id="__codelineno-5-361" name="__codelineno-5-361" href="#__codelineno-5-361"></a># certificate files must have &quot;.crt&quot; as the file ending and you must run
</span><span id="__span-5-362"><a id="__codelineno-5-362" name="__codelineno-5-362" href="#__codelineno-5-362"></a># &quot;openssl rehash &lt;path to capath&gt;&quot; each time you add/remove a certificate.
</span><span id="__span-5-363"><a id="__codelineno-5-363" name="__codelineno-5-363" href="#__codelineno-5-363"></a>#cafile
</span><span id="__span-5-364"><a id="__codelineno-5-364" name="__codelineno-5-364" href="#__codelineno-5-364"></a>#capath
</span><span id="__span-5-365"><a id="__codelineno-5-365" name="__codelineno-5-365" href="#__codelineno-5-365"></a>
</span><span id="__span-5-366"><a id="__codelineno-5-366" name="__codelineno-5-366" href="#__codelineno-5-366"></a>
</span><span id="__span-5-367"><a id="__codelineno-5-367" name="__codelineno-5-367" href="#__codelineno-5-367"></a># If require_certificate is true, you may set use_identity_as_username to true
</span><span id="__span-5-368"><a id="__codelineno-5-368" name="__codelineno-5-368" href="#__codelineno-5-368"></a># to use the CN value from the client certificate as a username. If this is
</span><span id="__span-5-369"><a id="__codelineno-5-369" name="__codelineno-5-369" href="#__codelineno-5-369"></a># true, the password_file option will not be used for this listener.
</span><span id="__span-5-370"><a id="__codelineno-5-370" name="__codelineno-5-370" href="#__codelineno-5-370"></a>#use_identity_as_username false
</span><span id="__span-5-371"><a id="__codelineno-5-371" name="__codelineno-5-371" href="#__codelineno-5-371"></a>
</span><span id="__span-5-372"><a id="__codelineno-5-372" name="__codelineno-5-372" href="#__codelineno-5-372"></a># -----------------------------------------------------------------
</span><span id="__span-5-373"><a id="__codelineno-5-373" name="__codelineno-5-373" href="#__codelineno-5-373"></a># Pre-shared-key based SSL/TLS support
</span><span id="__span-5-374"><a id="__codelineno-5-374" name="__codelineno-5-374" href="#__codelineno-5-374"></a># -----------------------------------------------------------------
</span><span id="__span-5-375"><a id="__codelineno-5-375" name="__codelineno-5-375" href="#__codelineno-5-375"></a># The following options can be used to enable PSK based SSL/TLS support for
</span><span id="__span-5-376"><a id="__codelineno-5-376" name="__codelineno-5-376" href="#__codelineno-5-376"></a># this listener. Note that the recommended port for MQTT over TLS is 8883, but
</span><span id="__span-5-377"><a id="__codelineno-5-377" name="__codelineno-5-377" href="#__codelineno-5-377"></a># this must be set manually.
</span><span id="__span-5-378"><a id="__codelineno-5-378" name="__codelineno-5-378" href="#__codelineno-5-378"></a>#
</span><span id="__span-5-379"><a id="__codelineno-5-379" name="__codelineno-5-379" href="#__codelineno-5-379"></a># See also the mosquitto-tls man page and the &quot;Certificate based SSL/TLS
</span><span id="__span-5-380"><a id="__codelineno-5-380" name="__codelineno-5-380" href="#__codelineno-5-380"></a># support&quot; section. Only one of certificate or PSK encryption support can be
</span><span id="__span-5-381"><a id="__codelineno-5-381" name="__codelineno-5-381" href="#__codelineno-5-381"></a># enabled for any listener.
</span><span id="__span-5-382"><a id="__codelineno-5-382" name="__codelineno-5-382" href="#__codelineno-5-382"></a>
</span><span id="__span-5-383"><a id="__codelineno-5-383" name="__codelineno-5-383" href="#__codelineno-5-383"></a># The psk_hint option enables pre-shared-key support for this listener and also
</span><span id="__span-5-384"><a id="__codelineno-5-384" name="__codelineno-5-384" href="#__codelineno-5-384"></a># acts as an identifier for this listener. The hint is sent to clients and may
</span><span id="__span-5-385"><a id="__codelineno-5-385" name="__codelineno-5-385" href="#__codelineno-5-385"></a># be used locally to aid authentication. The hint is a free form string that
</span><span id="__span-5-386"><a id="__codelineno-5-386" name="__codelineno-5-386" href="#__codelineno-5-386"></a># doesn&#39;t have much meaning in itself, so feel free to be creative.
</span><span id="__span-5-387"><a id="__codelineno-5-387" name="__codelineno-5-387" href="#__codelineno-5-387"></a># If this option is provided, see psk_file to define the pre-shared keys to be
</span><span id="__span-5-388"><a id="__codelineno-5-388" name="__codelineno-5-388" href="#__codelineno-5-388"></a># used or create a security plugin to handle them.
</span><span id="__span-5-389"><a id="__codelineno-5-389" name="__codelineno-5-389" href="#__codelineno-5-389"></a>#psk_hint
</span><span id="__span-5-390"><a id="__codelineno-5-390" name="__codelineno-5-390" href="#__codelineno-5-390"></a>
</span><span id="__span-5-391"><a id="__codelineno-5-391" name="__codelineno-5-391" href="#__codelineno-5-391"></a># When using PSK, the encryption ciphers used will be chosen from the list of
</span><span id="__span-5-392"><a id="__codelineno-5-392" name="__codelineno-5-392" href="#__codelineno-5-392"></a># available PSK ciphers. If you want to control which ciphers are available,
</span><span id="__span-5-393"><a id="__codelineno-5-393" name="__codelineno-5-393" href="#__codelineno-5-393"></a># use the &quot;ciphers&quot; option.  The list of available ciphers can be optained
</span><span id="__span-5-394"><a id="__codelineno-5-394" name="__codelineno-5-394" href="#__codelineno-5-394"></a># using the &quot;openssl ciphers&quot; command and should be provided in the same format
</span><span id="__span-5-395"><a id="__codelineno-5-395" name="__codelineno-5-395" href="#__codelineno-5-395"></a># as the output of that command.
</span><span id="__span-5-396"><a id="__codelineno-5-396" name="__codelineno-5-396" href="#__codelineno-5-396"></a>#ciphers
</span><span id="__span-5-397"><a id="__codelineno-5-397" name="__codelineno-5-397" href="#__codelineno-5-397"></a>
</span><span id="__span-5-398"><a id="__codelineno-5-398" name="__codelineno-5-398" href="#__codelineno-5-398"></a># Set use_identity_as_username to have the psk identity sent by the client used
</span><span id="__span-5-399"><a id="__codelineno-5-399" name="__codelineno-5-399" href="#__codelineno-5-399"></a># as its username. Authentication will be carried out using the PSK rather than
</span><span id="__span-5-400"><a id="__codelineno-5-400" name="__codelineno-5-400" href="#__codelineno-5-400"></a># the MQTT username/password and so password_file will not be used for this
</span><span id="__span-5-401"><a id="__codelineno-5-401" name="__codelineno-5-401" href="#__codelineno-5-401"></a># listener.
</span><span id="__span-5-402"><a id="__codelineno-5-402" name="__codelineno-5-402" href="#__codelineno-5-402"></a>#use_identity_as_username false
</span><span id="__span-5-403"><a id="__codelineno-5-403" name="__codelineno-5-403" href="#__codelineno-5-403"></a>
</span><span id="__span-5-404"><a id="__codelineno-5-404" name="__codelineno-5-404" href="#__codelineno-5-404"></a>
</span><span id="__span-5-405"><a id="__codelineno-5-405" name="__codelineno-5-405" href="#__codelineno-5-405"></a># =================================================================
</span><span id="__span-5-406"><a id="__codelineno-5-406" name="__codelineno-5-406" href="#__codelineno-5-406"></a># Persistence
</span><span id="__span-5-407"><a id="__codelineno-5-407" name="__codelineno-5-407" href="#__codelineno-5-407"></a># =================================================================
</span><span id="__span-5-408"><a id="__codelineno-5-408" name="__codelineno-5-408" href="#__codelineno-5-408"></a>
</span><span id="__span-5-409"><a id="__codelineno-5-409" name="__codelineno-5-409" href="#__codelineno-5-409"></a># If persistence is enabled, save the in-memory database to disk
</span><span id="__span-5-410"><a id="__codelineno-5-410" name="__codelineno-5-410" href="#__codelineno-5-410"></a># every autosave_interval seconds. If set to 0, the persistence
</span><span id="__span-5-411"><a id="__codelineno-5-411" name="__codelineno-5-411" href="#__codelineno-5-411"></a># database will only be written when mosquitto exits. See also
</span><span id="__span-5-412"><a id="__codelineno-5-412" name="__codelineno-5-412" href="#__codelineno-5-412"></a># autosave_on_changes.
</span><span id="__span-5-413"><a id="__codelineno-5-413" name="__codelineno-5-413" href="#__codelineno-5-413"></a># Note that writing of the persistence database can be forced by
</span><span id="__span-5-414"><a id="__codelineno-5-414" name="__codelineno-5-414" href="#__codelineno-5-414"></a># sending mosquitto a SIGUSR1 signal.
</span><span id="__span-5-415"><a id="__codelineno-5-415" name="__codelineno-5-415" href="#__codelineno-5-415"></a>autosave_interval 100
</span><span id="__span-5-416"><a id="__codelineno-5-416" name="__codelineno-5-416" href="#__codelineno-5-416"></a>
</span><span id="__span-5-417"><a id="__codelineno-5-417" name="__codelineno-5-417" href="#__codelineno-5-417"></a># If true, mosquitto will count the number of subscription changes, retained
</span><span id="__span-5-418"><a id="__codelineno-5-418" name="__codelineno-5-418" href="#__codelineno-5-418"></a># messages received and queued messages and if the total exceeds
</span><span id="__span-5-419"><a id="__codelineno-5-419" name="__codelineno-5-419" href="#__codelineno-5-419"></a># autosave_interval then the in-memory database will be saved to disk.
</span><span id="__span-5-420"><a id="__codelineno-5-420" name="__codelineno-5-420" href="#__codelineno-5-420"></a># If false, mosquitto will save the in-memory database to disk by treating
</span><span id="__span-5-421"><a id="__codelineno-5-421" name="__codelineno-5-421" href="#__codelineno-5-421"></a># autosave_interval as a time in seconds.
</span><span id="__span-5-422"><a id="__codelineno-5-422" name="__codelineno-5-422" href="#__codelineno-5-422"></a>autosave_on_changes true
</span><span id="__span-5-423"><a id="__codelineno-5-423" name="__codelineno-5-423" href="#__codelineno-5-423"></a>
</span><span id="__span-5-424"><a id="__codelineno-5-424" name="__codelineno-5-424" href="#__codelineno-5-424"></a># Save persistent message data to disk (true/false).
</span><span id="__span-5-425"><a id="__codelineno-5-425" name="__codelineno-5-425" href="#__codelineno-5-425"></a># This saves information about all messages, including
</span><span id="__span-5-426"><a id="__codelineno-5-426" name="__codelineno-5-426" href="#__codelineno-5-426"></a># subscriptions, currently in-flight messages and retained
</span><span id="__span-5-427"><a id="__codelineno-5-427" name="__codelineno-5-427" href="#__codelineno-5-427"></a># messages.
</span><span id="__span-5-428"><a id="__codelineno-5-428" name="__codelineno-5-428" href="#__codelineno-5-428"></a># retained_persistence is a synonym for this option.
</span><span id="__span-5-429"><a id="__codelineno-5-429" name="__codelineno-5-429" href="#__codelineno-5-429"></a>persistence true
</span><span id="__span-5-430"><a id="__codelineno-5-430" name="__codelineno-5-430" href="#__codelineno-5-430"></a>
</span><span id="__span-5-431"><a id="__codelineno-5-431" name="__codelineno-5-431" href="#__codelineno-5-431"></a># The filename to use for the persistent database, not including
</span><span id="__span-5-432"><a id="__codelineno-5-432" name="__codelineno-5-432" href="#__codelineno-5-432"></a># the path.
</span><span id="__span-5-433"><a id="__codelineno-5-433" name="__codelineno-5-433" href="#__codelineno-5-433"></a>persistence_file mosquitto.db
</span><span id="__span-5-434"><a id="__codelineno-5-434" name="__codelineno-5-434" href="#__codelineno-5-434"></a>
</span><span id="__span-5-435"><a id="__codelineno-5-435" name="__codelineno-5-435" href="#__codelineno-5-435"></a># Location for persistent database.
</span><span id="__span-5-436"><a id="__codelineno-5-436" name="__codelineno-5-436" href="#__codelineno-5-436"></a># Default is an empty string (current directory).
</span><span id="__span-5-437"><a id="__codelineno-5-437" name="__codelineno-5-437" href="#__codelineno-5-437"></a># Set to e.g. /var/lib/mosquitto if running as a proper service on Linux or
</span><span id="__span-5-438"><a id="__codelineno-5-438" name="__codelineno-5-438" href="#__codelineno-5-438"></a># similar.
</span><span id="__span-5-439"><a id="__codelineno-5-439" name="__codelineno-5-439" href="#__codelineno-5-439"></a>persistence_location /var/lib/mosquitto
</span><span id="__span-5-440"><a id="__codelineno-5-440" name="__codelineno-5-440" href="#__codelineno-5-440"></a>
</span><span id="__span-5-441"><a id="__codelineno-5-441" name="__codelineno-5-441" href="#__codelineno-5-441"></a>
</span><span id="__span-5-442"><a id="__codelineno-5-442" name="__codelineno-5-442" href="#__codelineno-5-442"></a># =================================================================
</span><span id="__span-5-443"><a id="__codelineno-5-443" name="__codelineno-5-443" href="#__codelineno-5-443"></a># Logging
</span><span id="__span-5-444"><a id="__codelineno-5-444" name="__codelineno-5-444" href="#__codelineno-5-444"></a># =================================================================
</span><span id="__span-5-445"><a id="__codelineno-5-445" name="__codelineno-5-445" href="#__codelineno-5-445"></a>
</span><span id="__span-5-446"><a id="__codelineno-5-446" name="__codelineno-5-446" href="#__codelineno-5-446"></a># Places to log to. Use multiple log_dest lines for multiple
</span><span id="__span-5-447"><a id="__codelineno-5-447" name="__codelineno-5-447" href="#__codelineno-5-447"></a># logging destinations.
</span><span id="__span-5-448"><a id="__codelineno-5-448" name="__codelineno-5-448" href="#__codelineno-5-448"></a># Possible destinations are: stdout stderr syslog topic file dlt
</span><span id="__span-5-449"><a id="__codelineno-5-449" name="__codelineno-5-449" href="#__codelineno-5-449"></a>#
</span><span id="__span-5-450"><a id="__codelineno-5-450" name="__codelineno-5-450" href="#__codelineno-5-450"></a># stdout and stderr log to the console on the named output.
</span><span id="__span-5-451"><a id="__codelineno-5-451" name="__codelineno-5-451" href="#__codelineno-5-451"></a>#
</span><span id="__span-5-452"><a id="__codelineno-5-452" name="__codelineno-5-452" href="#__codelineno-5-452"></a># syslog uses the userspace syslog facility which usually ends up
</span><span id="__span-5-453"><a id="__codelineno-5-453" name="__codelineno-5-453" href="#__codelineno-5-453"></a># in /var/log/messages or similar.
</span><span id="__span-5-454"><a id="__codelineno-5-454" name="__codelineno-5-454" href="#__codelineno-5-454"></a>#
</span><span id="__span-5-455"><a id="__codelineno-5-455" name="__codelineno-5-455" href="#__codelineno-5-455"></a># topic logs to the broker topic &#39;$SYS/broker/log/&lt;severity&gt;&#39;,
</span><span id="__span-5-456"><a id="__codelineno-5-456" name="__codelineno-5-456" href="#__codelineno-5-456"></a># where severity is one of D, E, W, N, I, M which are debug, error,
</span><span id="__span-5-457"><a id="__codelineno-5-457" name="__codelineno-5-457" href="#__codelineno-5-457"></a># warning, notice, information and message. Message type severity is used by
</span><span id="__span-5-458"><a id="__codelineno-5-458" name="__codelineno-5-458" href="#__codelineno-5-458"></a># the subscribe/unsubscribe log_types and publishes log messages to
</span><span id="__span-5-459"><a id="__codelineno-5-459" name="__codelineno-5-459" href="#__codelineno-5-459"></a># $SYS/broker/log/M/susbcribe or $SYS/broker/log/M/unsubscribe.
</span><span id="__span-5-460"><a id="__codelineno-5-460" name="__codelineno-5-460" href="#__codelineno-5-460"></a>#
</span><span id="__span-5-461"><a id="__codelineno-5-461" name="__codelineno-5-461" href="#__codelineno-5-461"></a># The file destination requires an additional parameter which is the file to be
</span><span id="__span-5-462"><a id="__codelineno-5-462" name="__codelineno-5-462" href="#__codelineno-5-462"></a># logged to, e.g. &quot;log_dest file /var/log/mosquitto.log&quot;. The file will be
</span><span id="__span-5-463"><a id="__codelineno-5-463" name="__codelineno-5-463" href="#__codelineno-5-463"></a># closed and reopened when the broker receives a HUP signal. Only a single file
</span><span id="__span-5-464"><a id="__codelineno-5-464" name="__codelineno-5-464" href="#__codelineno-5-464"></a># destination may be configured.
</span><span id="__span-5-465"><a id="__codelineno-5-465" name="__codelineno-5-465" href="#__codelineno-5-465"></a>#
</span><span id="__span-5-466"><a id="__codelineno-5-466" name="__codelineno-5-466" href="#__codelineno-5-466"></a># The dlt destination is for the automotive `Diagnostic Log and Trace` tool.
</span><span id="__span-5-467"><a id="__codelineno-5-467" name="__codelineno-5-467" href="#__codelineno-5-467"></a># This requires that Mosquitto has been compiled with DLT support.
</span><span id="__span-5-468"><a id="__codelineno-5-468" name="__codelineno-5-468" href="#__codelineno-5-468"></a>#
</span><span id="__span-5-469"><a id="__codelineno-5-469" name="__codelineno-5-469" href="#__codelineno-5-469"></a># Note that if the broker is running as a Windows service it will default to
</span><span id="__span-5-470"><a id="__codelineno-5-470" name="__codelineno-5-470" href="#__codelineno-5-470"></a># &quot;log_dest none&quot; and neither stdout nor stderr logging is available.
</span><span id="__span-5-471"><a id="__codelineno-5-471" name="__codelineno-5-471" href="#__codelineno-5-471"></a># Use &quot;log_dest none&quot; if you wish to disable logging.
</span><span id="__span-5-472"><a id="__codelineno-5-472" name="__codelineno-5-472" href="#__codelineno-5-472"></a>log_dest file /var/log/mosquitto/mosquitto.log
</span><span id="__span-5-473"><a id="__codelineno-5-473" name="__codelineno-5-473" href="#__codelineno-5-473"></a>
</span><span id="__span-5-474"><a id="__codelineno-5-474" name="__codelineno-5-474" href="#__codelineno-5-474"></a># Types of messages to log. Use multiple log_type lines for logging
</span><span id="__span-5-475"><a id="__codelineno-5-475" name="__codelineno-5-475" href="#__codelineno-5-475"></a># multiple types of messages.
</span><span id="__span-5-476"><a id="__codelineno-5-476" name="__codelineno-5-476" href="#__codelineno-5-476"></a># Possible types are: debug, error, warning, notice, information,
</span><span id="__span-5-477"><a id="__codelineno-5-477" name="__codelineno-5-477" href="#__codelineno-5-477"></a># none, subscribe, unsubscribe, websockets, all.
</span><span id="__span-5-478"><a id="__codelineno-5-478" name="__codelineno-5-478" href="#__codelineno-5-478"></a># Note that debug type messages are for decoding the incoming/outgoing
</span><span id="__span-5-479"><a id="__codelineno-5-479" name="__codelineno-5-479" href="#__codelineno-5-479"></a># network packets. They are not logged in &quot;topics&quot;.
</span><span id="__span-5-480"><a id="__codelineno-5-480" name="__codelineno-5-480" href="#__codelineno-5-480"></a>#log_type error
</span><span id="__span-5-481"><a id="__codelineno-5-481" name="__codelineno-5-481" href="#__codelineno-5-481"></a>#log_type warning
</span><span id="__span-5-482"><a id="__codelineno-5-482" name="__codelineno-5-482" href="#__codelineno-5-482"></a>#log_type notice
</span><span id="__span-5-483"><a id="__codelineno-5-483" name="__codelineno-5-483" href="#__codelineno-5-483"></a>#log_type information
</span><span id="__span-5-484"><a id="__codelineno-5-484" name="__codelineno-5-484" href="#__codelineno-5-484"></a>
</span><span id="__span-5-485"><a id="__codelineno-5-485" name="__codelineno-5-485" href="#__codelineno-5-485"></a>
</span><span id="__span-5-486"><a id="__codelineno-5-486" name="__codelineno-5-486" href="#__codelineno-5-486"></a># If set to true, client connection and disconnection messages will be included
</span><span id="__span-5-487"><a id="__codelineno-5-487" name="__codelineno-5-487" href="#__codelineno-5-487"></a># in the log.
</span><span id="__span-5-488"><a id="__codelineno-5-488" name="__codelineno-5-488" href="#__codelineno-5-488"></a>#connection_messages true
</span><span id="__span-5-489"><a id="__codelineno-5-489" name="__codelineno-5-489" href="#__codelineno-5-489"></a>
</span><span id="__span-5-490"><a id="__codelineno-5-490" name="__codelineno-5-490" href="#__codelineno-5-490"></a># If using syslog logging (not on Windows), messages will be logged to the
</span><span id="__span-5-491"><a id="__codelineno-5-491" name="__codelineno-5-491" href="#__codelineno-5-491"></a># &quot;daemon&quot; facility by default. Use the log_facility option to choose which of
</span><span id="__span-5-492"><a id="__codelineno-5-492" name="__codelineno-5-492" href="#__codelineno-5-492"></a># local0 to local7 to log to instead. The option value should be an integer
</span><span id="__span-5-493"><a id="__codelineno-5-493" name="__codelineno-5-493" href="#__codelineno-5-493"></a># value, e.g. &quot;log_facility 5&quot; to use local5.
</span><span id="__span-5-494"><a id="__codelineno-5-494" name="__codelineno-5-494" href="#__codelineno-5-494"></a>#log_facility
</span><span id="__span-5-495"><a id="__codelineno-5-495" name="__codelineno-5-495" href="#__codelineno-5-495"></a>
</span><span id="__span-5-496"><a id="__codelineno-5-496" name="__codelineno-5-496" href="#__codelineno-5-496"></a># If set to true, add a timestamp value to each log message.
</span><span id="__span-5-497"><a id="__codelineno-5-497" name="__codelineno-5-497" href="#__codelineno-5-497"></a>log_timestamp true
</span><span id="__span-5-498"><a id="__codelineno-5-498" name="__codelineno-5-498" href="#__codelineno-5-498"></a>
</span><span id="__span-5-499"><a id="__codelineno-5-499" name="__codelineno-5-499" href="#__codelineno-5-499"></a># Set the format of the log timestamp. If left unset, this is the number of
</span><span id="__span-5-500"><a id="__codelineno-5-500" name="__codelineno-5-500" href="#__codelineno-5-500"></a># seconds since the Unix epoch.
</span><span id="__span-5-501"><a id="__codelineno-5-501" name="__codelineno-5-501" href="#__codelineno-5-501"></a># This is a free text string which will be passed to the strftime function. To
</span><span id="__span-5-502"><a id="__codelineno-5-502" name="__codelineno-5-502" href="#__codelineno-5-502"></a># get an ISO 8601 datetime, for example:
</span><span id="__span-5-503"><a id="__codelineno-5-503" name="__codelineno-5-503" href="#__codelineno-5-503"></a># log_timestamp_format %Y-%m-%dT%H:%M:%S
</span><span id="__span-5-504"><a id="__codelineno-5-504" name="__codelineno-5-504" href="#__codelineno-5-504"></a>log_timestamp_format %Y-%m-%dT%H:%M:%S
</span><span id="__span-5-505"><a id="__codelineno-5-505" name="__codelineno-5-505" href="#__codelineno-5-505"></a>
</span><span id="__span-5-506"><a id="__codelineno-5-506" name="__codelineno-5-506" href="#__codelineno-5-506"></a># Change the websockets logging level. This is a global option, it is not
</span><span id="__span-5-507"><a id="__codelineno-5-507" name="__codelineno-5-507" href="#__codelineno-5-507"></a># possible to set per listener. This is an integer that is interpreted by
</span><span id="__span-5-508"><a id="__codelineno-5-508" name="__codelineno-5-508" href="#__codelineno-5-508"></a># libwebsockets as a bit mask for its lws_log_levels enum. See the
</span><span id="__span-5-509"><a id="__codelineno-5-509" name="__codelineno-5-509" href="#__codelineno-5-509"></a># libwebsockets documentation for more details. &quot;log_type websockets&quot; must also
</span><span id="__span-5-510"><a id="__codelineno-5-510" name="__codelineno-5-510" href="#__codelineno-5-510"></a># be enabled.
</span><span id="__span-5-511"><a id="__codelineno-5-511" name="__codelineno-5-511" href="#__codelineno-5-511"></a>#websockets_log_level 0
</span><span id="__span-5-512"><a id="__codelineno-5-512" name="__codelineno-5-512" href="#__codelineno-5-512"></a>
</span><span id="__span-5-513"><a id="__codelineno-5-513" name="__codelineno-5-513" href="#__codelineno-5-513"></a>
</span><span id="__span-5-514"><a id="__codelineno-5-514" name="__codelineno-5-514" href="#__codelineno-5-514"></a># =================================================================
</span><span id="__span-5-515"><a id="__codelineno-5-515" name="__codelineno-5-515" href="#__codelineno-5-515"></a># Security
</span><span id="__span-5-516"><a id="__codelineno-5-516" name="__codelineno-5-516" href="#__codelineno-5-516"></a># =================================================================
</span><span id="__span-5-517"><a id="__codelineno-5-517" name="__codelineno-5-517" href="#__codelineno-5-517"></a>
</span><span id="__span-5-518"><a id="__codelineno-5-518" name="__codelineno-5-518" href="#__codelineno-5-518"></a># If set, only clients that have a matching prefix on their
</span><span id="__span-5-519"><a id="__codelineno-5-519" name="__codelineno-5-519" href="#__codelineno-5-519"></a># clientid will be allowed to connect to the broker. By default,
</span><span id="__span-5-520"><a id="__codelineno-5-520" name="__codelineno-5-520" href="#__codelineno-5-520"></a># all clients may connect.
</span><span id="__span-5-521"><a id="__codelineno-5-521" name="__codelineno-5-521" href="#__codelineno-5-521"></a># For example, setting &quot;secure-&quot; here would mean a client &quot;secure-
</span><span id="__span-5-522"><a id="__codelineno-5-522" name="__codelineno-5-522" href="#__codelineno-5-522"></a># client&quot; could connect but another with clientid &quot;mqtt&quot; couldn&#39;t.
</span><span id="__span-5-523"><a id="__codelineno-5-523" name="__codelineno-5-523" href="#__codelineno-5-523"></a>#clientid_prefixes
</span><span id="__span-5-524"><a id="__codelineno-5-524" name="__codelineno-5-524" href="#__codelineno-5-524"></a>
</span><span id="__span-5-525"><a id="__codelineno-5-525" name="__codelineno-5-525" href="#__codelineno-5-525"></a># Boolean value that determines whether clients that connect
</span><span id="__span-5-526"><a id="__codelineno-5-526" name="__codelineno-5-526" href="#__codelineno-5-526"></a># without providing a username are allowed to connect. If set to
</span><span id="__span-5-527"><a id="__codelineno-5-527" name="__codelineno-5-527" href="#__codelineno-5-527"></a># false then a password file should be created (see the
</span><span id="__span-5-528"><a id="__codelineno-5-528" name="__codelineno-5-528" href="#__codelineno-5-528"></a># password_file option) to control authenticated client access.
</span><span id="__span-5-529"><a id="__codelineno-5-529" name="__codelineno-5-529" href="#__codelineno-5-529"></a>#
</span><span id="__span-5-530"><a id="__codelineno-5-530" name="__codelineno-5-530" href="#__codelineno-5-530"></a># Defaults to false, unless there are no listeners defined in the configuration
</span><span id="__span-5-531"><a id="__codelineno-5-531" name="__codelineno-5-531" href="#__codelineno-5-531"></a># file, in which case it is set to true, but connections are only allowed from
</span><span id="__span-5-532"><a id="__codelineno-5-532" name="__codelineno-5-532" href="#__codelineno-5-532"></a># the local machine.
</span><span id="__span-5-533"><a id="__codelineno-5-533" name="__codelineno-5-533" href="#__codelineno-5-533"></a>#allow_anonymous false
</span><span id="__span-5-534"><a id="__codelineno-5-534" name="__codelineno-5-534" href="#__codelineno-5-534"></a>
</span><span id="__span-5-535"><a id="__codelineno-5-535" name="__codelineno-5-535" href="#__codelineno-5-535"></a># -----------------------------------------------------------------
</span><span id="__span-5-536"><a id="__codelineno-5-536" name="__codelineno-5-536" href="#__codelineno-5-536"></a># Default authentication and topic access control
</span><span id="__span-5-537"><a id="__codelineno-5-537" name="__codelineno-5-537" href="#__codelineno-5-537"></a># -----------------------------------------------------------------
</span><span id="__span-5-538"><a id="__codelineno-5-538" name="__codelineno-5-538" href="#__codelineno-5-538"></a>
</span><span id="__span-5-539"><a id="__codelineno-5-539" name="__codelineno-5-539" href="#__codelineno-5-539"></a># Control access to the broker using a password file. This file can be
</span><span id="__span-5-540"><a id="__codelineno-5-540" name="__codelineno-5-540" href="#__codelineno-5-540"></a># generated using the mosquitto_passwd utility. If TLS support is not compiled
</span><span id="__span-5-541"><a id="__codelineno-5-541" name="__codelineno-5-541" href="#__codelineno-5-541"></a># into mosquitto (it is recommended that TLS support should be included) then
</span><span id="__span-5-542"><a id="__codelineno-5-542" name="__codelineno-5-542" href="#__codelineno-5-542"></a># plain text passwords are used, in which case the file should be a text file
</span><span id="__span-5-543"><a id="__codelineno-5-543" name="__codelineno-5-543" href="#__codelineno-5-543"></a># with lines in the format:
</span><span id="__span-5-544"><a id="__codelineno-5-544" name="__codelineno-5-544" href="#__codelineno-5-544"></a># username:password
</span><span id="__span-5-545"><a id="__codelineno-5-545" name="__codelineno-5-545" href="#__codelineno-5-545"></a># The password (and colon) may be omitted if desired, although this
</span><span id="__span-5-546"><a id="__codelineno-5-546" name="__codelineno-5-546" href="#__codelineno-5-546"></a># offers very little in the way of security.
</span><span id="__span-5-547"><a id="__codelineno-5-547" name="__codelineno-5-547" href="#__codelineno-5-547"></a>#
</span><span id="__span-5-548"><a id="__codelineno-5-548" name="__codelineno-5-548" href="#__codelineno-5-548"></a># See the TLS client require_certificate and use_identity_as_username options
</span><span id="__span-5-549"><a id="__codelineno-5-549" name="__codelineno-5-549" href="#__codelineno-5-549"></a># for alternative authentication options. If a plugin is used as well as
</span><span id="__span-5-550"><a id="__codelineno-5-550" name="__codelineno-5-550" href="#__codelineno-5-550"></a># password_file, the plugin check will be made first.
</span><span id="__span-5-551"><a id="__codelineno-5-551" name="__codelineno-5-551" href="#__codelineno-5-551"></a>password_file /etc/mosquitto/password_file
</span><span id="__span-5-552"><a id="__codelineno-5-552" name="__codelineno-5-552" href="#__codelineno-5-552"></a>
</span><span id="__span-5-553"><a id="__codelineno-5-553" name="__codelineno-5-553" href="#__codelineno-5-553"></a># Access may also be controlled using a pre-shared-key file. This requires
</span><span id="__span-5-554"><a id="__codelineno-5-554" name="__codelineno-5-554" href="#__codelineno-5-554"></a># TLS-PSK support and a listener configured to use it. The file should be text
</span><span id="__span-5-555"><a id="__codelineno-5-555" name="__codelineno-5-555" href="#__codelineno-5-555"></a># lines in the format:
</span><span id="__span-5-556"><a id="__codelineno-5-556" name="__codelineno-5-556" href="#__codelineno-5-556"></a># identity:key
</span><span id="__span-5-557"><a id="__codelineno-5-557" name="__codelineno-5-557" href="#__codelineno-5-557"></a># The key should be in hexadecimal format without a leading &quot;0x&quot;.
</span><span id="__span-5-558"><a id="__codelineno-5-558" name="__codelineno-5-558" href="#__codelineno-5-558"></a># If an plugin is used as well, the plugin check will be made first.
</span><span id="__span-5-559"><a id="__codelineno-5-559" name="__codelineno-5-559" href="#__codelineno-5-559"></a>#psk_file
</span><span id="__span-5-560"><a id="__codelineno-5-560" name="__codelineno-5-560" href="#__codelineno-5-560"></a>
</span><span id="__span-5-561"><a id="__codelineno-5-561" name="__codelineno-5-561" href="#__codelineno-5-561"></a># Control access to topics on the broker using an access control list
</span><span id="__span-5-562"><a id="__codelineno-5-562" name="__codelineno-5-562" href="#__codelineno-5-562"></a># file. If this parameter is defined then only the topics listed will
</span><span id="__span-5-563"><a id="__codelineno-5-563" name="__codelineno-5-563" href="#__codelineno-5-563"></a># have access.
</span><span id="__span-5-564"><a id="__codelineno-5-564" name="__codelineno-5-564" href="#__codelineno-5-564"></a># If the first character of a line of the ACL file is a # it is treated as a
</span><span id="__span-5-565"><a id="__codelineno-5-565" name="__codelineno-5-565" href="#__codelineno-5-565"></a># comment.
</span><span id="__span-5-566"><a id="__codelineno-5-566" name="__codelineno-5-566" href="#__codelineno-5-566"></a># Topic access is added with lines of the format:
</span><span id="__span-5-567"><a id="__codelineno-5-567" name="__codelineno-5-567" href="#__codelineno-5-567"></a>#
</span><span id="__span-5-568"><a id="__codelineno-5-568" name="__codelineno-5-568" href="#__codelineno-5-568"></a># topic [read|write|readwrite|deny] &lt;topic&gt;
</span><span id="__span-5-569"><a id="__codelineno-5-569" name="__codelineno-5-569" href="#__codelineno-5-569"></a>#
</span><span id="__span-5-570"><a id="__codelineno-5-570" name="__codelineno-5-570" href="#__codelineno-5-570"></a># The access type is controlled using &quot;read&quot;, &quot;write&quot;, &quot;readwrite&quot; or &quot;deny&quot;.
</span><span id="__span-5-571"><a id="__codelineno-5-571" name="__codelineno-5-571" href="#__codelineno-5-571"></a># This parameter is optional (unless &lt;topic&gt; contains a space character) - if
</span><span id="__span-5-572"><a id="__codelineno-5-572" name="__codelineno-5-572" href="#__codelineno-5-572"></a># not given then the access is read/write.  &lt;topic&gt; can contain the + or #
</span><span id="__span-5-573"><a id="__codelineno-5-573" name="__codelineno-5-573" href="#__codelineno-5-573"></a># wildcards as in subscriptions.
</span><span id="__span-5-574"><a id="__codelineno-5-574" name="__codelineno-5-574" href="#__codelineno-5-574"></a>#
</span><span id="__span-5-575"><a id="__codelineno-5-575" name="__codelineno-5-575" href="#__codelineno-5-575"></a># The &quot;deny&quot; option can used to explicity deny access to a topic that would
</span><span id="__span-5-576"><a id="__codelineno-5-576" name="__codelineno-5-576" href="#__codelineno-5-576"></a># otherwise be granted by a broader read/write/readwrite statement. Any &quot;deny&quot;
</span><span id="__span-5-577"><a id="__codelineno-5-577" name="__codelineno-5-577" href="#__codelineno-5-577"></a># topics are handled before topics that grant read/write access.
</span><span id="__span-5-578"><a id="__codelineno-5-578" name="__codelineno-5-578" href="#__codelineno-5-578"></a>#
</span><span id="__span-5-579"><a id="__codelineno-5-579" name="__codelineno-5-579" href="#__codelineno-5-579"></a># The first set of topics are applied to anonymous clients, assuming
</span><span id="__span-5-580"><a id="__codelineno-5-580" name="__codelineno-5-580" href="#__codelineno-5-580"></a># allow_anonymous is true. User specific topic ACLs are added after a
</span><span id="__span-5-581"><a id="__codelineno-5-581" name="__codelineno-5-581" href="#__codelineno-5-581"></a># user line as follows:
</span><span id="__span-5-582"><a id="__codelineno-5-582" name="__codelineno-5-582" href="#__codelineno-5-582"></a>#
</span><span id="__span-5-583"><a id="__codelineno-5-583" name="__codelineno-5-583" href="#__codelineno-5-583"></a># user &lt;username&gt;
</span><span id="__span-5-584"><a id="__codelineno-5-584" name="__codelineno-5-584" href="#__codelineno-5-584"></a>#
</span><span id="__span-5-585"><a id="__codelineno-5-585" name="__codelineno-5-585" href="#__codelineno-5-585"></a># The username referred to here is the same as in password_file. It is
</span><span id="__span-5-586"><a id="__codelineno-5-586" name="__codelineno-5-586" href="#__codelineno-5-586"></a># not the clientid.
</span><span id="__span-5-587"><a id="__codelineno-5-587" name="__codelineno-5-587" href="#__codelineno-5-587"></a>#
</span><span id="__span-5-588"><a id="__codelineno-5-588" name="__codelineno-5-588" href="#__codelineno-5-588"></a>#
</span><span id="__span-5-589"><a id="__codelineno-5-589" name="__codelineno-5-589" href="#__codelineno-5-589"></a># If is also possible to define ACLs based on pattern substitution within the
</span><span id="__span-5-590"><a id="__codelineno-5-590" name="__codelineno-5-590" href="#__codelineno-5-590"></a># topic. The patterns available for substition are:
</span><span id="__span-5-591"><a id="__codelineno-5-591" name="__codelineno-5-591" href="#__codelineno-5-591"></a>#
</span><span id="__span-5-592"><a id="__codelineno-5-592" name="__codelineno-5-592" href="#__codelineno-5-592"></a># %c to match the client id of the client
</span><span id="__span-5-593"><a id="__codelineno-5-593" name="__codelineno-5-593" href="#__codelineno-5-593"></a># %u to match the username of the client
</span><span id="__span-5-594"><a id="__codelineno-5-594" name="__codelineno-5-594" href="#__codelineno-5-594"></a>#
</span><span id="__span-5-595"><a id="__codelineno-5-595" name="__codelineno-5-595" href="#__codelineno-5-595"></a># The substitution pattern must be the only text for that level of hierarchy.
</span><span id="__span-5-596"><a id="__codelineno-5-596" name="__codelineno-5-596" href="#__codelineno-5-596"></a>#
</span><span id="__span-5-597"><a id="__codelineno-5-597" name="__codelineno-5-597" href="#__codelineno-5-597"></a># The form is the same as for the topic keyword, but using pattern as the
</span><span id="__span-5-598"><a id="__codelineno-5-598" name="__codelineno-5-598" href="#__codelineno-5-598"></a># keyword.
</span><span id="__span-5-599"><a id="__codelineno-5-599" name="__codelineno-5-599" href="#__codelineno-5-599"></a># Pattern ACLs apply to all users even if the &quot;user&quot; keyword has previously
</span><span id="__span-5-600"><a id="__codelineno-5-600" name="__codelineno-5-600" href="#__codelineno-5-600"></a># been given.
</span><span id="__span-5-601"><a id="__codelineno-5-601" name="__codelineno-5-601" href="#__codelineno-5-601"></a>#
</span><span id="__span-5-602"><a id="__codelineno-5-602" name="__codelineno-5-602" href="#__codelineno-5-602"></a># If using bridges with usernames and ACLs, connection messages can be allowed
</span><span id="__span-5-603"><a id="__codelineno-5-603" name="__codelineno-5-603" href="#__codelineno-5-603"></a># with the following pattern:
</span><span id="__span-5-604"><a id="__codelineno-5-604" name="__codelineno-5-604" href="#__codelineno-5-604"></a># pattern write $SYS/broker/connection/%c/state
</span><span id="__span-5-605"><a id="__codelineno-5-605" name="__codelineno-5-605" href="#__codelineno-5-605"></a>#
</span><span id="__span-5-606"><a id="__codelineno-5-606" name="__codelineno-5-606" href="#__codelineno-5-606"></a># pattern [read|write|readwrite] &lt;topic&gt;
</span><span id="__span-5-607"><a id="__codelineno-5-607" name="__codelineno-5-607" href="#__codelineno-5-607"></a>#
</span><span id="__span-5-608"><a id="__codelineno-5-608" name="__codelineno-5-608" href="#__codelineno-5-608"></a># Example:
</span><span id="__span-5-609"><a id="__codelineno-5-609" name="__codelineno-5-609" href="#__codelineno-5-609"></a>#
</span><span id="__span-5-610"><a id="__codelineno-5-610" name="__codelineno-5-610" href="#__codelineno-5-610"></a># pattern write sensor/%u/data
</span><span id="__span-5-611"><a id="__codelineno-5-611" name="__codelineno-5-611" href="#__codelineno-5-611"></a>#
</span><span id="__span-5-612"><a id="__codelineno-5-612" name="__codelineno-5-612" href="#__codelineno-5-612"></a># If an plugin is used as well as acl_file, the plugin check will be
</span><span id="__span-5-613"><a id="__codelineno-5-613" name="__codelineno-5-613" href="#__codelineno-5-613"></a># made first.
</span><span id="__span-5-614"><a id="__codelineno-5-614" name="__codelineno-5-614" href="#__codelineno-5-614"></a>#acl_file
</span><span id="__span-5-615"><a id="__codelineno-5-615" name="__codelineno-5-615" href="#__codelineno-5-615"></a>
</span><span id="__span-5-616"><a id="__codelineno-5-616" name="__codelineno-5-616" href="#__codelineno-5-616"></a># -----------------------------------------------------------------
</span><span id="__span-5-617"><a id="__codelineno-5-617" name="__codelineno-5-617" href="#__codelineno-5-617"></a># External authentication and topic access plugin options
</span><span id="__span-5-618"><a id="__codelineno-5-618" name="__codelineno-5-618" href="#__codelineno-5-618"></a># -----------------------------------------------------------------
</span><span id="__span-5-619"><a id="__codelineno-5-619" name="__codelineno-5-619" href="#__codelineno-5-619"></a>
</span><span id="__span-5-620"><a id="__codelineno-5-620" name="__codelineno-5-620" href="#__codelineno-5-620"></a># External authentication and access control can be supported with the
</span><span id="__span-5-621"><a id="__codelineno-5-621" name="__codelineno-5-621" href="#__codelineno-5-621"></a># plugin option. This is a path to a loadable plugin. See also the
</span><span id="__span-5-622"><a id="__codelineno-5-622" name="__codelineno-5-622" href="#__codelineno-5-622"></a># plugin_opt_* options described below.
</span><span id="__span-5-623"><a id="__codelineno-5-623" name="__codelineno-5-623" href="#__codelineno-5-623"></a>#
</span><span id="__span-5-624"><a id="__codelineno-5-624" name="__codelineno-5-624" href="#__codelineno-5-624"></a># The plugin option can be specified multiple times to load multiple
</span><span id="__span-5-625"><a id="__codelineno-5-625" name="__codelineno-5-625" href="#__codelineno-5-625"></a># plugins. The plugins will be processed in the order that they are specified
</span><span id="__span-5-626"><a id="__codelineno-5-626" name="__codelineno-5-626" href="#__codelineno-5-626"></a># here. If the plugin option is specified alongside either of
</span><span id="__span-5-627"><a id="__codelineno-5-627" name="__codelineno-5-627" href="#__codelineno-5-627"></a># password_file or acl_file then the plugin checks will be made first.
</span><span id="__span-5-628"><a id="__codelineno-5-628" name="__codelineno-5-628" href="#__codelineno-5-628"></a>#
</span><span id="__span-5-629"><a id="__codelineno-5-629" name="__codelineno-5-629" href="#__codelineno-5-629"></a># If the per_listener_settings option is false, the plugin will be apply to all
</span><span id="__span-5-630"><a id="__codelineno-5-630" name="__codelineno-5-630" href="#__codelineno-5-630"></a># listeners. If per_listener_settings is true, then the plugin will apply to
</span><span id="__span-5-631"><a id="__codelineno-5-631" name="__codelineno-5-631" href="#__codelineno-5-631"></a># the current listener being defined only.
</span><span id="__span-5-632"><a id="__codelineno-5-632" name="__codelineno-5-632" href="#__codelineno-5-632"></a>#
</span><span id="__span-5-633"><a id="__codelineno-5-633" name="__codelineno-5-633" href="#__codelineno-5-633"></a># This option is also available as `auth_plugin`, but this use is deprecated
</span><span id="__span-5-634"><a id="__codelineno-5-634" name="__codelineno-5-634" href="#__codelineno-5-634"></a># and will be removed in the future.
</span><span id="__span-5-635"><a id="__codelineno-5-635" name="__codelineno-5-635" href="#__codelineno-5-635"></a>#
</span><span id="__span-5-636"><a id="__codelineno-5-636" name="__codelineno-5-636" href="#__codelineno-5-636"></a>#plugin
</span><span id="__span-5-637"><a id="__codelineno-5-637" name="__codelineno-5-637" href="#__codelineno-5-637"></a>
</span><span id="__span-5-638"><a id="__codelineno-5-638" name="__codelineno-5-638" href="#__codelineno-5-638"></a># If the plugin option above is used, define options to pass to the
</span><span id="__span-5-639"><a id="__codelineno-5-639" name="__codelineno-5-639" href="#__codelineno-5-639"></a># plugin here as described by the plugin instructions. All options named
</span><span id="__span-5-640"><a id="__codelineno-5-640" name="__codelineno-5-640" href="#__codelineno-5-640"></a># using the format plugin_opt_* will be passed to the plugin, for example:
</span><span id="__span-5-641"><a id="__codelineno-5-641" name="__codelineno-5-641" href="#__codelineno-5-641"></a>#
</span><span id="__span-5-642"><a id="__codelineno-5-642" name="__codelineno-5-642" href="#__codelineno-5-642"></a># This option is also available as `auth_opt_*`, but this use is deprecated
</span><span id="__span-5-643"><a id="__codelineno-5-643" name="__codelineno-5-643" href="#__codelineno-5-643"></a># and will be removed in the future.
</span><span id="__span-5-644"><a id="__codelineno-5-644" name="__codelineno-5-644" href="#__codelineno-5-644"></a>#
</span><span id="__span-5-645"><a id="__codelineno-5-645" name="__codelineno-5-645" href="#__codelineno-5-645"></a># plugin_opt_db_host
</span><span id="__span-5-646"><a id="__codelineno-5-646" name="__codelineno-5-646" href="#__codelineno-5-646"></a># plugin_opt_db_port
</span><span id="__span-5-647"><a id="__codelineno-5-647" name="__codelineno-5-647" href="#__codelineno-5-647"></a># plugin_opt_db_username
</span><span id="__span-5-648"><a id="__codelineno-5-648" name="__codelineno-5-648" href="#__codelineno-5-648"></a># plugin_opt_db_password
</span><span id="__span-5-649"><a id="__codelineno-5-649" name="__codelineno-5-649" href="#__codelineno-5-649"></a>
</span><span id="__span-5-650"><a id="__codelineno-5-650" name="__codelineno-5-650" href="#__codelineno-5-650"></a>
</span><span id="__span-5-651"><a id="__codelineno-5-651" name="__codelineno-5-651" href="#__codelineno-5-651"></a># =================================================================
</span><span id="__span-5-652"><a id="__codelineno-5-652" name="__codelineno-5-652" href="#__codelineno-5-652"></a># Bridges
</span><span id="__span-5-653"><a id="__codelineno-5-653" name="__codelineno-5-653" href="#__codelineno-5-653"></a># =================================================================
</span><span id="__span-5-654"><a id="__codelineno-5-654" name="__codelineno-5-654" href="#__codelineno-5-654"></a>
</span><span id="__span-5-655"><a id="__codelineno-5-655" name="__codelineno-5-655" href="#__codelineno-5-655"></a># A bridge is a way of connecting multiple MQTT brokers together.
</span><span id="__span-5-656"><a id="__codelineno-5-656" name="__codelineno-5-656" href="#__codelineno-5-656"></a># Create a new bridge using the &quot;connection&quot; option as described below. Set
</span><span id="__span-5-657"><a id="__codelineno-5-657" name="__codelineno-5-657" href="#__codelineno-5-657"></a># options for the bridges using the remaining parameters. You must specify the
</span><span id="__span-5-658"><a id="__codelineno-5-658" name="__codelineno-5-658" href="#__codelineno-5-658"></a># address and at least one topic to subscribe to.
</span><span id="__span-5-659"><a id="__codelineno-5-659" name="__codelineno-5-659" href="#__codelineno-5-659"></a>#
</span><span id="__span-5-660"><a id="__codelineno-5-660" name="__codelineno-5-660" href="#__codelineno-5-660"></a># Each connection must have a unique name.
</span><span id="__span-5-661"><a id="__codelineno-5-661" name="__codelineno-5-661" href="#__codelineno-5-661"></a>#
</span><span id="__span-5-662"><a id="__codelineno-5-662" name="__codelineno-5-662" href="#__codelineno-5-662"></a># The address line may have multiple host address and ports specified. See
</span><span id="__span-5-663"><a id="__codelineno-5-663" name="__codelineno-5-663" href="#__codelineno-5-663"></a># below in the round_robin description for more details on bridge behaviour if
</span><span id="__span-5-664"><a id="__codelineno-5-664" name="__codelineno-5-664" href="#__codelineno-5-664"></a># multiple addresses are used. Note that if you use an IPv6 address, then you
</span><span id="__span-5-665"><a id="__codelineno-5-665" name="__codelineno-5-665" href="#__codelineno-5-665"></a># are required to specify a port.
</span><span id="__span-5-666"><a id="__codelineno-5-666" name="__codelineno-5-666" href="#__codelineno-5-666"></a>#
</span><span id="__span-5-667"><a id="__codelineno-5-667" name="__codelineno-5-667" href="#__codelineno-5-667"></a># The direction that the topic will be shared can be chosen by
</span><span id="__span-5-668"><a id="__codelineno-5-668" name="__codelineno-5-668" href="#__codelineno-5-668"></a># specifying out, in or both, where the default value is out.
</span><span id="__span-5-669"><a id="__codelineno-5-669" name="__codelineno-5-669" href="#__codelineno-5-669"></a># The QoS level of the bridged communication can be specified with the next
</span><span id="__span-5-670"><a id="__codelineno-5-670" name="__codelineno-5-670" href="#__codelineno-5-670"></a># topic option. The default QoS level is 0, to change the QoS the topic
</span><span id="__span-5-671"><a id="__codelineno-5-671" name="__codelineno-5-671" href="#__codelineno-5-671"></a># direction must also be given.
</span><span id="__span-5-672"><a id="__codelineno-5-672" name="__codelineno-5-672" href="#__codelineno-5-672"></a>#
</span><span id="__span-5-673"><a id="__codelineno-5-673" name="__codelineno-5-673" href="#__codelineno-5-673"></a># The local and remote prefix options allow a topic to be remapped when it is
</span><span id="__span-5-674"><a id="__codelineno-5-674" name="__codelineno-5-674" href="#__codelineno-5-674"></a># bridged to/from the remote broker. This provides the ability to place a topic
</span><span id="__span-5-675"><a id="__codelineno-5-675" name="__codelineno-5-675" href="#__codelineno-5-675"></a># tree in an appropriate location.
</span><span id="__span-5-676"><a id="__codelineno-5-676" name="__codelineno-5-676" href="#__codelineno-5-676"></a>#
</span><span id="__span-5-677"><a id="__codelineno-5-677" name="__codelineno-5-677" href="#__codelineno-5-677"></a># For more details see the mosquitto.conf man page.
</span><span id="__span-5-678"><a id="__codelineno-5-678" name="__codelineno-5-678" href="#__codelineno-5-678"></a>#
</span><span id="__span-5-679"><a id="__codelineno-5-679" name="__codelineno-5-679" href="#__codelineno-5-679"></a># Multiple topics can be specified per connection, but be careful
</span><span id="__span-5-680"><a id="__codelineno-5-680" name="__codelineno-5-680" href="#__codelineno-5-680"></a># not to create any loops.
</span><span id="__span-5-681"><a id="__codelineno-5-681" name="__codelineno-5-681" href="#__codelineno-5-681"></a>#
</span><span id="__span-5-682"><a id="__codelineno-5-682" name="__codelineno-5-682" href="#__codelineno-5-682"></a># If you are using bridges with cleansession set to false (the default), then
</span><span id="__span-5-683"><a id="__codelineno-5-683" name="__codelineno-5-683" href="#__codelineno-5-683"></a># you may get unexpected behaviour from incoming topics if you change what
</span><span id="__span-5-684"><a id="__codelineno-5-684" name="__codelineno-5-684" href="#__codelineno-5-684"></a># topics you are subscribing to. This is because the remote broker keeps the
</span><span id="__span-5-685"><a id="__codelineno-5-685" name="__codelineno-5-685" href="#__codelineno-5-685"></a># subscription for the old topic. If you have this problem, connect your bridge
</span><span id="__span-5-686"><a id="__codelineno-5-686" name="__codelineno-5-686" href="#__codelineno-5-686"></a># with cleansession set to true, then reconnect with cleansession set to false
</span><span id="__span-5-687"><a id="__codelineno-5-687" name="__codelineno-5-687" href="#__codelineno-5-687"></a># as normal.
</span><span id="__span-5-688"><a id="__codelineno-5-688" name="__codelineno-5-688" href="#__codelineno-5-688"></a>#connection &lt;name&gt;
</span><span id="__span-5-689"><a id="__codelineno-5-689" name="__codelineno-5-689" href="#__codelineno-5-689"></a>#address &lt;host&gt;[:&lt;port&gt;] [&lt;host&gt;[:&lt;port&gt;]]
</span><span id="__span-5-690"><a id="__codelineno-5-690" name="__codelineno-5-690" href="#__codelineno-5-690"></a>#topic &lt;topic&gt; [[[out | in | both] qos-level] local-prefix remote-prefix]
</span><span id="__span-5-691"><a id="__codelineno-5-691" name="__codelineno-5-691" href="#__codelineno-5-691"></a>
</span><span id="__span-5-692"><a id="__codelineno-5-692" name="__codelineno-5-692" href="#__codelineno-5-692"></a># If you need to have the bridge connect over a particular network interface,
</span><span id="__span-5-693"><a id="__codelineno-5-693" name="__codelineno-5-693" href="#__codelineno-5-693"></a># use bridge_bind_address to tell the bridge which local IP address the socket
</span><span id="__span-5-694"><a id="__codelineno-5-694" name="__codelineno-5-694" href="#__codelineno-5-694"></a># should bind to, e.g. `bridge_bind_address 192.168.1.10`
</span><span id="__span-5-695"><a id="__codelineno-5-695" name="__codelineno-5-695" href="#__codelineno-5-695"></a>#bridge_bind_address
</span><span id="__span-5-696"><a id="__codelineno-5-696" name="__codelineno-5-696" href="#__codelineno-5-696"></a>
</span><span id="__span-5-697"><a id="__codelineno-5-697" name="__codelineno-5-697" href="#__codelineno-5-697"></a># If a bridge has topics that have &quot;out&quot; direction, the default behaviour is to
</span><span id="__span-5-698"><a id="__codelineno-5-698" name="__codelineno-5-698" href="#__codelineno-5-698"></a># send an unsubscribe request to the remote broker on that topic. This means
</span><span id="__span-5-699"><a id="__codelineno-5-699" name="__codelineno-5-699" href="#__codelineno-5-699"></a># that changing a topic direction from &quot;in&quot; to &quot;out&quot; will not keep receiving
</span><span id="__span-5-700"><a id="__codelineno-5-700" name="__codelineno-5-700" href="#__codelineno-5-700"></a># incoming messages. Sending these unsubscribe requests is not always
</span><span id="__span-5-701"><a id="__codelineno-5-701" name="__codelineno-5-701" href="#__codelineno-5-701"></a># desirable, setting bridge_attempt_unsubscribe to false will disable sending
</span><span id="__span-5-702"><a id="__codelineno-5-702" name="__codelineno-5-702" href="#__codelineno-5-702"></a># the unsubscribe request.
</span><span id="__span-5-703"><a id="__codelineno-5-703" name="__codelineno-5-703" href="#__codelineno-5-703"></a>#bridge_attempt_unsubscribe true
</span><span id="__span-5-704"><a id="__codelineno-5-704" name="__codelineno-5-704" href="#__codelineno-5-704"></a>
</span><span id="__span-5-705"><a id="__codelineno-5-705" name="__codelineno-5-705" href="#__codelineno-5-705"></a># Set the version of the MQTT protocol to use with for this bridge. Can be one
</span><span id="__span-5-706"><a id="__codelineno-5-706" name="__codelineno-5-706" href="#__codelineno-5-706"></a># of mqttv50, mqttv311 or mqttv31. Defaults to mqttv311.
</span><span id="__span-5-707"><a id="__codelineno-5-707" name="__codelineno-5-707" href="#__codelineno-5-707"></a>#bridge_protocol_version mqttv311
</span><span id="__span-5-708"><a id="__codelineno-5-708" name="__codelineno-5-708" href="#__codelineno-5-708"></a>
</span><span id="__span-5-709"><a id="__codelineno-5-709" name="__codelineno-5-709" href="#__codelineno-5-709"></a># Set the clean session variable for this bridge.
</span><span id="__span-5-710"><a id="__codelineno-5-710" name="__codelineno-5-710" href="#__codelineno-5-710"></a># When set to true, when the bridge disconnects for any reason, all
</span><span id="__span-5-711"><a id="__codelineno-5-711" name="__codelineno-5-711" href="#__codelineno-5-711"></a># messages and subscriptions will be cleaned up on the remote
</span><span id="__span-5-712"><a id="__codelineno-5-712" name="__codelineno-5-712" href="#__codelineno-5-712"></a># broker. Note that with cleansession set to true, there may be a
</span><span id="__span-5-713"><a id="__codelineno-5-713" name="__codelineno-5-713" href="#__codelineno-5-713"></a># significant amount of retained messages sent when the bridge
</span><span id="__span-5-714"><a id="__codelineno-5-714" name="__codelineno-5-714" href="#__codelineno-5-714"></a># reconnects after losing its connection.
</span><span id="__span-5-715"><a id="__codelineno-5-715" name="__codelineno-5-715" href="#__codelineno-5-715"></a># When set to false, the subscriptions and messages are kept on the
</span><span id="__span-5-716"><a id="__codelineno-5-716" name="__codelineno-5-716" href="#__codelineno-5-716"></a># remote broker, and delivered when the bridge reconnects.
</span><span id="__span-5-717"><a id="__codelineno-5-717" name="__codelineno-5-717" href="#__codelineno-5-717"></a>#cleansession false
</span><span id="__span-5-718"><a id="__codelineno-5-718" name="__codelineno-5-718" href="#__codelineno-5-718"></a>
</span><span id="__span-5-719"><a id="__codelineno-5-719" name="__codelineno-5-719" href="#__codelineno-5-719"></a># Set the amount of time a bridge using the lazy start type must be idle before
</span><span id="__span-5-720"><a id="__codelineno-5-720" name="__codelineno-5-720" href="#__codelineno-5-720"></a># it will be stopped. Defaults to 60 seconds.
</span><span id="__span-5-721"><a id="__codelineno-5-721" name="__codelineno-5-721" href="#__codelineno-5-721"></a>#idle_timeout 60
</span><span id="__span-5-722"><a id="__codelineno-5-722" name="__codelineno-5-722" href="#__codelineno-5-722"></a>
</span><span id="__span-5-723"><a id="__codelineno-5-723" name="__codelineno-5-723" href="#__codelineno-5-723"></a># Set the keepalive interval for this bridge connection, in
</span><span id="__span-5-724"><a id="__codelineno-5-724" name="__codelineno-5-724" href="#__codelineno-5-724"></a># seconds.
</span><span id="__span-5-725"><a id="__codelineno-5-725" name="__codelineno-5-725" href="#__codelineno-5-725"></a>#keepalive_interval 60
</span><span id="__span-5-726"><a id="__codelineno-5-726" name="__codelineno-5-726" href="#__codelineno-5-726"></a>
</span><span id="__span-5-727"><a id="__codelineno-5-727" name="__codelineno-5-727" href="#__codelineno-5-727"></a># Set the clientid to use on the local broker. If not defined, this defaults to
</span><span id="__span-5-728"><a id="__codelineno-5-728" name="__codelineno-5-728" href="#__codelineno-5-728"></a># &#39;local.&lt;clientid&gt;&#39;. If you are bridging a broker to itself, it is important
</span><span id="__span-5-729"><a id="__codelineno-5-729" name="__codelineno-5-729" href="#__codelineno-5-729"></a># that local_clientid and clientid do not match.
</span><span id="__span-5-730"><a id="__codelineno-5-730" name="__codelineno-5-730" href="#__codelineno-5-730"></a>#local_clientid
</span><span id="__span-5-731"><a id="__codelineno-5-731" name="__codelineno-5-731" href="#__codelineno-5-731"></a>
</span><span id="__span-5-732"><a id="__codelineno-5-732" name="__codelineno-5-732" href="#__codelineno-5-732"></a># If set to true, publish notification messages to the local and remote brokers
</span><span id="__span-5-733"><a id="__codelineno-5-733" name="__codelineno-5-733" href="#__codelineno-5-733"></a># giving information about the state of the bridge connection. Retained
</span><span id="__span-5-734"><a id="__codelineno-5-734" name="__codelineno-5-734" href="#__codelineno-5-734"></a># messages are published to the topic $SYS/broker/connection/&lt;clientid&gt;/state
</span><span id="__span-5-735"><a id="__codelineno-5-735" name="__codelineno-5-735" href="#__codelineno-5-735"></a># unless the notification_topic option is used.
</span><span id="__span-5-736"><a id="__codelineno-5-736" name="__codelineno-5-736" href="#__codelineno-5-736"></a># If the message is 1 then the connection is active, or 0 if the connection has
</span><span id="__span-5-737"><a id="__codelineno-5-737" name="__codelineno-5-737" href="#__codelineno-5-737"></a># failed.
</span><span id="__span-5-738"><a id="__codelineno-5-738" name="__codelineno-5-738" href="#__codelineno-5-738"></a># This uses the last will and testament feature.
</span><span id="__span-5-739"><a id="__codelineno-5-739" name="__codelineno-5-739" href="#__codelineno-5-739"></a>#notifications true
</span><span id="__span-5-740"><a id="__codelineno-5-740" name="__codelineno-5-740" href="#__codelineno-5-740"></a>
</span><span id="__span-5-741"><a id="__codelineno-5-741" name="__codelineno-5-741" href="#__codelineno-5-741"></a># Choose the topic on which notification messages for this bridge are
</span><span id="__span-5-742"><a id="__codelineno-5-742" name="__codelineno-5-742" href="#__codelineno-5-742"></a># published. If not set, messages are published on the topic
</span><span id="__span-5-743"><a id="__codelineno-5-743" name="__codelineno-5-743" href="#__codelineno-5-743"></a># $SYS/broker/connection/&lt;clientid&gt;/state
</span><span id="__span-5-744"><a id="__codelineno-5-744" name="__codelineno-5-744" href="#__codelineno-5-744"></a>#notification_topic
</span><span id="__span-5-745"><a id="__codelineno-5-745" name="__codelineno-5-745" href="#__codelineno-5-745"></a>
</span><span id="__span-5-746"><a id="__codelineno-5-746" name="__codelineno-5-746" href="#__codelineno-5-746"></a># Set the client id to use on the remote end of this bridge connection. If not
</span><span id="__span-5-747"><a id="__codelineno-5-747" name="__codelineno-5-747" href="#__codelineno-5-747"></a># defined, this defaults to &#39;name.hostname&#39; where name is the connection name
</span><span id="__span-5-748"><a id="__codelineno-5-748" name="__codelineno-5-748" href="#__codelineno-5-748"></a># and hostname is the hostname of this computer.
</span><span id="__span-5-749"><a id="__codelineno-5-749" name="__codelineno-5-749" href="#__codelineno-5-749"></a># This replaces the old &quot;clientid&quot; option to avoid confusion. &quot;clientid&quot;
</span><span id="__span-5-750"><a id="__codelineno-5-750" name="__codelineno-5-750" href="#__codelineno-5-750"></a># remains valid for the time being.
</span><span id="__span-5-751"><a id="__codelineno-5-751" name="__codelineno-5-751" href="#__codelineno-5-751"></a>#remote_clientid
</span><span id="__span-5-752"><a id="__codelineno-5-752" name="__codelineno-5-752" href="#__codelineno-5-752"></a>
</span><span id="__span-5-753"><a id="__codelineno-5-753" name="__codelineno-5-753" href="#__codelineno-5-753"></a># Set the password to use when connecting to a broker that requires
</span><span id="__span-5-754"><a id="__codelineno-5-754" name="__codelineno-5-754" href="#__codelineno-5-754"></a># authentication. This option is only used if remote_username is also set.
</span><span id="__span-5-755"><a id="__codelineno-5-755" name="__codelineno-5-755" href="#__codelineno-5-755"></a># This replaces the old &quot;password&quot; option to avoid confusion. &quot;password&quot;
</span><span id="__span-5-756"><a id="__codelineno-5-756" name="__codelineno-5-756" href="#__codelineno-5-756"></a># remains valid for the time being.
</span><span id="__span-5-757"><a id="__codelineno-5-757" name="__codelineno-5-757" href="#__codelineno-5-757"></a>#remote_password
</span><span id="__span-5-758"><a id="__codelineno-5-758" name="__codelineno-5-758" href="#__codelineno-5-758"></a>
</span><span id="__span-5-759"><a id="__codelineno-5-759" name="__codelineno-5-759" href="#__codelineno-5-759"></a># Set the username to use when connecting to a broker that requires
</span><span id="__span-5-760"><a id="__codelineno-5-760" name="__codelineno-5-760" href="#__codelineno-5-760"></a># authentication.
</span><span id="__span-5-761"><a id="__codelineno-5-761" name="__codelineno-5-761" href="#__codelineno-5-761"></a># This replaces the old &quot;username&quot; option to avoid confusion. &quot;username&quot;
</span><span id="__span-5-762"><a id="__codelineno-5-762" name="__codelineno-5-762" href="#__codelineno-5-762"></a># remains valid for the time being.
</span><span id="__span-5-763"><a id="__codelineno-5-763" name="__codelineno-5-763" href="#__codelineno-5-763"></a>#remote_username
</span><span id="__span-5-764"><a id="__codelineno-5-764" name="__codelineno-5-764" href="#__codelineno-5-764"></a>
</span><span id="__span-5-765"><a id="__codelineno-5-765" name="__codelineno-5-765" href="#__codelineno-5-765"></a># Set the amount of time a bridge using the automatic start type will wait
</span><span id="__span-5-766"><a id="__codelineno-5-766" name="__codelineno-5-766" href="#__codelineno-5-766"></a># until attempting to reconnect.
</span><span id="__span-5-767"><a id="__codelineno-5-767" name="__codelineno-5-767" href="#__codelineno-5-767"></a># This option can be configured to use a constant delay time in seconds, or to
</span><span id="__span-5-768"><a id="__codelineno-5-768" name="__codelineno-5-768" href="#__codelineno-5-768"></a># use a backoff mechanism based on &quot;Decorrelated Jitter&quot;, which adds a degree
</span><span id="__span-5-769"><a id="__codelineno-5-769" name="__codelineno-5-769" href="#__codelineno-5-769"></a># of randomness to when the restart occurs.
</span><span id="__span-5-770"><a id="__codelineno-5-770" name="__codelineno-5-770" href="#__codelineno-5-770"></a>#
</span><span id="__span-5-771"><a id="__codelineno-5-771" name="__codelineno-5-771" href="#__codelineno-5-771"></a># Set a constant timeout of 20 seconds:
</span><span id="__span-5-772"><a id="__codelineno-5-772" name="__codelineno-5-772" href="#__codelineno-5-772"></a># restart_timeout 20
</span><span id="__span-5-773"><a id="__codelineno-5-773" name="__codelineno-5-773" href="#__codelineno-5-773"></a>#
</span><span id="__span-5-774"><a id="__codelineno-5-774" name="__codelineno-5-774" href="#__codelineno-5-774"></a># Set backoff with a base (start value) of 10 seconds and a cap (upper limit) of
</span><span id="__span-5-775"><a id="__codelineno-5-775" name="__codelineno-5-775" href="#__codelineno-5-775"></a># 60 seconds:
</span><span id="__span-5-776"><a id="__codelineno-5-776" name="__codelineno-5-776" href="#__codelineno-5-776"></a># restart_timeout 10 30
</span><span id="__span-5-777"><a id="__codelineno-5-777" name="__codelineno-5-777" href="#__codelineno-5-777"></a>#
</span><span id="__span-5-778"><a id="__codelineno-5-778" name="__codelineno-5-778" href="#__codelineno-5-778"></a># Defaults to jitter with a base of 5 and cap of 30
</span><span id="__span-5-779"><a id="__codelineno-5-779" name="__codelineno-5-779" href="#__codelineno-5-779"></a>#restart_timeout 5 30
</span><span id="__span-5-780"><a id="__codelineno-5-780" name="__codelineno-5-780" href="#__codelineno-5-780"></a>
</span><span id="__span-5-781"><a id="__codelineno-5-781" name="__codelineno-5-781" href="#__codelineno-5-781"></a># If the bridge has more than one address given in the address/addresses
</span><span id="__span-5-782"><a id="__codelineno-5-782" name="__codelineno-5-782" href="#__codelineno-5-782"></a># configuration, the round_robin option defines the behaviour of the bridge on
</span><span id="__span-5-783"><a id="__codelineno-5-783" name="__codelineno-5-783" href="#__codelineno-5-783"></a># a failure of the bridge connection. If round_robin is false, the default
</span><span id="__span-5-784"><a id="__codelineno-5-784" name="__codelineno-5-784" href="#__codelineno-5-784"></a># value, then the first address is treated as the main bridge connection. If
</span><span id="__span-5-785"><a id="__codelineno-5-785" name="__codelineno-5-785" href="#__codelineno-5-785"></a># the connection fails, the other secondary addresses will be attempted in
</span><span id="__span-5-786"><a id="__codelineno-5-786" name="__codelineno-5-786" href="#__codelineno-5-786"></a># turn. Whilst connected to a secondary bridge, the bridge will periodically
</span><span id="__span-5-787"><a id="__codelineno-5-787" name="__codelineno-5-787" href="#__codelineno-5-787"></a># attempt to reconnect to the main bridge until successful.
</span><span id="__span-5-788"><a id="__codelineno-5-788" name="__codelineno-5-788" href="#__codelineno-5-788"></a># If round_robin is true, then all addresses are treated as equals. If a
</span><span id="__span-5-789"><a id="__codelineno-5-789" name="__codelineno-5-789" href="#__codelineno-5-789"></a># connection fails, the next address will be tried and if successful will
</span><span id="__span-5-790"><a id="__codelineno-5-790" name="__codelineno-5-790" href="#__codelineno-5-790"></a># remain connected until it fails
</span><span id="__span-5-791"><a id="__codelineno-5-791" name="__codelineno-5-791" href="#__codelineno-5-791"></a>#round_robin false
</span><span id="__span-5-792"><a id="__codelineno-5-792" name="__codelineno-5-792" href="#__codelineno-5-792"></a>
</span><span id="__span-5-793"><a id="__codelineno-5-793" name="__codelineno-5-793" href="#__codelineno-5-793"></a># Set the start type of the bridge. This controls how the bridge starts and
</span><span id="__span-5-794"><a id="__codelineno-5-794" name="__codelineno-5-794" href="#__codelineno-5-794"></a># can be one of three types: automatic, lazy and once. Note that RSMB provides
</span><span id="__span-5-795"><a id="__codelineno-5-795" name="__codelineno-5-795" href="#__codelineno-5-795"></a># a fourth start type &quot;manual&quot; which isn&#39;t currently supported by mosquitto.
</span><span id="__span-5-796"><a id="__codelineno-5-796" name="__codelineno-5-796" href="#__codelineno-5-796"></a>#
</span><span id="__span-5-797"><a id="__codelineno-5-797" name="__codelineno-5-797" href="#__codelineno-5-797"></a># &quot;automatic&quot; is the default start type and means that the bridge connection
</span><span id="__span-5-798"><a id="__codelineno-5-798" name="__codelineno-5-798" href="#__codelineno-5-798"></a># will be started automatically when the broker starts and also restarted
</span><span id="__span-5-799"><a id="__codelineno-5-799" name="__codelineno-5-799" href="#__codelineno-5-799"></a># after a short delay (30 seconds) if the connection fails.
</span><span id="__span-5-800"><a id="__codelineno-5-800" name="__codelineno-5-800" href="#__codelineno-5-800"></a>#
</span><span id="__span-5-801"><a id="__codelineno-5-801" name="__codelineno-5-801" href="#__codelineno-5-801"></a># Bridges using the &quot;lazy&quot; start type will be started automatically when the
</span><span id="__span-5-802"><a id="__codelineno-5-802" name="__codelineno-5-802" href="#__codelineno-5-802"></a># number of queued messages exceeds the number set with the &quot;threshold&quot;
</span><span id="__span-5-803"><a id="__codelineno-5-803" name="__codelineno-5-803" href="#__codelineno-5-803"></a># parameter. It will be stopped automatically after the time set by the
</span><span id="__span-5-804"><a id="__codelineno-5-804" name="__codelineno-5-804" href="#__codelineno-5-804"></a># &quot;idle_timeout&quot; parameter. Use this start type if you wish the connection to
</span><span id="__span-5-805"><a id="__codelineno-5-805" name="__codelineno-5-805" href="#__codelineno-5-805"></a># only be active when it is needed.
</span><span id="__span-5-806"><a id="__codelineno-5-806" name="__codelineno-5-806" href="#__codelineno-5-806"></a>#
</span><span id="__span-5-807"><a id="__codelineno-5-807" name="__codelineno-5-807" href="#__codelineno-5-807"></a># A bridge using the &quot;once&quot; start type will be started automatically when the
</span><span id="__span-5-808"><a id="__codelineno-5-808" name="__codelineno-5-808" href="#__codelineno-5-808"></a># broker starts but will not be restarted if the connection fails.
</span><span id="__span-5-809"><a id="__codelineno-5-809" name="__codelineno-5-809" href="#__codelineno-5-809"></a>#start_type automatic
</span><span id="__span-5-810"><a id="__codelineno-5-810" name="__codelineno-5-810" href="#__codelineno-5-810"></a>
</span><span id="__span-5-811"><a id="__codelineno-5-811" name="__codelineno-5-811" href="#__codelineno-5-811"></a># Set the number of messages that need to be queued for a bridge with lazy
</span><span id="__span-5-812"><a id="__codelineno-5-812" name="__codelineno-5-812" href="#__codelineno-5-812"></a># start type to be restarted. Defaults to 10 messages.
</span><span id="__span-5-813"><a id="__codelineno-5-813" name="__codelineno-5-813" href="#__codelineno-5-813"></a># Must be less than max_queued_messages.
</span><span id="__span-5-814"><a id="__codelineno-5-814" name="__codelineno-5-814" href="#__codelineno-5-814"></a>#threshold 10
</span><span id="__span-5-815"><a id="__codelineno-5-815" name="__codelineno-5-815" href="#__codelineno-5-815"></a>
</span><span id="__span-5-816"><a id="__codelineno-5-816" name="__codelineno-5-816" href="#__codelineno-5-816"></a># If try_private is set to true, the bridge will attempt to indicate to the
</span><span id="__span-5-817"><a id="__codelineno-5-817" name="__codelineno-5-817" href="#__codelineno-5-817"></a># remote broker that it is a bridge not an ordinary client. If successful, this
</span><span id="__span-5-818"><a id="__codelineno-5-818" name="__codelineno-5-818" href="#__codelineno-5-818"></a># means that loop detection will be more effective and that retained messages
</span><span id="__span-5-819"><a id="__codelineno-5-819" name="__codelineno-5-819" href="#__codelineno-5-819"></a># will be propagated correctly. Not all brokers support this feature so it may
</span><span id="__span-5-820"><a id="__codelineno-5-820" name="__codelineno-5-820" href="#__codelineno-5-820"></a># be necessary to set try_private to false if your bridge does not connect
</span><span id="__span-5-821"><a id="__codelineno-5-821" name="__codelineno-5-821" href="#__codelineno-5-821"></a># properly.
</span><span id="__span-5-822"><a id="__codelineno-5-822" name="__codelineno-5-822" href="#__codelineno-5-822"></a>#try_private true
</span><span id="__span-5-823"><a id="__codelineno-5-823" name="__codelineno-5-823" href="#__codelineno-5-823"></a>
</span><span id="__span-5-824"><a id="__codelineno-5-824" name="__codelineno-5-824" href="#__codelineno-5-824"></a># Some MQTT brokers do not allow retained messages. MQTT v5 gives a mechanism
</span><span id="__span-5-825"><a id="__codelineno-5-825" name="__codelineno-5-825" href="#__codelineno-5-825"></a># for brokers to tell clients that they do not support retained messages, but
</span><span id="__span-5-826"><a id="__codelineno-5-826" name="__codelineno-5-826" href="#__codelineno-5-826"></a># this is not possible for MQTT v3.1.1 or v3.1. If you need to bridge to a
</span><span id="__span-5-827"><a id="__codelineno-5-827" name="__codelineno-5-827" href="#__codelineno-5-827"></a># v3.1.1 or v3.1 broker that does not support retained messages, set the
</span><span id="__span-5-828"><a id="__codelineno-5-828" name="__codelineno-5-828" href="#__codelineno-5-828"></a># bridge_outgoing_retain option to false. This will remove the retain bit on
</span><span id="__span-5-829"><a id="__codelineno-5-829" name="__codelineno-5-829" href="#__codelineno-5-829"></a># all outgoing messages to that bridge, regardless of any other setting.
</span><span id="__span-5-830"><a id="__codelineno-5-830" name="__codelineno-5-830" href="#__codelineno-5-830"></a>#bridge_outgoing_retain true
</span><span id="__span-5-831"><a id="__codelineno-5-831" name="__codelineno-5-831" href="#__codelineno-5-831"></a>
</span><span id="__span-5-832"><a id="__codelineno-5-832" name="__codelineno-5-832" href="#__codelineno-5-832"></a># If you wish to restrict the size of messages sent to a remote bridge, use the
</span><span id="__span-5-833"><a id="__codelineno-5-833" name="__codelineno-5-833" href="#__codelineno-5-833"></a># bridge_max_packet_size option. This sets the maximum number of bytes for
</span><span id="__span-5-834"><a id="__codelineno-5-834" name="__codelineno-5-834" href="#__codelineno-5-834"></a># the total message, including headers and payload.
</span><span id="__span-5-835"><a id="__codelineno-5-835" name="__codelineno-5-835" href="#__codelineno-5-835"></a># Note that MQTT v5 brokers may provide their own maximum-packet-size property.
</span><span id="__span-5-836"><a id="__codelineno-5-836" name="__codelineno-5-836" href="#__codelineno-5-836"></a># In this case, the smaller of the two limits will be used.
</span><span id="__span-5-837"><a id="__codelineno-5-837" name="__codelineno-5-837" href="#__codelineno-5-837"></a># Set to 0 for &quot;unlimited&quot;.
</span><span id="__span-5-838"><a id="__codelineno-5-838" name="__codelineno-5-838" href="#__codelineno-5-838"></a>#bridge_max_packet_size 0
</span><span id="__span-5-839"><a id="__codelineno-5-839" name="__codelineno-5-839" href="#__codelineno-5-839"></a>
</span><span id="__span-5-840"><a id="__codelineno-5-840" name="__codelineno-5-840" href="#__codelineno-5-840"></a>
</span><span id="__span-5-841"><a id="__codelineno-5-841" name="__codelineno-5-841" href="#__codelineno-5-841"></a># -----------------------------------------------------------------
</span><span id="__span-5-842"><a id="__codelineno-5-842" name="__codelineno-5-842" href="#__codelineno-5-842"></a># Certificate based SSL/TLS support
</span><span id="__span-5-843"><a id="__codelineno-5-843" name="__codelineno-5-843" href="#__codelineno-5-843"></a># -----------------------------------------------------------------
</span><span id="__span-5-844"><a id="__codelineno-5-844" name="__codelineno-5-844" href="#__codelineno-5-844"></a># Either bridge_cafile or bridge_capath must be defined to enable TLS support
</span><span id="__span-5-845"><a id="__codelineno-5-845" name="__codelineno-5-845" href="#__codelineno-5-845"></a># for this bridge.
</span><span id="__span-5-846"><a id="__codelineno-5-846" name="__codelineno-5-846" href="#__codelineno-5-846"></a># bridge_cafile defines the path to a file containing the
</span><span id="__span-5-847"><a id="__codelineno-5-847" name="__codelineno-5-847" href="#__codelineno-5-847"></a># Certificate Authority certificates that have signed the remote broker
</span><span id="__span-5-848"><a id="__codelineno-5-848" name="__codelineno-5-848" href="#__codelineno-5-848"></a># certificate.
</span><span id="__span-5-849"><a id="__codelineno-5-849" name="__codelineno-5-849" href="#__codelineno-5-849"></a># bridge_capath defines a directory that will be searched for files containing
</span><span id="__span-5-850"><a id="__codelineno-5-850" name="__codelineno-5-850" href="#__codelineno-5-850"></a># the CA certificates. For bridge_capath to work correctly, the certificate
</span><span id="__span-5-851"><a id="__codelineno-5-851" name="__codelineno-5-851" href="#__codelineno-5-851"></a># files must have &quot;.crt&quot; as the file ending and you must run &quot;openssl rehash
</span><span id="__span-5-852"><a id="__codelineno-5-852" name="__codelineno-5-852" href="#__codelineno-5-852"></a># &lt;path to capath&gt;&quot; each time you add/remove a certificate.
</span><span id="__span-5-853"><a id="__codelineno-5-853" name="__codelineno-5-853" href="#__codelineno-5-853"></a>#bridge_cafile
</span><span id="__span-5-854"><a id="__codelineno-5-854" name="__codelineno-5-854" href="#__codelineno-5-854"></a>#bridge_capath
</span><span id="__span-5-855"><a id="__codelineno-5-855" name="__codelineno-5-855" href="#__codelineno-5-855"></a>
</span><span id="__span-5-856"><a id="__codelineno-5-856" name="__codelineno-5-856" href="#__codelineno-5-856"></a>
</span><span id="__span-5-857"><a id="__codelineno-5-857" name="__codelineno-5-857" href="#__codelineno-5-857"></a># If the remote broker has more than one protocol available on its port, e.g.
</span><span id="__span-5-858"><a id="__codelineno-5-858" name="__codelineno-5-858" href="#__codelineno-5-858"></a># MQTT and WebSockets, then use bridge_alpn to configure which protocol is
</span><span id="__span-5-859"><a id="__codelineno-5-859" name="__codelineno-5-859" href="#__codelineno-5-859"></a># requested. Note that WebSockets support for bridges is not yet available.
</span><span id="__span-5-860"><a id="__codelineno-5-860" name="__codelineno-5-860" href="#__codelineno-5-860"></a>#bridge_alpn
</span><span id="__span-5-861"><a id="__codelineno-5-861" name="__codelineno-5-861" href="#__codelineno-5-861"></a>
</span><span id="__span-5-862"><a id="__codelineno-5-862" name="__codelineno-5-862" href="#__codelineno-5-862"></a># When using certificate based encryption, bridge_insecure disables
</span><span id="__span-5-863"><a id="__codelineno-5-863" name="__codelineno-5-863" href="#__codelineno-5-863"></a># verification of the server hostname in the server certificate. This can be
</span><span id="__span-5-864"><a id="__codelineno-5-864" name="__codelineno-5-864" href="#__codelineno-5-864"></a># useful when testing initial server configurations, but makes it possible for
</span><span id="__span-5-865"><a id="__codelineno-5-865" name="__codelineno-5-865" href="#__codelineno-5-865"></a># a malicious third party to impersonate your server through DNS spoofing, for
</span><span id="__span-5-866"><a id="__codelineno-5-866" name="__codelineno-5-866" href="#__codelineno-5-866"></a># example. Use this option in testing only. If you need to resort to using this
</span><span id="__span-5-867"><a id="__codelineno-5-867" name="__codelineno-5-867" href="#__codelineno-5-867"></a># option in a production environment, your setup is at fault and there is no
</span><span id="__span-5-868"><a id="__codelineno-5-868" name="__codelineno-5-868" href="#__codelineno-5-868"></a># point using encryption.
</span><span id="__span-5-869"><a id="__codelineno-5-869" name="__codelineno-5-869" href="#__codelineno-5-869"></a>#bridge_insecure false
</span><span id="__span-5-870"><a id="__codelineno-5-870" name="__codelineno-5-870" href="#__codelineno-5-870"></a>
</span><span id="__span-5-871"><a id="__codelineno-5-871" name="__codelineno-5-871" href="#__codelineno-5-871"></a># Path to the PEM encoded client certificate, if required by the remote broker.
</span><span id="__span-5-872"><a id="__codelineno-5-872" name="__codelineno-5-872" href="#__codelineno-5-872"></a>#bridge_certfile
</span><span id="__span-5-873"><a id="__codelineno-5-873" name="__codelineno-5-873" href="#__codelineno-5-873"></a>
</span><span id="__span-5-874"><a id="__codelineno-5-874" name="__codelineno-5-874" href="#__codelineno-5-874"></a># Path to the PEM encoded client private key, if required by the remote broker.
</span><span id="__span-5-875"><a id="__codelineno-5-875" name="__codelineno-5-875" href="#__codelineno-5-875"></a>#bridge_keyfile
</span><span id="__span-5-876"><a id="__codelineno-5-876" name="__codelineno-5-876" href="#__codelineno-5-876"></a>
</span><span id="__span-5-877"><a id="__codelineno-5-877" name="__codelineno-5-877" href="#__codelineno-5-877"></a># -----------------------------------------------------------------
</span><span id="__span-5-878"><a id="__codelineno-5-878" name="__codelineno-5-878" href="#__codelineno-5-878"></a># PSK based SSL/TLS support
</span><span id="__span-5-879"><a id="__codelineno-5-879" name="__codelineno-5-879" href="#__codelineno-5-879"></a># -----------------------------------------------------------------
</span><span id="__span-5-880"><a id="__codelineno-5-880" name="__codelineno-5-880" href="#__codelineno-5-880"></a># Pre-shared-key encryption provides an alternative to certificate based
</span><span id="__span-5-881"><a id="__codelineno-5-881" name="__codelineno-5-881" href="#__codelineno-5-881"></a># encryption. A bridge can be configured to use PSK with the bridge_identity
</span><span id="__span-5-882"><a id="__codelineno-5-882" name="__codelineno-5-882" href="#__codelineno-5-882"></a># and bridge_psk options. These are the client PSK identity, and pre-shared-key
</span><span id="__span-5-883"><a id="__codelineno-5-883" name="__codelineno-5-883" href="#__codelineno-5-883"></a># in hexadecimal format with no &quot;0x&quot;. Only one of certificate and PSK based
</span><span id="__span-5-884"><a id="__codelineno-5-884" name="__codelineno-5-884" href="#__codelineno-5-884"></a># encryption can be used on one
</span><span id="__span-5-885"><a id="__codelineno-5-885" name="__codelineno-5-885" href="#__codelineno-5-885"></a># bridge at once.
</span><span id="__span-5-886"><a id="__codelineno-5-886" name="__codelineno-5-886" href="#__codelineno-5-886"></a>#bridge_identity
</span><span id="__span-5-887"><a id="__codelineno-5-887" name="__codelineno-5-887" href="#__codelineno-5-887"></a>#bridge_psk
</span><span id="__span-5-888"><a id="__codelineno-5-888" name="__codelineno-5-888" href="#__codelineno-5-888"></a>
</span><span id="__span-5-889"><a id="__codelineno-5-889" name="__codelineno-5-889" href="#__codelineno-5-889"></a>
</span><span id="__span-5-890"><a id="__codelineno-5-890" name="__codelineno-5-890" href="#__codelineno-5-890"></a># =================================================================
</span><span id="__span-5-891"><a id="__codelineno-5-891" name="__codelineno-5-891" href="#__codelineno-5-891"></a># External config files
</span><span id="__span-5-892"><a id="__codelineno-5-892" name="__codelineno-5-892" href="#__codelineno-5-892"></a># =================================================================
</span><span id="__span-5-893"><a id="__codelineno-5-893" name="__codelineno-5-893" href="#__codelineno-5-893"></a>
</span><span id="__span-5-894"><a id="__codelineno-5-894" name="__codelineno-5-894" href="#__codelineno-5-894"></a># External configuration files may be included by using the
</span><span id="__span-5-895"><a id="__codelineno-5-895" name="__codelineno-5-895" href="#__codelineno-5-895"></a># include_dir option. This defines a directory that will be searched
</span><span id="__span-5-896"><a id="__codelineno-5-896" name="__codelineno-5-896" href="#__codelineno-5-896"></a># for config files. All files that end in &#39;.conf&#39; will be loaded as
</span><span id="__span-5-897"><a id="__codelineno-5-897" name="__codelineno-5-897" href="#__codelineno-5-897"></a># a configuration file. It is best to have this as the last option
</span><span id="__span-5-898"><a id="__codelineno-5-898" name="__codelineno-5-898" href="#__codelineno-5-898"></a># in the main file. This option will only be processed from the main
</span><span id="__span-5-899"><a id="__codelineno-5-899" name="__codelineno-5-899" href="#__codelineno-5-899"></a># configuration file. The directory specified must not contain the
</span><span id="__span-5-900"><a id="__codelineno-5-900" name="__codelineno-5-900" href="#__codelineno-5-900"></a># main configuration file.
</span><span id="__span-5-901"><a id="__codelineno-5-901" name="__codelineno-5-901" href="#__codelineno-5-901"></a># Files within include_dir will be loaded sorted in case-sensitive
</span><span id="__span-5-902"><a id="__codelineno-5-902" name="__codelineno-5-902" href="#__codelineno-5-902"></a># alphabetical order, with capital letters ordered first. If this option is
</span><span id="__span-5-903"><a id="__codelineno-5-903" name="__codelineno-5-903" href="#__codelineno-5-903"></a># given multiple times, all of the files from the first instance will be
</span><span id="__span-5-904"><a id="__codelineno-5-904" name="__codelineno-5-904" href="#__codelineno-5-904"></a># processed before the next instance. See the man page for examples.
</span><span id="__span-5-905"><a id="__codelineno-5-905" name="__codelineno-5-905" href="#__codelineno-5-905"></a>#include_dir
</span></code></pre></div>
</div>
</div>
</div>
</li>
<li>
<p>修改配置目录的属组和属主</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>chown<span class="w"> </span>-R<span class="w"> </span>mosquitto:mosquitto<span class="w"> </span>/etc/mosquitto
</span></code></pre></div>
</li>
<li>
<p>设置防火墙</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>firewall-cmd<span class="w"> </span>--add-service<span class="o">={</span>mqtt,mqtt-tls<span class="o">}</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>firewall-cmd<span class="w"> </span>--add-service<span class="o">={</span>mqtt,mqtt-tls<span class="o">}</span><span class="w"> </span>--permanent
</span></code></pre></div>
</li>
<li>
<p>启动服务</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>systemctl<span class="w"> </span>start<span class="w"> </span>mosquitto
</span></code></pre></div>
</li>
<li>
<p>设置开机自启动</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>mosquitto
</span></code></pre></div>
<p>至此，MQTT server(broker)已安装完毕。</p>
</li>
</ol>
<hr />
<h2 id="_1">测试客户端是否可以连接服务端<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p>安装 MQTT 图形化客户端 MQTTX。打开<a href="https://mqttx.app/zh">官网</a>下载后，无脑下一步下一步即可。</p>
</li>
<li>
<p>新建连接</p>
<p>下图以连接 8883 端口（启用 TLS）为例，在这种方式下所有 MQTT 报文以密文形式传输。</p>
<p>如果你不想用 TLS，那么就连接 1883 端口（所有 MQTT 报文将以明文形式传输），相应的，第 3 处、第 5 处、第 8 处都需要修改。</p>
<p><img alt="1.png" src="/assets/images/install_mqtt/1.png" /></p>
</li>
<li>
<p>成功建立连接后点击新建订阅</p>
<p><img alt="2.png" src="/assets/images/install_mqtt/2.png" /></p>
</li>
<li>
<p>订阅主题设置为 hello</p>
<p><img alt="3.png" src="/assets/images/install_mqtt/3.png" /></p>
</li>
<li>
<p>发送 hello 主题的消息</p>
<p>在位置 1 处输入主题，消息内容用默认的，点击位置 2 处的发送，可以看到位置 3 处发送了消息，位置 4 处收到了消息。</p>
<p>因为此客户端订阅了 hello 主题，所以在服务端收到 hello 主题的消息后，又转给了此客户端。实际应用时不会这样设置，这里只是为了验证服务端是否可以与客户端交互。</p>
<p><img alt="4.png" src="/assets/images/install_mqtt/4.png" /></p>
</li>
</ol>







  
  



  


  



      
    </article>
  </div>

          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../../../..", "features": ["content.code.copy", "content.code.annotate", "content.tooltips", "navigation.tabs", "navigation.indexes", "navigation.top", "toc.follow"], "search": "../../../../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>