{"config":{"lang":["en"],"separator":"[\\s\\u200b\\u3000\\-\u3001\u3002\uff0c\uff0e\uff1f\uff01\uff1b]+","pipeline":["stemmer"]},"docs":[{"location":"blog/","title":"\u535a\u5ba2","text":""},{"location":"blog/2024/03/13/%E5%A5%BD%E6%83%B3%E5%85%A8%E4%B8%96%E7%95%8C%E9%83%BD%E7%9F%A5%E9%81%93%E6%88%91%E7%9C%8B%E5%AE%8C%E4%BA%86tcpip-illustrated-volume-1/","title":"\u597d\u60f3\u5168\u4e16\u754c\u90fd\u77e5\u9053\u6211\u770b\u5b8c\u4e86\u300aTCP/IP Illustrated, Volume 1\u300b","text":"<p>\u6211\u6700\u8fd1\u521a\u8bfb\u5b8c\u300aTCP/IP Illustrated, Volume 1\u300b\u8fd9\u672c\u4e66\uff0c\u5fcd\u4e0d\u4f4f\u548c\u5927\u5bb6\u5206\u4eab\u6211\u7684\u559c\u60a6\u3002</p> <p>\u6211\u5927\u5b66\u5b66\u7684\u4e13\u4e1a\u662f\u5316\u5b66\u5de5\u7a0b\uff0c\u6240\u4ee5\u5728\u5b66\u6821\u91cc\u6ca1\u6709\u5b66\u8fc7\u8ba1\u7b97\u673a\u7f51\u7edc\u3002\u6bd5\u4e1a\u540e\uff0c\u6211\u8f6c\u884c\u505a\u4e86\u7a0b\u5e8f\u5458\uff0c\u5728\u9762\u8bd5\u548c\u5de5\u4f5c\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6709\u591a\u4e2a\u524d\u8f88\u5efa\u8bae\u6211\u5b66\u4e60\u8ba1\u7b97\u673a\u7f51\u7edc\u3001\u64cd\u4f5c\u7cfb\u7edf\u3001\u7f16\u8bd1\u539f\u7406\u7b49\u8ba1\u7b97\u673a\u4e13\u4e1a\u8bfe\u7a0b\u3002\u6211\u81ea\u5df1\u53d1\u73b0\u5728\u5de5\u4f5c\u4e2d\u6d89\u53ca\u5230\u8fd9\u4e9b\u57fa\u7840\u77e5\u8bc6\u65f6\u6211\u662f\u6beb\u65e0\u5934\u7eea\u7684\uff0c\u6240\u4ee5\u6211\u4e5f\u610f\u8bc6\u5230\u5b83\u4eec\u7684\u91cd\u8981\u6027\u3002</p> <p>\u6211\u521a\u5f00\u59cb\u5b66\u4e60\u8ba1\u7b97\u673a\u7f51\u7edc\u662f\u901a\u8fc7\u5b66\u4e60\u6781\u5ba2\u65f6\u95f4\u7684\u300a\u8da3\u8c08\u7f51\u7edc\u534f\u8bae\u300b\uff0c\u8fd9\u95e8\u8bfe\u7a0b\u8ba9\u6211\u8fd9\u4e2a\u83dc\u9e1f\u5bf9\u7f51\u7edc\u6709\u4e86\u4e00\u4e2a\u521d\u6b65\u7684\u5370\u8c61\uff0c\u77e5\u9053\u4e86\u7f51\u7edc\u5206\u5c42\uff0c\u6bcf\u4e00\u5c42\u90fd\u6709\u54ea\u4e9b\u534f\u8bae\uff0c\u8fd9\u4e9b\u534f\u8bae\u662f\u4f5c\u4ec0\u4e48\u7528\u7684\u3002\u56e0\u4e3a\u8fd9\u95e8\u8bfe\u7a0b\u8bb2\u5f97\u6709\u8da3\uff0c\u6240\u4ee5\u6211\u5b66\u8d77\u6765\u5f88\u8f7b\u677e\uff0c\u5f53\u542c\u6545\u4e8b\u4e00\u6837\u3002\u6211\u89c9\u5f97\u521a\u5f00\u59cb\u5b66\u4e60\u4e00\u95e8\u8bfe\u7a0b\u65f6\uff0c\u80fd\u6709\u95e8\u50cf\u300a\u8da3\u8c08\u7f51\u7edc\u534f\u8bae\u300b\u8fd9\u6837\u7684\u8bfe\u7a0b\u662f\u5f88\u5e78\u8fd0\u7684\u3002\u5982\u679c\u4f60\u521a\u5f00\u59cb\u5b66\u8ba1\u7b97\u673a\u7f51\u7edc\u5c31\u9605\u8bfb\u4e13\u4e1a\u4e66\uff0c\u90a3\u4e48\u6ca1\u51e0\u5929\u53ef\u80fd\u5c31\u653e\u5f03\u4e86\u3002\u56e0\u4e3a\u521d\u671f\u5efa\u7acb\u5174\u8da3\u662f\u5173\u952e\u3002\u4e00\u70b9\u5174\u8da3\u90fd\u6ca1\u6709\uff0c\u4e00\u4e0a\u6765\u5c31\u662f\u4e00\u5806\u4e13\u4e1a\u540d\u8bcd\u548c\u672f\u8bed\uff0c\u52a0\u4e0a\u67af\u71e5\u7684\u8bb2\u89e3\uff0c\u6211\u80af\u5b9a\u575a\u6301\u4e0d\u4e86\u3002\u8bf4\u5230\u8fd9\uff0c\u8ba9\u6211\u56de\u5fc6\u8d77\u4e86\u5927\u5b66\u65f6\uff0c\u6709\u4e2a\u8001\u5e08\u4e00\u5b57\u4e00\u53e5\u5730\u5ff5 PPT\uff0c\u90a3\u53ef\u771f\u662f\u50ac\u7720\u3002</p> <p>\u6709\u4e86\u5174\u8da3\uff0c\u6709\u4e86\u521d\u6b65\u7684\u5370\u8c61\uff0c\u6211\u51b3\u5b9a\u9605\u8bfb\u672c\u4e13\u4e1a\u4e66\u3002\u4e8e\u662f\u6211\u5728\u7f51\u7edc\u4e0a\u641c\u4e86\u641c\uff0c\u770b\u770b\u8ba1\u7b97\u673a\u4e13\u4e1a\u7684\u5b66\u751f\u7528\u7684\u662f\u54ea\u672c\u7f51\u7edc\u6559\u6750\u3002\u300a\u8ba1\u7b97\u673a\u7f51\u7edc\u300b\u7b2c\u4e03\u7248\uff0c\u4f5c\u8005\u8c22\u5e0c\u4ec1\uff0c\u8fd9\u5c31\u662f\u6211\u51b3\u5b9a\u9605\u8bfb\u7684\u4e13\u4e1a\u4e66\u3002\u6536\u5230\u4e66\u7684\u90a3\u5929\uff0c\u6211\u5c31\u8feb\u4e0d\u53ca\u5f85\u5730\u9605\u8bfb\u3002\u9605\u8bfb\u8fd9\u672c\u4e66\u53ef\u82b1\u4e86\u6211\u4e0d\u5c11\u65f6\u95f4\uff0c\u5b83\u7684\u5185\u5bb9\u6bd4\u300a\u8da3\u8c08\u7f51\u7edc\u534f\u8bae\u300b\u591a\uff0c\u66f4\u7cfb\u7edf\u66f4\u5168\u9762\uff0c\u5b66\u8d77\u6765\u66f4\u8d39\u52b2\u3002\u56eb\u56f5\u541e\u67a3\u4e5f\u6bd4\u4e0d\u770b\u5f3a\uff0c\u6240\u4ee5\u6211\u9047\u5230\u5b9e\u5728\u770b\u4e0d\u61c2\u7684\u5c31\u8df3\u8fc7\uff0c\u4f46\u662f\u575a\u6301\u8981\u9605\u8bfb\u5b8c\u3002</p> <p>\u5b66\u5b8c\u4e86\u300a\u8da3\u8c08\u7f51\u7edc\u534f\u8bae\u300b\uff0c\u9605\u8bfb\u4e86\u300a\u8ba1\u7b97\u673a\u7f51\u7edc\u300b\uff0c\u6211\u89c9\u5f97\u6211\u5165\u95e8\u4e86\u3002\u5f53\u7136\uff0c\u80af\u5b9a\u4f1a\u6709\u90e8\u5206\u7f51\u53cb\u89c9\u5f97\u6211\u6ca1\u5165\u95e8\uff0c\u6211\u4e0d\u5728\u4e4e\u3002</p> <p>PS\uff1a\u73b0\u5728\u7684\u7f51\u7edc\u73af\u5883\u6bd4\u8d77\u6211\u4e0a\u4e2d\u5b66\u90a3\u4f1a\u513f\u5dee\u591a\u4e86\uff0c\u90a3\u65f6\u5019\u7f51\u53cb\u90fd\u4e92\u76f8\u9f13\u52b1\u6253\u6c14\uff0c\u591a\u662f\u8d5e\u7f8e\u4e4b\u8bcd\uff0c\u73b0\u5728\u7f51\u7edc\u4e0a\u5230\u5904\u90fd\u662f\u6b63\u786e\u903c\uff0c\u9119\u89c6\u6765\u9119\u89c6\u53bb\uff0c\u5f04\u5f97\u7f51\u7edc\u4e4c\u70df\u7634\u6c14\u3002</p> <p>\u81ea\u89c9\u5165\u95e8\u7684\u6211\u5728\u5de5\u4f5c\u4e2d\u9047\u5230\u7f51\u7edc\u95ee\u9898\u540e\u4e0d\u518d\u6beb\u65e0\u5934\u7eea\uff0c\u6211\u77e5\u9053\u8fd9\u4e2a\u95ee\u9898\u5c5e\u4e8e\u54ea\u4e00\u5c42\u7684\u54ea\u4e2a\u534f\u8bae\uff0c\u4f1a\u7ffb\u4e66\u5bfb\u627e\u7b54\u6848\u3002\u7406\u60f3\u60c5\u51b5\u662f\u7ffb\u4e66\u540e\u6211\u627e\u5230\u4e86\u7b54\u6848\uff0c\u53ef\u60dc\u73b0\u5b9e\u60c5\u51b5\u662f\u5927\u591a\u6570\u65f6\u5019\u6211\u7ffb\u4e66\u627e\u5230\u4e86\u63cf\u8ff0\u8be5\u534f\u8bae\u7684\u7ae0\u8282\uff0c\u5374\u627e\u4e0d\u5230\u95ee\u9898\u7684\u7b54\u6848\u3002\u522b\u6c14\u9981\uff0c\u8fd9\u5df2\u7ecf\u8fdb\u6b65\u4e86\u3002</p> <p>\u5076\u7136\u95f4\u6211\u77e5\u9053\u4e86\u7f51\u7edc\u95ee\u9898\u9700\u8981\u6293\u5305\u5206\u6790\uff0c\u6293\u5305\u53ef\u4ee5\u628a\u901a\u4fe1\u7684\u8fc7\u7a0b\u548c\u7ec6\u8282\u5448\u73b0\u51fa\u6765\u3002\u539f\u6765\u662f\u6211\u65b9\u6cd5\u4e0d\u5bf9\uff0c\u6ca1\u6709\u4f7f\u7528\u5de5\u5177\u3002\u4e8e\u662f\uff0c\u6211\u5c31\u5728\u5f02\u6b65\u793e\u533a<sup>1</sup>\u641c\u7d22 Wireshark\uff0c\u627e\u5230\u4e86\u4e24\u672c\u6797\u6c9b\u6ee1\u6240\u8457\u7684\u4e66\uff0c\u4e00\u672c\u53eb\u300aWireshark \u7f51\u7edc\u5206\u6790\u5c31\u8fd9\u4e48\u7b80\u5355\u300b\uff0c\u53e6\u4e00\u672c\u53eb\u300aWireshark \u7f51\u7edc\u5206\u6790\u7684\u827a\u672f\u300b\u3002\u6211\u5148\u540e\u8d2d\u4e70\u4e86\u8fd9\u4e24\u672c\u4e66\u7684\u7535\u5b50\u7248\u3002\u8fd9\u4e24\u672c\u4e66\u53ef\u5199\u5f97\u592a\u597d\u4e86\uff0c\u770b\u8d77\u6765\u7279\u522b\u8f7b\u677e\uff0c\u4e00\u7bc7\u63a5\u7740\u4e00\u7bc7\u5730\u770b\uff0c\u6bcf\u4e00\u7bc7\u90fd\u662f\u4e00\u4e2a\u6848\u4f8b\uff0c\u50cf\u662f\u5728\u7834\u6848\uff0c\u4ece\u6293\u5230\u7684\u7f51\u7edc\u5305\u4e2d\u62bd\u4e1d\u5265\u8327\uff0c\u627e\u5230\u201c\u771f\u51f6\u201d\u3002</p> <p>\u81ea\u4ece\u6211\u5b66\u4f1a\u4e86\u4f7f\u7528 Wireshark\uff0c\u771f\u662f\u9047\u5230\u4ec0\u4e48\u95ee\u9898\u90fd\u60f3\u6293\u4e2a\u5305\u770b\u770b\uff0c\u624b\u91cc\u6709\u9524\u5b50\u770b\u4ec0\u4e48\u90fd\u50cf\u9489\u5b50\u3002</p> <p>\u6797\u6c9b\u6ee1\u8001\u5e08\u5728\u4e66\u4e2d\u591a\u6b21\u63d0\u5230\u8fc7\u300aTCP/IP Illustrated, Volume 1\u300b\u8fd9\u672c\u4e66\uff0c\u6bd4\u5982\u4e0b\u9762\u8fd9\u6bb5\u6458\u81ea\u300aWireshark \u7f51\u7edc\u5206\u6790\u5c31\u8fd9\u4e48\u7b80\u5355\u300b\u3002</p> <p>\u4e3a\u4ec0\u4e48 Wireshark \u8981\u628a\u8fd9\u4e2a\u56fe\u79f0\u4e3a\u201cStevens\u201d\u5462\uff1f\u6211\u731c\u662f\u4e3a\u4e86\u5411\u300aTCP/IP Illustrated\u300b\u7684\u4f5c\u8005 Richard Stevens \u81f4\u656c\u3002\u8fd9\u4e5f\u662f\u6211\u975e\u5e38\u559c\u6b22\u7684\u4e00\u5957\u4e66\uff0c\u5728\u6b64\u63a8\u8350\u7ed9\u6240\u6709\u8bfb\u8005\u3002</p> <p>\u6797\u6c9b\u6ee1\u8001\u5e08\u591a\u6b21\u63a8\u8350\u7684\u4e66\uff0c\u6211\u80af\u5b9a\u60f3\u8bfb\u4e00\u8bfb\uff0c\u6211\u4e5f\u60f3\u50cf\u6797\u6c9b\u6ee1\u8001\u5e08\u4e00\u6837\u5206\u6790\u7f51\u7edc\u5305\u65f6\u4e3e\u91cd\u82e5\u8f7b\u3002\u53bb\u5e74 12 \u6708\uff0c\u6211\u627e\u4eba\u4ee3\u8d2d\u4e86\u300aTCP/IP Illustrated, Volume 1\u300b\u539f\u7248\u7b2c\u4e00\u7248\uff0c\u6211\u6536\u5230\u4e66\u662f\u4eca\u5e74 1 \u6708\u521d\u3002\u6211\u82b1\u4e86 2 \u4e2a\u591a\u6708\u7684\u65f6\u95f4\u624d\u770b\u5b8c\uff0c\u6bcf\u5929\u5dee\u4e0d\u591a\u770b 10 \u9875\uff0c\u6625\u8282\u671f\u95f4\u6ca1\u6709\u770b\uff0c\u6240\u4ee5\u803d\u8bef\u4e86 10 \u591a\u5929\u3002</p> <p>\u9605\u8bfb\u5b8c\u300aTCP/IP Illustrated, Volume 1\u300b\u80af\u5b9a\u662f\u6709\u6210\u5c31\u611f\u7684\uff0c\u6bd5\u7adf\u8fd9\u4e48\u539a\u4e00\u672c\u82f1\u8bed\u5199\u7684\u4e13\u4e1a\u7c7b\u4e66\u7c4d\u3002\u9664\u4e86\u6210\u5c31\u611f\u8fd8\u6709\u9ad8\u5174\uff0c\u6211\u53ef\u592a\u725b\u903c\u4e86\uff0c\u54c8\u54c8\u5f00\u73a9\u7b11\ud83d\ude1d\u3002\u4f5c\u8005\u529f\u529b\u6df1\u539a\uff0c\u80fd\u628a\u590d\u6742\u7684\u95ee\u9898\u7b80\u5355\u5316\uff0c\u7b80\u6d01\u3001\u903b\u8f91\u6e05\u6670\u7684\u6587\u5b57\u63cf\u8ff0\u8ba9\u6211\u8fd9\u4e2a\u82f1\u8bed\u83dc\u9e1f\u4e5f\u6709\u4e86\u82f1\u8bed\u4e0d\u96be\u7684\u9519\u89c9\u3002</p> <p>\u6700\u540e\uff0c\u5e0c\u671b\u8fd9\u7bc7\u6587\u7ae0\u80fd\u5bf9\u4f60\u6709\u6240\u5e2e\u52a9\u3002</p> <ol> <li> <p>\u4eba\u6c11\u90ae\u7535\u51fa\u7248\u793e\u7684\u4e00\u4e2a\u5b50\u54c1\u724c\uff0c\u4e13\u95e8\u51fa\u7248\u8ba1\u7b97\u673a\u7c7b\u7684\u4e66\u7c4d\u3002\u6211\u5f88\u559c\u6b22\uff0c\u56e0\u4e3a\u53ef\u4ee5\u4e70\u7535\u5b50\u7248\u3002\u00a0\u21a9</p> </li> </ol>"},{"location":"blog/2024/06/13/vmware-workstation-%E5%92%8C-vmware-fusion-%E5%AF%B9%E6%89%80%E6%9C%89%E7%94%A8%E6%88%B7%E5%AE%8C%E5%85%A8%E5%85%8D%E8%B4%B9/","title":"VMware Workstation \u548c VMware Fusion \u5bf9\u6240\u6709\u7528\u6237\u5b8c\u5168\u514d\u8d39","text":"<p>\u4ece\u4ec0\u4e48\u65f6\u5019\u5f00\u59cb\u5bf9\u4e2a\u4eba\u7528\u6237\u5b8c\u5168\u514d\u8d39</p> <p>2024 \u5e74 5 \u6708 13 \u53f7\uff0cVMware \u5b98\u65b9\u53d1\u5e03\u4e86\u4e00\u7bc7\u535a\u5ba2\uff0c\u5ba3\u5e03 VMware Workstation Pro \u548c VMware Fusion Pro \u5bf9\u4e2a\u4eba\u7528\u6237\u5b8c\u5168\u514d\u8d39\u3002</p> <p>\u4ece\u4ec0\u4e48\u65f6\u5019\u5f00\u59cb\u5bf9\u6240\u6709\u7528\u6237\u5b8c\u5168\u514d\u8d39</p> <p>2024 \u5e74 11 \u6708 11 \u53f7\uff0cVMware \u5b98\u65b9\u53d1\u5e03\u4e86\u4e00\u7bc7\u535a\u5ba2\uff0c\u5ba3\u5e03 VMware Workstation Pro \u548c VMware Fusion Pro \u5bf9\u6240\u6709\u7528\u6237\u5b8c\u5168\u514d\u8d39\u3002</p> <p>\u5177\u4f53\u5230\u7248\u672c\u7684\u8bdd\uff0cVMware Workstation Pro \u4ece 17.6.2 \u7248\u672c\u5f00\u59cb\uff0cVMware Fusion Pro \u4ece 13.6.2 \u7248\u672c\u5f00\u59cb\uff0c\u4e0d\u518d\u9700\u8981\u8bb8\u53ef\u8bc1\u5bc6\u94a5\uff0c\u6240\u6709\u7528\u6237\u53ef\u4ee5\u514d\u8d39\u4f7f\u7528\u3002</p> <p>\u4e0b\u9762\u662f\u622a\u53d6\u81ea VMware Workstation Pro 17.6.2 \u7248\u672c\u7684\u53d1\u884c\u8bf4\u660e</p> <p>Quote</p> <p>VMware Workstation Pro \u4e0d\u518d\u9700\u8981\u8bb8\u53ef\u8bc1\u5bc6\u94a5\uff0c\u73b0\u5728\u53ef\u514d\u8d39\u7528\u4e8e\u5546\u4e1a\u3001\u6559\u80b2\u548c\u4e2a\u4eba\u7528\u9014\u3002</p> <p>\u4e0b\u9762\u662f\u622a\u53d6\u81ea VMware Fusion Pro 13.6.2 \u7248\u672c\u7684\u53d1\u884c\u8bf4\u660e</p> <p>Quote</p> <p>VMware Fusion \u4e0d\u518d\u9700\u8981\u8bb8\u53ef\u8bc1\u5bc6\u94a5\uff0c\u73b0\u5728\u53ef\u514d\u8d39\u7528\u4e8e\u5546\u4e1a\u3001\u6559\u80b2\u548c\u4e2a\u4eba\u7528\u9014\u3002</p>"},{"location":"blog/2024/06/13/vmware-workstation-%E5%92%8C-vmware-fusion-%E5%AF%B9%E6%89%80%E6%9C%89%E7%94%A8%E6%88%B7%E5%AE%8C%E5%85%A8%E5%85%8D%E8%B4%B9/#_1","title":"\u5982\u4f55\u4e0b\u8f7d","text":""},{"location":"blog/2024/06/13/vmware-workstation-%E5%92%8C-vmware-fusion-%E5%AF%B9%E6%89%80%E6%9C%89%E7%94%A8%E6%88%B7%E5%AE%8C%E5%85%A8%E5%85%8D%E8%B4%B9/#_2","title":"\u65b9\u5f0f\u4e00\uff0c\u76f4\u63a5\u4e0b\u8f7d","text":"<p>\u94fe\u63a5\u5df2\u5931\u6548</p> <p>2025 \u5e74 3 \u6708 27 \u65e5\uff0c\u6211\u4f7f\u7528\u4e0b\u9762\u7684\u94fe\u63a5\u4e0b\u8f7d\u65f6\uff0c\u88ab\u91cd\u5b9a\u5411\u5230\u535a\u901a\u7684\u5b98\u7f51\uff0c\u5df2\u7ecf\u65e0\u6cd5\u76f4\u63a5\u4e0b\u8f7d\u4e86\uff0c\u592a\u6076\u5fc3\u4e86\u3002\u4e4b\u524d\u6211\u90fd\u662f\u901a\u8fc7\u4e0b\u9762\u7684\u94fe\u63a5\u4e0b\u8f7d\u7684\uff0c\u56e0\u4e3a\u8fd9\u662f\u81ea\u52a8\u66f4\u65b0\u65f6\u66b4\u9732\u51fa\u6765\u7684\u5730\u5740\uff0c\u73b0\u5728\u535a\u901a\u8fd9\u4e48\u641e\uff0c\u5c31\u662f\u4e0d\u60f3\u8ba9\u6211\u4eec\u76f4\u63a5\u4e0b\u8f7d\u4e86\uff0c\u5fc5\u987b\u6ce8\u518c\u8d26\u53f7\u624d\u80fd\u4e0b\u8f7d\u4e86\u3002</p> WindowsLinuxmacOS <pre><code>https://softwareupdate.vmware.com/cds/vmw-desktop/ws/17.6.2/24409262/windows/core/VMware-workstation-17.6.2-24409262.exe.tar\n</code></pre> <pre><code>https://softwareupdate.vmware.com/cds/vmw-desktop/ws/17.6.2/24409262/linux/core/VMware-Workstation-17.6.2-24409262.x86_64.bundle.tar\n</code></pre> <pre><code>https://softwareupdate.vmware.com/cds/vmw-desktop/fusion/13.6.2/24409261/universal/core/com.vmware.fusion.zip.tar\n</code></pre>"},{"location":"blog/2024/06/13/vmware-workstation-%E5%92%8C-vmware-fusion-%E5%AF%B9%E6%89%80%E6%9C%89%E7%94%A8%E6%88%B7%E5%AE%8C%E5%85%A8%E5%85%8D%E8%B4%B9/#_3","title":"\u65b9\u5f0f\u4e8c\uff0c\u5b98\u7f51\u6ce8\u518c\u8d26\u53f7\u4e0b\u8f7d","text":"<p>\u56e0\u4e3a 2023 \u5e74 11 \u6708 22 \u53f7 Broadcom(\u535a\u901a)\u5b8c\u6210\u4e86\u5bf9 VMware \u7684\u6536\u8d2d\uff0c\u6240\u4ee5\u73b0\u5728\u8981\u53bb\u535a\u901a\u5b98\u7f51\u6ce8\u518c\u8d26\u53f7\u624d\u80fd\u4e0b\u8f7dVMware Workstation Pro \u548c VMware Fusion Pro\u3002</p> <ol> <li> <p>\u6253\u5f00\u535a\u901a\u5b98\u7f51\u540e\u70b9\u51fb\u53f3\u4e0a\u89d2\u7684 Support Portal\uff0c\u5728\u5f39\u51fa\u7684\u5bf9\u8bdd\u6846\u4e2d\u70b9\u51fb Register \u6ce8\u518c\u8d26\u53f7\u3002\u5982\u679c\u4f60\u5df2\u7ecf\u6709\u4e86 VMware \u8d26\u53f7\uff0c\u90a3\u4e48\u53ef\u4ee5\u70b9\u51fb Forgot Username/Password?\uff0c\u901a\u8fc7\u91cd\u7f6e VMware \u8d26\u53f7\u7684\u5bc6\u7801\u7684\u65b9\u5f0f\uff0c\u7ee7\u7eed\u4f7f\u7528\u539f\u6765\u7684 VMware \u8d26\u53f7\u3002</p> <p></p> </li> <li> <p>\u6ce8\u518c\u8d26\u53f7\u767b\u5f55\u540e\uff0c\u6309\u7167\u4e0b\u56fe\u6240\u793a\u70b9\u51fb\u3002</p> <p></p> </li> <li> <p>\u5728\u641c\u7d22\u6846\u4e2d\u8f93\u5165 fusion \u6216\u8005 workstation \u5c31\u80fd\u8fc7\u6ee4\u51fa\u6211\u4eec\u8981\u4e0b\u8f7d\u7684\u8f6f\u4ef6\uff0c\u5982\u4e0b\u56fe\u6240\u793a\u3002</p> <p>Info</p> <p>VMware Fusion \u662f\u5728 macOS \u4e0a\u8fd0\u884c\u7684\uff0cVMware Workstation \u662f\u5728 Windows \u4e0a\u8fd0\u884c\u7684\uff0c\u4e0d\u8981\u641e\u9519\u4e86\u3002</p> <p></p> <p></p> <p>\u4e0b\u9762\u662f Workstation \u7684\u4f8b\u5b50\uff0c\u548c\u4e0a\u9762 Fusion \u5dee\u4e0d\u591a\u3002</p> <p></p> <p></p> </li> </ol>"},{"location":"blog/2024/06/13/vmware-workstation-%E5%92%8C-vmware-fusion-%E5%AF%B9%E6%89%80%E6%9C%89%E7%94%A8%E6%88%B7%E5%AE%8C%E5%85%A8%E5%85%8D%E8%B4%B9/#vmware-broadcom","title":"\u5df2\u6709 VMware \u8d26\u53f7\u5982\u4f55\u8f6c\u79fb\u5230 Broadcom(\u535a\u901a)","text":"<p>Quote</p> <p>\u65b9\u6cd5\u6765\u81ea\u5b98\u65b9 KB366920 \u6587\u6863 VMware migrated users account activation issues</p> <ol> <li> <p>\u6253\u5f00\u535a\u901a\u5b98\u7f51\u540e\u70b9\u51fb\u53f3\u4e0a\u89d2\u7684 Support Portal\uff0c\u5728\u5f39\u51fa\u7684\u5bf9\u8bdd\u6846\u4e2d\u70b9\u51fb Forgot Username/Password?\u3002</p> <p></p> </li> <li> <p>\u8f93\u5165\u5df2\u6709\u7684 VMware \u8d26\u53f7</p> <p></p> <p></p> </li> <li> <p>\u63a5\u7740\u4f60\u7684\u90ae\u7bb1\u4f1a\u6536\u5230\u91cd\u7f6e\u5bc6\u7801\u7684\u94fe\u63a5\uff0c\u70b9\u5f00\u94fe\u63a5\u8f93\u5165\u65b0\u7684\u5bc6\u7801\u5373\u53ef\u5b9e\u73b0 VMware \u8d26\u53f7\u8f6c\u79fb\u5230 Broadcom(\u535a\u901a)\u3002</p> </li> </ol>"},{"location":"blog/2025/03/24/%E4%B8%AA%E4%BA%BA%E7%BD%91%E7%AB%99%E6%94%B9%E9%80%A0%E4%B8%AD/","title":"\u4e2a\u4eba\u7f51\u7ad9\u6539\u9020\u4e2d","text":"<p>\u4e00\u662f\u6837\u5f0f\u98ce\u683c\u53d8\u4e86\uff0c\u4e8c\u662f\u6709\u4e9b\u6587\u7ae0\u9700\u8981\u91cd\u5199\uff0c\u6bd4\u5982\u6240\u6709\u6d89\u53ca CentOS \u7684\uff0c\u4e09\u662f\u6709\u4e9b\u9700\u8981\u5b8c\u5584\uff0c\u56db\u662f\u52a0\u4e86\u4e00\u4e2a\u65b0\u7684\u7cfb\u5217\u6587\u7ae0\u53eb\u6f2b\u6e38 MySQL \u6e90\u7801\u3002</p> <p>\u7f51\u9875\u5185\u6709\u4e9b\u94fe\u63a5\u5931\u6548\u4e86\uff0c\u6216\u8005\u8def\u5f84\u9519\u4e86\uff0c\u8bf7\u89c1\u8c05\uff0c\u6211\u6b63\u5728\u6539\uff0c\u5305\u62ec\u683c\u5f0f\u4e0a\u7684\u9519\u8bef\u3002\u56e0\u4e3a\u5927\u90e8\u5206\u7a7a\u95f2\u65f6\u95f4\u90fd\u7528\u6765\u5e26\u5b69\u5b50\u4e86\uff0c\u6240\u4ee5\u6211\u4fee\u6539\u535a\u5ba2\u7684\u901f\u5ea6\u6162\u4e86\u3002</p>"},{"location":"blog/2023/11/13/%E4%BB%8A%E5%B9%B4%E5%8F%8C%E5%8D%81%E4%B8%80%E6%88%91%E4%B9%B0%E4%BA%86%E4%B8%80%E4%B8%AA-apple-tv/","title":"\u4eca\u5e74\u53cc\u5341\u4e00\u6211\u4e70\u4e86\u4e00\u4e2a Apple TV","text":"<p>\u6b63\u5982\u6807\u9898\u6240\u8bf4\uff0c\u6211\u4e70\u4e86\u4e00\u4e2a\u82f9\u679c\u673a\u9876\u76d2\u3002\u5982\u679c\u4f60\u6709\u5982\u4e0b\u9700\u6c42\uff0c\u90a3\u4e48\u4e5f\u53ef\u4ee5\u8003\u8651\u4e70\u4e00\u4e2a\u3002</p> <ul> <li>\u89c2\u770b\u56fd\u5916\u6d41\u5a92\u4f53\uff0c\u6bd4\u5982 Netflix\u3001Hulu\u3001Disney+\u7b49\u3002</li> <li>\u60f3\u770b 4K \u675c\u6bd4\u89c6\u754c\u548c 4K HDR \u7684\u89c6\u9891\u3002</li> <li>\u5e0c\u671b\u5168\u5c4b\u7684\u8bbe\u5907\u90fd\u53ef\u4ee5\u5728\u8fde\u4e0a Wifi \u548c\u8fde\u63a5\u7f51\u7ebf\u540e\u81ea\u52a8\u83b7\u5f97\u79d1\u5b66\u4e0a\u7f51\u7684\u80fd\u529b\u3002\u53ea\u6709\u6700\u65b0\u6b3e 128G \u7248\u672c\u548c\u4e0a\u4e00\u4ee3\u7248\u672c\u652f\u6301\u3002</li> </ul>"},{"location":"blog/2023/11/13/%E4%BB%8A%E5%B9%B4%E5%8F%8C%E5%8D%81%E4%B8%80%E6%88%91%E4%B9%B0%E4%BA%86%E4%B8%80%E4%B8%AA-apple-tv/#_1","title":"\u5b9e\u62cd","text":"<p>\u673a\u9876\u76d2\u4f53\u79ef\u5f88\u5c0f\uff0c\u6211\u62ff\u5230\u540e\u653e\u5728\u624b\u638c\u4e0a\u62cd\u4e86\u4e00\u5f20\u7167\u7247\u3002  \u673a\u9876\u76d2\u4e0a\u5c31 3 \u4e2a\u63a5\u53e3\uff0c\u4ece\u5de6\u5f80\u53f3\u5206\u522b\u662f\u7535\u6e90\u3001\u7f51\u53e3\u3001HDMI\u3002\u6574\u4e2a\u673a\u8eab\u5c31\u53ea\u6709\u8fd9 3 \u4e2a\u63a5\u53e3\uff0c\u518d\u6ca1\u6709\u5176\u4ed6\u4e1c\u897f\u4e86\uff0c\u7535\u6e90\u6309\u94ae\u90fd\u6ca1\u6709\u3002\u90a3\u600e\u4e48\u5f00\u673a\uff1f\u7528\u9065\u63a7\u5668\u3002  \u4e0b\u9762\u662f\u6211\u5f53\u65f6\u62cd\u7684\u9065\u63a7\u5668\u7167\u7247\uff0c\u56e0\u4e3a\u521a\u4ece\u76d2\u5b50\u91cc\u62ff\u51fa\u6765\u8fd8\u6ca1\u6765\u5f97\u53ca\u628a\u4fdd\u62a4\u819c\u6495\u6389\u3002\u82f9\u679c\u7684\u9065\u63a7\u5668\u505a\u5f97\u8fd8\u662f\u633a\u7b80\u6d01\u7684\uff0c\u5e95\u90e8\u6709\u4e00\u4e2a USB-C \u5145\u7535\u63a5\u53e3\u3002 </p>"},{"location":"blog/2023/11/13/%E4%BB%8A%E5%B9%B4%E5%8F%8C%E5%8D%81%E4%B8%80%E6%88%91%E4%B9%B0%E4%BA%86%E4%B8%80%E4%B8%AA-apple-tv/#_2","title":"\u4f7f\u7528\u611f\u53d7","text":"<p>\u6211\u76ee\u524d\u53ea\u770b Netflix \u4e0a\u7684\u89c6\u9891\u3002\u56e0\u4e3a Netflix \u7684\u7535\u89c6\u5267\u3001\u7535\u5f71\u3001\u52a8\u6f2b\u7b49\u7247\u6e90\u5f88\u591a\uff0c\u6bd4\u56fd\u5185\u7231\u5947\u827a\u3001\u4f18\u9177\u3001\u817e\u8baf\u8981\u591a\uff0c\u5b83\u7684\u7247\u5b50\u8d28\u91cf\u9ad8\uff0c\u8fd9\u91cc\u8d28\u91cf\u662f\u6307\u6e05\u6670\u5ea6\uff0c\u5f88\u591a\u5f88\u591a\u7247\u5b50\u90fd\u662f 4K \u675c\u6bd4\u89c6\u754c\u6216\u8005 4K HDR\uff0c\u56fd\u5185\u7684\u6d41\u5a92\u4f53\u5f88\u5c11\u6709\u8fd9\u79cd\u7247\u6e90\u7684\u3002\u5982\u679c\u4f60\u5bb6\u91cc\u7684\u7535\u89c6\u673a\u652f\u6301 4K \u675c\u6bd4\u89c6\u754c\u6216\u8005 4K HDR\uff0c\u5343\u4e07\u4e0d\u8981\u6d6a\u8d39\u8fd9\u4e48\u597d\u7684\u786c\u4ef6\u3002</p> <p>Netflix \u7684\u89c6\u9891\u8be6\u60c5\u9875\u4f1a\u6709\u89c6\u9891\u8d28\u91cf\u6807\u7b7e\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u4f60\u53ef\u4ee5\u6253\u5f00https://help.netflix.com/zh-cn/node/13444\u9875\u9762\u67e5\u770b\u5b98\u65b9\u5bf9\u753b\u8d28\u7684\u8bf4\u660e\u3002 </p> <p>\u56e0\u4e3a\u89c2\u770b 4K \u89c6\u9891\u662f\u975e\u5e38\u6d88\u8017\u6d41\u91cf\u7684\uff0c\u6240\u4ee5\u673a\u573a\u7684\u6d41\u91cf\u4e00\u5b9a\u8981\u8db3\u3002\u5177\u4f53\u8981\u591a\u5c11\u6d41\u91cf\u5f97\u5b9e\u9645\u4f7f\u7528\u4e86\u624d\u80fd\u77e5\u9053\uff0c\u6bcf\u4e2a\u4eba\u7684\u60c5\u51b5\u662f\u4e0d\u4e00\u6837\u7684\uff0c\u6211\u81ea\u5df1\u5f00\u7684 400G \u6d41\u91cf\u662f\u591f\u6211\u7528\u4e86\u3002</p> <p>\u9664\u4e86\u89c2\u770b\u9ad8\u6e05\u89c6\u9891\u5916\uff0cApple TV \u6700\u8ba9\u6211\u5fc3\u52a8\u7684\u529f\u80fd\u5c31\u4f5c\u4e3a\u5bb6\u5ead\u65c1\u8def\u7f51\u5173\uff0c\u8ba9\u5bb6\u4e2d\u6240\u6709\u63a5\u5165 Wifi \u548c\u7f51\u7ebf\u7684\u8bbe\u5907\u96f6\u914d\u7f6e\u83b7\u5f97\u79d1\u5b66\u4e0a\u7f51\u7684\u80fd\u529b\u3002\u5f88\u591a\u8bbe\u5907\u4e0d\u65b9\u4fbf\u5b89\u88c5\u79d1\u5b66\u4e0a\u7f51\u7684\u8f6f\u4ef6\uff0c\u4f9d\u9760 Apple TV \u771f\u7684\u53ef\u4ee5\u7701\u5f88\u591a\u4e8b\u3002\u4e0d\u7136\u4f60\u5c31\u5f97\u4e70\u8f6f\u8def\u7531\uff0c\u90a3\u79cd\u4e1c\u897f\u90fd\u662f\u7ed9\u7231\u6298\u817e\u7684\u4eba\u51c6\u5907\u7684\uff0c\u6211\u4e00\u70b9\u5174\u8da3\u90fd\u6ca1\u6709\uff0c\u5012\u4e0d\u662f\u6211\u4e0d\u7231\u6298\u817e\uff0c\u5355\u7eaf\u4e0d\u60f3\u5728\u8fd9\u4ef6\u4e8b\u4e0a\u6298\u817e\u3002</p>"},{"location":"blog/2023/11/13/%E4%BB%8A%E5%B9%B4%E5%8F%8C%E5%8D%81%E4%B8%80%E6%88%91%E4%B9%B0%E4%BA%86%E4%B8%80%E4%B8%AA-apple-tv/#_3","title":"\u8981\u8d2d\u4e70\u7684\u4e1c\u897f","text":"<ol> <li>8 \u5b57\u7535\u6e90\u7ebf\u3002\u56e0\u4e3a\u6211\u4e70\u7684\u662f\u6e2f\u7248\u7684\uff0c\u6240\u4ee5\u81ea\u5e26\u7684\u7535\u6e90\u7ebf\u7528\u4e0d\u4e86\u3002\u6211\u5728\u72d7\u4e1c\u4e0a\u82b1\u4e86 12 \u5757\u94b1\u4e70\u4e86\u4e00\u6839\u56fd\u6807 8 \u5b57\u7535\u6e90\u7ebf\u3002</li> <li>HDMI 2.1 \u7ebf\u3002\u6211\u4e70\u4e86\u4e00\u6839 2 \u7c73\u957f\u7684 HDMI 2.1 \u7248\u672c\u7684\u7ebf\uff0c\u82b1\u4e86 20 \u591a\u5757\u94b1\u3002</li> <li>Stash\u30024 \u7f8e\u5143\u3002\u4f7f\u7528\u7f8e\u56fd\u82f9\u679c ID \u8d26\u53f7\u767b\u5f55\u5e94\u7528\u5546\u5e97\u8d2d\u4e70\u3002</li> <li>\u673a\u573a\u3002</li> </ol>"},{"location":"blog/2023/11/13/%E4%BB%8A%E5%B9%B4%E5%8F%8C%E5%8D%81%E4%B8%80%E6%88%91%E4%B9%B0%E4%BA%86%E4%B8%80%E4%B8%AA-apple-tv/#_4","title":"\u914d\u7f6e","text":"<ol> <li>Apple TV \u7684\u7f51\u7edc\u914d\u7f6e\u3002\u4fee\u6539\u6210\u624b\u52a8\u83b7\u53d6 IP \u5730\u5740\uff0c\u8fd9\u662f\u4e3a\u4e86\u628a Apple TV \u7684 IP \u5730\u5740\u56fa\u5b9a\u4e0b\u6765\u3002\u5176\u4ed6\u914d\u7f6e\u4fdd\u6301\u4e0d\u53d8\u3002</li> <li>\u8def\u7531\u5668\u914d\u7f6e\u3002\u4fee\u6539 DHCP \u670d\u52a1\u7684\u7f51\u5173\u5730\u5740\uff0c\u6539\u6210 Apple TV \u7684 IP \u5730\u5740\u3002DHCP \u670d\u52a1\u91cc\u7684 DNS \u670d\u52a1\u5668\u5206\u522b\u6539\u6210\u963f\u91cc\u7684 223.5.5.5 \u548c Cloudflare \u7684 1.1.1.1\uff0c\u6216\u8005\u6539\u6210 Apple TV \u7684 IP \u5730\u5740\u3002 <p>DHCP \u4e0d\u662f\u7acb\u523b\u751f\u6548\u7684\uff0c\u5982\u679c\u4f60\u5e0c\u671b\u7acb\u5373\u751f\u6548\uff0c\u90a3\u4e48\u53ef\u4ee5\u91cd\u542f\u8def\u7531\u5668\u3002</p> </li> </ol>"},{"location":"blog/2024/01/15/%E4%BB%8A%E5%B9%B4%E9%BB%91%E4%BA%94%E6%88%91%E8%B4%AD%E4%B9%B0%E4%BA%86-vmware-workstation-17-pro/","title":"\u4eca\u5e74\u9ed1\u4e94\uff0c\u6211\u8d2d\u4e70\u4e86 VMware Workstation 17 Pro","text":"<p>\u91cd\u78c5\u6d88\u606f</p> <p>2024 \u5e74 11 \u6708 11 \u53f7\u8d77\uff0cVMware Workstation Pro \u548c VMware Fusion Pro \u5bf9\u6240\u6709\u7528\u6237\u5b8c\u5168\u514d\u8d39\uff0c\u60f3\u4e86\u89e3\u5982\u4f55\u4e0b\u8f7d\u53ef\u4ee5\u67e5\u770b\u6211\u7684\u53e6\u4e00\u7bc7blog</p> <p>\u6bcf\u5e74\u7684\u9ed1\u8272\u661f\u671f\u4e94\u90fd\u662f\u8d2d\u4e70 VMware Workstation \u548c VMware Fusion \u7684\u597d\u65f6\u673a\u3002\u6211\u5728\u7b49\u5f85\u4e86\u5927\u534a\u5e74\u65f6\u95f4\u540e\uff0c\u5728\u4eca\u5e74\uff08\u519c\u5386\uff09\u7684\u9ed1\u4e94\u8d2d\u4e70\u4e86 VMware Workstation 17 Pro\u3002</p> <p>\u5728\u8fd9\u7bc7\u6587\u7ae0\u91cc\uff0c\u6211\u4f1a\u548c\u5927\u5bb6\u5206\u4eab\u5982\u4f55\u8d2d\u4e70 VMware Workstation \u548c VMware Fusion\u3001\u4ec0\u4e48\u65f6\u5019\u4e70\u66f4\u4f18\u60e0\u4ee5\u53ca\u5982\u4f55\u7533\u8bf7\u514d\u8d39\u7684 VMware Fusion Player\u3002</p>"},{"location":"blog/2024/01/15/%E4%BB%8A%E5%B9%B4%E9%BB%91%E4%BA%94%E6%88%91%E8%B4%AD%E4%B9%B0%E4%BA%86-vmware-workstation-17-pro/#vmware-workstation-vmware-fusion","title":"VMware Workstation \u548c VMware Fusion \u7684\u533a\u522b","text":"<p>\u9996\u5148\uff0c\u4f60\u9700\u8981\u77e5\u9053 Workstation \u548c Fusion \u7684\u533a\u522b\u3002Workstation \u8fd0\u884c\u4e8e Windows \u548c Linux \u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0cFusion \u8fd0\u884c\u4e8e macOS \u64cd\u4f5c\u7cfb\u7edf\u4e2d\u3002\u8bf7\u6839\u636e\u4f60\u81ea\u5df1\u7684\u64cd\u4f5c\u7cfb\u7edf\u9009\u62e9\u8d2d\u4e70\u7684\u8f6f\u4ef6\uff0c\u5343\u4e07\u4e0d\u8981\u4e70\u9519\u4e86\u3002</p>"},{"location":"blog/2024/01/15/%E4%BB%8A%E5%B9%B4%E9%BB%91%E4%BA%94%E6%88%91%E8%B4%AD%E4%B9%B0%E4%BA%86-vmware-workstation-17-pro/#player-pro","title":"Player \u548c Pro \u7684\u533a\u522b","text":"<p>\u8fd9\u548c\u6211\u4eec\u4e70\u624b\u673a\u5dee\u4e0d\u591a\uff0c\u5c31\u662f Pro \u7248\u672c\u529f\u80fd\u66f4\u591a\uff0c\u5176\u5b9e\u4e5f\u6ca1\u591a\u51e0\u4e2a\u3002\u4f60\u53ef\u4ee5\u770b\u770b\u5b98\u7f51Fusion Player \u548c Pro \u7684\u6bd4\u8f83\u3001Workstation Player \u548c Pro \u7684\u6bd4\u8f83\uff0c\u6839\u636e\u81ea\u5df1\u7684\u9700\u6c42\u518d\u505a\u51b3\u5b9a\u3002</p>"},{"location":"blog/2024/01/15/%E4%BB%8A%E5%B9%B4%E9%BB%91%E4%BA%94%E6%88%91%E8%B4%AD%E4%B9%B0%E4%BA%86-vmware-workstation-17-pro/#vmware-workstation-pro-vmware-fusion-pro","title":"\u5982\u4f55\u8d2d\u4e70 VMware Workstation Pro \u548c VMware Fusion Pro","text":"<p>\u76f4\u63a5\u5728\u5b98\u65b9\u5546\u5e97https://store-us.vmware.com/\u8d2d\u4e70\u3002</p> <p>\u5f53\u7136\uff0c\u7b2c\u4e00\u6b65\u80af\u5b9a\u662f\u6ce8\u518c\u8d26\u53f7\uff0c\u7136\u540e\u9009\u62e9\u8981\u8d2d\u4e70\u7684\u8f6f\u4ef6\uff0c\u6700\u540e\u652f\u4ed8\u5373\u53ef\u3002\u8fd9\u91cc\u8981\u6ce8\u610f\u7684\u662f\u652f\u4ed8\u65b9\u5f0f\uff0c\u8981\u4f7f\u7528 VISA \u6216\u8005 MasterCard \u8fd9\u79cd\u652f\u6301\u5916\u5e01\u7684\u4fe1\u7528\u5361\u3002</p> <p>\u4ef7\u683c\u5982\u4e0b\u8868\u6240\u793a\uff1a</p> Player Pro Workstation $149 $199 Fusion $149 $199"},{"location":"blog/2024/01/15/%E4%BB%8A%E5%B9%B4%E9%BB%91%E4%BA%94%E6%88%91%E8%B4%AD%E4%B9%B0%E4%BA%86-vmware-workstation-17-pro/#_1","title":"\u4ec0\u4e48\u65f6\u5019\u4e70\u66f4\u4f18\u60e0","text":"<p>\u770b\u5b8c\u4e0a\u9762\u7684\u4ef7\u683c\u8868\uff0c\u4f60\u662f\u4e0d\u662f\u89c9\u5f97\u633a\u8d35\u7684\u3002\u53cd\u6b63\u6211\u662f\u89c9\u5f97\u5f88\u8d35\uff0c\u6240\u4ee5\u6211\u89c2\u671b\u4e86\u51e0\u4e4e\u4e00\u5e74\u65f6\u95f4\uff0c\u53d1\u73b0\u9664\u4e86\u9ed1\u8272\u661f\u671f\u4e94\u6709\u6298\u6263\uff0c\u5176\u4ed6\u65f6\u95f4\u5c31\u6ca1\u6709\u6298\u6263\u3002</p>"},{"location":"blog/2024/01/15/%E4%BB%8A%E5%B9%B4%E9%BB%91%E4%BA%94%E6%88%91%E8%B4%AD%E4%B9%B0%E4%BA%86-vmware-workstation-17-pro/#_2","title":"\u9ed1\u4e94\u6298\u6263","text":"<p>\u9ed1\u4e94\u6298\u6263\u4f1a\u6301\u7eed 1 \u5468\u65f6\u95f4\uff0c\u53ef\u80fd\u66f4\u957f\uff0c\u4e0d\u8fc7\u6211\u53ea\u5173\u6ce8\u4e86\u4e00\u5468\uff0c\u4e0b\u5355\u540e\u5c31\u6ca1\u518d\u5173\u6ce8\u3002\u9ed1\u4e94\u671f\u95f4\uff0cPro \u7248\u672c\u7684\u4ef7\u683c\u662f $139.30\uff0c\u76f8\u5f53\u4e8e 7 \u6298\u4f18\u60e0\u3002</p>"},{"location":"blog/2024/01/15/%E4%BB%8A%E5%B9%B4%E9%BB%91%E4%BA%94%E6%88%91%E8%B4%AD%E4%B9%B0%E4%BA%86-vmware-workstation-17-pro/#_3","title":"\u8df3\u9635\u8425\u6298\u6263","text":"<p>\u6211\u60f3\u4e0d\u51fa\u4e00\u4e2a\u5408\u9002\u7684\u8bcd\u6765\u5f62\u5bb9\u8fd9\u79cd\u4f18\u60e0\uff0c\u5c31\u53eb\u201c\u8df3\u9635\u8425\u6298\u6263\u201d\u5427\u3002 \u4e0a\u9762\u8fd9\u5f20\u56fe\u7247\u5c31\u662f\u8bf4\uff0c\u5982\u679c\u4f60\u66fe\u7ecf\u8d2d\u4e70\u8fc7 Parallels \u8f6f\u4ef6\uff0c\u90a3\u4e48\u53ef\u4ee5\u4ee5 6 \u6298\u7684\u4ef7\u683c\u8d2d\u4e70 VMware Fusion Player \u6216 Pro\u3002Parallels \u662f\u8fd0\u884c\u5728 macOS \u64cd\u4f5c\u7cfb\u7edf\u4e0a\u7684\u53e6\u4e00\u6b3e\u77e5\u540d\u865a\u62df\u673a\u8f6f\u4ef6\uff0c\u4e5f\u5c31\u662f VMware \u7684\u7ade\u4e89\u5bf9\u624b\u3002\u6240\u4ee5\u5982\u679c\u4f60\u613f\u610f\u8f6c\u6362\u9635\u8425\uff0c\u4ece Parallels \u9635\u8425\u8f6c\u5230 VMware \u9635\u8425\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u4eab\u53d7 6 \u6298\u8d2d\u4e70\u7684\u4f18\u60e0\u3002\u662f\u4e0d\u662f\u89c9\u5f97\u633a\u597d\u73a9\u7684\u3002</p> <p>\u94fe\u63a5\u5728\u8fd9\u91ccUpgrade from Parallels and save on VMware Fusion\uff0c\u6253\u5f00\u540e\u8f93\u5165\u4f60\u8d2d\u4e70\u7684 Parallels \u5e8f\u5217\u53f7\u9a8c\u8bc1\u901a\u8fc7\u5c31\u53ef\u4ee5 6 \u6298\u8d2d\u4e70 VMware Fusion \u7cfb\u5217\u3002\u8fd9\u4e2a\u6298\u6263\u662f\u5b98\u65b9\u7ed9\u51fa\u7684\uff0c\u6240\u4ee5\u4f60\u4e0d\u7528\u62c5\u5fc3\u6cc4\u6f0f\u5e8f\u5217\u53f7\u7684\u95ee\u9898\u3002\u6211\u6b63\u5de7\u5728 2021 \u5e74\u8d2d\u4e70\u8fc7 Parallels 16\uff0c\u6240\u4ee5\u5c31\u8bd5\u4e86\u8bd5\u8df3\u9635\u8425\u6298\u6263\uff0c\u786e\u5b9e\u662f\u53ef\u4ee5\u4f7f\u7528\u7684\u3002</p> <p>\u4e0b\u9762\u662f\u6211\u7684\u8d2d\u4e70\u8bb0\u5f55\u622a\u56fe\uff1a  \u7b2c\u4e8c\u6761\u8ba2\u5355\u5c31\u662f\u6211 23 \u5e74 6 \u6708\u4f7f\u7528\u8df3\u9635\u8425\u6298\u6263\u4ee5 6 \u6298\u7684\u4ef7\u683c\u8d2d\u4e70\u4e86 VMware Fusion Pro\u3002\u7b2c\u4e00\u6761\u8ba2\u5355\u662f\u4f7f\u7528\u9ed1\u4e94\u6298\u6263\u4ee5 7 \u6298\u7684\u4ef7\u683c\u8d2d\u4e70\u4e86 VMware Workstation Pro\u3002</p>"},{"location":"blog/2024/01/15/%E4%BB%8A%E5%B9%B4%E9%BB%91%E4%BA%94%E6%88%91%E8%B4%AD%E4%B9%B0%E4%BA%86-vmware-workstation-17-pro/#vmware-fusion-player","title":"\u5982\u4f55\u7533\u8bf7\u514d\u8d39\u7684 VMware Fusion Player","text":"<p>\u5982\u679c\u4f60\u4e00\u5206\u94b1\u4e5f\u4e0d\u60f3\u82b1\uff0c\u4f46\u662f\u5e0c\u671b\u4f53\u9762\u5730\u4f7f\u7528\u6b63\u7248 VMware Fusion Player\uff0c\u90a3\u4e48\u5b98\u65b9\u662f\u6709\u63d0\u4f9b\u7533\u8bf7\u9014\u5f84\u7684\uff0c\u800c\u4e14\u6211\u8bd5\u8fc7\u3002\u5728\u6211\u6ca1\u6709\u8d2d\u4e70\u4e4b\u524d\uff0c\u4e00\u76f4\u5728 macOS \u4e0a\u8fd0\u884c\u7684\u662f\u7533\u8bf7\u7684\u514d\u8d39\u7248 VMware Fusion Player\u3002 \u7533\u8bf7\u65b9\u6cd5\uff1a</p> <ol> <li>\u6253\u5f00\u7533\u8bf7\u94fe\u63a5VMware Fusion Player \u2013 Personal Use License</li> <li>\u6ce8\u518c VMware \u8d26\u53f7</li> <li>\u586b\u4e2a\u4eba\u4fe1\u606f</li> <li>\u6210\u529f\u540e\u4f1a\u6709\u90ae\u4ef6\u53d1\u9001\u5230\u4f60\u7684\u90ae\u7bb1\uff0c\u91cc\u9762\u6709\u5e8f\u5217\u53f7</li> </ol> <p>\u7533\u8bf7\u975e\u5e38\u7b80\u5355\uff0c10 \u5206\u949f\u5c31\u641e\u5b9a\u4e86\u3002\u8981\u6ce8\u610f\u7684\u662f\u8fd9\u4e2a\u514d\u8d39\u7248\u662f\u4e2a\u4eba\u4f7f\u7528\u6388\u6743\uff0c\u4e0d\u53ef\u4ee5\u5728\u516c\u53f8\u4f7f\u7528\uff0c\u4e0d\u53ef\u4ee5\u7528\u4e8e\u5546\u4e1a\u7528\u9014\uff0c\u8be6\u7ec6\u4fe1\u606f\u53ef\u4ee5\u5728\u7533\u8bf7\u9875\u9762\u627e\u5230\u3002</p>"},{"location":"blog/2024/12/07/%E4%BD%BF%E7%94%A8-ansible-%E4%B8%80%E9%94%AE%E5%AE%89%E8%A3%85-freeiparocky-linux-9/","title":"\u4f7f\u7528 Ansible \u4e00\u952e\u5b89\u88c5 FreeIPA(Rocky Linux 9)","text":"<p>\u5b89\u88c5\u76ee\u6807</p> <ul> <li> \u5b89\u88c5\u4e00\u4e2a FreeIPA \u670d\u52a1\u7aef\u5b9e\u4f8b\uff0c\u8be5\u5b9e\u4f8b\u6240\u5728\u4e3b\u673a IP \u5730\u5740\u4e3a 192.168.2.60\uff0c\u5bf9\u5e94\u4e3b\u673a\u540d ipa-server.xuwangwei.test\u3002</li> <li> \u5b89\u88c5\u4e24\u4e2a FreeIPA \u5ba2\u6237\u7aef\u5b9e\u4f8b\uff0c\u4e24\u53f0\u4e3b\u673a IP \u5730\u5740\u5206\u522b\u4e3a 192.168.2.61\u3001192.168.2.62\uff0c\u5bf9\u5e94\u4e3b\u673a\u540d machine1.xuwangwei.test\u3001machine2.xuwangwei.test\u3002</li> </ul> <p>\u524d\u7f6e\u6761\u4ef6</p> <ul> <li> Ansible \u7ba1\u7406\u8282\u70b9<sup>1</sup>\u9700\u8981\u80fd\u591f\u901a\u8fc7 <code>ssh</code> \u514d\u5bc6\u767b\u5f55\u5230\u76ee\u6807\u8282\u70b9<sup>2</sup>\u3002</li> <li> \u767b\u5f55\u76ee\u6807\u8282\u70b9\u7684\u8d26\u53f7\u9700\u8981\u80fd\u591f\u514d\u5bc6\u6267\u884c <code>sudo</code> \u547d\u4ee4\u3002</li> </ul> <ol> <li> <p>\u5b89\u88c5 Ansible</p> <pre><code>sudo dnf install ansible-core -y\n</code></pre> </li> <li> <p>\u5b89\u88c5 Ansible collection</p> <pre><code>ansible-galaxy collection install freeipa.ansible_freeipa:1.14.1\nansible-galaxy collection install ansible.posix:1.6.1\n</code></pre> </li> <li> <p>\u521b\u5efa\u76ee\u5f55 <code>deploy_freeipa_using_ansible</code>\uff0c\u4f5c\u4e3a\u540e\u7eed\u7684\u5de5\u4f5c\u76ee\u5f55</p> <pre><code>mkdir deploy_freeipa_using_ansible &amp;&amp; cd deploy_freeipa_using_ansible\n</code></pre> </li> <li> <p>\u521b\u5efa inventory</p> inventory<pre><code>[ipaserver]\nipa-server.xuwangwei.test ansible_host=192.168.2.60\n\n[ipaclients]\nmachine1.xuwangwei.test ansible_host=192.168.2.61\nmachine2.xuwangwei.test ansible_host=192.168.2.62\n</code></pre> </li> <li> <p>\u521b\u5efa\u76ee\u5f55 group_vars\uff0c\u5728 group_vars \u76ee\u5f55\u4e0b\u521b\u5efa\u4e24\u4e2a\u6587\u4ef6\uff0c\u5206\u522b\u5b58\u653e ipaserver \u548c ipaclients \u7684\u53d8\u91cf</p> group_vars/ipaserver.yml<pre><code>ipadm_password: xuwangwei3306\nipaadmin_password: xuwangwei3306\nipaserver_ip_addresses: 192.168.2.60\nipaserver_domain: xuwangwei.test\nipaserver_realm: XUWANGWEI.TEST\nipaserver_hostname: ipa-server.xuwangwei.test\nipaserver_no_host_dns: yes\nipaserver_setup_dns: yes\nipaserver_reverse_zones: 2.168.192.in-addr.arpa\nipaserver_auto_reverse: yes\nipaserver_auto_forwarders: yes\nipaserver_setup_firewalld: yes\nipaserver_firewalld_zone: public\n</code></pre> group_vars/ipaclients.yml<pre><code>ipaclient_domain: xuwangwei.test\nipaclient_mkhomedir: yes\nipaclient_ntp_servers: 192.168.2.60\nipaclient_configure_dns_resolver: yes\nipaclient_dns_servers: 192.168.2.60\nipaadmin_password: xuwangwei3306\n</code></pre> </li> <li> <p>\u521b\u5efa deploy_freeipa.yml</p> deploy_freeipa.yml<pre><code>---\n- name: Configure IPA server\n  hosts: ipaserver\n  become: true\n  pre_tasks:\n    - name: Set the hostname\n      ansible.builtin.hostname:\n        name: \"{{ inventory_hostname }}\"\n\n    - name: Update /etc/hosts with server details\n      ansible.builtin.lineinfile:\n        path: /etc/hosts\n        line: \"{{ ansible_host }} {{ inventory_hostname }} {{ inventory_hostname_short }}\"\n        state: present\n        create: true\n\n  roles:\n    - role: freeipa.ansible_freeipa.ipaserver\n      state: present\n\n  post_tasks:\n    - name: Ensure allow_sync_ptr is yes\n      freeipa.ansible_freeipa.ipadnsconfig:\n        ipaadmin_password: \"{{ ipaadmin_password }}\"\n        allow_sync_ptr: yes\n\n    - name: Add FreeIPA service to firewalld (temporary and permanent)\n      ansible.posix.firewalld:\n        service: freeipa-4\n        state: enabled\n        permanent: true\n        immediate: true\n\n    - name: Add DNS service to firewalld (temporary and permanent)\n      ansible.posix.firewalld:\n        service: dns\n        state: enabled\n        permanent: true\n        immediate: true\n\n    - name: Add NTP service to firewalld (temporary and permanent)\n      ansible.posix.firewalld:\n        service: ntp\n        state: enabled\n        permanent: true\n        immediate: true\n\n    - name: Ensure /etc/chrony.conf contains allow for LAN\n      ansible.builtin.lineinfile:\n        path: /etc/chrony.conf\n        regexp: '^allow '\n        line: 'allow 192.168.2.0/24'\n        state: present\n\n    - name: Restart chronyd service to apply changes\n      ansible.builtin.service:\n        name: chronyd\n        state: restarted\n        enabled: true\n\n- name: Configure IPA clients\n  hosts: ipaclients\n  become: true\n  pre_tasks:\n    - name: Set the hostname\n      ansible.builtin.hostname:\n        name: \"{{ inventory_hostname }}\"\n\n    - name: Update /etc/hosts with client details\n      ansible.builtin.lineinfile:\n        path: /etc/hosts\n        line: \"{{ ansible_host }} {{ inventory_hostname }} {{ inventory_hostname_short }}\"\n        state: present\n        create: true\n\n  roles:\n    - role: freeipa.ansible_freeipa.ipaclient\n      state: present\n</code></pre> <p>\u6700\u7ec8\u7684\u76ee\u5f55\u7ed3\u6784\u5982\u4e0b\u6240\u793a\uff1a</p> <pre><code>deploy_freeipa_using_ansible/\n\u251c\u2500\u2500 inventory\n\u251c\u2500\u2500 group_vars/\n\u2502   \u251c\u2500\u2500 ipaserver.yml\n\u2502   \u2514\u2500\u2500 ipaclients.yml\n\u2514\u2500\u2500 deploy_freeipa.yml\n</code></pre> </li> <li> <p>\u4e00\u952e\u5b89\u88c5</p> <pre><code>ansible-playbook -i inventory deploy_freeipa.yml\n</code></pre> Success <pre><code>PLAY [Configure IPA server] ********************************************************************************************\n\nTASK [Gathering Facts] *************************************************************************************************\nok: [ipa-server.xuwangwei.test]\n\nTASK [Set the hostname] ************************************************************************************************\nchanged: [ipa-server.xuwangwei.test]\n\nTASK [Update /etc/hosts with server details] ***************************************************************************\nchanged: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaserver : Import variables specific to distribution] ***********************************\nok: [ipa-server.xuwangwei.test] =&gt; (item=/home/vagrant/.ansible/collections/ansible_collections/freeipa/ansible_freeipa/roles/ipaserver/vars/default.yml)\n\nTASK [freeipa.ansible_freeipa.ipaserver : Install IPA server] **********************************************************\nincluded: /home/vagrant/.ansible/collections/ansible_collections/freeipa/ansible_freeipa/roles/ipaserver/tasks/install.yml for ipa-server.xuwangwei.test\n\nTASK [freeipa.ansible_freeipa.ipaserver : Install - Ensure that IPA server packages are installed] *********************\nchanged: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaserver : Install - Ensure that IPA server packages for dns are installed] *************\nchanged: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaserver : Install - Ensure that IPA server packages for adtrust are installed] *********\nskipping: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaserver : Install - Ensure that firewall packages installed] ***************************\nok: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaserver : Firewalld service - Ensure that firewalld is running] ************************\nchanged: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaserver : Firewalld - Verify runtime zone \"public\"] ************************************\nchanged: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaserver : Firewalld - Verify permanent zone \"public\"] **********************************\nchanged: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaserver : Copy external certs] *********************************************************\nskipping: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaserver : Install - Server installation test] ******************************************\nok: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaserver : Install - Master password creation] ******************************************\nchanged: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaserver : Install - Use new master password] *******************************************\nok: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaserver : Use user defined master password, if provided] *******************************\nskipping: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaserver : Install - Server preparation] ************************************************\nchanged: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaserver : Install - Setup NTP] *********************************************************\nchanged: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaserver : Install - Setup DS] **********************************************************\nchanged: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaserver : Install - Setup KRB] *********************************************************\nchanged: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaserver : Install - Setup CA] **********************************************************\nchanged: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaserver : Copy /root/ipa.csr to \"ipa-server.xuwangwei.test-ipa.csr\"] *******************\nskipping: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaserver : Install - Setup otpd] ********************************************************\nchanged: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaserver : Install - Setup HTTP] ********************************************************\nchanged: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaserver : Install - Setup KRA] *********************************************************\nskipping: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaserver : Install - Setup DNS] *********************************************************\nchanged: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaserver : Install - Setup ADTRUST] *****************************************************\nchanged: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaserver : Install - Set DS password] ***************************************************\nchanged: [ipa-server.xuwangwei.test]\n\nTASK [Install - Setup client] ******************************************************************************************\n\nTASK [freeipa.ansible_freeipa.ipaclient : Import variables specific to distribution] ***********************************\nok: [ipa-server.xuwangwei.test] =&gt; (item=/home/vagrant/.ansible/collections/ansible_collections/freeipa/ansible_freeipa/roles/ipaclient/vars/default.yml)\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install IPA client] **********************************************************\nincluded: /home/vagrant/.ansible/collections/ansible_collections/freeipa/ansible_freeipa/roles/ipaclient/tasks/install.yml for ipa-server.xuwangwei.test\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Ensure that IPA client packages are installed] *********************\nskipping: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Set ipaclient_servers] *********************************************\nskipping: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Set ipaclient_servers from cluster inventory] **********************\nskipping: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Check that either password or keytab is set] ***********************\nskipping: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Set default principal if no keytab is given] ***********************\nok: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Fail on missing ipaclient_domain and ipaserver_domain] *************\nskipping: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Fail on missing ipaclient_servers] *********************************\nskipping: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Configure DNS resolver] ********************************************\nskipping: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - IPA client test] ***************************************************\nok: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Cleanup leftover ccache] *******************************************\nok: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Configure NTP] *****************************************************\nok: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Make sure One-Time Password is enabled if it's already defined] ****\nskipping: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Disable One-Time Password for on_master] ***************************\nskipping: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Test if IPA client has working krb5.keytab] ************************\nok: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Disable One-Time Password for client with working krb5.keytab] *****\nskipping: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Keytab or password is required for getting otp] ********************\nskipping: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Create temporary file for keytab] **********************************\nskipping: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Copy keytab to server temporary file] ******************************\nskipping: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Get One-Time Password for client enrollment] ***********************\nskipping: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Store the previously obtained OTP] *********************************\nskipping: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Remove keytab temporary file] **************************************\nskipping: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Store predefined OTP in admin_password] **************************************\nskipping: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Check if principal and keytab are set] *****************************\nskipping: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Check if one of password or keytabs are set] ***********************\nskipping: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - From host keytab, purge XUWANGWEI.TEST] ****************************\nskipping: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Backup and set hostname] *******************************************\nskipping: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Create temporary krb5 configuration] *******************************\nok: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Join IPA] **********************************************************\nskipping: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : The krb5 configuration is not correct] ***************************************\nskipping: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : IPA test failed] *************************************************************\nskipping: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Fail due to missing ca.crt file] *********************************************\nskipping: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Configure IPA default.conf] ****************************************\nskipping: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Configure SSSD] ****************************************************\nchanged: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - IPA API calls for remaining enrollment parts] **********************\nchanged: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Fix IPA ca] ********************************************************\nskipping: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Create IPA NSS database] *******************************************\nchanged: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Configure SSH and SSHD] ********************************************\nchanged: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Configure automount] ***********************************************\nok: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Configure firefox] *************************************************\nskipping: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Configure NIS] *****************************************************\nchanged: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Remove temporary krb5.conf] **************************************************\nchanged: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Configure krb5 for IPA realm] **************************************\nskipping: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Configure certmonger] **********************************************\nskipping: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Restore original admin password if overwritten by OTP] *************\nskipping: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Cleanup leftover ccache] *****************************************************\nok: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Remove temporary krb5.conf] **************************************************\nok: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Remove temporary krb5.conf backup] *******************************************\nchanged: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Uninstall IPA client] ********************************************************\nskipping: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaserver : Install - Enable IPA] ********************************************************\nchanged: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaserver : Install - Configure firewalld] ***********************************************\nchanged: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaserver : Install - Configure firewalld runtime] ***************************************\nchanged: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaserver : Install - Cleanup root IPA cache] ********************************************\nok: [ipa-server.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaserver : Cleanup temporary files] *****************************************************\nok: [ipa-server.xuwangwei.test] =&gt; (item=/etc/ipa/.tmp_pkcs12_dirsrv)\nok: [ipa-server.xuwangwei.test] =&gt; (item=/etc/ipa/.tmp_pkcs12_http)\nok: [ipa-server.xuwangwei.test] =&gt; (item=/etc/ipa/.tmp_pkcs12_pkinit)\n\nTASK [freeipa.ansible_freeipa.ipaserver : Uninstall IPA server] ********************************************************\nskipping: [ipa-server.xuwangwei.test]\n\nTASK [Ensure allow_sync_ptr is yes] ************************************************************************************\nchanged: [ipa-server.xuwangwei.test]\n\nTASK [Add FreeIPA service to firewalld (temporary and permanent)] ******************************************************\nchanged: [ipa-server.xuwangwei.test]\n\nTASK [Add DNS service to firewalld (temporary and permanent)] **********************************************************\nok: [ipa-server.xuwangwei.test]\n\nTASK [Add NTP service to firewalld (temporary and permanent)] **********************************************************\nok: [ipa-server.xuwangwei.test]\n\nTASK [Ensure /etc/chrony.conf contains allow for LAN] ******************************************************************\nchanged: [ipa-server.xuwangwei.test]\n\nTASK [Restart chronyd service to apply changes] ************************************************************************\nchanged: [ipa-server.xuwangwei.test]\n\nPLAY [Configure IPA clients] *******************************************************************************************\n\nTASK [Gathering Facts] *************************************************************************************************\nok: [machine1.xuwangwei.test]\nok: [machine2.xuwangwei.test]\n\nTASK [Set the hostname] ************************************************************************************************\nchanged: [machine2.xuwangwei.test]\nchanged: [machine1.xuwangwei.test]\n\nTASK [Update /etc/hosts with client details] ***************************************************************************\nchanged: [machine1.xuwangwei.test]\nchanged: [machine2.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Import variables specific to distribution] ***********************************\nok: [machine1.xuwangwei.test] =&gt; (item=/home/vagrant/.ansible/collections/ansible_collections/freeipa/ansible_freeipa/roles/ipaclient/vars/default.yml)\nok: [machine2.xuwangwei.test] =&gt; (item=/home/vagrant/.ansible/collections/ansible_collections/freeipa/ansible_freeipa/roles/ipaclient/vars/default.yml)\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install IPA client] **********************************************************\nincluded: /home/vagrant/.ansible/collections/ansible_collections/freeipa/ansible_freeipa/roles/ipaclient/tasks/install.yml for machine1.xuwangwei.test, machine2.xuwangwei.test\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Ensure that IPA client packages are installed] *********************\nchanged: [machine1.xuwangwei.test]\nchanged: [machine2.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Set ipaclient_servers] *********************************************\nskipping: [machine1.xuwangwei.test]\nskipping: [machine2.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Set ipaclient_servers from cluster inventory] **********************\nskipping: [machine1.xuwangwei.test]\nskipping: [machine2.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Check that either password or keytab is set] ***********************\nskipping: [machine1.xuwangwei.test]\nskipping: [machine2.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Set default principal if no keytab is given] ***********************\nok: [machine1.xuwangwei.test]\nok: [machine2.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Fail on missing ipaclient_domain and ipaserver_domain] *************\nskipping: [machine1.xuwangwei.test]\nskipping: [machine2.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Fail on missing ipaclient_servers] *********************************\nskipping: [machine1.xuwangwei.test]\nskipping: [machine2.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Configure DNS resolver] ********************************************\nchanged: [machine1.xuwangwei.test]\nchanged: [machine2.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - IPA client test] ***************************************************\nok: [machine1.xuwangwei.test]\nok: [machine2.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Cleanup leftover ccache] *******************************************\nok: [machine1.xuwangwei.test]\nok: [machine2.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Configure NTP] *****************************************************\nchanged: [machine1.xuwangwei.test]\nchanged: [machine2.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Make sure One-Time Password is enabled if it's already defined] ****\nskipping: [machine1.xuwangwei.test]\nskipping: [machine2.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Disable One-Time Password for on_master] ***************************\nskipping: [machine1.xuwangwei.test]\nskipping: [machine2.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Test if IPA client has working krb5.keytab] ************************\nok: [machine1.xuwangwei.test]\nok: [machine2.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Disable One-Time Password for client with working krb5.keytab] *****\nskipping: [machine1.xuwangwei.test]\nskipping: [machine2.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Keytab or password is required for getting otp] ********************\nskipping: [machine1.xuwangwei.test]\nskipping: [machine2.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Create temporary file for keytab] **********************************\nskipping: [machine1.xuwangwei.test]\nskipping: [machine2.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Copy keytab to server temporary file] ******************************\nskipping: [machine1.xuwangwei.test]\nskipping: [machine2.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Get One-Time Password for client enrollment] ***********************\nskipping: [machine1.xuwangwei.test]\nskipping: [machine2.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Store the previously obtained OTP] *********************************\nskipping: [machine1.xuwangwei.test]\nskipping: [machine2.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Remove keytab temporary file] **************************************\nskipping: [machine1.xuwangwei.test]\nskipping: [machine2.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Store predefined OTP in admin_password] **************************************\nskipping: [machine1.xuwangwei.test]\nskipping: [machine2.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Check if principal and keytab are set] *****************************\nskipping: [machine1.xuwangwei.test]\nskipping: [machine2.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Check if one of password or keytabs are set] ***********************\nskipping: [machine1.xuwangwei.test]\nskipping: [machine2.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - From host keytab, purge XUWANGWEI.TEST] ****************************\nskipping: [machine1.xuwangwei.test]\nskipping: [machine2.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Backup and set hostname] *******************************************\nchanged: [machine2.xuwangwei.test]\nchanged: [machine1.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Create temporary krb5 configuration] *******************************\nok: [machine2.xuwangwei.test]\nok: [machine1.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Join IPA] **********************************************************\nchanged: [machine1.xuwangwei.test]\nchanged: [machine2.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : The krb5 configuration is not correct] ***************************************\nskipping: [machine1.xuwangwei.test]\nskipping: [machine2.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : IPA test failed] *************************************************************\nskipping: [machine1.xuwangwei.test]\nskipping: [machine2.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Fail due to missing ca.crt file] *********************************************\nskipping: [machine1.xuwangwei.test]\nskipping: [machine2.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Configure IPA default.conf] ****************************************\nchanged: [machine1.xuwangwei.test]\nchanged: [machine2.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Configure SSSD] ****************************************************\nchanged: [machine1.xuwangwei.test]\nchanged: [machine2.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - IPA API calls for remaining enrollment parts] **********************\nchanged: [machine1.xuwangwei.test]\nchanged: [machine2.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Fix IPA ca] ********************************************************\nskipping: [machine1.xuwangwei.test]\nskipping: [machine2.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Create IPA NSS database] *******************************************\nchanged: [machine1.xuwangwei.test]\nchanged: [machine2.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Configure SSH and SSHD] ********************************************\nchanged: [machine1.xuwangwei.test]\nchanged: [machine2.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Configure automount] ***********************************************\nok: [machine1.xuwangwei.test]\nok: [machine2.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Configure firefox] *************************************************\nskipping: [machine1.xuwangwei.test]\nskipping: [machine2.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Configure NIS] *****************************************************\nchanged: [machine2.xuwangwei.test]\nchanged: [machine1.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Remove temporary krb5.conf] **************************************************\nchanged: [machine1.xuwangwei.test]\nchanged: [machine2.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Configure krb5 for IPA realm] **************************************\nchanged: [machine2.xuwangwei.test]\nchanged: [machine1.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Configure certmonger] **********************************************\nchanged: [machine1.xuwangwei.test]\nchanged: [machine2.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Install - Restore original admin password if overwritten by OTP] *************\nskipping: [machine1.xuwangwei.test]\nskipping: [machine2.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Cleanup leftover ccache] *****************************************************\nok: [machine2.xuwangwei.test]\nok: [machine1.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Remove temporary krb5.conf] **************************************************\nok: [machine1.xuwangwei.test]\nok: [machine2.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Remove temporary krb5.conf backup] *******************************************\nchanged: [machine1.xuwangwei.test]\nchanged: [machine2.xuwangwei.test]\n\nTASK [freeipa.ansible_freeipa.ipaclient : Uninstall IPA client] ********************************************************\nskipping: [machine1.xuwangwei.test]\nskipping: [machine2.xuwangwei.test]\n\nPLAY RECAP *************************************************************************************************************\nipa-server.xuwangwei.test  : ok=53   changed=32   unreachable=0    failed=0    skipped=38   rescued=0    ignored=0\nmachine1.xuwangwei.test    : ok=28   changed=17   unreachable=0    failed=0    skipped=25   rescued=0    ignored=0\nmachine2.xuwangwei.test    : ok=28   changed=17   unreachable=0    failed=0    skipped=25   rescued=0    ignored=0\n</code></pre> <p>\u81f3\u6b64\uff0c\u670d\u52a1\u7aef\u548c\u5ba2\u6237\u7aef\u5df2\u5b89\u88c5\u5b8c\u6bd5\u3002</p> </li> </ol> <ol> <li> <p>Ansible \u7ba1\u7406\u8282\u70b9\u662f\u6307\u5b89\u88c5 Ansible \u548c\u8fd0\u884c Ansible \u63a7\u5236\u547d\u4ee4\u7684\u4e3b\u673a\u3002\u00a0\u21a9</p> </li> <li> <p>\u76ee\u6807\u8282\u70b9\u662f\u6307\u9700\u8981\u90e8\u7f72 FreeIPA \u7684\u4e3b\u673a\uff0cAnsible \u4f1a\u901a\u8fc7 SSH \u5bf9\u8fd9\u4e9b\u8282\u70b9\u8fdb\u884c\u64cd\u4f5c\u3002\u00a0\u21a9</p> </li> </ol>","tags":["Ansible","FreeIPA","Rocky Linux"]},{"location":"blog/2023/10/29/%E5%AE%89%E8%A3%85kerberos%E6%9C%8D%E5%8A%A1rocky-linux-92/","title":"\u5b89\u88c5Kerberos\u670d\u52a1\uff08Rocky Linux 9.2\uff09","text":"<p>\u5b89\u88c5\u76ee\u6807</p> <ul> <li> \u4e00\u4e3b\u4e00\u5907\uff0c\u5171\u4e24\u4e2aKDC\u5b9e\u4f8b\u3002</li> <li> \u4e3bKDC\u6bcf\u9694\u4e00\u4e2a\u5c0f\u65f6\u540c\u6b65\u6570\u636e\u5e93\u81f3\u5907KDC\u3002</li> <li> \u4e3bKDC\u5b89\u88c5\u5728kdc1.example.com\u4e3b\u673a\u4e0a\uff0c\u5907KDC\u5b89\u88c5\u5728kdc2.example.com\u4e3b\u673a\u4e0a\u3002</li> </ul> <p>\u524d\u7f6e\u6761\u4ef6</p> <ul> <li> \u65f6\u949f\u540c\u6b65\u3002\u5728\u672c\u6587\u4e2d\uff0c\u5373\u662fkdc1.example.com\u4e3b\u673a\u4e0ekdc2.example.com\u4e3b\u673a\u9700\u8981\u65f6\u949f\u540c\u6b65\u3002</li> <li> \u914d\u7f6e/etc/hosts\u3002</li> </ul>"},{"location":"blog/2023/10/29/%E5%AE%89%E8%A3%85kerberos%E6%9C%8D%E5%8A%A1rocky-linux-92/#kdc","title":"\u4e3bKDC\u7684\u5b89\u88c5\u4e0e\u914d\u7f6e","text":"<ol> <li> <p>\u5b89\u88c5KDC\u8f6f\u4ef6\u5305</p> <pre><code>[root@kdc1 ~]# dnf install krb5-server krb5-workstation\n</code></pre> </li> <li> <p>\u4fee\u6539/etc/krb5.conf</p> \u4fee\u6539\u524d\u4fee\u6539\u540e <pre><code># To opt out of the system crypto-policies configuration of krb5, remove the\n# symlink at /etc/krb5.conf.d/crypto-policies which will not be recreated.\nincludedir /etc/krb5.conf.d/\n\n[logging]\n    default = FILE:/var/log/krb5libs.log\n    kdc = FILE:/var/log/krb5kdc.log\n    admin_server = FILE:/var/log/kadmind.log\n\n[libdefaults]\n    dns_lookup_realm = false\n    ticket_lifetime = 24h\n    renew_lifetime = 7d\n    forwardable = true\n    rdns = false\n    pkinit_anchors = FILE:/etc/pki/tls/certs/ca-bundle.crt\n    spake_preauth_groups = edwards25519\n    dns_canonicalize_hostname = fallback\n    qualify_shortname = \"\"\n#    default_realm = EXAMPLE.COM\n    default_ccache_name = KEYRING:persistent:%{uid}\n\n[realms]\n# EXAMPLE.COM = {\n#     kdc = kerberos.example.com\n#     admin_server = kerberos.example.com\n# }\n\n[domain_realm]\n# .example.com = EXAMPLE.COM\n# example.com = EXAMPLE.COM\n</code></pre> <pre><code># To opt out of the system crypto-policies configuration of krb5, remove the\n# symlink at /etc/krb5.conf.d/crypto-policies which will not be recreated.\nincludedir /etc/krb5.conf.d/\n\n[logging]\n    default = FILE:/var/log/krb5libs.log\n    kdc = FILE:/var/log/krb5kdc.log\n    admin_server = FILE:/var/log/kadmind.log\n\n[libdefaults]\n    dns_lookup_realm = false\n    dns_lookup_kdc = false\n    dns_canonicalize_hostname = false\n    rdns = false\n    ticket_lifetime = 24h\n    renew_lifetime = 7d\n    forwardable = true\n    pkinit_anchors = FILE:/etc/pki/tls/certs/ca-bundle.crt\n    spake_preauth_groups = edwards25519\n    qualify_shortname = \"\"\n    default_realm = EXAMPLE.COM\n#    default_ccache_name = KEYRING:persistent:%{uid}\n\n[realms]\nEXAMPLE.COM = {\n    kdc = kdc1.example.com\n    # \u5982\u679c\u4f60\u4e0d\u9700\u8981\u5907KDC\uff0c\u5220\u9664\u4e0b\u4e00\u884c\n    kdc = kdc2.example.com\n    admin_server = kdc1.example.com\n    # \u5982\u679c\u4f60\u4e0d\u9700\u8981\u5907KDC\uff0c\u5220\u9664\u4e0b\u4e00\u884c\n    primary_kdc = kdc1.example.com\n}\n\n[domain_realm]\n.example.com = EXAMPLE.COM\nexample.com = EXAMPLE.COM\n</code></pre> </li> <li> <p>/var/kerberos/krb5kdc/kdc.conf\u914d\u7f6e\u4fdd\u6301\u4e0d\u53d8</p> <pre><code>[kdcdefaults]\n    kdc_ports = 88\n    kdc_tcp_ports = 88\n    spake_preauth_kdc_challenge = edwards25519\n\n[realms]\nEXAMPLE.COM = {\n    master_key_type = aes256-cts-hmac-sha384-192\n    acl_file = /var/kerberos/krb5kdc/kadm5.acl\n    dict_file = /usr/share/dict/words\n    default_principal_flags = +preauth\n    admin_keytab = /var/kerberos/krb5kdc/kadm5.keytab\n    supported_enctypes = aes256-cts-hmac-sha384-192:normal aes128-cts-hmac-sha256-128:normal aes256-cts-hmac-sha1-96:normal aes128-cts-hmac-sha1-96:normal camellia256-cts-cmac:normal camellia128-cts-cmac:normal arcfour-hmac-md5:normal\n    # Supported encryption types for FIPS mode:\n    #supported_enctypes = aes256-cts-hmac-sha384-192:normal aes128-cts-hmac-sha256-128:normal\n}\n</code></pre> </li> <li> <p>\u521b\u5efa\u6570\u636e\u5e93\u5e76\u8bbe\u7f6e\u4e3b\u5bc6\u7801</p> <pre><code>[root@kdc1 ~]# kdb5_util create -s\n</code></pre> </li> <li> <p>/var/kerberos/krb5kdc/kadm5.acl\u914d\u7f6e\u4fdd\u6301\u4e0d\u53d8</p> <pre><code>*/admin@EXAMPLE.COM *\n</code></pre> </li> <li> <p>\u542f\u52a8\u670d\u52a1\u5e76\u8bbe\u7f6e\u5f00\u673a\u81ea\u542f</p> <pre><code>[root@kdc1 ~]# systemctl start krb5kdc.service\n[root@kdc1 ~]# systemctl start kadmin.service\n[root@kdc1 ~]# systemctl enable krb5kdc.service\n[root@kdc1 ~]# systemctl enable kadmin.service\n</code></pre> </li> <li> <p>\u8bbe\u7f6e\u9632\u706b\u5899</p> <pre><code>[root@kdc1 ~]# firewall-cmd --add-service=kerberos\n[root@kdc1 ~]# firewall-cmd --permanent --add-service=kerberos\n[root@kdc1 ~]# firewall-cmd --add-service=kadmin\n[root@kdc1 ~]# firewall-cmd --permanent --add-service=kadmin\n</code></pre> <p>\u81f3\u6b64\uff0c\u4e3bKDC\u5df2\u7ecf\u5b89\u88c5\u5b8c\u6bd5\u3002\u5982\u679c\u9700\u8981\u63d0\u9ad8Kerberos\u670d\u52a1\u7684\u53ef\u7528\u6027\uff0c\u53ef\u4ee5\u5b89\u88c5\u4e00\u4e2a\u81f3\u591a\u4e2a\u5907\u7528\u670d\u52a1\u3002\u5b89\u88c5\u5907\u7528\u670d\u52a1\u7684\u8fc7\u7a0b\u5199\u5728\u4e86\u4e0b\u65b9\u3002</p> </li> </ol>"},{"location":"blog/2023/10/29/%E5%AE%89%E8%A3%85kerberos%E6%9C%8D%E5%8A%A1rocky-linux-92/#kdc_1","title":"\u5907KDC\u7684\u5b89\u88c5\u4e0e\u914d\u7f6e","text":"<ol> <li> <p>\u5b89\u88c5KDC\u8f6f\u4ef6\u5305</p> <pre><code>[root@kdc2 ~]# dnf install krb5-server krb5-workstation\n</code></pre> </li> <li> <p>\u590d\u5236\u4e3b\u670d\u52a1\u7684/etc/krb5.conf\u6587\u4ef6\u548c/var/kerberos/krb5kdc/kdc.conf\u6587\u4ef6\u81f3\u5907\u670d\u52a1\u7684\u4e3b\u673a</p> <pre><code>[root@kdc1 ~]# scp /etc/krb5.conf root@kdc2.example.com:/etc/krb5.conf\n[root@kdc1 ~]# scp /var/kerberos/krb5kdc/kdc.conf root@kdc2.example.com:/var/kerberos/krb5kdc/kdc.conf\n</code></pre> </li> <li> <p>\u521b\u5efa\u4e00\u4e2a\u7528\u6237principal\u2014\u2014\u7ba1\u7406\u5458tom/admin@EXAMPLE.COM\uff0c\u53ef\u4ee5\u5728\u5176\u4ed6\u4e3b\u673a\u4f7f\u7528\u8fd9\u4e2a\u7528\u6237\u8fde\u63a5\u5230KDC\uff08\u66f4\u51c6\u786e\u5730\u8bf4\u662fkadmin\u670d\u52a1\u7aef\uff09\u5e76\u62e5\u6709\u7ba1\u7406\u5458\u6743\u9650\u3002\u7a0d\u540e\u6211\u4eec\u5c31\u4f1a\u5728\u5907\u4efd\u4e3b\u673a\u4e0a\u4f7f\u7528tom/admin@EXAMPLE.COM\u8fde\u63a5\u5230KDC\u3002\u521b\u5efa\u4e00\u4e2a\u4e3b\u673aprincipal\u2014\u2014host/kdc1.example.com@EXAMPLE.COM\uff0c\u76f8\u5f53\u4e8e\u8fd9\u53f0\u4e3b\u673a\u7684\u8eab\u4efd\u8bc1\u53f7\u7801\uff0c\u5728\u4e3b\u670d\u52a1\u7684\u6570\u636e\u5e93\u540c\u6b65\u81f3\u5907\u670d\u52a1\u7684\u6570\u636e\u5e93\u65f6\u7528\u4e8e\u8bc1\u660e\u81ea\u5df1\u7684\u8eab\u4efd\u3002</p> <pre><code>[root@kdc1 ~]# kadmin.local -r EXAMPLE.COM\nAuthenticating as principal root/admin@EXAMPLE.COM with password.\nkadmin.local:  addprinc tom/admin\nNo policy specified for tom/admin@EXAMPLE.COM; defaulting to no policy\nEnter password for principal \"tom/admin@EXAMPLE.COM\": \nRe-enter password for principal \"tom/admin@EXAMPLE.COM\": \nPrincipal \"tom/admin@EXAMPLE.COM\" created.\nkadmin.local:  addprinc -randkey host/kdc1.example.com\nNo policy specified for host/kdc1.example.com@EXAMPLE.COM; defaulting to no policy\nPrincipal \"host/kdc1.example.com@EXAMPLE.COM\" created.\nkadmin.local:  ktadd host/kdc1.example.com\nEntry for principal host/kdc1.example.com with kvno 2, encryption type aes256-cts-hmac-sha384-192 added to keytab FILE:/etc/krb5.keytab.\nEntry for principal host/kdc1.example.com with kvno 2, encryption type aes128-cts-hmac-sha256-128 added to keytab FILE:/etc/krb5.keytab.\nEntry for principal host/kdc1.example.com with kvno 2, encryption type aes256-cts-hmac-sha1-96 added to keytab FILE:/etc/krb5.keytab.\nEntry for principal host/kdc1.example.com with kvno 2, encryption type aes128-cts-hmac-sha1-96 added to keytab FILE:/etc/krb5.keytab.\nEntry for principal host/kdc1.example.com with kvno 2, encryption type camellia256-cts-cmac added to keytab FILE:/etc/krb5.keytab.\nEntry for principal host/kdc1.example.com with kvno 2, encryption type camellia128-cts-cmac added to keytab FILE:/etc/krb5.keytab.\nEntry for principal host/kdc1.example.com with kvno 2, encryption type arcfour-hmac added to keytab FILE:/etc/krb5.keytab.\nkadmin.local:  quit\n</code></pre> </li> <li> <p>\u5728\u5907\u4efd\u4e3b\u673a\u4e0a\u4f7f\u7528tom/admin@EXAMPLE.COM\u8fde\u63a5\u5230KDC\uff0c\u521b\u5efa\u4e00\u4e2a\u4e3b\u673aprincipal\u2014\u2014host/kdc2.example.com@EXAMPLE.COM\uff0c\u8fd9\u662f\u5907\u4efd\u4e3b\u673a\u7684\u8eab\u4efd\u8bc1\u53f7\u7801\u3002\u4e3a\u4ec0\u4e48\u4e3b\u670d\u52a1\u548c\u5907\u670d\u52a1\u8981\u521b\u5efa\u5404\u81ea\u7684principal\uff1f\u56e0\u4e3a\u8eab\u4efd\u8ba4\u8bc1\u662f\u53cc\u5411\u7684\uff0c\u53cc\u65b9\u8981\u51fa\u793a\u81ea\u5df1\u7684\u8bc1\u660e\uff0c\u4f60\u51fa\u793a\u4f60\u7684\u8eab\u4efd\u8bc1\uff0c\u6211\u51fa\u793a\u6211\u7684\u8eab\u4efd\u8bc1\u3002</p> <pre><code>[root@kdc2 ~]# kadmin -p tom/admin -r EXAMPLE.COM\nAuthenticating as principal tom/admin with password.\nPassword for tom/admin@EXAMPLE.COM: \nkadmin:  addprinc -randkey host/kdc2.example.com\nNo policy specified for host/kdc2.example.com@EXAMPLE.COM; defaulting to no policy\nPrincipal \"host/kdc2.example.com@EXAMPLE.COM\" created.\nkadmin:  ktadd host/kdc2.example.com\nEntry for principal host/kdc2.example.com with kvno 2, encryption type aes256-cts-hmac-sha384-192 added to keytab FILE:/etc/krb5.keytab.\nEntry for principal host/kdc2.example.com with kvno 2, encryption type aes128-cts-hmac-sha256-128 added to keytab FILE:/etc/krb5.keytab.\nEntry for principal host/kdc2.example.com with kvno 2, encryption type aes256-cts-hmac-sha1-96 added to keytab FILE:/etc/krb5.keytab.\nEntry for principal host/kdc2.example.com with kvno 2, encryption type aes128-cts-hmac-sha1-96 added to keytab FILE:/etc/krb5.keytab.\nEntry for principal host/kdc2.example.com with kvno 2, encryption type camellia256-cts-cmac added to keytab FILE:/etc/krb5.keytab.\nEntry for principal host/kdc2.example.com with kvno 2, encryption type camellia128-cts-cmac added to keytab FILE:/etc/krb5.keytab.\nEntry for principal host/kdc2.example.com with kvno 2, encryption type arcfour-hmac added to keytab FILE:/etc/krb5.keytab.\nkadmin:  quit\n</code></pre> </li> <li> <p>\u5c06\u4e3b\u670d\u52a1\u7684\u4e3b\u673aprincipal\u5199\u5165\u914d\u7f6e\u6587\u4ef6/var/kerberos/krb5kdc/kpropd.acl\uff0c\u76f8\u5f53\u4e8e\u544a\u8bc9\u5907\u670d\u52a1\u53ea\u9700\u8ba4\u53efhost/kdc1.example.com@EXAMPLE.COM\u540c\u6b65\u6570\u636e\u5e93\u3002</p> <pre><code>[root@kdc2 ~]# echo host/kdc1.example.com@EXAMPLE.COM &gt; /var/kerberos/krb5kdc/kpropd.acl\n</code></pre> </li> <li> <p>\u590d\u5236\u6570\u636e\u5e93\u4e3b\u5bc6\u7801</p> <pre><code>[root@kdc1 ~]# scp /var/kerberos/krb5kdc/.k5.EXAMPLE.COM root@kdc2.example.com:/var/kerberos/krb5kdc/.k5.EXAMPLE.COM\n</code></pre> </li> <li> <p>\u542f\u52a8\u670d\u52a1\u3001\u8bbe\u7f6e\u5f00\u673a\u81ea\u542f\u3001\u8bbe\u7f6e\u9632\u706b\u5899</p> <pre><code>[root@kdc2 ~]# systemctl start kprop.service\n[root@kdc2 ~]# systemctl enable kprop.service\n[root@kdc2 ~]# firewall-cmd --add-service=kprop\n[root@kdc2 ~]# firewall-cmd --permanent --add-service=kprop\n</code></pre> </li> <li> <p>\u5bfc\u51fa\u4e3b\u670d\u52a1\u7684\u6570\u636e\u5e93</p> <pre><code>[root@kdc1 ~]# kdb5_util dump /var/kerberos/krb5kdc/replica_datatrans\n</code></pre> </li> <li> <p>\u540c\u6b65\u6570\u636e\u5e93\u5230\u5907\u4efd\u670d\u52a1</p> <pre><code>[root@kdc1 ~]# kprop kdc2.example.com\nDatabase propagation to kdc2.example.com: SUCCEEDED\n</code></pre> </li> <li> <p>\u542f\u52a8\u670d\u52a1\u3001\u8bbe\u7f6e\u5f00\u673a\u81ea\u542f\u3001\u8bbe\u7f6e\u9632\u706b\u5899</p> <pre><code>[root@kdc2 ~]# systemctl start krb5kdc.service\n[root@kdc2 ~]# systemctl enable krb5kdc.service\n[root@kdc2 ~]# firewall-cmd --add-service=kerberos\n[root@kdc2 ~]# firewall-cmd --permanent --add-service=kerberos\n</code></pre> </li> <li> <p>\u521b\u5efa\u5b9a\u65f6\u4efb\u52a1</p> <pre><code>[root@kdc1 ~]# vi /etc/cron.hourly/distribute_main_kdc_to_slave\n</code></pre> </li> <li> <p>\u5b9a\u65f6\u4efb\u52a1\u5185\u5bb9</p> <pre><code>#!/bin/sh\n\n# Distribute KDC database to slave servers\n# Created by Jason Garman for use with MIT Kerberos 5\n\n# Configurables\nslavekdcs=\"kdc2.example.com\"\nslavedata=\"/var/kerberos/krb5kdc/replica_datatrans\"\n\nsuccess=1\n\nkdb5_util dump ${slavedata}\nerror=$?\nif [ $error -ne 0 ]; then\n    echo \"Kerberos database dump failed with exit code $error. Exiting.\"\n    exit 1\nfi\n\nfor kdc in $slavekdcs; do\n    kprop -f ${slavedata} ${kdc}\n    error=$?\n    if [ $error -ne 0 ]; then\n        echo \"Propagation of database to host ${kdc} failed with exit code $error.\"\n        echo \"Continuing with other slave servers.\"\n        success=0\n    fi\ndone\n\nif [ $success -eq 1 ]; then\n    echo \"Kerberos database successfully replicated to all slaves.\"\nfi\n</code></pre> </li> <li> <p>\u4fee\u6539\u6743\u9650</p> <pre><code>[root@kdc1 ~]# chmod a+x /etc/cron.hourly/distribute_main_kdc_to_slave\n</code></pre> <p>\u5982\u679c\u60f3\u67e5\u770b\u5b9a\u65f6\u4efb\u52a1\u7684\u6267\u884c\u65e5\u5fd7\uff0c\u53ef\u4ee5\u67e5\u770b/var/log/cron\u6587\u4ef6\u3002</p> </li> </ol>"},{"location":"blog/2023/10/29/%E5%AE%89%E8%A3%85kerberos%E6%9C%8D%E5%8A%A1rocky-linux-92/#kdc_2","title":"KDC\u5404\u5b88\u62a4\u8fdb\u7a0b\u7b80\u4ecb","text":"\u5b88\u62a4\u8fdb\u7a0b\u540d\u79f0 \u9ed8\u8ba4\u76d1\u542c\u7aef\u53e3\u53f7 \u804c\u8d23 krb5kdc 88 \u8eab\u4efd\u8ba4\u8bc1\u3002 kadmind 464 \u5904\u7406\u4fee\u6539\u5bc6\u7801\u8bf7\u6c42\u3002 749 \u5904\u7406\u5bf9principal\u7684\u589e\u5220\u6539\u67e5\u3001\u5bfc\u51fa\u7b49\u8bf7\u6c42\u3002 kpropd 754 \u540c\u6b65\u6570\u636e\u5e93\u3002\u5907\u670d\u52a1\u624d\u9700\u8981\u542f\u52a8\uff0c\u4e3b\u670d\u52a1\u4e0d\u9700\u8981\u542f\u52a8\u3002"},{"location":"blog/2024/07/27/%E5%AE%89%E8%A3%85-mqtt-%E6%9C%8D%E5%8A%A1rocky-linux-9/","title":"\u5b89\u88c5 MQTT \u670d\u52a1(Rocky Linux 9)","text":"<p>\u5b89\u88c5\u76ee\u6807</p> <ul> <li> \u5b89\u88c5\u4e00\u4e2a MQTT server(broker) \u5b9e\u4f8b\uff0c\u8be5\u5b9e\u4f8b\u6240\u5728\u4e3b\u673a\u7684 IP \u5730\u5740\u4e3a 192.168.2.162\u3002\u672c\u6587\u4ee5\u5b89\u88c5 MQTT server(broker)\u7684\u5f00\u6e90\u5b9e\u73b0 Eclipse Mosquitto \u4e3a\u4f8b\uff0c\u7248\u672c\u53f7 2.0.18\u3002</li> <li> \u4f7f\u7528 MQTT \u56fe\u5f62\u5316\u5ba2\u6237\u7aef MQTTX \u9a8c\u8bc1\u662f\u5426\u53ef\u4ee5\u8fde\u63a5 MQTT server(broker)\u3001\u8ba2\u9605\u6d88\u606f\u3001\u53d1\u5e03\u6d88\u606f\u3002</li> </ul> <p>\u524d\u7f6e\u6761\u4ef6</p> <ul> <li> \u65e0\u3002</li> </ul>","tags":["MQTT","Eclipse Mosquitto","Rocky Linux"]},{"location":"blog/2024/07/27/%E5%AE%89%E8%A3%85-mqtt-%E6%9C%8D%E5%8A%A1rocky-linux-9/#mqtt-serverbroker","title":"\u5b89\u88c5 MQTT server(broker)","text":"<ol> <li> <p>\u5b89\u88c5</p> <pre><code>dnf install epel-release -y\ndnf install mosquitto -y\n</code></pre> </li> <li> <p>\u521b\u5efa\u6570\u636e\u76ee\u5f55\uff0c\u7528\u4e8e\u6301\u4e45\u5316\u6d88\u606f</p> <pre><code>mkdir /var/lib/mosquitto\nchown mosquitto:mosquitto /var/lib/mosquitto\n</code></pre> </li> <li> <p>\u521b\u5efa MQTT \u8d26\u53f7 example_user \u5e76\u8bbe\u7f6e\u5bc6\u7801\uff0c\u540e\u9762\u5ba2\u6237\u7aef\u8fde\u63a5\u670d\u52a1\u7aef\u65f6\u4f7f\u7528</p> <pre><code>[root@localhost ~]# mosquitto_passwd -c /etc/mosquitto/password_file example_user\nPassword: \nReenter password: \n</code></pre> </li> <li> <p>\u751f\u6210\u81ea\u7b7e\u540d SSL/TLS \u8bc1\u4e66\uff0c\u7ed9\u670d\u52a1\u7aef\u7528</p> <pre><code>openssl req -newkey rsa:2048 -keyout /etc/mosquitto/mqtt_server.key -x509 -days 365 -out /etc/mosquitto/mqtt_server.crt -subj=\"/C=CN/ST=Jiangsu/L=Changzhou\" -noenc\n</code></pre> </li> <li> <p>\u4fee\u6539\u914d\u7f6e\u6587\u4ef6/etc/mosquitto/mosquitto.conf</p> \u4fee\u6539\u524d\u4fee\u6539\u540e <pre><code># Config file for mosquitto\n#\n# See mosquitto.conf(5) for more information.\n#\n# Default values are shown, uncomment to change.\n#\n# Use the # character to indicate a comment, but only if it is the\n# very first character on the line.\n\n# =================================================================\n# General configuration\n# =================================================================\n\n# Use per listener security settings.\n#\n# It is recommended this option be set before any other options.\n#\n# If this option is set to true, then all authentication and access control\n# options are controlled on a per listener basis. The following options are\n# affected:\n#\n# acl_file\n# allow_anonymous\n# allow_zero_length_clientid\n# auto_id_prefix\n# password_file\n# plugin\n# plugin_opt_*\n# psk_file\n#\n# Note that if set to true, then a durable client (i.e. with clean session set\n# to false) that has disconnected will use the ACL settings defined for the\n# listener that it was most recently connected to.\n#\n# The default behaviour is for this to be set to false, which maintains the\n# setting behaviour from previous versions of mosquitto.\n#per_listener_settings false\n\n\n# This option controls whether a client is allowed to connect with a zero\n# length client id or not. This option only affects clients using MQTT v3.1.1\n# and later. If set to false, clients connecting with a zero length client id\n# are disconnected. If set to true, clients will be allocated a client id by\n# the broker. This means it is only useful for clients with clean session set\n# to true.\n#allow_zero_length_clientid true\n\n# If allow_zero_length_clientid is true, this option allows you to set a prefix\n# to automatically generated client ids to aid visibility in logs.\n# Defaults to 'auto-'\n#auto_id_prefix auto-\n\n# This option affects the scenario when a client subscribes to a topic that has\n# retained messages. It is possible that the client that published the retained\n# message to the topic had access at the time they published, but that access\n# has been subsequently removed. If check_retain_source is set to true, the\n# default, the source of a retained message will be checked for access rights\n# before it is republished. When set to false, no check will be made and the\n# retained message will always be published. This affects all listeners.\n#check_retain_source true\n\n# QoS 1 and 2 messages will be allowed inflight per client until this limit\n# is exceeded.  Defaults to 0. (No maximum)\n# See also max_inflight_messages\n#max_inflight_bytes 0\n\n# The maximum number of QoS 1 and 2 messages currently inflight per\n# client.\n# This includes messages that are partway through handshakes and\n# those that are being retried. Defaults to 20. Set to 0 for no\n# maximum. Setting to 1 will guarantee in-order delivery of QoS 1\n# and 2 messages.\n#max_inflight_messages 20\n\n# For MQTT v5 clients, it is possible to have the server send a \"server\n# keepalive\" value that will override the keepalive value set by the client.\n# This is intended to be used as a mechanism to say that the server will\n# disconnect the client earlier than it anticipated, and that the client should\n# use the new keepalive value. The max_keepalive option allows you to specify\n# that clients may only connect with keepalive less than or equal to this\n# value, otherwise they will be sent a server keepalive telling them to use\n# max_keepalive. This only applies to MQTT v5 clients. The default, and maximum\n# value allowable, is 65535.\n#\n# Set to 0 to allow clients to set keepalive = 0, which means no keepalive\n# checks are made and the client will never be disconnected by the broker if no\n# messages are received. You should be very sure this is the behaviour that you\n# want.\n#\n# For MQTT v3.1.1 and v3.1 clients, there is no mechanism to tell the client\n# what keepalive value they should use. If an MQTT v3.1.1 or v3.1 client\n# specifies a keepalive time greater than max_keepalive they will be sent a\n# CONNACK message with the \"identifier rejected\" reason code, and disconnected.\n#\n#max_keepalive 65535\n\n# For MQTT v5 clients, it is possible to have the server send a \"maximum packet\n# size\" value that will instruct the client it will not accept MQTT packets\n# with size greater than max_packet_size bytes. This applies to the full MQTT\n# packet, not just the payload. Setting this option to a positive value will\n# set the maximum packet size to that number of bytes. If a client sends a\n# packet which is larger than this value, it will be disconnected. This applies\n# to all clients regardless of the protocol version they are using, but v3.1.1\n# and earlier clients will of course not have received the maximum packet size\n# information. Defaults to no limit. Setting below 20 bytes is forbidden\n# because it is likely to interfere with ordinary client operation, even with\n# very small payloads.\n#max_packet_size 0\n\n# QoS 1 and 2 messages above those currently in-flight will be queued per\n# client until this limit is exceeded.  Defaults to 0. (No maximum)\n# See also max_queued_messages.\n# If both max_queued_messages and max_queued_bytes are specified, packets will\n# be queued until the first limit is reached.\n#max_queued_bytes 0\n\n# Set the maximum QoS supported. Clients publishing at a QoS higher than\n# specified here will be disconnected.\n#max_qos 2\n\n# The maximum number of QoS 1 and 2 messages to hold in a queue per client\n# above those that are currently in-flight.  Defaults to 1000. Set\n# to 0 for no maximum (not recommended).\n# See also queue_qos0_messages.\n# See also max_queued_bytes.\n#max_queued_messages 1000\n#\n# This option sets the maximum number of heap memory bytes that the broker will\n# allocate, and hence sets a hard limit on memory use by the broker.  Memory\n# requests that exceed this value will be denied. The effect will vary\n# depending on what has been denied. If an incoming message is being processed,\n# then the message will be dropped and the publishing client will be\n# disconnected. If an outgoing message is being sent, then the individual\n# message will be dropped and the receiving client will be disconnected.\n# Defaults to no limit.\n#memory_limit 0\n\n# This option sets the maximum publish payload size that the broker will allow.\n# Received messages that exceed this size will not be accepted by the broker.\n# The default value is 0, which means that all valid MQTT messages are\n# accepted. MQTT imposes a maximum payload size of 268435455 bytes.\n#message_size_limit 0\n\n# This option allows the session of persistent clients (those with clean\n# session set to false) that are not currently connected to be removed if they\n# do not reconnect within a certain time frame. This is a non-standard option\n# in MQTT v3.1. MQTT v3.1.1 and v5.0 allow brokers to remove client sessions.\n#\n# Badly designed clients may set clean session to false whilst using a randomly\n# generated client id. This leads to persistent clients that connect once and\n# never reconnect. This option allows these clients to be removed.  This option\n# allows persistent clients (those with clean session set to false) to be\n# removed if they do not reconnect within a certain time frame.\n#\n# The expiration period should be an integer followed by one of h d w m y for\n# hour, day, week, month and year respectively. For example\n#\n# persistent_client_expiration 2m\n# persistent_client_expiration 14d\n# persistent_client_expiration 1y\n#\n# The default if not set is to never expire persistent clients.\n#persistent_client_expiration\n\n# Write process id to a file. Default is a blank string which means\n# a pid file shouldn't be written.\n# This should be set to /var/run/mosquitto/mosquitto.pid if mosquitto is\n# being run automatically on boot with an init script and\n# start-stop-daemon or similar.\n#pid_file\n\n# Set to true to queue messages with QoS 0 when a persistent client is\n# disconnected. These messages are included in the limit imposed by\n# max_queued_messages and max_queued_bytes\n# Defaults to false.\n# This is a non-standard option for the MQTT v3.1 spec but is allowed in\n# v3.1.1.\n#queue_qos0_messages false\n\n# Set to false to disable retained message support. If a client publishes a\n# message with the retain bit set, it will be disconnected if this is set to\n# false.\n#retain_available true\n\n# Disable Nagle's algorithm on client sockets. This has the effect of reducing\n# latency of individual messages at the potential cost of increasing the number\n# of packets being sent.\n#set_tcp_nodelay false\n\n# Time in seconds between updates of the $SYS tree.\n# Set to 0 to disable the publishing of the $SYS tree.\n#sys_interval 10\n\n# The MQTT specification requires that the QoS of a message delivered to a\n# subscriber is never upgraded to match the QoS of the subscription. Enabling\n# this option changes this behaviour. If upgrade_outgoing_qos is set true,\n# messages sent to a subscriber will always match the QoS of its subscription.\n# This is a non-standard option explicitly disallowed by the spec.\n#upgrade_outgoing_qos false\n\n# When run as root, drop privileges to this user and its primary\n# group.\n# Set to root to stay as root, but this is not recommended.\n# If set to \"mosquitto\", or left unset, and the \"mosquitto\" user does not exist\n# then it will drop privileges to the \"nobody\" user instead.\n# If run as a non-root user, this setting has no effect.\n# Note that on Windows this has no effect and so mosquitto should be started by\n# the user you wish it to run as.\n#user mosquitto\n\n# =================================================================\n# Listeners\n# =================================================================\n\n# Listen on a port/ip address combination. By using this variable\n# multiple times, mosquitto can listen on more than one port. If\n# this variable is used and neither bind_address nor port given,\n# then the default listener will not be started.\n# The port number to listen on must be given. Optionally, an ip\n# address or host name may be supplied as a second argument. In\n# this case, mosquitto will attempt to bind the listener to that\n# address and so restrict access to the associated network and\n# interface. By default, mosquitto will listen on all interfaces.\n# Note that for a websockets listener it is not possible to bind to a host\n# name.\n#\n# On systems that support Unix Domain Sockets, it is also possible\n# to create a # Unix socket rather than opening a TCP socket. In\n# this case, the port number should be set to 0 and a unix socket\n# path must be provided, e.g.\n# listener 0 /tmp/mosquitto.sock\n#\n# listener port-number [ip address/host name/unix socket path]\n#listener\n\n# By default, a listener will attempt to listen on all supported IP protocol\n# versions. If you do not have an IPv4 or IPv6 interface you may wish to\n# disable support for either of those protocol versions. In particular, note\n# that due to the limitations of the websockets library, it will only ever\n# attempt to open IPv6 sockets if IPv6 support is compiled in, and so will fail\n# if IPv6 is not available.\n#\n# Set to `ipv4` to force the listener to only use IPv4, or set to `ipv6` to\n# force the listener to only use IPv6. If you want support for both IPv4 and\n# IPv6, then do not use the socket_domain option.\n#\n#socket_domain\n\n# Bind the listener to a specific interface. This is similar to\n# the [ip address/host name] part of the listener definition, but is useful\n# when an interface has multiple addresses or the address may change. If used\n# with the [ip address/host name] part of the listener definition, then the\n# bind_interface option will take priority.\n# Not available on Windows.\n#\n# Example: bind_interface eth0\n#bind_interface\n\n# When a listener is using the websockets protocol, it is possible to serve\n# http data as well. Set http_dir to a directory which contains the files you\n# wish to serve. If this option is not specified, then no normal http\n# connections will be possible.\n#http_dir\n\n# The maximum number of client connections to allow. This is\n# a per listener setting.\n# Default is -1, which means unlimited connections.\n# Note that other process limits mean that unlimited connections\n# are not really possible. Typically the default maximum number of\n# connections possible is around 1024.\n#max_connections -1\n\n# The listener can be restricted to operating within a topic hierarchy using\n# the mount_point option. This is achieved be prefixing the mount_point string\n# to all topics for any clients connected to this listener. This prefixing only\n# happens internally to the broker; the client will not see the prefix.\n#mount_point\n\n# Choose the protocol to use when listening.\n# This can be either mqtt or websockets.\n# Certificate based TLS may be used with websockets, except that only the\n# cafile, certfile, keyfile, ciphers, and ciphers_tls13 options are supported.\n#protocol mqtt\n\n# Set use_username_as_clientid to true to replace the clientid that a client\n# connected with with its username. This allows authentication to be tied to\n# the clientid, which means that it is possible to prevent one client\n# disconnecting another by using the same clientid.\n# If a client connects with no username it will be disconnected as not\n# authorised when this option is set to true.\n# Do not use in conjunction with clientid_prefixes.\n# See also use_identity_as_username.\n# This does not apply globally, but on a per-listener basis.\n#use_username_as_clientid\n\n# Change the websockets headers size. This is a global option, it is not\n# possible to set per listener. This option sets the size of the buffer used in\n# the libwebsockets library when reading HTTP headers. If you are passing large\n# header data such as cookies then you may need to increase this value. If left\n# unset, or set to 0, then the default of 1024 bytes will be used.\n#websockets_headers_size\n\n# -----------------------------------------------------------------\n# Certificate based SSL/TLS support\n# -----------------------------------------------------------------\n# The following options can be used to enable certificate based SSL/TLS support\n# for this listener. Note that the recommended port for MQTT over TLS is 8883,\n# but this must be set manually.\n#\n# See also the mosquitto-tls man page and the \"Pre-shared-key based SSL/TLS\n# support\" section. Only one of certificate or PSK encryption support can be\n# enabled for any listener.\n\n# Both of certfile and keyfile must be defined to enable certificate based\n# TLS encryption.\n\n# Path to the PEM encoded server certificate.\n#certfile\n\n# Path to the PEM encoded keyfile.\n#keyfile\n\n# If you wish to control which encryption ciphers are used, use the ciphers\n# option. The list of available ciphers can be optained using the \"openssl\n# ciphers\" command and should be provided in the same format as the output of\n# that command. This applies to TLS 1.2 and earlier versions only. Use\n# ciphers_tls1.3 for TLS v1.3.\n#ciphers\n\n# Choose which TLS v1.3 ciphersuites are used for this listener.\n# Defaults to \"TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256\"\n#ciphers_tls1.3\n\n# If you have require_certificate set to true, you can create a certificate\n# revocation list file to revoke access to particular client certificates. If\n# you have done this, use crlfile to point to the PEM encoded revocation file.\n#crlfile\n\n# To allow the use of ephemeral DH key exchange, which provides forward\n# security, the listener must load DH parameters. This can be specified with\n# the dhparamfile option. The dhparamfile can be generated with the command\n# e.g. \"openssl dhparam -out dhparam.pem 2048\"\n#dhparamfile\n\n# By default an TLS enabled listener will operate in a similar fashion to a\n# https enabled web server, in that the server has a certificate signed by a CA\n# and the client will verify that it is a trusted certificate. The overall aim\n# is encryption of the network traffic. By setting require_certificate to true,\n# the client must provide a valid certificate in order for the network\n# connection to proceed. This allows access to the broker to be controlled\n# outside of the mechanisms provided by MQTT.\n#require_certificate false\n\n# cafile and capath define methods of accessing the PEM encoded\n# Certificate Authority certificates that will be considered trusted when\n# checking incoming client certificates.\n# cafile defines the path to a file containing the CA certificates.\n# capath defines a directory that will be searched for files\n# containing the CA certificates. For capath to work correctly, the\n# certificate files must have \".crt\" as the file ending and you must run\n# \"openssl rehash &lt;path to capath&gt;\" each time you add/remove a certificate.\n#cafile\n#capath\n\n\n# If require_certificate is true, you may set use_identity_as_username to true\n# to use the CN value from the client certificate as a username. If this is\n# true, the password_file option will not be used for this listener.\n#use_identity_as_username false\n\n# -----------------------------------------------------------------\n# Pre-shared-key based SSL/TLS support\n# -----------------------------------------------------------------\n# The following options can be used to enable PSK based SSL/TLS support for\n# this listener. Note that the recommended port for MQTT over TLS is 8883, but\n# this must be set manually.\n#\n# See also the mosquitto-tls man page and the \"Certificate based SSL/TLS\n# support\" section. Only one of certificate or PSK encryption support can be\n# enabled for any listener.\n\n# The psk_hint option enables pre-shared-key support for this listener and also\n# acts as an identifier for this listener. The hint is sent to clients and may\n# be used locally to aid authentication. The hint is a free form string that\n# doesn't have much meaning in itself, so feel free to be creative.\n# If this option is provided, see psk_file to define the pre-shared keys to be\n# used or create a security plugin to handle them.\n#psk_hint\n\n# When using PSK, the encryption ciphers used will be chosen from the list of\n# available PSK ciphers. If you want to control which ciphers are available,\n# use the \"ciphers\" option.  The list of available ciphers can be optained\n# using the \"openssl ciphers\" command and should be provided in the same format\n# as the output of that command.\n#ciphers\n\n# Set use_identity_as_username to have the psk identity sent by the client used\n# as its username. Authentication will be carried out using the PSK rather than\n# the MQTT username/password and so password_file will not be used for this\n# listener.\n#use_identity_as_username false\n\n\n# =================================================================\n# Persistence\n# =================================================================\n\n# If persistence is enabled, save the in-memory database to disk\n# every autosave_interval seconds. If set to 0, the persistence\n# database will only be written when mosquitto exits. See also\n# autosave_on_changes.\n# Note that writing of the persistence database can be forced by\n# sending mosquitto a SIGUSR1 signal.\n#autosave_interval 1800\n\n# If true, mosquitto will count the number of subscription changes, retained\n# messages received and queued messages and if the total exceeds\n# autosave_interval then the in-memory database will be saved to disk.\n# If false, mosquitto will save the in-memory database to disk by treating\n# autosave_interval as a time in seconds.\n#autosave_on_changes false\n\n# Save persistent message data to disk (true/false).\n# This saves information about all messages, including\n# subscriptions, currently in-flight messages and retained\n# messages.\n# retained_persistence is a synonym for this option.\n#persistence false\n\n# The filename to use for the persistent database, not including\n# the path.\n#persistence_file mosquitto.db\n\n# Location for persistent database.\n# Default is an empty string (current directory).\n# Set to e.g. /var/lib/mosquitto if running as a proper service on Linux or\n# similar.\n#persistence_location\n\n\n# =================================================================\n# Logging\n# =================================================================\n\n# Places to log to. Use multiple log_dest lines for multiple\n# logging destinations.\n# Possible destinations are: stdout stderr syslog topic file dlt\n#\n# stdout and stderr log to the console on the named output.\n#\n# syslog uses the userspace syslog facility which usually ends up\n# in /var/log/messages or similar.\n#\n# topic logs to the broker topic '$SYS/broker/log/&lt;severity&gt;',\n# where severity is one of D, E, W, N, I, M which are debug, error,\n# warning, notice, information and message. Message type severity is used by\n# the subscribe/unsubscribe log_types and publishes log messages to\n# $SYS/broker/log/M/susbcribe or $SYS/broker/log/M/unsubscribe.\n#\n# The file destination requires an additional parameter which is the file to be\n# logged to, e.g. \"log_dest file /var/log/mosquitto.log\". The file will be\n# closed and reopened when the broker receives a HUP signal. Only a single file\n# destination may be configured.\n#\n# The dlt destination is for the automotive `Diagnostic Log and Trace` tool.\n# This requires that Mosquitto has been compiled with DLT support.\n#\n# Note that if the broker is running as a Windows service it will default to\n# \"log_dest none\" and neither stdout nor stderr logging is available.\n# Use \"log_dest none\" if you wish to disable logging.\n#log_dest stderr\n\n# Types of messages to log. Use multiple log_type lines for logging\n# multiple types of messages.\n# Possible types are: debug, error, warning, notice, information,\n# none, subscribe, unsubscribe, websockets, all.\n# Note that debug type messages are for decoding the incoming/outgoing\n# network packets. They are not logged in \"topics\".\n#log_type error\n#log_type warning\n#log_type notice\n#log_type information\n\n\n# If set to true, client connection and disconnection messages will be included\n# in the log.\n#connection_messages true\n\n# If using syslog logging (not on Windows), messages will be logged to the\n# \"daemon\" facility by default. Use the log_facility option to choose which of\n# local0 to local7 to log to instead. The option value should be an integer\n# value, e.g. \"log_facility 5\" to use local5.\n#log_facility\n\n# If set to true, add a timestamp value to each log message.\n#log_timestamp true\n\n# Set the format of the log timestamp. If left unset, this is the number of\n# seconds since the Unix epoch.\n# This is a free text string which will be passed to the strftime function. To\n# get an ISO 8601 datetime, for example:\n# log_timestamp_format %Y-%m-%dT%H:%M:%S\n#log_timestamp_format\n\n# Change the websockets logging level. This is a global option, it is not\n# possible to set per listener. This is an integer that is interpreted by\n# libwebsockets as a bit mask for its lws_log_levels enum. See the\n# libwebsockets documentation for more details. \"log_type websockets\" must also\n# be enabled.\n#websockets_log_level 0\n\n\n# =================================================================\n# Security\n# =================================================================\n\n# If set, only clients that have a matching prefix on their\n# clientid will be allowed to connect to the broker. By default,\n# all clients may connect.\n# For example, setting \"secure-\" here would mean a client \"secure-\n# client\" could connect but another with clientid \"mqtt\" couldn't.\n#clientid_prefixes\n\n# Boolean value that determines whether clients that connect\n# without providing a username are allowed to connect. If set to\n# false then a password file should be created (see the\n# password_file option) to control authenticated client access.\n#\n# Defaults to false, unless there are no listeners defined in the configuration\n# file, in which case it is set to true, but connections are only allowed from\n# the local machine.\n#allow_anonymous false\n\n# -----------------------------------------------------------------\n# Default authentication and topic access control\n# -----------------------------------------------------------------\n\n# Control access to the broker using a password file. This file can be\n# generated using the mosquitto_passwd utility. If TLS support is not compiled\n# into mosquitto (it is recommended that TLS support should be included) then\n# plain text passwords are used, in which case the file should be a text file\n# with lines in the format:\n# username:password\n# The password (and colon) may be omitted if desired, although this\n# offers very little in the way of security.\n#\n# See the TLS client require_certificate and use_identity_as_username options\n# for alternative authentication options. If a plugin is used as well as\n# password_file, the plugin check will be made first.\n#password_file\n\n# Access may also be controlled using a pre-shared-key file. This requires\n# TLS-PSK support and a listener configured to use it. The file should be text\n# lines in the format:\n# identity:key\n# The key should be in hexadecimal format without a leading \"0x\".\n# If an plugin is used as well, the plugin check will be made first.\n#psk_file\n\n# Control access to topics on the broker using an access control list\n# file. If this parameter is defined then only the topics listed will\n# have access.\n# If the first character of a line of the ACL file is a # it is treated as a\n# comment.\n# Topic access is added with lines of the format:\n#\n# topic [read|write|readwrite|deny] &lt;topic&gt;\n#\n# The access type is controlled using \"read\", \"write\", \"readwrite\" or \"deny\".\n# This parameter is optional (unless &lt;topic&gt; contains a space character) - if\n# not given then the access is read/write.  &lt;topic&gt; can contain the + or #\n# wildcards as in subscriptions.\n#\n# The \"deny\" option can used to explicity deny access to a topic that would\n# otherwise be granted by a broader read/write/readwrite statement. Any \"deny\"\n# topics are handled before topics that grant read/write access.\n#\n# The first set of topics are applied to anonymous clients, assuming\n# allow_anonymous is true. User specific topic ACLs are added after a\n# user line as follows:\n#\n# user &lt;username&gt;\n#\n# The username referred to here is the same as in password_file. It is\n# not the clientid.\n#\n#\n# If is also possible to define ACLs based on pattern substitution within the\n# topic. The patterns available for substition are:\n#\n# %c to match the client id of the client\n# %u to match the username of the client\n#\n# The substitution pattern must be the only text for that level of hierarchy.\n#\n# The form is the same as for the topic keyword, but using pattern as the\n# keyword.\n# Pattern ACLs apply to all users even if the \"user\" keyword has previously\n# been given.\n#\n# If using bridges with usernames and ACLs, connection messages can be allowed\n# with the following pattern:\n# pattern write $SYS/broker/connection/%c/state\n#\n# pattern [read|write|readwrite] &lt;topic&gt;\n#\n# Example:\n#\n# pattern write sensor/%u/data\n#\n# If an plugin is used as well as acl_file, the plugin check will be\n# made first.\n#acl_file\n\n# -----------------------------------------------------------------\n# External authentication and topic access plugin options\n# -----------------------------------------------------------------\n\n# External authentication and access control can be supported with the\n# plugin option. This is a path to a loadable plugin. See also the\n# plugin_opt_* options described below.\n#\n# The plugin option can be specified multiple times to load multiple\n# plugins. The plugins will be processed in the order that they are specified\n# here. If the plugin option is specified alongside either of\n# password_file or acl_file then the plugin checks will be made first.\n#\n# If the per_listener_settings option is false, the plugin will be apply to all\n# listeners. If per_listener_settings is true, then the plugin will apply to\n# the current listener being defined only.\n#\n# This option is also available as `auth_plugin`, but this use is deprecated\n# and will be removed in the future.\n#\n#plugin\n\n# If the plugin option above is used, define options to pass to the\n# plugin here as described by the plugin instructions. All options named\n# using the format plugin_opt_* will be passed to the plugin, for example:\n#\n# This option is also available as `auth_opt_*`, but this use is deprecated\n# and will be removed in the future.\n#\n# plugin_opt_db_host\n# plugin_opt_db_port\n# plugin_opt_db_username\n# plugin_opt_db_password\n\n\n# =================================================================\n# Bridges\n# =================================================================\n\n# A bridge is a way of connecting multiple MQTT brokers together.\n# Create a new bridge using the \"connection\" option as described below. Set\n# options for the bridges using the remaining parameters. You must specify the\n# address and at least one topic to subscribe to.\n#\n# Each connection must have a unique name.\n#\n# The address line may have multiple host address and ports specified. See\n# below in the round_robin description for more details on bridge behaviour if\n# multiple addresses are used. Note that if you use an IPv6 address, then you\n# are required to specify a port.\n#\n# The direction that the topic will be shared can be chosen by\n# specifying out, in or both, where the default value is out.\n# The QoS level of the bridged communication can be specified with the next\n# topic option. The default QoS level is 0, to change the QoS the topic\n# direction must also be given.\n#\n# The local and remote prefix options allow a topic to be remapped when it is\n# bridged to/from the remote broker. This provides the ability to place a topic\n# tree in an appropriate location.\n#\n# For more details see the mosquitto.conf man page.\n#\n# Multiple topics can be specified per connection, but be careful\n# not to create any loops.\n#\n# If you are using bridges with cleansession set to false (the default), then\n# you may get unexpected behaviour from incoming topics if you change what\n# topics you are subscribing to. This is because the remote broker keeps the\n# subscription for the old topic. If you have this problem, connect your bridge\n# with cleansession set to true, then reconnect with cleansession set to false\n# as normal.\n#connection &lt;name&gt;\n#address &lt;host&gt;[:&lt;port&gt;] [&lt;host&gt;[:&lt;port&gt;]]\n#topic &lt;topic&gt; [[[out | in | both] qos-level] local-prefix remote-prefix]\n\n# If you need to have the bridge connect over a particular network interface,\n# use bridge_bind_address to tell the bridge which local IP address the socket\n# should bind to, e.g. `bridge_bind_address 192.168.1.10`\n#bridge_bind_address\n\n# If a bridge has topics that have \"out\" direction, the default behaviour is to\n# send an unsubscribe request to the remote broker on that topic. This means\n# that changing a topic direction from \"in\" to \"out\" will not keep receiving\n# incoming messages. Sending these unsubscribe requests is not always\n# desirable, setting bridge_attempt_unsubscribe to false will disable sending\n# the unsubscribe request.\n#bridge_attempt_unsubscribe true\n\n# Set the version of the MQTT protocol to use with for this bridge. Can be one\n# of mqttv50, mqttv311 or mqttv31. Defaults to mqttv311.\n#bridge_protocol_version mqttv311\n\n# Set the clean session variable for this bridge.\n# When set to true, when the bridge disconnects for any reason, all\n# messages and subscriptions will be cleaned up on the remote\n# broker. Note that with cleansession set to true, there may be a\n# significant amount of retained messages sent when the bridge\n# reconnects after losing its connection.\n# When set to false, the subscriptions and messages are kept on the\n# remote broker, and delivered when the bridge reconnects.\n#cleansession false\n\n# Set the amount of time a bridge using the lazy start type must be idle before\n# it will be stopped. Defaults to 60 seconds.\n#idle_timeout 60\n\n# Set the keepalive interval for this bridge connection, in\n# seconds.\n#keepalive_interval 60\n\n# Set the clientid to use on the local broker. If not defined, this defaults to\n# 'local.&lt;clientid&gt;'. If you are bridging a broker to itself, it is important\n# that local_clientid and clientid do not match.\n#local_clientid\n\n# If set to true, publish notification messages to the local and remote brokers\n# giving information about the state of the bridge connection. Retained\n# messages are published to the topic $SYS/broker/connection/&lt;clientid&gt;/state\n# unless the notification_topic option is used.\n# If the message is 1 then the connection is active, or 0 if the connection has\n# failed.\n# This uses the last will and testament feature.\n#notifications true\n\n# Choose the topic on which notification messages for this bridge are\n# published. If not set, messages are published on the topic\n# $SYS/broker/connection/&lt;clientid&gt;/state\n#notification_topic\n\n# Set the client id to use on the remote end of this bridge connection. If not\n# defined, this defaults to 'name.hostname' where name is the connection name\n# and hostname is the hostname of this computer.\n# This replaces the old \"clientid\" option to avoid confusion. \"clientid\"\n# remains valid for the time being.\n#remote_clientid\n\n# Set the password to use when connecting to a broker that requires\n# authentication. This option is only used if remote_username is also set.\n# This replaces the old \"password\" option to avoid confusion. \"password\"\n# remains valid for the time being.\n#remote_password\n\n# Set the username to use when connecting to a broker that requires\n# authentication.\n# This replaces the old \"username\" option to avoid confusion. \"username\"\n# remains valid for the time being.\n#remote_username\n\n# Set the amount of time a bridge using the automatic start type will wait\n# until attempting to reconnect.\n# This option can be configured to use a constant delay time in seconds, or to\n# use a backoff mechanism based on \"Decorrelated Jitter\", which adds a degree\n# of randomness to when the restart occurs.\n#\n# Set a constant timeout of 20 seconds:\n# restart_timeout 20\n#\n# Set backoff with a base (start value) of 10 seconds and a cap (upper limit) of\n# 60 seconds:\n# restart_timeout 10 30\n#\n# Defaults to jitter with a base of 5 and cap of 30\n#restart_timeout 5 30\n\n# If the bridge has more than one address given in the address/addresses\n# configuration, the round_robin option defines the behaviour of the bridge on\n# a failure of the bridge connection. If round_robin is false, the default\n# value, then the first address is treated as the main bridge connection. If\n# the connection fails, the other secondary addresses will be attempted in\n# turn. Whilst connected to a secondary bridge, the bridge will periodically\n# attempt to reconnect to the main bridge until successful.\n# If round_robin is true, then all addresses are treated as equals. If a\n# connection fails, the next address will be tried and if successful will\n# remain connected until it fails\n#round_robin false\n\n# Set the start type of the bridge. This controls how the bridge starts and\n# can be one of three types: automatic, lazy and once. Note that RSMB provides\n# a fourth start type \"manual\" which isn't currently supported by mosquitto.\n#\n# \"automatic\" is the default start type and means that the bridge connection\n# will be started automatically when the broker starts and also restarted\n# after a short delay (30 seconds) if the connection fails.\n#\n# Bridges using the \"lazy\" start type will be started automatically when the\n# number of queued messages exceeds the number set with the \"threshold\"\n# parameter. It will be stopped automatically after the time set by the\n# \"idle_timeout\" parameter. Use this start type if you wish the connection to\n# only be active when it is needed.\n#\n# A bridge using the \"once\" start type will be started automatically when the\n# broker starts but will not be restarted if the connection fails.\n#start_type automatic\n\n# Set the number of messages that need to be queued for a bridge with lazy\n# start type to be restarted. Defaults to 10 messages.\n# Must be less than max_queued_messages.\n#threshold 10\n\n# If try_private is set to true, the bridge will attempt to indicate to the\n# remote broker that it is a bridge not an ordinary client. If successful, this\n# means that loop detection will be more effective and that retained messages\n# will be propagated correctly. Not all brokers support this feature so it may\n# be necessary to set try_private to false if your bridge does not connect\n# properly.\n#try_private true\n\n# Some MQTT brokers do not allow retained messages. MQTT v5 gives a mechanism\n# for brokers to tell clients that they do not support retained messages, but\n# this is not possible for MQTT v3.1.1 or v3.1. If you need to bridge to a\n# v3.1.1 or v3.1 broker that does not support retained messages, set the\n# bridge_outgoing_retain option to false. This will remove the retain bit on\n# all outgoing messages to that bridge, regardless of any other setting.\n#bridge_outgoing_retain true\n\n# If you wish to restrict the size of messages sent to a remote bridge, use the\n# bridge_max_packet_size option. This sets the maximum number of bytes for\n# the total message, including headers and payload.\n# Note that MQTT v5 brokers may provide their own maximum-packet-size property.\n# In this case, the smaller of the two limits will be used.\n# Set to 0 for \"unlimited\".\n#bridge_max_packet_size 0\n\n\n# -----------------------------------------------------------------\n# Certificate based SSL/TLS support\n# -----------------------------------------------------------------\n# Either bridge_cafile or bridge_capath must be defined to enable TLS support\n# for this bridge.\n# bridge_cafile defines the path to a file containing the\n# Certificate Authority certificates that have signed the remote broker\n# certificate.\n# bridge_capath defines a directory that will be searched for files containing\n# the CA certificates. For bridge_capath to work correctly, the certificate\n# files must have \".crt\" as the file ending and you must run \"openssl rehash\n# &lt;path to capath&gt;\" each time you add/remove a certificate.\n#bridge_cafile\n#bridge_capath\n\n\n# If the remote broker has more than one protocol available on its port, e.g.\n# MQTT and WebSockets, then use bridge_alpn to configure which protocol is\n# requested. Note that WebSockets support for bridges is not yet available.\n#bridge_alpn\n\n# When using certificate based encryption, bridge_insecure disables\n# verification of the server hostname in the server certificate. This can be\n# useful when testing initial server configurations, but makes it possible for\n# a malicious third party to impersonate your server through DNS spoofing, for\n# example. Use this option in testing only. If you need to resort to using this\n# option in a production environment, your setup is at fault and there is no\n# point using encryption.\n#bridge_insecure false\n\n# Path to the PEM encoded client certificate, if required by the remote broker.\n#bridge_certfile\n\n# Path to the PEM encoded client private key, if required by the remote broker.\n#bridge_keyfile\n\n# -----------------------------------------------------------------\n# PSK based SSL/TLS support\n# -----------------------------------------------------------------\n# Pre-shared-key encryption provides an alternative to certificate based\n# encryption. A bridge can be configured to use PSK with the bridge_identity\n# and bridge_psk options. These are the client PSK identity, and pre-shared-key\n# in hexadecimal format with no \"0x\". Only one of certificate and PSK based\n# encryption can be used on one\n# bridge at once.\n#bridge_identity\n#bridge_psk\n\n\n# =================================================================\n# External config files\n# =================================================================\n\n# External configuration files may be included by using the\n# include_dir option. This defines a directory that will be searched\n# for config files. All files that end in '.conf' will be loaded as\n# a configuration file. It is best to have this as the last option\n# in the main file. This option will only be processed from the main\n# configuration file. The directory specified must not contain the\n# main configuration file.\n# Files within include_dir will be loaded sorted in case-sensitive\n# alphabetical order, with capital letters ordered first. If this option is\n# given multiple times, all of the files from the first instance will be\n# processed before the next instance. See the man page for examples.\n#include_dir\n</code></pre> <pre><code># Config file for mosquitto\n#\n# See mosquitto.conf(5) for more information.\n#\n# Default values are shown, uncomment to change.\n#\n# Use the # character to indicate a comment, but only if it is the\n# very first character on the line.\n\n# =================================================================\n# General configuration\n# =================================================================\n\n# Use per listener security settings.\n#\n# It is recommended this option be set before any other options.\n#\n# If this option is set to true, then all authentication and access control\n# options are controlled on a per listener basis. The following options are\n# affected:\n#\n# acl_file\n# allow_anonymous\n# allow_zero_length_clientid\n# auto_id_prefix\n# password_file\n# plugin\n# plugin_opt_*\n# psk_file\n#\n# Note that if set to true, then a durable client (i.e. with clean session set\n# to false) that has disconnected will use the ACL settings defined for the\n# listener that it was most recently connected to.\n#\n# The default behaviour is for this to be set to false, which maintains the\n# setting behaviour from previous versions of mosquitto.\n#per_listener_settings false\n\n\n# This option controls whether a client is allowed to connect with a zero\n# length client id or not. This option only affects clients using MQTT v3.1.1\n# and later. If set to false, clients connecting with a zero length client id\n# are disconnected. If set to true, clients will be allocated a client id by\n# the broker. This means it is only useful for clients with clean session set\n# to true.\n#allow_zero_length_clientid true\n\n# If allow_zero_length_clientid is true, this option allows you to set a prefix\n# to automatically generated client ids to aid visibility in logs.\n# Defaults to 'auto-'\n#auto_id_prefix auto-\n\n# This option affects the scenario when a client subscribes to a topic that has\n# retained messages. It is possible that the client that published the retained\n# message to the topic had access at the time they published, but that access\n# has been subsequently removed. If check_retain_source is set to true, the\n# default, the source of a retained message will be checked for access rights\n# before it is republished. When set to false, no check will be made and the\n# retained message will always be published. This affects all listeners.\n#check_retain_source true\n\n# QoS 1 and 2 messages will be allowed inflight per client until this limit\n# is exceeded.  Defaults to 0. (No maximum)\n# See also max_inflight_messages\n#max_inflight_bytes 0\n\n# The maximum number of QoS 1 and 2 messages currently inflight per\n# client.\n# This includes messages that are partway through handshakes and\n# those that are being retried. Defaults to 20. Set to 0 for no\n# maximum. Setting to 1 will guarantee in-order delivery of QoS 1\n# and 2 messages.\n#max_inflight_messages 20\n\n# For MQTT v5 clients, it is possible to have the server send a \"server\n# keepalive\" value that will override the keepalive value set by the client.\n# This is intended to be used as a mechanism to say that the server will\n# disconnect the client earlier than it anticipated, and that the client should\n# use the new keepalive value. The max_keepalive option allows you to specify\n# that clients may only connect with keepalive less than or equal to this\n# value, otherwise they will be sent a server keepalive telling them to use\n# max_keepalive. This only applies to MQTT v5 clients. The default, and maximum\n# value allowable, is 65535.\n#\n# Set to 0 to allow clients to set keepalive = 0, which means no keepalive\n# checks are made and the client will never be disconnected by the broker if no\n# messages are received. You should be very sure this is the behaviour that you\n# want.\n#\n# For MQTT v3.1.1 and v3.1 clients, there is no mechanism to tell the client\n# what keepalive value they should use. If an MQTT v3.1.1 or v3.1 client\n# specifies a keepalive time greater than max_keepalive they will be sent a\n# CONNACK message with the \"identifier rejected\" reason code, and disconnected.\n#\n#max_keepalive 65535\n\n# For MQTT v5 clients, it is possible to have the server send a \"maximum packet\n# size\" value that will instruct the client it will not accept MQTT packets\n# with size greater than max_packet_size bytes. This applies to the full MQTT\n# packet, not just the payload. Setting this option to a positive value will\n# set the maximum packet size to that number of bytes. If a client sends a\n# packet which is larger than this value, it will be disconnected. This applies\n# to all clients regardless of the protocol version they are using, but v3.1.1\n# and earlier clients will of course not have received the maximum packet size\n# information. Defaults to no limit. Setting below 20 bytes is forbidden\n# because it is likely to interfere with ordinary client operation, even with\n# very small payloads.\n#max_packet_size 0\n\n# QoS 1 and 2 messages above those currently in-flight will be queued per\n# client until this limit is exceeded.  Defaults to 0. (No maximum)\n# See also max_queued_messages.\n# If both max_queued_messages and max_queued_bytes are specified, packets will\n# be queued until the first limit is reached.\n#max_queued_bytes 0\n\n# Set the maximum QoS supported. Clients publishing at a QoS higher than\n# specified here will be disconnected.\n#max_qos 2\n\n# The maximum number of QoS 1 and 2 messages to hold in a queue per client\n# above those that are currently in-flight.  Defaults to 1000. Set\n# to 0 for no maximum (not recommended).\n# See also queue_qos0_messages.\n# See also max_queued_bytes.\n#max_queued_messages 1000\n#\n# This option sets the maximum number of heap memory bytes that the broker will\n# allocate, and hence sets a hard limit on memory use by the broker.  Memory\n# requests that exceed this value will be denied. The effect will vary\n# depending on what has been denied. If an incoming message is being processed,\n# then the message will be dropped and the publishing client will be\n# disconnected. If an outgoing message is being sent, then the individual\n# message will be dropped and the receiving client will be disconnected.\n# Defaults to no limit.\n#memory_limit 0\n\n# This option sets the maximum publish payload size that the broker will allow.\n# Received messages that exceed this size will not be accepted by the broker.\n# The default value is 0, which means that all valid MQTT messages are\n# accepted. MQTT imposes a maximum payload size of 268435455 bytes.\n#message_size_limit 0\n\n# This option allows the session of persistent clients (those with clean\n# session set to false) that are not currently connected to be removed if they\n# do not reconnect within a certain time frame. This is a non-standard option\n# in MQTT v3.1. MQTT v3.1.1 and v5.0 allow brokers to remove client sessions.\n#\n# Badly designed clients may set clean session to false whilst using a randomly\n# generated client id. This leads to persistent clients that connect once and\n# never reconnect. This option allows these clients to be removed.  This option\n# allows persistent clients (those with clean session set to false) to be\n# removed if they do not reconnect within a certain time frame.\n#\n# The expiration period should be an integer followed by one of h d w m y for\n# hour, day, week, month and year respectively. For example\n#\n# persistent_client_expiration 2m\n# persistent_client_expiration 14d\n# persistent_client_expiration 1y\n#\n# The default if not set is to never expire persistent clients.\npersistent_client_expiration 1d\n\n# Write process id to a file. Default is a blank string which means\n# a pid file shouldn't be written.\n# This should be set to /var/run/mosquitto/mosquitto.pid if mosquitto is\n# being run automatically on boot with an init script and\n# start-stop-daemon or similar.\npid_file /run/mosquitto/mosquitto.pid\n\n# Set to true to queue messages with QoS 0 when a persistent client is\n# disconnected. These messages are included in the limit imposed by\n# max_queued_messages and max_queued_bytes\n# Defaults to false.\n# This is a non-standard option for the MQTT v3.1 spec but is allowed in\n# v3.1.1.\n#queue_qos0_messages false\n\n# Set to false to disable retained message support. If a client publishes a\n# message with the retain bit set, it will be disconnected if this is set to\n# false.\n#retain_available true\n\n# Disable Nagle's algorithm on client sockets. This has the effect of reducing\n# latency of individual messages at the potential cost of increasing the number\n# of packets being sent.\nset_tcp_nodelay true\n\n# Time in seconds between updates of the $SYS tree.\n# Set to 0 to disable the publishing of the $SYS tree.\n#sys_interval 10\n\n# The MQTT specification requires that the QoS of a message delivered to a\n# subscriber is never upgraded to match the QoS of the subscription. Enabling\n# this option changes this behaviour. If upgrade_outgoing_qos is set true,\n# messages sent to a subscriber will always match the QoS of its subscription.\n# This is a non-standard option explicitly disallowed by the spec.\n#upgrade_outgoing_qos false\n\n# When run as root, drop privileges to this user and its primary\n# group.\n# Set to root to stay as root, but this is not recommended.\n# If set to \"mosquitto\", or left unset, and the \"mosquitto\" user does not exist\n# then it will drop privileges to the \"nobody\" user instead.\n# If run as a non-root user, this setting has no effect.\n# Note that on Windows this has no effect and so mosquitto should be started by\n# the user you wish it to run as.\nuser mosquitto\n\n# =================================================================\n# Listeners\n# =================================================================\n\n# Listen on a port/ip address combination. By using this variable\n# multiple times, mosquitto can listen on more than one port. If\n# this variable is used and neither bind_address nor port given,\n# then the default listener will not be started.\n# The port number to listen on must be given. Optionally, an ip\n# address or host name may be supplied as a second argument. In\n# this case, mosquitto will attempt to bind the listener to that\n# address and so restrict access to the associated network and\n# interface. By default, mosquitto will listen on all interfaces.\n# Note that for a websockets listener it is not possible to bind to a host\n# name.\n#\n# On systems that support Unix Domain Sockets, it is also possible\n# to create a # Unix socket rather than opening a TCP socket. In\n# this case, the port number should be set to 0 and a unix socket\n# path must be provided, e.g.\n# listener 0 /tmp/mosquitto.sock\n#\n# listener port-number [ip address/host name/unix socket path]\nlistener 1883\nlistener 8883\n\n# By default, a listener will attempt to listen on all supported IP protocol\n# versions. If you do not have an IPv4 or IPv6 interface you may wish to\n# disable support for either of those protocol versions. In particular, note\n# that due to the limitations of the websockets library, it will only ever\n# attempt to open IPv6 sockets if IPv6 support is compiled in, and so will fail\n# if IPv6 is not available.\n#\n# Set to `ipv4` to force the listener to only use IPv4, or set to `ipv6` to\n# force the listener to only use IPv6. If you want support for both IPv4 and\n# IPv6, then do not use the socket_domain option.\n#\n#socket_domain\n\n# Bind the listener to a specific interface. This is similar to\n# the [ip address/host name] part of the listener definition, but is useful\n# when an interface has multiple addresses or the address may change. If used\n# with the [ip address/host name] part of the listener definition, then the\n# bind_interface option will take priority.\n# Not available on Windows.\n#\n# Example: bind_interface eth0\n#bind_interface\n\n# When a listener is using the websockets protocol, it is possible to serve\n# http data as well. Set http_dir to a directory which contains the files you\n# wish to serve. If this option is not specified, then no normal http\n# connections will be possible.\n#http_dir\n\n# The maximum number of client connections to allow. This is\n# a per listener setting.\n# Default is -1, which means unlimited connections.\n# Note that other process limits mean that unlimited connections\n# are not really possible. Typically the default maximum number of\n# connections possible is around 1024.\n#max_connections -1\n\n# The listener can be restricted to operating within a topic hierarchy using\n# the mount_point option. This is achieved be prefixing the mount_point string\n# to all topics for any clients connected to this listener. This prefixing only\n# happens internally to the broker; the client will not see the prefix.\n#mount_point\n\n# Choose the protocol to use when listening.\n# This can be either mqtt or websockets.\n# Certificate based TLS may be used with websockets, except that only the\n# cafile, certfile, keyfile, ciphers, and ciphers_tls13 options are supported.\n#protocol mqtt\n\n# Set use_username_as_clientid to true to replace the clientid that a client\n# connected with with its username. This allows authentication to be tied to\n# the clientid, which means that it is possible to prevent one client\n# disconnecting another by using the same clientid.\n# If a client connects with no username it will be disconnected as not\n# authorised when this option is set to true.\n# Do not use in conjunction with clientid_prefixes.\n# See also use_identity_as_username.\n# This does not apply globally, but on a per-listener basis.\n#use_username_as_clientid\n\n# Change the websockets headers size. This is a global option, it is not\n# possible to set per listener. This option sets the size of the buffer used in\n# the libwebsockets library when reading HTTP headers. If you are passing large\n# header data such as cookies then you may need to increase this value. If left\n# unset, or set to 0, then the default of 1024 bytes will be used.\n#websockets_headers_size\n\n# -----------------------------------------------------------------\n# Certificate based SSL/TLS support\n# -----------------------------------------------------------------\n# The following options can be used to enable certificate based SSL/TLS support\n# for this listener. Note that the recommended port for MQTT over TLS is 8883,\n# but this must be set manually.\n#\n# See also the mosquitto-tls man page and the \"Pre-shared-key based SSL/TLS\n# support\" section. Only one of certificate or PSK encryption support can be\n# enabled for any listener.\n\n# Both of certfile and keyfile must be defined to enable certificate based\n# TLS encryption.\n\n# Path to the PEM encoded server certificate.\ncertfile /etc/mosquitto/mqtt_server.crt\n\n# Path to the PEM encoded keyfile.\nkeyfile /etc/mosquitto/mqtt_server.key\n\n# If you wish to control which encryption ciphers are used, use the ciphers\n# option. The list of available ciphers can be optained using the \"openssl\n# ciphers\" command and should be provided in the same format as the output of\n# that command. This applies to TLS 1.2 and earlier versions only. Use\n# ciphers_tls1.3 for TLS v1.3.\n#ciphers\n\n# Choose which TLS v1.3 ciphersuites are used for this listener.\n# Defaults to \"TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256\"\n#ciphers_tls1.3\n\n# If you have require_certificate set to true, you can create a certificate\n# revocation list file to revoke access to particular client certificates. If\n# you have done this, use crlfile to point to the PEM encoded revocation file.\n#crlfile\n\n# To allow the use of ephemeral DH key exchange, which provides forward\n# security, the listener must load DH parameters. This can be specified with\n# the dhparamfile option. The dhparamfile can be generated with the command\n# e.g. \"openssl dhparam -out dhparam.pem 2048\"\n#dhparamfile\n\n# By default an TLS enabled listener will operate in a similar fashion to a\n# https enabled web server, in that the server has a certificate signed by a CA\n# and the client will verify that it is a trusted certificate. The overall aim\n# is encryption of the network traffic. By setting require_certificate to true,\n# the client must provide a valid certificate in order for the network\n# connection to proceed. This allows access to the broker to be controlled\n# outside of the mechanisms provided by MQTT.\nrequire_certificate false\n\n# cafile and capath define methods of accessing the PEM encoded\n# Certificate Authority certificates that will be considered trusted when\n# checking incoming client certificates.\n# cafile defines the path to a file containing the CA certificates.\n# capath defines a directory that will be searched for files\n# containing the CA certificates. For capath to work correctly, the\n# certificate files must have \".crt\" as the file ending and you must run\n# \"openssl rehash &lt;path to capath&gt;\" each time you add/remove a certificate.\n#cafile\n#capath\n\n\n# If require_certificate is true, you may set use_identity_as_username to true\n# to use the CN value from the client certificate as a username. If this is\n# true, the password_file option will not be used for this listener.\n#use_identity_as_username false\n\n# -----------------------------------------------------------------\n# Pre-shared-key based SSL/TLS support\n# -----------------------------------------------------------------\n# The following options can be used to enable PSK based SSL/TLS support for\n# this listener. Note that the recommended port for MQTT over TLS is 8883, but\n# this must be set manually.\n#\n# See also the mosquitto-tls man page and the \"Certificate based SSL/TLS\n# support\" section. Only one of certificate or PSK encryption support can be\n# enabled for any listener.\n\n# The psk_hint option enables pre-shared-key support for this listener and also\n# acts as an identifier for this listener. The hint is sent to clients and may\n# be used locally to aid authentication. The hint is a free form string that\n# doesn't have much meaning in itself, so feel free to be creative.\n# If this option is provided, see psk_file to define the pre-shared keys to be\n# used or create a security plugin to handle them.\n#psk_hint\n\n# When using PSK, the encryption ciphers used will be chosen from the list of\n# available PSK ciphers. If you want to control which ciphers are available,\n# use the \"ciphers\" option.  The list of available ciphers can be optained\n# using the \"openssl ciphers\" command and should be provided in the same format\n# as the output of that command.\n#ciphers\n\n# Set use_identity_as_username to have the psk identity sent by the client used\n# as its username. Authentication will be carried out using the PSK rather than\n# the MQTT username/password and so password_file will not be used for this\n# listener.\n#use_identity_as_username false\n\n\n# =================================================================\n# Persistence\n# =================================================================\n\n# If persistence is enabled, save the in-memory database to disk\n# every autosave_interval seconds. If set to 0, the persistence\n# database will only be written when mosquitto exits. See also\n# autosave_on_changes.\n# Note that writing of the persistence database can be forced by\n# sending mosquitto a SIGUSR1 signal.\nautosave_interval 100\n\n# If true, mosquitto will count the number of subscription changes, retained\n# messages received and queued messages and if the total exceeds\n# autosave_interval then the in-memory database will be saved to disk.\n# If false, mosquitto will save the in-memory database to disk by treating\n# autosave_interval as a time in seconds.\nautosave_on_changes true\n\n# Save persistent message data to disk (true/false).\n# This saves information about all messages, including\n# subscriptions, currently in-flight messages and retained\n# messages.\n# retained_persistence is a synonym for this option.\npersistence true\n\n# The filename to use for the persistent database, not including\n# the path.\npersistence_file mosquitto.db\n\n# Location for persistent database.\n# Default is an empty string (current directory).\n# Set to e.g. /var/lib/mosquitto if running as a proper service on Linux or\n# similar.\npersistence_location /var/lib/mosquitto\n\n\n# =================================================================\n# Logging\n# =================================================================\n\n# Places to log to. Use multiple log_dest lines for multiple\n# logging destinations.\n# Possible destinations are: stdout stderr syslog topic file dlt\n#\n# stdout and stderr log to the console on the named output.\n#\n# syslog uses the userspace syslog facility which usually ends up\n# in /var/log/messages or similar.\n#\n# topic logs to the broker topic '$SYS/broker/log/&lt;severity&gt;',\n# where severity is one of D, E, W, N, I, M which are debug, error,\n# warning, notice, information and message. Message type severity is used by\n# the subscribe/unsubscribe log_types and publishes log messages to\n# $SYS/broker/log/M/susbcribe or $SYS/broker/log/M/unsubscribe.\n#\n# The file destination requires an additional parameter which is the file to be\n# logged to, e.g. \"log_dest file /var/log/mosquitto.log\". The file will be\n# closed and reopened when the broker receives a HUP signal. Only a single file\n# destination may be configured.\n#\n# The dlt destination is for the automotive `Diagnostic Log and Trace` tool.\n# This requires that Mosquitto has been compiled with DLT support.\n#\n# Note that if the broker is running as a Windows service it will default to\n# \"log_dest none\" and neither stdout nor stderr logging is available.\n# Use \"log_dest none\" if you wish to disable logging.\nlog_dest file /var/log/mosquitto/mosquitto.log\n\n# Types of messages to log. Use multiple log_type lines for logging\n# multiple types of messages.\n# Possible types are: debug, error, warning, notice, information,\n# none, subscribe, unsubscribe, websockets, all.\n# Note that debug type messages are for decoding the incoming/outgoing\n# network packets. They are not logged in \"topics\".\n#log_type error\n#log_type warning\n#log_type notice\n#log_type information\n\n\n# If set to true, client connection and disconnection messages will be included\n# in the log.\n#connection_messages true\n\n# If using syslog logging (not on Windows), messages will be logged to the\n# \"daemon\" facility by default. Use the log_facility option to choose which of\n# local0 to local7 to log to instead. The option value should be an integer\n# value, e.g. \"log_facility 5\" to use local5.\n#log_facility\n\n# If set to true, add a timestamp value to each log message.\nlog_timestamp true\n\n# Set the format of the log timestamp. If left unset, this is the number of\n# seconds since the Unix epoch.\n# This is a free text string which will be passed to the strftime function. To\n# get an ISO 8601 datetime, for example:\n# log_timestamp_format %Y-%m-%dT%H:%M:%S\nlog_timestamp_format %Y-%m-%dT%H:%M:%S\n\n# Change the websockets logging level. This is a global option, it is not\n# possible to set per listener. This is an integer that is interpreted by\n# libwebsockets as a bit mask for its lws_log_levels enum. See the\n# libwebsockets documentation for more details. \"log_type websockets\" must also\n# be enabled.\n#websockets_log_level 0\n\n\n# =================================================================\n# Security\n# =================================================================\n\n# If set, only clients that have a matching prefix on their\n# clientid will be allowed to connect to the broker. By default,\n# all clients may connect.\n# For example, setting \"secure-\" here would mean a client \"secure-\n# client\" could connect but another with clientid \"mqtt\" couldn't.\n#clientid_prefixes\n\n# Boolean value that determines whether clients that connect\n# without providing a username are allowed to connect. If set to\n# false then a password file should be created (see the\n# password_file option) to control authenticated client access.\n#\n# Defaults to false, unless there are no listeners defined in the configuration\n# file, in which case it is set to true, but connections are only allowed from\n# the local machine.\n#allow_anonymous false\n\n# -----------------------------------------------------------------\n# Default authentication and topic access control\n# -----------------------------------------------------------------\n\n# Control access to the broker using a password file. This file can be\n# generated using the mosquitto_passwd utility. If TLS support is not compiled\n# into mosquitto (it is recommended that TLS support should be included) then\n# plain text passwords are used, in which case the file should be a text file\n# with lines in the format:\n# username:password\n# The password (and colon) may be omitted if desired, although this\n# offers very little in the way of security.\n#\n# See the TLS client require_certificate and use_identity_as_username options\n# for alternative authentication options. If a plugin is used as well as\n# password_file, the plugin check will be made first.\npassword_file /etc/mosquitto/password_file\n\n# Access may also be controlled using a pre-shared-key file. This requires\n# TLS-PSK support and a listener configured to use it. The file should be text\n# lines in the format:\n# identity:key\n# The key should be in hexadecimal format without a leading \"0x\".\n# If an plugin is used as well, the plugin check will be made first.\n#psk_file\n\n# Control access to topics on the broker using an access control list\n# file. If this parameter is defined then only the topics listed will\n# have access.\n# If the first character of a line of the ACL file is a # it is treated as a\n# comment.\n# Topic access is added with lines of the format:\n#\n# topic [read|write|readwrite|deny] &lt;topic&gt;\n#\n# The access type is controlled using \"read\", \"write\", \"readwrite\" or \"deny\".\n# This parameter is optional (unless &lt;topic&gt; contains a space character) - if\n# not given then the access is read/write.  &lt;topic&gt; can contain the + or #\n# wildcards as in subscriptions.\n#\n# The \"deny\" option can used to explicity deny access to a topic that would\n# otherwise be granted by a broader read/write/readwrite statement. Any \"deny\"\n# topics are handled before topics that grant read/write access.\n#\n# The first set of topics are applied to anonymous clients, assuming\n# allow_anonymous is true. User specific topic ACLs are added after a\n# user line as follows:\n#\n# user &lt;username&gt;\n#\n# The username referred to here is the same as in password_file. It is\n# not the clientid.\n#\n#\n# If is also possible to define ACLs based on pattern substitution within the\n# topic. The patterns available for substition are:\n#\n# %c to match the client id of the client\n# %u to match the username of the client\n#\n# The substitution pattern must be the only text for that level of hierarchy.\n#\n# The form is the same as for the topic keyword, but using pattern as the\n# keyword.\n# Pattern ACLs apply to all users even if the \"user\" keyword has previously\n# been given.\n#\n# If using bridges with usernames and ACLs, connection messages can be allowed\n# with the following pattern:\n# pattern write $SYS/broker/connection/%c/state\n#\n# pattern [read|write|readwrite] &lt;topic&gt;\n#\n# Example:\n#\n# pattern write sensor/%u/data\n#\n# If an plugin is used as well as acl_file, the plugin check will be\n# made first.\n#acl_file\n\n# -----------------------------------------------------------------\n# External authentication and topic access plugin options\n# -----------------------------------------------------------------\n\n# External authentication and access control can be supported with the\n# plugin option. This is a path to a loadable plugin. See also the\n# plugin_opt_* options described below.\n#\n# The plugin option can be specified multiple times to load multiple\n# plugins. The plugins will be processed in the order that they are specified\n# here. If the plugin option is specified alongside either of\n# password_file or acl_file then the plugin checks will be made first.\n#\n# If the per_listener_settings option is false, the plugin will be apply to all\n# listeners. If per_listener_settings is true, then the plugin will apply to\n# the current listener being defined only.\n#\n# This option is also available as `auth_plugin`, but this use is deprecated\n# and will be removed in the future.\n#\n#plugin\n\n# If the plugin option above is used, define options to pass to the\n# plugin here as described by the plugin instructions. All options named\n# using the format plugin_opt_* will be passed to the plugin, for example:\n#\n# This option is also available as `auth_opt_*`, but this use is deprecated\n# and will be removed in the future.\n#\n# plugin_opt_db_host\n# plugin_opt_db_port\n# plugin_opt_db_username\n# plugin_opt_db_password\n\n\n# =================================================================\n# Bridges\n# =================================================================\n\n# A bridge is a way of connecting multiple MQTT brokers together.\n# Create a new bridge using the \"connection\" option as described below. Set\n# options for the bridges using the remaining parameters. You must specify the\n# address and at least one topic to subscribe to.\n#\n# Each connection must have a unique name.\n#\n# The address line may have multiple host address and ports specified. See\n# below in the round_robin description for more details on bridge behaviour if\n# multiple addresses are used. Note that if you use an IPv6 address, then you\n# are required to specify a port.\n#\n# The direction that the topic will be shared can be chosen by\n# specifying out, in or both, where the default value is out.\n# The QoS level of the bridged communication can be specified with the next\n# topic option. The default QoS level is 0, to change the QoS the topic\n# direction must also be given.\n#\n# The local and remote prefix options allow a topic to be remapped when it is\n# bridged to/from the remote broker. This provides the ability to place a topic\n# tree in an appropriate location.\n#\n# For more details see the mosquitto.conf man page.\n#\n# Multiple topics can be specified per connection, but be careful\n# not to create any loops.\n#\n# If you are using bridges with cleansession set to false (the default), then\n# you may get unexpected behaviour from incoming topics if you change what\n# topics you are subscribing to. This is because the remote broker keeps the\n# subscription for the old topic. If you have this problem, connect your bridge\n# with cleansession set to true, then reconnect with cleansession set to false\n# as normal.\n#connection &lt;name&gt;\n#address &lt;host&gt;[:&lt;port&gt;] [&lt;host&gt;[:&lt;port&gt;]]\n#topic &lt;topic&gt; [[[out | in | both] qos-level] local-prefix remote-prefix]\n\n# If you need to have the bridge connect over a particular network interface,\n# use bridge_bind_address to tell the bridge which local IP address the socket\n# should bind to, e.g. `bridge_bind_address 192.168.1.10`\n#bridge_bind_address\n\n# If a bridge has topics that have \"out\" direction, the default behaviour is to\n# send an unsubscribe request to the remote broker on that topic. This means\n# that changing a topic direction from \"in\" to \"out\" will not keep receiving\n# incoming messages. Sending these unsubscribe requests is not always\n# desirable, setting bridge_attempt_unsubscribe to false will disable sending\n# the unsubscribe request.\n#bridge_attempt_unsubscribe true\n\n# Set the version of the MQTT protocol to use with for this bridge. Can be one\n# of mqttv50, mqttv311 or mqttv31. Defaults to mqttv311.\n#bridge_protocol_version mqttv311\n\n# Set the clean session variable for this bridge.\n# When set to true, when the bridge disconnects for any reason, all\n# messages and subscriptions will be cleaned up on the remote\n# broker. Note that with cleansession set to true, there may be a\n# significant amount of retained messages sent when the bridge\n# reconnects after losing its connection.\n# When set to false, the subscriptions and messages are kept on the\n# remote broker, and delivered when the bridge reconnects.\n#cleansession false\n\n# Set the amount of time a bridge using the lazy start type must be idle before\n# it will be stopped. Defaults to 60 seconds.\n#idle_timeout 60\n\n# Set the keepalive interval for this bridge connection, in\n# seconds.\n#keepalive_interval 60\n\n# Set the clientid to use on the local broker. If not defined, this defaults to\n# 'local.&lt;clientid&gt;'. If you are bridging a broker to itself, it is important\n# that local_clientid and clientid do not match.\n#local_clientid\n\n# If set to true, publish notification messages to the local and remote brokers\n# giving information about the state of the bridge connection. Retained\n# messages are published to the topic $SYS/broker/connection/&lt;clientid&gt;/state\n# unless the notification_topic option is used.\n# If the message is 1 then the connection is active, or 0 if the connection has\n# failed.\n# This uses the last will and testament feature.\n#notifications true\n\n# Choose the topic on which notification messages for this bridge are\n# published. If not set, messages are published on the topic\n# $SYS/broker/connection/&lt;clientid&gt;/state\n#notification_topic\n\n# Set the client id to use on the remote end of this bridge connection. If not\n# defined, this defaults to 'name.hostname' where name is the connection name\n# and hostname is the hostname of this computer.\n# This replaces the old \"clientid\" option to avoid confusion. \"clientid\"\n# remains valid for the time being.\n#remote_clientid\n\n# Set the password to use when connecting to a broker that requires\n# authentication. This option is only used if remote_username is also set.\n# This replaces the old \"password\" option to avoid confusion. \"password\"\n# remains valid for the time being.\n#remote_password\n\n# Set the username to use when connecting to a broker that requires\n# authentication.\n# This replaces the old \"username\" option to avoid confusion. \"username\"\n# remains valid for the time being.\n#remote_username\n\n# Set the amount of time a bridge using the automatic start type will wait\n# until attempting to reconnect.\n# This option can be configured to use a constant delay time in seconds, or to\n# use a backoff mechanism based on \"Decorrelated Jitter\", which adds a degree\n# of randomness to when the restart occurs.\n#\n# Set a constant timeout of 20 seconds:\n# restart_timeout 20\n#\n# Set backoff with a base (start value) of 10 seconds and a cap (upper limit) of\n# 60 seconds:\n# restart_timeout 10 30\n#\n# Defaults to jitter with a base of 5 and cap of 30\n#restart_timeout 5 30\n\n# If the bridge has more than one address given in the address/addresses\n# configuration, the round_robin option defines the behaviour of the bridge on\n# a failure of the bridge connection. If round_robin is false, the default\n# value, then the first address is treated as the main bridge connection. If\n# the connection fails, the other secondary addresses will be attempted in\n# turn. Whilst connected to a secondary bridge, the bridge will periodically\n# attempt to reconnect to the main bridge until successful.\n# If round_robin is true, then all addresses are treated as equals. If a\n# connection fails, the next address will be tried and if successful will\n# remain connected until it fails\n#round_robin false\n\n# Set the start type of the bridge. This controls how the bridge starts and\n# can be one of three types: automatic, lazy and once. Note that RSMB provides\n# a fourth start type \"manual\" which isn't currently supported by mosquitto.\n#\n# \"automatic\" is the default start type and means that the bridge connection\n# will be started automatically when the broker starts and also restarted\n# after a short delay (30 seconds) if the connection fails.\n#\n# Bridges using the \"lazy\" start type will be started automatically when the\n# number of queued messages exceeds the number set with the \"threshold\"\n# parameter. It will be stopped automatically after the time set by the\n# \"idle_timeout\" parameter. Use this start type if you wish the connection to\n# only be active when it is needed.\n#\n# A bridge using the \"once\" start type will be started automatically when the\n# broker starts but will not be restarted if the connection fails.\n#start_type automatic\n\n# Set the number of messages that need to be queued for a bridge with lazy\n# start type to be restarted. Defaults to 10 messages.\n# Must be less than max_queued_messages.\n#threshold 10\n\n# If try_private is set to true, the bridge will attempt to indicate to the\n# remote broker that it is a bridge not an ordinary client. If successful, this\n# means that loop detection will be more effective and that retained messages\n# will be propagated correctly. Not all brokers support this feature so it may\n# be necessary to set try_private to false if your bridge does not connect\n# properly.\n#try_private true\n\n# Some MQTT brokers do not allow retained messages. MQTT v5 gives a mechanism\n# for brokers to tell clients that they do not support retained messages, but\n# this is not possible for MQTT v3.1.1 or v3.1. If you need to bridge to a\n# v3.1.1 or v3.1 broker that does not support retained messages, set the\n# bridge_outgoing_retain option to false. This will remove the retain bit on\n# all outgoing messages to that bridge, regardless of any other setting.\n#bridge_outgoing_retain true\n\n# If you wish to restrict the size of messages sent to a remote bridge, use the\n# bridge_max_packet_size option. This sets the maximum number of bytes for\n# the total message, including headers and payload.\n# Note that MQTT v5 brokers may provide their own maximum-packet-size property.\n# In this case, the smaller of the two limits will be used.\n# Set to 0 for \"unlimited\".\n#bridge_max_packet_size 0\n\n\n# -----------------------------------------------------------------\n# Certificate based SSL/TLS support\n# -----------------------------------------------------------------\n# Either bridge_cafile or bridge_capath must be defined to enable TLS support\n# for this bridge.\n# bridge_cafile defines the path to a file containing the\n# Certificate Authority certificates that have signed the remote broker\n# certificate.\n# bridge_capath defines a directory that will be searched for files containing\n# the CA certificates. For bridge_capath to work correctly, the certificate\n# files must have \".crt\" as the file ending and you must run \"openssl rehash\n# &lt;path to capath&gt;\" each time you add/remove a certificate.\n#bridge_cafile\n#bridge_capath\n\n\n# If the remote broker has more than one protocol available on its port, e.g.\n# MQTT and WebSockets, then use bridge_alpn to configure which protocol is\n# requested. Note that WebSockets support for bridges is not yet available.\n#bridge_alpn\n\n# When using certificate based encryption, bridge_insecure disables\n# verification of the server hostname in the server certificate. This can be\n# useful when testing initial server configurations, but makes it possible for\n# a malicious third party to impersonate your server through DNS spoofing, for\n# example. Use this option in testing only. If you need to resort to using this\n# option in a production environment, your setup is at fault and there is no\n# point using encryption.\n#bridge_insecure false\n\n# Path to the PEM encoded client certificate, if required by the remote broker.\n#bridge_certfile\n\n# Path to the PEM encoded client private key, if required by the remote broker.\n#bridge_keyfile\n\n# -----------------------------------------------------------------\n# PSK based SSL/TLS support\n# -----------------------------------------------------------------\n# Pre-shared-key encryption provides an alternative to certificate based\n# encryption. A bridge can be configured to use PSK with the bridge_identity\n# and bridge_psk options. These are the client PSK identity, and pre-shared-key\n# in hexadecimal format with no \"0x\". Only one of certificate and PSK based\n# encryption can be used on one\n# bridge at once.\n#bridge_identity\n#bridge_psk\n\n\n# =================================================================\n# External config files\n# =================================================================\n\n# External configuration files may be included by using the\n# include_dir option. This defines a directory that will be searched\n# for config files. All files that end in '.conf' will be loaded as\n# a configuration file. It is best to have this as the last option\n# in the main file. This option will only be processed from the main\n# configuration file. The directory specified must not contain the\n# main configuration file.\n# Files within include_dir will be loaded sorted in case-sensitive\n# alphabetical order, with capital letters ordered first. If this option is\n# given multiple times, all of the files from the first instance will be\n# processed before the next instance. See the man page for examples.\n#include_dir\n</code></pre> </li> <li> <p>\u4fee\u6539\u914d\u7f6e\u76ee\u5f55\u7684\u5c5e\u7ec4\u548c\u5c5e\u4e3b</p> <pre><code>chown -R mosquitto:mosquitto /etc/mosquitto\n</code></pre> </li> <li> <p>\u8bbe\u7f6e\u9632\u706b\u5899</p> <pre><code>firewall-cmd --add-service={mqtt,mqtt-tls}\nfirewall-cmd --add-service={mqtt,mqtt-tls} --permanent\n</code></pre> </li> <li> <p>\u542f\u52a8\u670d\u52a1</p> <pre><code>systemctl start mosquitto\n</code></pre> </li> <li> <p>\u8bbe\u7f6e\u5f00\u673a\u81ea\u542f\u52a8</p> <pre><code>systemctl enable mosquitto\n</code></pre> <p>\u81f3\u6b64\uff0cMQTT server(broker)\u5df2\u5b89\u88c5\u5b8c\u6bd5\u3002</p> </li> </ol>","tags":["MQTT","Eclipse Mosquitto","Rocky Linux"]},{"location":"blog/2024/07/27/%E5%AE%89%E8%A3%85-mqtt-%E6%9C%8D%E5%8A%A1rocky-linux-9/#_1","title":"\u6d4b\u8bd5\u5ba2\u6237\u7aef\u662f\u5426\u53ef\u4ee5\u8fde\u63a5\u670d\u52a1\u7aef","text":"<ol> <li> <p>\u5b89\u88c5 MQTT \u56fe\u5f62\u5316\u5ba2\u6237\u7aef MQTTX\u3002\u6253\u5f00\u5b98\u7f51\u4e0b\u8f7d\u540e\uff0c\u65e0\u8111\u4e0b\u4e00\u6b65\u4e0b\u4e00\u6b65\u5373\u53ef\u3002</p> </li> <li> <p>\u65b0\u5efa\u8fde\u63a5</p> <p>\u4e0b\u56fe\u4ee5\u8fde\u63a5 8883 \u7aef\u53e3\uff08\u542f\u7528 TLS\uff09\u4e3a\u4f8b\uff0c\u5728\u8fd9\u79cd\u65b9\u5f0f\u4e0b\u6240\u6709 MQTT \u62a5\u6587\u4ee5\u5bc6\u6587\u5f62\u5f0f\u4f20\u8f93\u3002</p> <p>\u5982\u679c\u4f60\u4e0d\u60f3\u7528 TLS\uff0c\u90a3\u4e48\u5c31\u8fde\u63a5 1883 \u7aef\u53e3\uff08\u6240\u6709 MQTT \u62a5\u6587\u5c06\u4ee5\u660e\u6587\u5f62\u5f0f\u4f20\u8f93\uff09\uff0c\u76f8\u5e94\u7684\uff0c\u7b2c 3 \u5904\u3001\u7b2c 5 \u5904\u3001\u7b2c 8 \u5904\u90fd\u9700\u8981\u4fee\u6539\u3002</p> <p></p> </li> <li> <p>\u6210\u529f\u5efa\u7acb\u8fde\u63a5\u540e\u70b9\u51fb\u65b0\u5efa\u8ba2\u9605</p> <p></p> </li> <li> <p>\u8ba2\u9605\u4e3b\u9898\u8bbe\u7f6e\u4e3a hello</p> <p></p> </li> <li> <p>\u53d1\u9001 hello \u4e3b\u9898\u7684\u6d88\u606f</p> <p>\u5728\u4f4d\u7f6e 1 \u5904\u8f93\u5165\u4e3b\u9898\uff0c\u6d88\u606f\u5185\u5bb9\u7528\u9ed8\u8ba4\u7684\uff0c\u70b9\u51fb\u4f4d\u7f6e 2 \u5904\u7684\u53d1\u9001\uff0c\u53ef\u4ee5\u770b\u5230\u4f4d\u7f6e 3 \u5904\u53d1\u9001\u4e86\u6d88\u606f\uff0c\u4f4d\u7f6e 4 \u5904\u6536\u5230\u4e86\u6d88\u606f\u3002</p> <p>\u56e0\u4e3a\u6b64\u5ba2\u6237\u7aef\u8ba2\u9605\u4e86 hello \u4e3b\u9898\uff0c\u6240\u4ee5\u5728\u670d\u52a1\u7aef\u6536\u5230 hello \u4e3b\u9898\u7684\u6d88\u606f\u540e\uff0c\u53c8\u8f6c\u7ed9\u4e86\u6b64\u5ba2\u6237\u7aef\u3002\u5b9e\u9645\u5e94\u7528\u65f6\u4e0d\u4f1a\u8fd9\u6837\u8bbe\u7f6e\uff0c\u8fd9\u91cc\u53ea\u662f\u4e3a\u4e86\u9a8c\u8bc1\u670d\u52a1\u7aef\u662f\u5426\u53ef\u4ee5\u4e0e\u5ba2\u6237\u7aef\u4ea4\u4e92\u3002</p> <p></p> </li> </ol>","tags":["MQTT","Eclipse Mosquitto","Rocky Linux"]},{"location":"blog/2024/06/14/%E5%AE%89%E8%A3%85-mysql-57centos-7/","title":"\u5b89\u88c5 MySQL 5.7(CentOS 7)","text":"<p>\u5b89\u88c5\u76ee\u6807</p> <ul> <li> \u5b89\u88c5\u4e00\u4e2a MySQL \u670d\u52a1\u7aef\u5b9e\u4f8b\uff0c\u7248\u672c\u662f 5.7.44\u3002</li> <li> \u4e24\u79cd\u5b89\u88c5\u65b9\u6cd5\uff0c\u4e00\u79cd\u662f\u4f7f\u7528\u5b98\u65b9\u63d0\u4f9b\u7684 rpm \u5305\u8fdb\u884c\u5b89\u88c5\uff0c\u53e6\u4e00\u79cd\u662f\u4f7f\u7528\u6e90\u4ee3\u7801\u7f16\u8bd1\u5b89\u88c5\u3002</li> </ul> <p>\u524d\u7f6e\u6761\u4ef6</p> <ul> <li> \u5f85\u5b89\u88c5 MySQL \u7684\u673a\u5668\u80fd\u8bbf\u95ee yum \u4ed3\u5e93\u3002</li> </ul>"},{"location":"blog/2024/06/14/%E5%AE%89%E8%A3%85-mysql-57centos-7/#rpm","title":"\u901a\u8fc7\u5b98\u65b9 rpm \u5305\u5b89\u88c5","text":"<p>\u91cd\u8981</p> <p>5.7.44 \u7248\u672c\u662f 5.7 \u7cfb\u5217\u7684\u6700\u540e\u4e00\u4e2a\u7248\u672c\uff0c\u4e0d\u4f1a\u518d\u66f4\u65b0\u4e86\uff0c\u8be6\u89c1\u5b98\u65b9\u6587\u6863\u3002</p> <ol> <li> <p>\u6253\u5f00 MySQL \u5b98\u65b9\u4e0b\u8f7d\u5730\u5740https://downloads.mysql.com/archives/community/</p> <p>Product Version \u9009\u62e9 5.7.44\uff0cOperating System \u9009\u62e9 Red Hat Enterprise Linux / Oracle Linux\uff0cOS Version \u9009\u62e9 Red Hat Enterprise Linux 7 / Oracle Linux 7 (x86, 64-bit)\u3002\u70b9\u51fb RPM Bundle \u4e00\u680f\u7684 Download \u6309\u94ae\uff0c\u5f00\u59cb\u4e0b\u8f7d\u3002</p> <p></p> </li> <li> <p>\u5c06\u4e0a\u4e00\u6b65\u4e0b\u8f7d\u7684\u6587\u4ef6\u4e0a\u4f20\u5230\u88c5\u6709 CentOS 7 \u7684\u670d\u52a1\u5668\u4e0a\uff0c\u653e\u54ea\u91cc\u90fd\u53ef\u4ee5\u3002\u5728\u672c\u6587\u4e2d\uff0c\u6211\u5c06\u6587\u4ef6\u653e\u5728\u4e86/root/mysql_bundle \u76ee\u5f55\u4e0b\u3002\u6b64\u5904\u7684\u76ee\u5f55\u4ec5\u4ec5\u662f\u7528\u6765\u653e rpm \u5b89\u88c5\u5305\uff0c\u6700\u7ec8\u7684\u5b89\u88c5\u76ee\u5f55\u4e0d\u662f\u5b83\u3002</p> <pre><code>[root@localhost mysql_bundle]# ll\ntotal 557332\n-rw-r--r--. 1 root root 570705920 Jun 13 18:30 mysql-5.7.44-1.el7.x86_64.rpm-bundle.tar\n</code></pre> </li> <li> <p>\u89e3\u538b</p> <pre><code>[root@localhost mysql_bundle]# tar -xf mysql-5.7.44-1.el7.x86_64.rpm-bundle.tar\n</code></pre> </li> <li> <p>\u5b89\u88c5</p> <p><pre><code>[root@localhost mysql_bundle]# yum install mysql-community-{server,client,common,libs}-*\n</code></pre> \u4e0b\u9762\u662f yum \u547d\u4ee4\u6267\u884c\u540e\u7684\u4f9d\u8d56\u5206\u6790\uff0c\u53ef\u4ee5\u770b\u5230\u9664\u4e86\u4ece\u5b98\u7f51\u4e0b\u8f7d\u7684\u4ee5\u5916\uff0c\u8fd8\u9700\u8981\u4f9d\u8d56\u5f88\u591a\u5b89\u88c5\u5305\uff0c\u6bd4\u5982 net-tools\u3001perl \u7b49\u7b49\u3002\u8f93\u5165 y \u540e\u56de\u8f66\uff0c\u540c\u610f\u5b89\u88c5\u3002 <pre><code>Dependencies Resolved\n\n===========================================================================================================\nPackage                 Arch   Version             Repository                                        Size\n===========================================================================================================\nInstalling:\nmysql-community-client  x86_64 5.7.44-1.el7        /mysql-community-client-5.7.44-1.el7.x86_64      120 M\nmysql-community-common  x86_64 5.7.44-1.el7        /mysql-community-common-5.7.44-1.el7.x86_64      2.8 M\nmysql-community-libs    x86_64 5.7.44-1.el7        /mysql-community-libs-5.7.44-1.el7.x86_64         11 M\n    replacing  mariadb-libs.x86_64 1:5.5.68-1.el7\nmysql-community-libs-compat\n                        x86_64 5.7.44-1.el7        /mysql-community-libs-compat-5.7.44-1.el7.x86_64 6.0 M\n    replacing  mariadb-libs.x86_64 1:5.5.68-1.el7\nmysql-community-server  x86_64 5.7.44-1.el7        /mysql-community-server-5.7.44-1.el7.x86_64      796 M\nInstalling for dependencies:\nnet-tools               x86_64 2.0-0.25.20131004git.el7\n                                                    os                                               306 k\nperl                    x86_64 4:5.16.3-299.el7_9  updates                                          8.0 M\nperl-Carp               noarch 1.26-244.el7        os                                                19 k\nperl-Encode             x86_64 2.51-7.el7          os                                               1.5 M\nperl-Exporter           noarch 5.68-3.el7          os                                                28 k\nperl-File-Path          noarch 2.09-2.el7          os                                                26 k\nperl-File-Temp          noarch 0.23.01-3.el7       os                                                56 k\nperl-Filter             x86_64 1.49-3.el7          os                                                76 k\nperl-Getopt-Long        noarch 2.40-3.el7          os                                                56 k\nperl-HTTP-Tiny          noarch 0.033-3.el7         os                                                38 k\nperl-PathTools          x86_64 3.40-5.el7          os                                                82 k\nperl-Pod-Escapes        noarch 1:1.04-299.el7_9    updates                                           52 k\nperl-Pod-Perldoc        noarch 3.20-4.el7          os                                                87 k\nperl-Pod-Simple         noarch 1:3.28-4.el7        os                                               216 k\nperl-Pod-Usage          noarch 1.63-3.el7          os                                                27 k\nperl-Scalar-List-Utils  x86_64 1.27-248.el7        os                                                36 k\nperl-Socket             x86_64 2.010-5.el7         os                                                49 k\nperl-Storable           x86_64 2.45-3.el7          os                                                77 k\nperl-Text-ParseWords    noarch 3.29-4.el7          os                                                14 k\nperl-Time-HiRes         x86_64 4:1.9725-3.el7      os                                                45 k\nperl-Time-Local         noarch 1.2300-2.el7        os                                                24 k\nperl-constant           noarch 1.27-2.el7          os                                                19 k\nperl-libs               x86_64 4:5.16.3-299.el7_9  updates                                          690 k\nperl-macros             x86_64 4:5.16.3-299.el7_9  updates                                           44 k\nperl-parent             noarch 1:0.225-244.el7     os                                                12 k\nperl-podlators          noarch 2.5.1-3.el7         os                                               112 k\nperl-threads            x86_64 1.87-4.el7          os                                                49 k\nperl-threads-shared     x86_64 1.43-6.el7          os                                                39 k\n\nTransaction Summary\n===========================================================================================================\nInstall  5 Packages (+28 Dependent packages)\n\nTotal size: 947 M\nTotal download size: 12 M\nIs this ok [y/d/N]: \n</code></pre></p> </li> <li> <p>\u4fee\u6539\u914d\u7f6e\u6587\u4ef6/etc/my.cnf</p> \u4fee\u6539\u524d\u4fee\u6539\u540e <pre><code># For advice on how to change settings please see\n# http://dev.mysql.com/doc/refman/5.7/en/server-configuration-defaults.html\n\n[mysqld]\n#\n# Remove leading # and set to the amount of RAM for the most important data\n# cache in MySQL. Start at 70% of total RAM for dedicated server, else 10%.\n# innodb_buffer_pool_size = 128M\n#\n# Remove leading # to turn on a very important data integrity option: logging\n# changes to the binary log between backups.\n# log_bin\n#\n# Remove leading # to set options mainly useful for reporting servers.\n# The server defaults are faster for transactions and fast SELECTs.\n# Adjust sizes as needed, experiment to find the optimal values.\n# join_buffer_size = 128M\n# sort_buffer_size = 2M\n# read_rnd_buffer_size = 2M\ndatadir=/var/lib/mysql\nsocket=/var/lib/mysql/mysql.sock\n\n# Disabling symbolic-links is recommended to prevent assorted security risks\nsymbolic-links=0\n\nlog-error=/var/log/mysqld.log\npid-file=/var/run/mysqld/mysqld.pid\n</code></pre> <pre><code># For advice on how to change settings please see\n# http://dev.mysql.com/doc/refman/5.7/en/server-configuration-defaults.html\n\n[mysqld]\n#\n# Remove leading # and set to the amount of RAM for the most important data\n# cache in MySQL. Start at 70% of total RAM for dedicated server, else 10%.\ninnodb_buffer_pool_size =1G\ninnodb_buffer_pool_instances=1\ninnodb_log_file_size=256M\ninnodb_lru_scan_depth=128\ninnodb_io_capacity=10000\ninnodb_io_capacity_max=16000\ninnodb_status_output_locks=on\ninnodb_print_all_deadlocks=on\ninnodb_undo_tablespaces=10\n\ncharacter_set_server=utf8\n#\n# Remove leading # to turn on a very important data integrity option: logging\n# changes to the binary log between backups.\nlog-bin=master-bin\nserver_id=1\n#\n# Remove leading # to set options mainly useful for reporting servers.\n# The server defaults are faster for transactions and fast SELECTs.\n# Adjust sizes as needed, experiment to find the optimal values.\njoin_buffer_size = 2M\nsort_buffer_size = 2M\n# read_rnd_buffer_size = 2M\ndatadir=/var/lib/mysql\nsocket=/var/lib/mysql/mysql.sock\n\n# Disabling symbolic-links is recommended to prevent assorted security risks\nsymbolic-links=0\n\nlog-error=/var/log/mysqld.log\nlog_timestamps=SYSTEM\npid-file=/var/run/mysqld/mysqld.pid\n\nlog_output=TABLE\nslow_query_log=ON\nlong_query_time=2\ntls_version=TLSv1.2\n\nsql_mode='STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION'\n\n[client]\nsocket=/var/lib/mysql/mysql.sock\n</code></pre> </li> <li> <p>\u542f\u52a8\u670d\u52a1</p> <pre><code>systemctl start mysqld\n</code></pre> </li> <li> <p>\u8bbe\u7f6e\u9632\u706b\u5899</p> <pre><code>firewall-cmd --add-service=mysql\nfirewall-cmd --add-service=mysql --permanent\n</code></pre> </li> <li> <p>\u83b7\u53d6\u8d85\u7ea7\u7528\u6237'root'@'localhost'\u7684\u4e34\u65f6\u5bc6\u7801</p> <pre><code>grep 'temporary password' /var/log/mysqld.log\n</code></pre> </li> <li> <p>\u4f7f\u7528\u4e34\u65f6\u5bc6\u7801\u767b\u5f55</p> <pre><code>mysql -uroot -p\n</code></pre> </li> <li> <p>\u8bbe\u7f6e\u8d85\u7ea7\u7528\u6237'root'@'localhost'\u7684\u6b63\u5f0f\u5bc6\u7801</p> <pre><code>mysql&gt; ALTER USER 'root'@'localhost' IDENTIFIED BY 'MyNewPass4!';\n</code></pre> </li> <li> <p>\u521b\u5efa\u7528\u6237'example'@'%'\u4e14\u8bbe\u7f6e\u5bc6\u7801\uff0c\u5bc6\u7801\u6c38\u4e0d\u8fc7\u671f</p> <pre><code>mysql&gt; CREATE USER 'example'@'%' IDENTIFIED BY 'MyNewPass4!' PASSWORD EXPIRE NEVER;\n</code></pre> </li> <li> <p>\u8d4b\u4e88\u7528\u6237'example'@'%'\u5168\u90e8\u6743\u9650</p> <pre><code>mysql&gt; GRANT ALL ON *.* TO 'example'@'%';\n</code></pre> </li> <li> <p>\u9000\u51fa\u5ba2\u6237\u7aef</p> <pre><code>mysql&gt; exit\n</code></pre> </li> </ol>"},{"location":"blog/2024/06/14/%E5%AE%89%E8%A3%85-mysql-57centos-7/#_1","title":"\u7f16\u8bd1\u5b89\u88c5","text":"<ol> <li> <p>\u5b89\u88c5\u4f9d\u8d56</p> <pre><code>yum install cmake make gcc-c++ openssl openssl-devel ncurses ncurses-devel perl -y\n</code></pre> </li> <li> <p>\u5b89\u88c5\u4f9d\u8d56 boost</p> <p>\u6d4f\u89c8\u5668\u6253\u5f00https://sourceforge.net/projects/boost/files/boost/1.59.0/\uff0c\u4e0b\u8f7d boost 1.59.0 \u7248\u672c\u3002  \u5c06\u4e0b\u8f7d\u7684 boost_1_59_0.tar.gz \u653e\u5230 CentOS 7 \u670d\u52a1\u5668\u7684/usr/local \u76ee\u5f55\u4e0b\uff0c\u89e3\u538b\uff0c\u5220\u9664\u538b\u7f29\u5305\u3002 <pre><code>tar -zxf /usr/local/boost_1_59_0.tar.gz -C /usr/local\nrm -f /usr/local/boost_1_59_0.tar.gz\n</code></pre></p> </li> <li> <p>\u4e0b\u8f7d MySQL \u6e90\u4ee3\u7801</p> <p>\u6253\u5f00 MySQL\u5b98\u65b9\u4e0b\u8f7d\u5730\u5740\uff0cProduct Version \u9009\u62e9 5.7.44\uff0cOperating System \u9009\u62e9 Source Code\uff0cOS Version \u9009\u62e9 All Operating Systems (Generic) (Architecture Independent)\u3002\u70b9\u51fb Compressed TAR Archive \u4e00\u680f\u7684 Download \u6309\u94ae\uff0c\u5f00\u59cb\u4e0b\u8f7d\u3002 </p> </li> <li> <p>\u89e3\u538b</p> <p>MySQL \u6e90\u4ee3\u7801\u538b\u7f29\u5305\u653e\u5230/usr/local/src \u76ee\u5f55\u4e0b\uff0c\u89e3\u538b\u5230\u540c\u7ea7\u76ee\u5f55\uff0c\u5220\u9664\u538b\u7f29\u5305\u3002 <pre><code>tar -zxf /usr/local/src/mysql-5.7.44.tar.gz -C /usr/local/src\nrm -f /usr/local/src/mysql-5.7.44.tar.gz\ncd /usr/local/src/mysql-5.7.44/\n</code></pre></p> </li> <li> <p>\u7f16\u8bd1\u5e76\u5b89\u88c5\u5230/usr/local/mysql \u76ee\u5f55\u4e0b</p> <pre><code>mkdir bld\ncd bld\ncmake .. -DCMAKE_INSTALL_PREFIX=/usr/local/mysql -DWITH_INNODB_MEMCACHED=1 -DWITH_BOOST=/usr/local/boost_1_59_0 \nmake\nmake install\n</code></pre> </li> <li> <p>\u521b\u5efa\u7528\u6237 mysql \u548c\u7528\u6237\u7ec4 mysql</p> <pre><code>groupadd mysql\nuseradd -r -g mysql -s /bin/false mysql\n</code></pre> </li> <li> <p>\u4fee\u6539\u76ee\u5f55\u7684\u5c5e\u4e3b\u548c\u5c5e\u7ec4</p> <pre><code>chown -R mysql:mysql /usr/local/mysql\n</code></pre> </li> <li> <p>\u5c06/usr/local/mysql/bin \u4e0b\u7684\u53ef\u6267\u884c\u6587\u4ef6\uff08\u5305\u542b\u670d\u52a1\u7aef\u548c\u5ba2\u6237\u7aef\u53ca\u5de5\u5177\uff09\u52a0\u5165\u73af\u5883\u53d8\u91cf</p> <pre><code>echo 'export MYSQL_HOME=/usr/local/mysql' &gt; /etc/profile.d/mysql.sh\necho 'export PATH=$PATH:$MYSQL_HOME/bin' &gt;&gt; /etc/profile.d/mysql.sh\nsource /etc/profile.d/mysql.sh\n</code></pre> </li> <li> <p>\u9a8c\u8bc1\u4e0a\u4e00\u6b65\u64cd\u4f5c\u662f\u5426\u6210\u529f</p> <pre><code>[root@localhost bld]# mysql -V\nmysql  Ver 14.14 Distrib 5.7.44, for Linux (x86_64) using  EditLine wrapper\n</code></pre> </li> <li> <p>\u521b\u5efa\u6570\u636e\u76ee\u5f55\u548c\u5b58\u653e pid \u7684\u76ee\u5f55\uff0c\u5e76\u4e14\u4fee\u6539\u5c5e\u4e3b\u5c5e\u7ec4</p> <pre><code>mkdir /var/run/mysqld /var/lib/mysql\nchown mysql:mysql /var/run/mysqld /var/lib/mysql\n</code></pre> </li> <li> <p>\u521b\u5efa\u9519\u8bef\u65e5\u5fd7\u8f93\u51fa\u6587\u4ef6\uff0c\u5e76\u4e14\u4fee\u6539\u5c5e\u4e3b\u5c5e\u7ec4</p> <pre><code>touch /var/log/mysqld.log\nchown mysql:mysql /var/log/mysqld.log\n</code></pre> </li> <li> <p>\u521b\u5efa\u914d\u7f6e\u6587\u4ef6/etc/my.cnf</p> <pre><code># For advice on how to change settings please see\n# http://dev.mysql.com/doc/refman/5.7/en/server-configuration-defaults.html\n\n[mysqld]\n#\n# Remove leading # and set to the amount of RAM for the most important data\n# cache in MySQL. Start at 70% of total RAM for dedicated server, else 10%.\ninnodb_buffer_pool_size =256M\ninnodb_buffer_pool_instances=1\ninnodb_log_file_size=256M\ninnodb_lru_scan_depth=128\ninnodb_io_capacity=10000\ninnodb_io_capacity_max=16000\ninnodb_status_output_locks=on\ninnodb_print_all_deadlocks=on\ninnodb_undo_tablespaces=10\n\ncharacter_set_server=utf8\n#\n# Remove leading # to turn on a very important data integrity option: logging\n# changes to the binary log between backups.\nlog-bin=master-bin\nserver_id=1\n#\n# Remove leading # to set options mainly useful for reporting servers.\n# The server defaults are faster for transactions and fast SELECTs.\n# Adjust sizes as needed, experiment to find the optimal values.\njoin_buffer_size = 2M\nsort_buffer_size = 2M\n# read_rnd_buffer_size = 2M\nbasedir=/usr/local/mysql\ndatadir=/var/lib/mysql\nsocket=/var/lib/mysql/mysql.sock\n\n# Disabling symbolic-links is recommended to prevent assorted security risks\nsymbolic-links=0\n\nlog-error=/var/log/mysqld.log\nlog_timestamps=SYSTEM\npid-file=/var/run/mysqld/mysqld.pid\n\nlog_output=TABLE\nslow_query_log=ON\nlong_query_time=2\ntls_version=TLSv1.2\n\nsql_mode='STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION'\n\n[client]\nsocket=/var/lib/mysql/mysql.sock\n</code></pre> </li> <li> <p>\u521d\u59cb\u5316\u6570\u636e\u76ee\u5f55</p> <pre><code>mysqld --initialize-insecure --user=mysql\n</code></pre> </li> <li> <p>\u590d\u5236$MYSQL_HOME/support-files/mysql.server \u5230/etc/init.d/mysqld\uff0c\u8fd9\u662f\u5b98\u65b9\u63d0\u4f9b\u7684\u542f\u52a8\u3001\u505c\u6b62\u811a\u672c\uff0c\u6211\u4eec\u628a\u5b83\u653e\u5728/etc/init.d \u76ee\u5f55\u4e0b\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528 service \u547d\u4ee4\u542f\u52a8\u3001\u505c\u6b62 MySQL \u670d\u52a1\u5668\u3002</p> <pre><code>cp $MYSQL_HOME/support-files/mysql.server /etc/init.d/mysqld\n</code></pre> </li> <li> <p>\u8d4b\u4e88/etc/init.d/mysqld \u53ef\u6267\u884c\u6743\u9650</p> <pre><code>chmod +x /etc/init.d/mysqld\n</code></pre> </li> <li> <p>\u8bbe\u7f6e\u5f00\u673a\u81ea\u542f\u52a8 MySQL \u670d\u52a1\u5668</p> <pre><code>chkconfig --add mysqld\n</code></pre> </li> <li> <p>\u542f\u52a8 MySQL \u670d\u52a1\u5668</p> <pre><code>[root@localhost bld]# service mysqld start\nStarting MySQL. SUCCESS!\n</code></pre> </li> <li> <p>\u76f4\u63a5\u767b\u5f55\uff0c\u5f53\u524d'root'@'localhost'\u7528\u6237\u65e0\u5bc6\u7801\uff0c\u56e0\u4e3a\u5728\u7b2c 15 \u6b65\u7684\u65f6\u5019\u4f7f\u7528--initialize-insecure \u53c2\u6570\u3002</p> <pre><code>mysql -uroot -p\n</code></pre> </li> <li> <p>\u56e0\u4e3a\u8d85\u7ea7\u7528\u6237'root'@'localhost'\u8fd8\u6ca1\u6709\u5bc6\u7801\uff0c\u6240\u4ee5\u767b\u5f55\u540e\u7b2c\u4e00\u4ef6\u4e8b\u5c31\u662f\u8bbe\u7f6e\u8d85\u7ea7\u7528\u6237'root'@'localhost'\u7684\u6b63\u5f0f\u5bc6\u7801</p> <pre><code>mysql&gt; ALTER USER 'root'@'localhost' IDENTIFIED BY 'MyNewPass4!';\n</code></pre> </li> <li> <p>\u521b\u5efa\u7528\u6237'example'@'%'\u4e14\u8bbe\u7f6e\u5bc6\u7801\uff0c\u5bc6\u7801\u6c38\u4e0d\u8fc7\u671f</p> <pre><code>mysql&gt; CREATE USER 'example'@'%' IDENTIFIED BY 'MyNewPass4!' PASSWORD EXPIRE NEVER;\n</code></pre> </li> <li> <p>\u8d4b\u4e88\u7528\u6237'example'@'%'\u5168\u90e8\u6743\u9650</p> <pre><code>mysql&gt; GRANT ALL ON *.* TO 'example'@'%';\n</code></pre> </li> <li> <p>\u9000\u51fa\u5ba2\u6237\u7aef</p> <pre><code>mysql&gt; exit\n</code></pre> </li> </ol>"},{"location":"blog/2024/01/30/%E5%AE%89%E8%A3%85-nfs-%E7%BD%91%E7%BB%9C%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9Fcentos-7/","title":"\u5b89\u88c5 NFS \u7f51\u7edc\u6587\u4ef6\u7cfb\u7edf(CentOS 7)","text":"<p>\u5b89\u88c5\u76ee\u6807</p> <ul> <li> \u5b89\u88c5\u4e00\u4e2a NFS(Network File System) \u670d\u52a1\u7aef\u5b9e\u4f8b\uff0c\u8be5\u5b9e\u4f8b\u6240\u5728\u4e3b\u673a\u7684 IP \u5730\u5740\u4e3a 192.168.2.70\uff0c\u5bf9\u5e94\u4e3b\u673a\u540d nfs.xuwangwei.test\u3002</li> <li> \u5171\u4eab nfs.xuwangwei.test \u4e3b\u673a\u7684/home \u76ee\u5f55\uff0c\u4f7f\u7528 client1.xuwangwei.test \u4e3b\u673a\u8fdb\u884c\u6302\u8f7d\u6d4b\u8bd5\u3002</li> </ul> <p>\u524d\u7f6e\u6761\u4ef6</p> <ul> <li> \u65e0\u3002</li> </ul>"},{"location":"blog/2024/01/30/%E5%AE%89%E8%A3%85-nfs-%E7%BD%91%E7%BB%9C%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9Fcentos-7/#_1","title":"\u5b89\u88c5\u670d\u52a1\u7aef","text":"<p>\u6ce8\u610f\u26a0\ufe0f\uff1a\u4e0b\u9762\u7684\u547d\u4ee4\u662f\u5728\u4e3b\u673a nfs.xuwangwei.test \u4e0a\u6267\u884c\u7684\u3002</p> <ol> <li> <p>\u5b89\u88c5</p> <pre><code>[root@nfs ~]# yum install nfs-utils\n</code></pre> </li> <li> <p>\u8bbe\u7f6e\u9632\u706b\u5899</p> <pre><code>[root@nfs ~]# firewall-cmd --add-service={rpc-bind,mountd,nfs}\n[root@nfs ~]# firewall-cmd --add-service={rpc-bind,mountd,nfs} --permanent\n</code></pre> </li> <li> <p>\u542f\u52a8\u670d\u52a1</p> <pre><code>[root@nfs ~]# systemctl start rpcbind nfs-mountd nfs\n</code></pre> </li> <li> <p>\u8bbe\u7f6e\u5f00\u673a\u81ea\u542f\u52a8</p> <pre><code>[root@nfs ~]# systemctl enable rpcbind nfs-mountd nfs\n</code></pre> </li> <li> <p>\u4fee\u6539\u914d\u7f6e\u6587\u4ef6/etc/exports\u3002\u5047\u8bbe\u6211\u60f3\u5171\u4eab/home \u76ee\u5f55\uff0c\u4f7f\u5f97 192.168.2.0/24 \u7f51\u7edc\u4e0b\u7684\u6240\u6709\u4e3b\u673a\u90fd\u6709\u6743\u9650\u4f7f\u7528\u8be5\u76ee\u5f55\uff0c\u4e14\u8be5\u76ee\u5f55\u5141\u8bb8\u8bfb\u5199\u3002</p> <pre><code>/home 192.168.2.0/24(rw,sync,no_root_squash)\n</code></pre> </li> <li> <p>\u4f7f\u914d\u7f6e\u6587\u4ef6\u751f\u6548</p> <pre><code>[root@nfs ~]# exportfs -rv\nexporting 192.168.2.0/24:/home\n</code></pre> </li> </ol>"},{"location":"blog/2024/01/30/%E5%AE%89%E8%A3%85-nfs-%E7%BD%91%E7%BB%9C%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9Fcentos-7/#_2","title":"\u6d4b\u8bd5\u914d\u7f6e\u662f\u5426\u6b63\u786e","text":"<p>\u6ce8\u610f\u26a0\ufe0f\uff1a\u4e0b\u9762\u7684\u547d\u4ee4\u6709\u5728\u4e3b\u673a nfs.xuwangwei.test \u4e0a\u6267\u884c\u7684\uff0c\u4e5f\u6709\u5728\u4e3b\u673a client1.xuwangwei.test \u4e0a\u6267\u884c\u7684\u3002\u8bf7\u6839\u636e\u63a7\u5236\u53f0\u7684\u63d0\u793a\u5206\u8fa8\u3002</p> <ol> <li> <p>\u5728\u4e3b\u673a nfs.xuwangwei.test \u4e0a\u521b\u5efa\u7528\u6237\u548c\u7528\u6237\u7ec4\u7528\u4e8e\u6d4b\u8bd5</p> <pre><code>[root@nfs ~]# groupadd --gid 2000 xuwangwei\n[root@nfs ~]# useradd --create-home --gid 2000 --uid 2000 xuwangwei\n</code></pre> </li> <li> <p>\u5728/home/xuwangwei \u76ee\u5f55\u4e0b\u65b0\u5efa\u4e00\u4e2a\u6587\u672c\u6587\u4ef6 1.txt\uff0c\u5185\u5bb9\u662f hello</p> <pre><code>[root@nfs ~]# su - xuwangwei -c 'echo \"hello\" &gt;&gt; /home/xuwangwei/1.txt'\n</code></pre> </li> <li> <p>\u67e5\u770b 1.txt \u662f\u5426\u65b0\u5efa\u6210\u529f\uff0c\u662f\u5426\u5199\u5165\u4e86 hello</p> <pre><code>[root@nfs ~]# ls -l /home/xuwangwei/1.txt\n-rw-rw-r--. 1 xuwangwei xuwangwei 6 1\u6708  30 17:45 /home/xuwangwei/1.txt\n[root@nfs ~]# cat /home/xuwangwei/1.txt\nhello\n</code></pre> </li> <li> <p>\u5728\u4e3b\u673a client1.xuwangwei.test \u4e0a\u521b\u5efa\u540c\u6837\u7684\u7528\u6237\u548c\u7528\u6237\u7ec4</p> <pre><code>[root@client1 ~]# groupadd --gid 2000 xuwangwei\n[root@client1 ~]# useradd --create-home --gid 2000 --uid 2000 xuwangwei\n</code></pre> </li> <li> <p>\u5b89\u88c5</p> <pre><code>[root@client1 ~]# yum install nfs-utils\n</code></pre> </li> <li> <p>\u6302\u8f7d\u76ee\u5f55</p> <pre><code>[root@client1 ~]# mount -v -t nfs4 192.168.2.70:/home /home\nmount.nfs4: timeout set for Tue Jan 30 18:01:48 2024\nmount.nfs4: trying text-based options 'vers=4.1,addr=192.168.2.70,clientaddr=192.168.2.71'\n</code></pre> </li> <li> <p>\u67e5\u770b\u662f\u5426\u6302\u8f7d\u6210\u529f</p> <pre><code>[root@client1 ~]# mount |grep 192.168.2.70\n192.168.2.70:/home on /home type nfs4 (rw,relatime,vers=4.1,rsize=1048576,wsize=1048576,namlen=255,hard,proto=tcp,timeo=600,retrans=2,sec=sys,clientaddr=192.168.2.71,local_lock=none,addr=192.168.2.70)\n</code></pre> </li> <li> <p>\u67e5\u770b 1.txt \u662f\u5426\u5b58\u5728\uff0c\u4e14\u5185\u5bb9\u662f\u5426\u6b63\u786e</p> <pre><code>[root@client1 ~]# ls -l /home/xuwangwei\n\u603b\u7528\u91cf 4\n-rw-rw-r--. 1 xuwangwei xuwangwei 6 1\u6708  30 17:45 1.txt\n[root@client1 ~]# cat /home/xuwangwei/1.txt \nhello\n</code></pre> </li> </ol>"},{"location":"blog/2023/08/26/%E5%AE%89%E8%A3%85nis%E6%9C%8D%E5%8A%A1centos-79/","title":"\u5b89\u88c5NIS\u670d\u52a1\uff08CentOS 7.9\uff09","text":"<p>\u5b89\u88c5\u76ee\u6807</p> <ul> <li> \u5b89\u88c5\u4e00\u4e2a NIS \u670d\u52a1\u7aef\u5b9e\u4f8b\uff0c\u8be5\u5b9e\u4f8b\u6240\u5728\u4e3b\u673a\u7684 IP \u5730\u5740\u4e3a 192.168.2.50\uff0c\u5bf9\u5e94\u4e3b\u673a\u540d nis-master.example.com\u3002</li> <li> \u5b89\u88c5\u4e00\u4e2a NIS \u5ba2\u6237\u7aef\u5b9e\u4f8b\uff0c\u8be5\u5b9e\u4f8b\u6240\u5728\u4e3b\u673a\u7684 IP \u5730\u5740\u4e3a 192.168.2.51\uff0c\u5bf9\u5e94\u4e3b\u673a\u540d nis-client.example.com\u3002</li> <li> \u4f7f\u5f97\u5ba2\u6237\u7aef\u7684\u7528\u6237\u3001\u7528\u6237\u7ec4\u3001hosts \u4e0e\u670d\u52a1\u7aef\u7684\u4fdd\u6301\u540c\u6b65\u3002</li> </ul> <p>\u524d\u7f6e\u6761\u4ef6</p> <ul> <li> \u65e0\u3002</li> </ul> <p>\u8865\u5145\u8bf4\u660e</p> <p>NIS \u66fe\u7528\u540d Yellow Pages\uff0c\u7b80\u79f0 YP\uff0c\u8fd9\u662f\u5b83\u7684\u5b89\u88c5\u5305\u3001\u914d\u7f6e\u548c\u547d\u4ee4\u4ee5 yp \u5f00\u5934\u7684\u539f\u56e0\u3002</p>"},{"location":"blog/2023/08/26/%E5%AE%89%E8%A3%85nis%E6%9C%8D%E5%8A%A1centos-79/#_1","title":"\u5b89\u88c5\u670d\u52a1\u7aef","text":"<p>Warning</p> <p>\u4e0b\u9762\u7684\u547d\u4ee4\u662f\u5728\u4e3b\u673a nis-master.example.com \u4e0a\u6267\u884c\u7684\u3002</p> <ol> <li> <p>\u5b89\u88c5</p> <pre><code>yum -y install ypserv\n</code></pre> </li> <li> <p>/etc/ypserv.conf\u914d\u7f6e\u4fdd\u6301\u4e0d\u53d8</p> <pre><code>#\n# ypserv.conf   In this file you can set certain options for the NIS server,\n#       and you can deny or restrict access to certain maps based\n#       on the originating host.\n#\n#       See ypserv.conf(5) for a description of the syntax.\n#\n\n# Some options for ypserv. This things are all not needed, if\n# you have a Linux net.\n\n# How many map file handles should be cached ?\nfiles: 30\n\n# Should we register ypserv with SLP ?\n# slp: no\n# After how many seconds we should re-register ypserv with SLP ?\n# slp_timeout: 3600\n\n# xfr requests are only allowed from ports &lt; 1024\nxfr_check_port: yes\n\n# The following, when uncommented,  will give you shadow like passwords.\n# Note that it will not work if you have slave NIS servers in your\n# network that do not run the same server as you.\n\n# Host                     : Domain  : Map              : Security \n#\n# *                        : *       : passwd.byname    : port \n# *                        : *       : passwd.byuid     : port\n\n# Not everybody should see the shadow passwords, not secure, since\n# under MSDOG everbody is root and can access ports &lt; 1024 !!!\n*              : *       : shadow.byname    : port\n*              : *       : passwd.adjunct.byname : port\n\n# If you comment out the next rule, ypserv and rpc.ypxfrd will\n# look for YP_SECURE and YP_AUTHDES in the maps. This will make\n# the security check a little bit slower, but you only have to\n# change the keys on the master server, not the configuration files\n# on each NIS server.\n# If you have maps with YP_SECURE or YP_AUTHDES, you should create\n# a rule for them above, that's much faster.\n# *                        : *       : *                : none\n</code></pre> </li> <li> <p>\u4fee\u6539\u914d\u7f6e/etc/hosts</p> \u4fee\u6539\u524d\u4fee\u6539\u540e <pre><code>127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4\n::1         localhost localhost.localdomain localhost6 localhost6.localdomain6\n</code></pre> <pre><code>127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4\n::1         localhost localhost.localdomain localhost6 localhost6.localdomain6\n192.168.2.50 nis-master.example.com\n192.168.2.51 nis-client.example.com\n</code></pre> </li> <li> <p>\u4fee\u6539\u914d\u7f6e/etc/sysconfig/network</p> <pre><code>echo 'NISDOMAIN=nis-example-domain' &gt;&gt; /etc/sysconfig/network\necho 'YPSERV_ARGS=\"-p 811\"' &gt;&gt; /etc/sysconfig/network\necho 'YPXFRD_ARGS=\"-p 813\"' &gt;&gt; /etc/sysconfig/network\n</code></pre> </li> <li> <p>\u4fee\u6539\u914d\u7f6e/etc/sysconfig/yppasswdd</p> \u4fee\u6539\u524d\u4fee\u6539\u540e <pre><code># The passwd and shadow files are located under the specified\n# directory path. rpc.yppasswdd will use these files, not /etc/passwd\n# and /etc/shadow.\n#ETCDIR=/etc\n\n# This option tells rpc.yppasswdd to use a different source file\n# instead of /etc/passwd\n# You can't mix usage of this with ETCDIR\n#PASSWDFILE=/etc/passwd\n\n# This option tells rpc.yppasswdd to use a different source file\n# instead of /etc/passwd.\n# You can't mix usage of this with ETCDIR\n#SHADOWFILE=/etc/shadow\n\n# Additional arguments passed to yppasswd\nYPPASSWDD_ARGS=\n</code></pre> <pre><code># The passwd and shadow files are located under the specified\n# directory path. rpc.yppasswdd will use these files, not /etc/passwd\n# and /etc/shadow.\n#ETCDIR=/etc\n\n# This option tells rpc.yppasswdd to use a different source file\n# instead of /etc/passwd\n# You can't mix usage of this with ETCDIR\n#PASSWDFILE=/etc/passwd\n\n# This option tells rpc.yppasswdd to use a different source file\n# instead of /etc/passwd.\n# You can't mix usage of this with ETCDIR\n#SHADOWFILE=/etc/shadow\n\n# Additional arguments passed to yppasswd\nYPPASSWDD_ARGS=\"--port 812\"\n</code></pre> </li> <li> <p>\u542f\u52a8\u670d\u52a1</p> <pre><code>systemctl restart rpcbind ypserv yppasswdd ypxfrd\nsystemctl enable rpcbind ypserv yppasswdd ypxfrd\n</code></pre> </li> <li> <p>\u8bbe\u7f6e\u9632\u706b\u5899</p> <pre><code>firewall-cmd --add-service=rpc-bind\nfirewall-cmd --permanent --add-service=rpc-bind\nfirewall-cmd --add-port=811-813/tcp\nfirewall-cmd --add-port=811-813/udp\nfirewall-cmd --permanent --add-port=811-813/tcp\nfirewall-cmd --permanent --add-port=811-813/udp\n</code></pre> </li> <li> <p>\u521b\u5efa\u6570\u636e\u5e93</p> <pre><code>/usr/lib64/yp/ypinit -m\n</code></pre> \u63a7\u5236\u53f0\u8f93\u51fa <pre><code>At this point, we have to construct a list of the hosts which will run NIS\nservers.  nis-master.example.com is in the list of NIS server hosts.  Please continue to add\nthe names for the other hosts, one per line.  When you are done with the\nlist, type a &lt;control D&gt;.\n    next host to add:  nis-master.example.com\n    next host to add:  \nThe current list of NIS servers looks like this:\n\nnis-master.example.com\n\nIs this correct?  [y/n: y]  y\nWe need a few minutes to build the databases...\nBuilding /var/yp/nis-example-domain/ypservers...\nRunning /var/yp/Makefile...\ngmake[1]: \u8fdb\u5165\u76ee\u5f55\u201c/var/yp/nis-example-domain\u201d\nUpdating passwd.byname...\nUpdating passwd.byuid...\nUpdating group.byname...\nUpdating group.bygid...\nUpdating hosts.byname...\nUpdating hosts.byaddr...\nUpdating rpc.byname...\nUpdating rpc.bynumber...\nUpdating services.byname...\nUpdating services.byservicename...\nUpdating netid.byname...\nUpdating protocols.bynumber...\nUpdating protocols.byname...\nUpdating mail.aliases...\ngmake[1]: \u79bb\u5f00\u76ee\u5f55\u201c/var/yp/nis-example-domain\u201d\n\nnis-master.example.com has been set up as a NIS master server.\n\nNow you can run ypinit -s nis-master.example.com on all slave server.\n</code></pre> </li> <li> <p>\u6dfb\u52a0\u6d4b\u8bd5\u7528\u6237\u548c\u7528\u6237\u7ec4\uff0c\u8bbe\u7f6e\u7528\u6237\u5bc6\u7801</p> <pre><code>groupadd hadoop\nuseradd -m -g hadoop hdfs\nuseradd -m -g hadoop yarn\nuseradd -m -g hadoop mapred\npasswd hdfs\npasswd yarn\npasswd mapred\n</code></pre> </li> <li> <p>\u66f4\u65b0NIS\u6570\u636e\u5e93\u3002\u6bcf\u6b21\u589e\u5220\u6539\u7528\u6237\u3001\u7528\u6237\u7ec4\u6216 hosts \u540e\u90fd\u9700\u8981\u6267\u884c\u8fd9\u4e00\u6b65\uff0c\u4f7f\u4fee\u6539\u751f\u6548\u3002</p> <pre><code>cd /var/yp;make\n</code></pre> \u63a7\u5236\u53f0\u8f93\u51fa <pre><code>gmake[1]: \u8fdb\u5165\u76ee\u5f55\u201c/var/yp/nis-example-domain\u201d\nUpdating passwd.byname...\nUpdating passwd.byuid...\nUpdating group.byname...\nUpdating group.bygid...\nUpdating netid.byname...\ngmake[1]: \u79bb\u5f00\u76ee\u5f55\u201c/var/yp/nis-example-domain\u201d\n</code></pre> </li> </ol>"},{"location":"blog/2023/08/26/%E5%AE%89%E8%A3%85nis%E6%9C%8D%E5%8A%A1centos-79/#_2","title":"\u5b89\u88c5\u5ba2\u6237\u7aef","text":"<p>Warning</p> <p>\u4e0b\u9762\u7684\u547d\u4ee4\u662f\u5728\u4e3b\u673a nis-client.example.com \u4e0a\u6267\u884c\u7684\u3002</p> <ol> <li> <p>\u5b89\u88c5</p> <pre><code>yum -y install ypbind yp-tools\n</code></pre> </li> </ol>"},{"location":"blog/2023/08/26/%E5%AE%89%E8%A3%85nis%E6%9C%8D%E5%8A%A1centos-79/#_3","title":"\u65b9\u5f0f\u4e00\uff1a\u901a\u8fc7\u56fe\u5f62\u5316\u754c\u9762\u914d\u7f6e","text":"<ol> <li> <p>\u5b89\u88c5\u56fe\u5f62\u5316\u914d\u7f6e\u6240\u9700\u8f6f\u4ef6\u5305</p> <pre><code>yum -y install setuptool authconfig-gtk\n</code></pre> </li> <li> <p>\u5f00\u542f\u56fe\u5f62\u5316\u914d\u7f6e\u754c\u9762</p> <pre><code>setup\n</code></pre> </li> <li> <p>\u9009\u62e9\u9a8c\u8bc1\u914d\u7f6e</p> <p></p> </li> <li> <p>\u9009\u62e9\u4f7f\u7528NIS\u540e\uff0c\u8fdb\u5165\u4e0b\u4e00\u6b65</p> <p></p> </li> <li> <p>\u8f93\u5165NIS\u57df\u548c\u670d\u52a1\u5668\u5730\u5740\uff0c\u9009\u62e9\u786e\u5b9a\u540e\u7cfb\u7edf\u81ea\u52a8\u914d\u7f6e\u5e76\u542f\u52a8NIS\u670d\u52a1</p> <p></p> </li> <li> <p>\u7cfb\u7edf\u81ea\u52a8\u542f\u52a8NIS\u670d\u52a1\u540e\u4f1a\u56de\u5230\u5982\u4e0b\u754c\u9762\uff0c\u9009\u62e9\u9000\u51fa\u5373\u53ef</p> <p></p> </li> </ol>"},{"location":"blog/2023/08/26/%E5%AE%89%E8%A3%85nis%E6%9C%8D%E5%8A%A1centos-79/#_4","title":"\u65b9\u5f0f\u4e8c\uff1a\u4e0d\u901a\u8fc7\u56fe\u5f62\u5316\u754c\u9762\u914d\u7f6e","text":"<ol> <li> <p>\u4fee\u6539\u914d\u7f6e/etc/yp.conf</p> \u4fee\u6539\u524d\u4fee\u6539\u540e <pre><code># /etc/yp.conf - ypbind configuration file\n# Valid entries are\n#\n# domain NISDOMAIN server HOSTNAME\n#   Use server HOSTNAME for the domain NISDOMAIN.\n#\n# domain NISDOMAIN broadcast\n#   Use  broadcast  on  the local net for domain NISDOMAIN\n#\n# domain NISDOMAIN slp\n#   Query local SLP server for ypserver supporting NISDOMAIN\n#\n# ypserver HOSTNAME\n#   Use server HOSTNAME for the  local  domain.  The\n#   IP-address of server must be listed in /etc/hosts.\n#\n# broadcast\n#   If no server for the default domain is specified or\n#   none of them is rechable, try a broadcast call to\n#   find a server.\n#\n</code></pre> <pre><code># /etc/yp.conf - ypbind configuration file\n# Valid entries are\n#\n# domain NISDOMAIN server HOSTNAME\n#   Use server HOSTNAME for the domain NISDOMAIN.\n#\n# domain NISDOMAIN broadcast\n#   Use  broadcast  on  the local net for domain NISDOMAIN\n#\n# domain NISDOMAIN slp\n#   Query local SLP server for ypserver supporting NISDOMAIN\n#\n# ypserver HOSTNAME\n#   Use server HOSTNAME for the  local  domain.  The\n#   IP-address of server must be listed in /etc/hosts.\n#\n# broadcast\n#   If no server for the default domain is specified or\n#   none of them is rechable, try a broadcast call to\n#   find a server.\n#\ndomain nis-example-domain server 192.168.2.50\n</code></pre> </li> <li> <p>\u4fee\u6539\u914d\u7f6e/etc/sysconfig/network</p> \u4fee\u6539\u524d\u4fee\u6539\u540e <pre><code># Created by anaconda\n</code></pre> <pre><code>NISDOMAIN=nis-example-domain\n</code></pre> </li> <li> <p>\u4fee\u6539\u914d\u7f6e/etc/nsswitch.conf</p> \u4fee\u6539\u524d\u4fee\u6539\u540e <pre><code>#\n# /etc/nsswitch.conf\n#\n# An example Name Service Switch config file. This file should be\n# sorted with the most-used services at the beginning.\n#\n# The entry '[NOTFOUND=return]' means that the search for an\n# entry should stop if the search in the previous entry turned\n# up nothing. Note that if the search failed due to some other reason\n# (like no NIS server responding) then the search continues with the\n# next entry.\n#\n# Valid entries include:\n#\n#   nisplus         Use NIS+ (NIS version 3)\n#   nis         Use NIS (NIS version 2), also called YP\n#   dns         Use DNS (Domain Name Service)\n#   files           Use the local files\n#   db          Use the local database (.db) files\n#   compat          Use NIS on compat mode\n#   hesiod          Use Hesiod for user lookups\n#   sss         Use sssd (System Security Services Daemon)\n#   [NOTFOUND=return]   Stop searching if not found so far\n#\n# WARNING: Running nscd with a secondary caching service like sssd may lead to\n#      unexpected behaviour, especially with how long entries are cached.\n\n# To use db, put the \"db\" in front of \"files\" for entries you want to be\n# looked up first in the databases\n#\n# Example:\n#passwd:    db files nisplus nis\n#shadow:    db files nisplus nis\n#group:     db files nisplus nis\n\npasswd:     files sss\nshadow:     files sss\ngroup:      files sss\n#initgroups: files sss\n\n#hosts:     db files nisplus nis dns\nhosts:      files dns myhostname\n\n# Example - obey only what nisplus tells us...\n#services:   nisplus [NOTFOUND=return] files\n#networks:   nisplus [NOTFOUND=return] files\n#protocols:  nisplus [NOTFOUND=return] files\n#rpc:        nisplus [NOTFOUND=return] files\n#ethers:     nisplus [NOTFOUND=return] files\n#netmasks:   nisplus [NOTFOUND=return] files     \n\nbootparams: nisplus [NOTFOUND=return] files\n\nethers:     files\nnetmasks:   files\nnetworks:   files\nprotocols:  files\nrpc:        files\nservices:   files sss\n\nnetgroup:   nisplus sss\n\npublickey:  nisplus\n\nautomount:  files nisplus sss\naliases:    files nisplus\n</code></pre> <pre><code>#\n# /etc/nsswitch.conf\n#\n# An example Name Service Switch config file. This file should be\n# sorted with the most-used services at the beginning.\n#\n# The entry '[NOTFOUND=return]' means that the search for an\n# entry should stop if the search in the previous entry turned\n# up nothing. Note that if the search failed due to some other reason\n# (like no NIS server responding) then the search continues with the\n# next entry.\n#\n# Valid entries include:\n#\n#   nisplus         Use NIS+ (NIS version 3)\n#   nis         Use NIS (NIS version 2), also called YP\n#   dns         Use DNS (Domain Name Service)\n#   files           Use the local files\n#   db          Use the local database (.db) files\n#   compat          Use NIS on compat mode\n#   hesiod          Use Hesiod for user lookups\n#   sss         Use sssd (System Security Services Daemon)\n#   [NOTFOUND=return]   Stop searching if not found so far\n#\n# WARNING: Running nscd with a secondary caching service like sssd may lead to\n#      unexpected behaviour, especially with how long entries are cached.\n\n# To use db, put the \"db\" in front of \"files\" for entries you want to be\n# looked up first in the databases\n#\n# Example:\n#passwd:    db files nisplus nis\n#shadow:    db files nisplus nis\n#group:     db files nisplus nis\n\npasswd:     files nis sss\nshadow:     files nis sss\ngroup:      files nis sss\n#initgroups: files sss\n\n#hosts:     db files nisplus nis dns\nhosts:      files nis dns myhostname\n\n# Example - obey only what nisplus tells us...\n#services:   nisplus [NOTFOUND=return] files\n#networks:   nisplus [NOTFOUND=return] files\n#protocols:  nisplus [NOTFOUND=return] files\n#rpc:        nisplus [NOTFOUND=return] files\n#ethers:     nisplus [NOTFOUND=return] files\n#netmasks:   nisplus [NOTFOUND=return] files     \n\nbootparams: nisplus [NOTFOUND=return] files\n\nethers:     files\nnetmasks:   files\nnetworks:   files\nprotocols:  files\nrpc:        files\nservices:   files sss\n\nnetgroup:   files nis sss\n\npublickey:  nisplus\n\nautomount:  files nis\naliases:    files nisplus\n</code></pre> </li> <li> <p>\u4fee\u6539\u914d\u7f6e/etc/sysconfig/authconfig</p> \u4fee\u6539\u524d\u4fee\u6539\u540e <pre><code>CACHECREDENTIALS=yes\nFAILLOCKARGS=\"deny=4 unlock_time=1200\"\nFORCELEGACY=no\nFORCESMARTCARD=no\nIPADOMAINJOINED=no\nIPAV2NONTP=no\nPASSWDALGORITHM=sha512\nUSEDB=no\nUSEECRYPTFS=no\nUSEFAILLOCK=no\nUSEFPRINTD=no\nUSEHESIOD=no\nUSEIPAV2=no\nUSEKERBEROS=no\nUSELDAP=no\nUSELDAPAUTH=no\nUSELOCAUTHORIZE=yes\nUSEMKHOMEDIR=no\nUSENIS=no\nUSEPAMACCESS=no\nUSEPASSWDQC=no\nUSEPWQUALITY=yes\nUSESHADOW=yes\nUSESMARTCARD=no\nUSESSSD=yes\nUSESSSDAUTH=no\nUSESYSNETAUTH=no\nUSEWINBIND=no\nUSEWINBINDAUTH=no\nWINBINDKRB5=no\n</code></pre> <pre><code>CACHECREDENTIALS=yes\nFAILLOCKARGS=\"deny=4 unlock_time=1200\"\nFORCELEGACY=no\nFORCESMARTCARD=no\nIPADOMAINJOINED=no\nIPAV2NONTP=no\nPASSWDALGORITHM=sha512\nUSEDB=no\nUSEECRYPTFS=no\nUSEFAILLOCK=no\nUSEFPRINTD=no\nUSEHESIOD=no\nUSEIPAV2=no\nUSEKERBEROS=no\nUSELDAP=no\nUSELDAPAUTH=no\nUSELOCAUTHORIZE=yes\nUSEMKHOMEDIR=no\nUSENIS=yes\nUSEPAMACCESS=no\nUSEPASSWDQC=no\nUSEPWQUALITY=yes\nUSESHADOW=yes\nUSESMARTCARD=no\nUSESSSD=yes\nUSESSSDAUTH=no\nUSESYSNETAUTH=no\nUSEWINBIND=no\nUSEWINBINDAUTH=no\nWINBINDKRB5=no\n</code></pre> </li> <li> <p>\u4fee\u6539\u914d\u7f6e/etc/pam.d/system-auth</p> \u4fee\u6539\u524d\u4fee\u6539\u540e <pre><code>#%PAM-1.0\n# This file is auto-generated.\n# User changes will be destroyed the next time authconfig is run.\nauth        required      pam_env.so\nauth        required      pam_faildelay.so delay=2000000\nauth        sufficient    pam_unix.so nullok try_first_pass\nauth        requisite     pam_succeed_if.so uid &gt;= 1000 quiet_success\nauth        required      pam_deny.so\n\naccount     required      pam_unix.so\naccount     sufficient    pam_localuser.so\naccount     sufficient    pam_succeed_if.so uid &lt; 1000 quiet\naccount     required      pam_permit.so\n\npassword    requisite     pam_pwquality.so try_first_pass local_users_only retry=3 authtok_type=\npassword    sufficient    pam_unix.so sha512 shadow nullok try_first_pass use_authtok\npassword    required      pam_deny.so\n\nsession     optional      pam_keyinit.so revoke\nsession     required      pam_limits.so\n-session     optional      pam_systemd.so\nsession     [success=1 default=ignore] pam_succeed_if.so service in crond quiet use_uid\nsession     required      pam_unix.so\n</code></pre> <pre><code>#%PAM-1.0\n# This file is auto-generated.\n# User changes will be destroyed the next time authconfig is run.\nauth        required      pam_env.so\nauth        required      pam_faildelay.so delay=2000000\nauth        sufficient    pam_unix.so nullok try_first_pass\nauth        requisite     pam_succeed_if.so uid &gt;= 1000 quiet_success\nauth        required      pam_deny.so\n\naccount     required      pam_unix.so\naccount     sufficient    pam_localuser.so\naccount     sufficient    pam_succeed_if.so uid &lt; 1000 quiet\naccount     required      pam_permit.so\n\npassword    requisite     pam_pwquality.so try_first_pass local_users_only retry=3 authtok_type=\npassword    sufficient    pam_unix.so sha512 shadow nis nullok try_first_pass use_authtok\npassword    required      pam_deny.so\n\nsession     optional      pam_keyinit.so revoke\nsession     required      pam_limits.so\n-session     optional      pam_systemd.so\nsession     [success=1 default=ignore] pam_succeed_if.so service in crond quiet use_uid\nsession     required      pam_unix.so\n</code></pre> </li> <li> <p>\u542f\u52a8\u670d\u52a1</p> <pre><code>systemctl restart rpcbind ypbind\nsystemctl enable rpcbind ypbind\n</code></pre> </li> </ol>"},{"location":"blog/2023/08/26/%E5%AE%89%E8%A3%85nis%E6%9C%8D%E5%8A%A1centos-79/#hosts","title":"\u6d4b\u8bd5\u7528\u6237\u3001\u7528\u6237\u7ec4\u3001hosts\u540c\u6b65\u60c5\u51b5","text":"<p>Warning</p> <p>\u4e0b\u9762\u7684\u547d\u4ee4\u662f\u5728\u4e3b\u673a nis-client.example.com \u4e0a\u6267\u884c\u7684\u3002</p> <ol> <li> <p>\u5728\u4e3b\u673anis-client.example.com\u4e0a\u67e5\u770b\u7528\u6237\u548c\u7528\u6237\u7ec4\u662f\u5426\u5b58\u5728\uff0c\u5982\u679c\u5b58\u5728\u8bf4\u660e\u5df2\u7ecf\u540c\u6b65</p> <p><pre><code>id hdfs;id yarn;id mapred\n</code></pre> \u8f93\u51fa <pre><code>uid=1000(hdfs) gid=1000(hadoop) \u7ec4=1000(hadoop)\nuid=1001(yarn) gid=1000(hadoop) \u7ec4=1000(hadoop)\nuid=1002(mapred) gid=1000(hadoop) \u7ec4=1000(hadoop)\n</code></pre></p> </li> <li> <p>\u5728\u4e3b\u673anis-client.example.com\u4e0aping\u4e3b\u673anis-master.example.com\uff0c\u5982\u679c\u53ef\u4ee5ping\u901a\u8bf4\u660ehosts\u5df2\u7ecf\u540c\u6b65</p> <p><pre><code>ping -c 4 nis-master.example.com\n</code></pre> \u8f93\u51fa <pre><code>PING nis-master.example.com (192.168.2.50) 56(84) bytes of data.\n64 bytes from nis-master.example.com (192.168.2.50): icmp_seq=1 ttl=64 time=0.435 ms\n64 bytes from nis-master.example.com (192.168.2.50): icmp_seq=2 ttl=64 time=0.729 ms\n64 bytes from nis-master.example.com (192.168.2.50): icmp_seq=3 ttl=64 time=0.837 ms\n64 bytes from nis-master.example.com (192.168.2.50): icmp_seq=4 ttl=64 time=0.843 ms\n\n--- nis-master.example.com ping statistics ---\n4 packets transmitted, 4 received, 0% packet loss, time 3003ms\nrtt min/avg/max/mdev = 0.435/0.711/0.843/0.165 ms\n</code></pre> \u901a\u8fc7\u4e0a\u97622\u6b65\u6d4b\u8bd5\u8bc1\u660e\u4e3b\u673anis-client.example.com\u7684\u7528\u6237\u3001\u7528\u6237\u7ec4\u3001hosts \u4e0e\u670d\u52a1\u7aefnis-master.example.com\u7684\u4fdd\u6301\u540c\u6b65\u3002</p> </li> </ol>"},{"location":"blog/2023/08/27/%E5%AE%89%E8%A3%85freeiparocky-linux-92/","title":"\u5b89\u88c5FreeIPA\uff08Rocky Linux 9.2\uff09","text":"<p>\u5b89\u88c5\u76ee\u6807</p> <ul> <li> \u5b89\u88c5\u4e00\u4e2aFreeIPA\u670d\u52a1\u7aef\u5b9e\u4f8b\uff0c\u8be5\u5b9e\u4f8b\u6240\u5728\u4e3b\u673a\u7684 IP \u5730\u5740\u4e3a 192.168.2.60\uff0c\u5bf9\u5e94\u4e3b\u673a\u540d ipa-server.xuwangwei.test\u3002</li> <li> \u5b89\u88c5\u4e00\u4e2aFreeIPA\u5ba2\u6237\u7aef\u5b9e\u4f8b\uff0c\u8be5\u5b9e\u4f8b\u6240\u5728\u4e3b\u673a\u7684 IP \u5730\u5740\u4e3a 192.168.2.61\uff0c\u5bf9\u5e94\u4e3b\u673a\u540d machine1.xuwangwei.test\u3002</li> </ul> <p>\u524d\u7f6e\u6761\u4ef6</p> <ul> <li> \u65e0\u3002</li> </ul>"},{"location":"blog/2023/08/27/%E5%AE%89%E8%A3%85freeiparocky-linux-92/#_1","title":"\u5b89\u88c5\u670d\u52a1\u7aef","text":"<p>Warning</p> <p>\u4e0b\u9762\u7684\u547d\u4ee4\u662f\u5728\u4e3b\u673a ipa-server.xuwangwei.test \u4e0a\u6267\u884c\u7684\u3002</p> <ol> <li> <p>\u8bbe\u7f6e\u4e3b\u673a\u540d</p> <pre><code>hostnamectl hostname ipa-server.xuwangwei.test\n</code></pre> </li> <li> <p>\u4fee\u6539\u914d\u7f6e/etc/hosts</p> <pre><code>127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4\n::1         localhost localhost.localdomain localhost6 localhost6.localdomain6\n192.168.2.60 ipa-server.xuwangwei.test ipa-server\n</code></pre> </li> <li> <p>\u5b89\u88c5</p> <pre><code>dnf install ipa-server ipa-server-dns rng-tools\n</code></pre> </li> <li> <p>\u542f\u52a8\u968f\u673a\u6570\u751f\u6210\u5668\u670d\u52a1rngd.service</p> <pre><code>systemctl start rngd\n</code></pre> </li> <li> <p>\u8bbe\u7f6e\u670d\u52a1\u7aef</p> <pre><code>ipa-server-install --realm=XUWANGWEI.TEST --domain=xuwangwei.test \\\n--hostname=ipa-server.xuwangwei.test --ip-address=192.168.2.60 \\\n--ntp-pool=time.apple.com --mkhomedir \\\n--setup-dns --no-forwarders --reverse-zone=2.168.192.in-addr.arpa --auto-reverse --netbios-name=XUWANGWEI \\\n--ds-password='xuwangwei3306' --admin-password='xuwangwei3306' --unattended\n</code></pre> \u63a7\u5236\u53f0\u8f93\u51fa <pre><code>Checking DNS domain 2.168.192.in-addr.arpa, please wait ...\n\nThe log file for this installation can be found in /var/log/ipaserver-install.log\n==============================================================================\nThis program will set up the IPA Server.\nVersion 4.10.2\n\nThis includes:\n* Configure a stand-alone CA (dogtag) for certificate management\n* Configure the NTP client (chronyd)\n* Create and configure an instance of Directory Server\n* Create and configure a Kerberos Key Distribution Center (KDC)\n* Configure Apache (httpd)\n* Configure DNS (bind)\n* Configure SID generation\n* Configure the KDC to enable PKINIT\n\nWarning: skipping DNS resolution of host ipa-server.xuwangwei.test\nChecking DNS domain xuwangwei.test., please wait ...\nChecking DNS domain 2.168.192.in-addr.arpa, please wait ...\nChecking DNS domain 2.168.192.in-addr.arpa, please wait ...\nUsing reverse zone(s) 2.168.192.in-addr.arpa.\n\nThe IPA Master Server will be configured with:\nHostname:       ipa-server.xuwangwei.test\nIP address(es): 192.168.2.60\nDomain name:    xuwangwei.test\nRealm name:     XUWANGWEI.TEST\n\nThe CA will be configured with:\nSubject DN:   CN=Certificate Authority,O=XUWANGWEI.TEST\nSubject base: O=XUWANGWEI.TEST\nChaining:     self-signed\n\nBIND DNS server will be configured to serve IPA domain with:\nForwarders:       No forwarders\nForward policy:   only\nReverse zone(s):  2.168.192.in-addr.arpa.\n\nNTP pool:   time.apple.com\nDisabled p11-kit-proxy\nSynchronizing time\nConfiguration of chrony was changed by installer.\nAttempting to sync time with chronyc.\nTime synchronization was successful.\nConfiguring directory server (dirsrv). Estimated time: 30 seconds\n[1/43]: creating directory server instance\nValidate installation settings ...\nCreate file system structures ...\nselinux is disabled, will not relabel ports or files.\nCreate database backend: dc=xuwangwei,dc=test ...\nPerform post-installation tasks ...\n[2/43]: tune ldbm plugin\n[3/43]: adding default schema\n[4/43]: enabling memberof plugin\n[5/43]: enabling winsync plugin\n[6/43]: configure password logging\n[7/43]: configuring replication version plugin\n[8/43]: enabling IPA enrollment plugin\n[9/43]: configuring uniqueness plugin\n[10/43]: configuring uuid plugin\n[11/43]: configuring modrdn plugin\n[12/43]: configuring DNS plugin\n[13/43]: enabling entryUSN plugin\n[14/43]: configuring lockout plugin\n[15/43]: configuring graceperiod plugin\n[16/43]: configuring topology plugin\n[17/43]: creating indices\n[18/43]: enabling referential integrity plugin\n[19/43]: configuring certmap.conf\n[20/43]: configure new location for managed entries\n[21/43]: configure dirsrv ccache and keytab\n[22/43]: enabling SASL mapping fallback\n[23/43]: restarting directory server\n[24/43]: adding sasl mappings to the directory\n[25/43]: adding default layout\n[26/43]: adding delegation layout\n[27/43]: creating container for managed entries\n[28/43]: configuring user private groups\n[29/43]: configuring netgroups from hostgroups\n[30/43]: creating default Sudo bind user\n[31/43]: creating default Auto Member layout\n[32/43]: adding range check plugin\n[33/43]: creating default HBAC rule allow_all\n[34/43]: adding entries for topology management\n[35/43]: initializing group membership\n[36/43]: adding master entry\n[37/43]: initializing domain level\n[38/43]: configuring Posix uid/gid generation\n[39/43]: adding replication acis\n[40/43]: activating sidgen plugin\n[41/43]: activating extdom plugin\n[42/43]: configuring directory to start on boot\n[43/43]: restarting directory server\nDone configuring directory server (dirsrv).\nConfiguring Kerberos KDC (krb5kdc)\n[1/11]: adding kerberos container to the directory\n[2/11]: configuring KDC\n[3/11]: initialize kerberos container\n[4/11]: adding default ACIs\n[5/11]: creating a keytab for the directory\n[6/11]: creating a keytab for the machine\n[7/11]: adding the password extension to the directory\n[8/11]: creating anonymous principal\n[9/11]: starting the KDC\n[10/11]: configuring KDC to start on boot\n[11/11]: enable PAC ticket signature support\nDone configuring Kerberos KDC (krb5kdc).\nConfiguring kadmin\n[1/2]: starting kadmin \n[2/2]: configuring kadmin to start on boot\nDone configuring kadmin.\nConfiguring ipa-custodia\n[1/5]: Making sure custodia container exists\n[2/5]: Generating ipa-custodia config file\n[3/5]: Generating ipa-custodia keys\n[4/5]: starting ipa-custodia \n[5/5]: configuring ipa-custodia to start on boot\nDone configuring ipa-custodia.\nConfiguring certificate server (pki-tomcatd). Estimated time: 3 minutes\n[1/30]: configuring certificate server instance\n[2/30]: stopping certificate server instance to update CS.cfg\n[3/30]: backing up CS.cfg\n[4/30]: Add ipa-pki-wait-running\n[5/30]: secure AJP connector\n[6/30]: reindex attributes\n[7/30]: exporting Dogtag certificate store pin\n[8/30]: disabling nonces\n[9/30]: set up CRL publishing\n[10/30]: enable PKIX certificate path discovery and validation\n[11/30]: authorizing RA to modify profiles\n[12/30]: authorizing RA to manage lightweight CAs\n[13/30]: Ensure lightweight CAs container exists\n[14/30]: Ensuring backward compatibility\n[15/30]: starting certificate server instance\n[16/30]: configure certmonger for renewals\n[17/30]: requesting RA certificate from CA\n[18/30]: publishing the CA certificate\n[19/30]: adding RA agent as a trusted user\n[20/30]: configure certificate renewals\n[21/30]: Configure HTTP to proxy connections\n[22/30]: updating IPA configuration\n[23/30]: enabling CA instance\n[24/30]: importing IPA certificate profiles\n[25/30]: migrating certificate profiles to LDAP\n[26/30]: adding default CA ACL\n[27/30]: adding 'ipa' CA entry\n[28/30]: Recording random serial number state\n[29/30]: configuring certmonger renewal for lightweight CAs\n[30/30]: deploying ACME service\nDone configuring certificate server (pki-tomcatd).\nConfiguring directory server (dirsrv)\n[1/3]: configuring TLS for DS instance\n[2/3]: adding CA certificate entry\n[3/3]: restarting directory server\nDone configuring directory server (dirsrv).\nConfiguring ipa-otpd\n[1/2]: starting ipa-otpd \n[2/2]: configuring ipa-otpd to start on boot\nDone configuring ipa-otpd.\nConfiguring the web interface (httpd)\n[1/22]: stopping httpd\n[2/22]: backing up ssl.conf\n[3/22]: disabling nss.conf\n[4/22]: configuring mod_ssl certificate paths\n[5/22]: setting mod_ssl protocol list\n[6/22]: configuring mod_ssl log directory\n[7/22]: disabling mod_ssl OCSP\n[8/22]: adding URL rewriting rules\n[9/22]: configuring httpd\nNothing to do for configure_httpd_wsgi_conf\n[10/22]: setting up httpd keytab\n[11/22]: configuring Gssproxy\n[12/22]: setting up ssl\n[13/22]: configure certmonger for renewals\n[14/22]: publish CA cert\n[15/22]: clean up any existing httpd ccaches\n[16/22]: enable ccache sweep\n[17/22]: configuring SELinux for httpd\n[18/22]: create KDC proxy config\n[19/22]: enable KDC proxy\n[20/22]: starting httpd\n[21/22]: configuring httpd to start on boot\n[22/22]: enabling oddjobd\nDone configuring the web interface (httpd).\nConfiguring Kerberos KDC (krb5kdc)\n[1/1]: installing X509 Certificate for PKINIT\nDone configuring Kerberos KDC (krb5kdc).\nApplying LDAP updates\nUpgrading IPA:. Estimated time: 1 minute 30 seconds\n[1/10]: stopping directory server\n[2/10]: saving configuration\n[3/10]: disabling listeners\n[4/10]: enabling DS global lock\n[5/10]: disabling Schema Compat\n[6/10]: starting directory server\n[7/10]: upgrading server\n[8/10]: stopping directory server\n[9/10]: restoring configuration\n[10/10]: starting directory server\nDone.\nRestarting the KDC\ndnssec-validation yes\nConfiguring DNS (named)\n[1/13]: generating rndc key file\n[2/13]: adding DNS container\n[3/13]: setting up our zone\n[4/13]: setting up reverse zone\n[5/13]: setting up our own record\n[6/13]: setting up records for other masters\n[7/13]: adding NS record to the zones\n[8/13]: setting up kerberos principal\n[9/13]: setting up LDAPI autobind\n[10/13]: setting up named.conf\ncreated new /etc/named.conf\ncreated named user config '/etc/named/ipa-ext.conf'\ncreated named user config '/etc/named/ipa-options-ext.conf'\ncreated named user config '/etc/named/ipa-logging-ext.conf'\n[11/13]: setting up server configuration\n[12/13]: configuring named to start on boot\n[13/13]: changing resolv.conf to point to ourselves\nDone configuring DNS (named).\nRestarting the web server to pick up resolv.conf changes\nConfiguring DNS key synchronization service (ipa-dnskeysyncd)\n[1/7]: checking status\n[2/7]: setting up bind-dyndb-ldap working directory\n[3/7]: setting up kerberos principal\n[4/7]: setting up SoftHSM\n[5/7]: adding DNSSEC containers\n[6/7]: creating replica keys\n[7/7]: configuring ipa-dnskeysyncd to start on boot\nDone configuring DNS key synchronization service (ipa-dnskeysyncd).\nRestarting ipa-dnskeysyncd\nRestarting named\nUpdating DNS system records\nConfiguring SID generation\n[1/8]: adding RID bases\n[2/8]: creating samba domain object\n[3/8]: adding admin(group) SIDs\n[4/8]: updating Kerberos config\n'dns_lookup_kdc' already set to 'true', nothing to do.\n[5/8]: activating sidgen task\n[6/8]: restarting Directory Server to take MS PAC and LDAP plugins changes into account\n[7/8]: adding fallback group\n[8/8]: adding SIDs to existing users and groups\nThis step may take considerable amount of time, please wait..\nDone.\nConfiguring client side components\nThis program will set up IPA client.\nVersion 4.10.2\n\nUsing existing certificate '/etc/ipa/ca.crt'.\nClient hostname: ipa-server.xuwangwei.test\nRealm: XUWANGWEI.TEST\nDNS Domain: xuwangwei.test\nIPA Server: ipa-server.xuwangwei.test\nBaseDN: dc=xuwangwei,dc=test\n\nConfigured /etc/sssd/sssd.conf\nSystemwide CA database updated.\nAdding SSH public key from /etc/ssh/ssh_host_ecdsa_key.pub\nAdding SSH public key from /etc/ssh/ssh_host_ed25519_key.pub\nAdding SSH public key from /etc/ssh/ssh_host_rsa_key.pub\nSSSD enabled\nConfigured /etc/openldap/ldap.conf\nConfigured /etc/ssh/ssh_config\nConfigured /etc/ssh/sshd_config.d/04-ipa.conf\nConfiguring xuwangwei.test as NIS domain.\nClient configuration complete.\nThe ipa-client-install command was successful\n\n==============================================================================\nSetup complete\n\nNext steps:\n    1. You must make sure these network ports are open:\n        TCP Ports:\n        * 80, 443: HTTP/HTTPS\n        * 389, 636: LDAP/LDAPS\n        * 88, 464: kerberos\n        * 53: bind\n        UDP Ports:\n        * 88, 464: kerberos\n        * 53: bind\n        * 123: ntp\n\n    2. You can now obtain a kerberos ticket using the command: 'kinit admin'\n    This ticket will allow you to use the IPA tools (e.g., ipa user-add)\n    and the web user interface.\n\nBe sure to back up the CA certificates stored in /root/cacert.p12\nThese files are required to create replicas. The password for these\nfiles is the Directory Manager password\nThe ipa-server-install command was successful\n</code></pre> </li> <li> <p>\u5141\u8bb8PTR\u540c\u6b65</p> <pre><code>[root@ipa-server ~]# kinit admin\nPassword for admin@XUWANGWEI.TEST: \n[root@ipa-server ~]# ipa dnsconfig-mod --allow-sync-ptr=true\n\u5141\u8bb8PTR\u540c\u6b65: True\nIPA DNS\u670d\u52a1\u5668: ipa-server.xuwangwei.test\n</code></pre> </li> <li> <p>\u8bbe\u7f6e\u9632\u706b\u5899</p> <pre><code>firewall-cmd --add-service={freeipa-4,dns}\nfirewall-cmd --add-service={freeipa-4,dns} --permanent\n</code></pre> <p>\u81f3\u6b64\uff0c\u670d\u52a1\u7aef\u5df2\u5b89\u88c5\u5b8c\u6bd5\u3002</p> </li> </ol>"},{"location":"blog/2023/08/27/%E5%AE%89%E8%A3%85freeiparocky-linux-92/#web","title":"\u8fdb\u5165Web\u7ba1\u7406\u5e73\u53f0\uff08\u53ef\u9009\uff09","text":"<ol> <li> <p>\u7528\u6d4f\u89c8\u5668\u6253\u5f00https://ipa-server.xuwangwei.test</p> <p></p> </li> <li> <p>\u8f93\u5165\u7528\u6237\u540dadmin\u548c\u5bc6\u7801\u540e\u8fdb\u5165\u7ba1\u7406\u9875\u9762</p> <p></p> </li> </ol>"},{"location":"blog/2023/08/27/%E5%AE%89%E8%A3%85freeiparocky-linux-92/#_2","title":"\u5b89\u88c5\u5ba2\u6237\u7aef","text":"<p>Warning</p> <p>\u4e0b\u9762\u7684\u547d\u4ee4\u662f\u5728\u4e3b\u673a machine1.xuwangwei.test \u4e0a\u6267\u884c\u7684\u3002</p> <ol> <li> <p>\u8bbe\u7f6e\u4e3b\u673a\u540d</p> <pre><code>hostnamectl hostname machine1.xuwangwei.test\n</code></pre> </li> <li> <p>\u4fee\u6539\u914d\u7f6e/etc/hosts</p> <pre><code>127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4\n::1         localhost localhost.localdomain localhost6 localhost6.localdomain6\n192.168.2.61 machine1.xuwangwei.test machine1\n</code></pre> </li> <li> <p>\u5b89\u88c5</p> <pre><code>dnf install ipa-client\n</code></pre> </li> <li> <p>\u8bbe\u7f6eDNS\uff0c\u6307\u5411 ipa-server</p> <pre><code>nmcli c modify ens160 ipv4.dns 192.168.2.60\nnmcli c up id ens160\n</code></pre> </li> <li> <p>\u8bbe\u7f6e\u5ba2\u6237\u7aef</p> <pre><code>ipa-client-install --ntp-pool=time.apple.com --mkhomedir \\\n--principal=admin --password='xuwangwei3306' --unattended\n</code></pre> <p>\u4e0b\u9762\u662f\u8bbe\u7f6e\u8fc7\u7a0b\u4e2d\u7684\u8f93\u51fa\u3002\u5ba2\u6237\u7aef\u7684\u8bbe\u7f6e\u8fc7\u7a0b\u76f8\u8f83\u670d\u52a1\u7aef\u7684\u8bbe\u7f6e\u7b80\u5355\u5f88\u591a\uff0c\u901f\u5ea6\u4e5f\u5feb\u5f88\u591a\u3002</p> \u63a7\u5236\u53f0\u8f93\u51fa <pre><code>This program will set up IPA client.\nVersion 4.10.2\n\nDiscovery was successful!\nClient hostname: machine1.xuwangwei.test\nRealm: XUWANGWEI.TEST\nDNS Domain: xuwangwei.test\nIPA Server: ipa-server.xuwangwei.test\nBaseDN: dc=xuwangwei,dc=test\nNTP pool: time.apple.com\n\nSynchronizing time\nConfiguration of chrony was changed by installer.\nAttempting to sync time with chronyc.\nTime synchronization was successful.\nSuccessfully retrieved CA cert\n    Subject:     CN=Certificate Authority,O=XUWANGWEI.TEST\n    Issuer:      CN=Certificate Authority,O=XUWANGWEI.TEST\n    Valid From:  2023-12-10 01:11:36\n    Valid Until: 2043-12-10 01:11:36\n\nEnrolled in IPA realm XUWANGWEI.TEST\nCreated /etc/ipa/default.conf\nConfigured /etc/sssd/sssd.conf\nSystemwide CA database updated.\nHostname (machine1.xuwangwei.test) does not have A/AAAA record.\nMissing reverse record(s) for address(es): fdb4:1b:7835:4c67:20c:29ff:fe7c:a184.\nAdding SSH public key from /etc/ssh/ssh_host_ecdsa_key.pub\nAdding SSH public key from /etc/ssh/ssh_host_ed25519_key.pub\nAdding SSH public key from /etc/ssh/ssh_host_rsa_key.pub\nSSSD enabled\nConfigured /etc/openldap/ldap.conf\nConfigured /etc/ssh/ssh_config\nConfigured /etc/ssh/sshd_config.d/04-ipa.conf\nConfiguring xuwangwei.test as NIS domain.\nConfigured /etc/krb5.conf for IPA realm XUWANGWEI.TEST\nClient configuration complete.\nThe ipa-client-install command was successful\n</code></pre> </li> <li> <p>\u67e5\u770bWeb\u7ba1\u7406\u9875\u9762</p> <p></p> <p>\u4ece\u4e0a\u56fe\u4e2d\u53ef\u4ee5\u770b\u5230\u5ba2\u6237\u7aef\u5df2\u7ecf\u6210\u529f\u6ce8\u518c\u3002\u81f3\u6b64\uff0c\u5ba2\u6237\u7aef\u5df2\u7ecf\u5b89\u88c5\u5b8c\u6bd5\u3002</p> </li> </ol>"},{"location":"blog/2024/01/05/%E5%AE%89%E8%A3%85-hbase-%E9%9B%86%E7%BE%A4rocky-linux-92/","title":"\u5b89\u88c5 HBase \u96c6\u7fa4(Rocky Linux 9.2)","text":"<p>\u5b89\u88c5\u76ee\u6807</p> <ul> <li> HBase \u96c6\u7fa4\u542f\u7528 Kerberos \u8ba4\u8bc1\u3002</li> <li> HBase \u7531 2 \u4e2a Master \u548c 3 \u4e2a RegionServer \u7ec4\u6210\u96c6\u7fa4\u3002</li> <li> HBase \u7684\u7248\u672c\u662f 2.5.7\u3002</li> </ul> <p>\u524d\u7f6e\u6761\u4ef6</p> <ul> <li> \u5df2\u6309\u7167\u5b89\u88c5 Hadoop \u96c6\u7fa4(Rocky Linux 9.2)\u5b89\u88c5 Hadoop\u3002</li> </ul>"},{"location":"blog/2024/01/05/%E5%AE%89%E8%A3%85-hbase-%E9%9B%86%E7%BE%A4rocky-linux-92/#_1","title":"\u51c6\u5907\u7528\u6237","text":"<p>Warning</p> <p>\u4e0b\u9762\u7684\u547d\u4ee4\u662f\u5728\u4e3b\u673a ipa-server \u4e0a\u6267\u884c\u7684\u3002</p> <ol> <li> <p>\u8eab\u4efd\u8ba4\u8bc1</p> <pre><code>[root@ipa-server ~]# kinit admin\nPassword for admin@XUWANGWEI.TEST: \n</code></pre> </li> <li> <p>\u65b0\u589e\u7528\u6237 hbase</p> <pre><code>ipa user-add hbase --first=hbase --last=hadoop --shell=/bin/bash --gidnumber=1532600004\nsu - hbase\nssh-keygen -t rsa -P '' -f ~/.ssh/id_rsa\ncat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys\nchmod 0600 ~/.ssh/authorized_keys\nexit\nipa user-mod hbase --sshpubkey=\"$( cat ~hbase/.ssh/id_rsa.pub )\"\n</code></pre> </li> </ol>"},{"location":"blog/2024/01/05/%E5%AE%89%E8%A3%85-hbase-%E9%9B%86%E7%BE%A4rocky-linux-92/#hbase","title":"\u5171\u4eab HBase \u914d\u7f6e\u76ee\u5f55","text":"<p>Warning</p> <p>\u4e0b\u9762\u7684\u547d\u4ee4\u662f\u5728\u4e3b\u673a ipa-server \u4e0a\u6267\u884c\u7684\u3002</p> <ol> <li> <p>\u4fee\u6539 NFS \u914d\u7f6e\u6587\u4ef6/etc/exports\uff0c\u4f7f\u5f97\u4e3b\u673a ipa-server \u4e0a\u7684/etc/hbase \u76ee\u5f55\u5171\u4eab\u7ed9\u5176\u4ed6\u4e3b\u673a\u3002</p> <pre><code>echo '/etc/hbase 192.168.2.0/24(rw,sync,no_root_squash)' &gt;&gt; /etc/exports\n</code></pre> </li> <li> <p>\u521b\u5efa HBase \u914d\u7f6e\u76ee\u5f55\u5e76\u8bbe\u7f6e\u5c5e\u4e3b\u5c5e\u7ec4</p> <pre><code>mkdir /etc/hbase\nchown hbase:hadoop /etc/hbase\nchmod 755 /etc/hbase\n</code></pre> </li> <li> <p>\u5237\u65b0 NFS \u7684\u914d\u7f6e</p> <pre><code>exportfs -rv\n</code></pre> </li> <li> <p>\u5728 IPA Server \u4e0a\u521b\u5efa\u6302\u8f7d\u914d\u7f6e</p> <pre><code>ipa automountkey-add default auto.direct --key=/etc/hbase --info=\"-fstype=nfs4,rw ipa-server:/etc/hbase\"\n</code></pre> </li> </ol>"},{"location":"blog/2024/01/05/%E5%AE%89%E8%A3%85-hbase-%E9%9B%86%E7%BE%A4rocky-linux-92/#hbase_1","title":"\u5b89\u88c5 HBase","text":"<p>Warning</p> <p>\u4e0b\u9762\u7684\u547d\u4ee4\u9700\u8981\u5728\u4e3b\u673a machine1~machine5 \u4e0a\u6267\u884c\u3002</p> <ol> <li> <p>\u4e0b\u8f7d\u3001\u89e3\u538b\u3001\u521b\u5efa\u522b\u540d</p> <pre><code>cd /opt\ncurl -O https://dlcdn.apache.org/hbase/2.5.7/hbase-2.5.7-hadoop3-bin.tar.gz\ntar -zxf hbase-2.5.7-hadoop3-bin.tar.gz\nln -s hbase-2.5.7-hadoop3 hbase\n</code></pre> </li> <li> <p>\u6dfb\u52a0\u73af\u5883\u53d8\u91cf</p> <pre><code>echo 'export HBASE_HOME=/opt/hbase' &gt; /etc/profile.d/hbase.sh\necho 'export PATH=$PATH:$HBASE_HOME/bin' &gt;&gt; /etc/profile.d/hbase.sh\necho 'export HBASE_CONF_DIR=/etc/hbase' &gt;&gt; /etc/profile.d/hbase.sh\nsource /etc/profile.d/hbase.sh\n</code></pre> </li> <li> <p>\u521b\u5efa\u6570\u636e\u76ee\u5f55\u5e76\u8bbe\u7f6e\u5c5e\u4e3b\u5c5e\u7ec4</p> <pre><code>chown -R -H hbase:hadoop $HBASE_HOME\nchmod 755 $HBASE_HOME\nmkdir /var/lib/hbase\nchown hbase:hadoop /var/lib/hbase\nchmod 750 /var/lib/hbase\n</code></pre> </li> <li> <p>\u521b\u5efa\u914d\u7f6e\u76ee\u5f55\u5e76\u8bbe\u7f6e\u5c5e\u4e3b\u5c5e\u7ec4</p> <pre><code>mkdir /etc/hbase\nchown hbase:hadoop /etc/hbase\nchmod 755 /etc/hbase\n</code></pre> </li> <li> <p>\u521b\u5efa\u65e5\u5fd7\u76ee\u5f55\u5e76\u8bbe\u7f6e\u5c5e\u4e3b\u5c5e\u7ec4</p> <pre><code>mkdir /var/log/hbase\nchown hbase:hadoop /var/log/hbase\nchmod 755 /var/log/hbase\n</code></pre> </li> <li> <p>\u5171\u4eab ipa-server \u7684/etc/hbase \u76ee\u5f55</p> <pre><code>systemctl reload autofs\n</code></pre> </li> </ol>"},{"location":"blog/2024/01/05/%E5%AE%89%E8%A3%85-hbase-%E9%9B%86%E7%BE%A4rocky-linux-92/#kerberos-principals-keytab-files","title":"\u51c6\u5907 Kerberos principals \u548c keytab files","text":"<p>Warning</p> <p>\u4e0b\u9762\u7684\u547d\u4ee4\u662f\u5728\u4e3b\u673a ipa-server \u4e0a\u6267\u884c\u7684\u3002</p> <ol> <li> <p>\u521b\u5efaprincipal</p> <pre><code>ipa service-add hbase/machine1.xuwangwei.test@XUWANGWEI.TEST --requires-pre-auth=true\nipa service-add hbase/machine2.xuwangwei.test@XUWANGWEI.TEST --requires-pre-auth=true\nipa service-add hbase/machine3.xuwangwei.test@XUWANGWEI.TEST --requires-pre-auth=true\nipa service-add hbase/machine4.xuwangwei.test@XUWANGWEI.TEST --requires-pre-auth=true\nipa service-add hbase/machine5.xuwangwei.test@XUWANGWEI.TEST --requires-pre-auth=true\n</code></pre> </li> <li> <p>\u5bfc\u51faprincipal\u7684\u5bc6\u94a5</p> <pre><code>ipa-getkeytab --principal=hbase/machine1.xuwangwei.test@XUWANGWEI.TEST --keytab=/etc/hbase/hbase.keytab --enctypes=aes256-sha1,aes128-sha1\nipa-getkeytab --principal=hbase/machine2.xuwangwei.test@XUWANGWEI.TEST --keytab=/etc/hbase/hbase.keytab --enctypes=aes256-sha1,aes128-sha1\nipa-getkeytab --principal=hbase/machine3.xuwangwei.test@XUWANGWEI.TEST --keytab=/etc/hbase/hbase.keytab --enctypes=aes256-sha1,aes128-sha1\nipa-getkeytab --principal=hbase/machine4.xuwangwei.test@XUWANGWEI.TEST --keytab=/etc/hbase/hbase.keytab --enctypes=aes256-sha1,aes128-sha1\nipa-getkeytab --principal=hbase/machine5.xuwangwei.test@XUWANGWEI.TEST --keytab=/etc/hbase/hbase.keytab --enctypes=aes256-sha1,aes128-sha1\nipa-getkeytab --principal=hbase@XUWANGWEI.TEST --keytab=/etc/hbase/hbase.keytab --enctypes=aes256-sha1,aes128-sha1\n</code></pre> </li> <li> <p>\u4fee\u6539keytab\u7684\u5c5e\u4e3b\u5c5e\u7ec4\u548c\u6743\u9650</p> <pre><code>chown hbase:hadoop /etc/hbase/*.keytab\nchmod 640 /etc/hbase/*.keytab\n</code></pre> </li> </ol>"},{"location":"blog/2024/01/05/%E5%AE%89%E8%A3%85-hbase-%E9%9B%86%E7%BE%A4rocky-linux-92/#hbase_2","title":"\u914d\u7f6e HBase","text":"<p>Warning</p> <p>\u4e0b\u9762\u7684\u547d\u4ee4\u662f\u5728\u4e3b\u673a machine1 \u4e0a\u6267\u884c\u7684\u3002</p> <ol> <li> <p>\u590d\u5236\u5b89\u88c5\u5305\u4e2d\u7684\u9ed8\u8ba4\u914d\u7f6e\u6587\u4ef6\u5230\u914d\u7f6e\u76ee\u5f55</p> <pre><code>cp -a $HBASE_HOME/conf/* $HBASE_CONF_DIR/\n</code></pre> </li> <li> <p>\u4fee\u6539\u914d\u7f6e\u6587\u4ef6$HBASE_CONF_DIR/hbase-env.sh</p> <pre><code>#!/usr/bin/env bash\n#\n#/**\n# * Licensed to the Apache Software Foundation (ASF) under one\n# * or more contributor license agreements.  See the NOTICE file\n# * distributed with this work for additional information\n# * regarding copyright ownership.  The ASF licenses this file\n# * to you under the Apache License, Version 2.0 (the\n# * \"License\"); you may not use this file except in compliance\n# * with the License.  You may obtain a copy of the License at\n# *\n# *     http://www.apache.org/licenses/LICENSE-2.0\n# *\n# * Unless required by applicable law or agreed to in writing, software\n# * distributed under the License is distributed on an \"AS IS\" BASIS,\n# * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# * See the License for the specific language governing permissions and\n# * limitations under the License.\n# */\n\n# Set environment variables here.\n\n# This script sets variables multiple times over the course of starting an hbase process,\n# so try to keep things idempotent unless you want to take an even deeper look\n# into the startup scripts (bin/hbase, etc.)\n\n# The java implementation to use.  Java 1.8+ required.\n# export JAVA_HOME=/usr/java/jdk1.8.0/\n\n# Extra Java CLASSPATH elements.  Optional.\n# export HBASE_CLASSPATH=\n\n# The maximum amount of heap to use. Default is left to JVM default.\n# export HBASE_HEAPSIZE=1G\n\n# Uncomment below if you intend to use off heap cache. For example, to allocate 8G of\n# offheap, set the value to \"8G\".\n# export HBASE_OFFHEAPSIZE=1G\n\n# Extra Java runtime options.\n# Default settings are applied according to the detected JVM version. Override these default\n# settings by specifying a value here. For more details on possible settings,\n# see http://hbase.apache.org/book.html#_jvm_tuning\nexport HBASE_OPTS=\"${HBASE_OPTS} -Djava.net.preferIPv4Stack=true\"\nexport HBASE_SHELL_OPTS=\"${HBASE_SHELL_OPTS} -Djava.security.auth.login.config=$HBASE_CONF_DIR/client-jaas.conf\"\nexport HBASE_MASTER_OPTS=\"${HBASE_MASTER_OPTS} -Djava.security.auth.login.config=$HBASE_CONF_DIR/server-jaas.conf\"\nexport HBASE_REGIONSERVER_OPTS=\"${HBASE_REGIONSERVER_OPTS} -Djava.security.auth.login.config=$HBASE_CONF_DIR/server-jaas.conf\"\n\n# Uncomment one of the below three options to enable java garbage collection logging for the server-side processes.\n\n# This enables basic gc logging to the .out file.\n# export SERVER_GC_OPTS=\"-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps\"\n\n# This enables basic gc logging to its own file.\n# If FILE-PATH is not replaced, the log file(.gc) would still be generated in the HBASE_LOG_DIR .\n# export SERVER_GC_OPTS=\"-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -Xloggc:&lt;FILE-PATH&gt;\"\n\n# This enables basic GC logging to its own file with automatic log rolling. Only applies to jdk 1.6.0_34+ and 1.7.0_2+.\n# If FILE-PATH is not replaced, the log file(.gc) would still be generated in the HBASE_LOG_DIR .\n# export SERVER_GC_OPTS=\"-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -Xloggc:&lt;FILE-PATH&gt; -XX:+UseGCLogFileRotation -XX:NumberOfGCLogFiles=1 -XX:GCLogFileSize=512M\"\n\n# Uncomment one of the below three options to enable java garbage collection logging for the client processes.\n\n# This enables basic gc logging to the .out file.\n# export CLIENT_GC_OPTS=\"-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps\"\n\n# This enables basic gc logging to its own file.\n# If FILE-PATH is not replaced, the log file(.gc) would still be generated in the HBASE_LOG_DIR .\n# export CLIENT_GC_OPTS=\"-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -Xloggc:&lt;FILE-PATH&gt;\"\n\n# This enables basic GC logging to its own file with automatic log rolling. Only applies to jdk 1.6.0_34+ and 1.7.0_2+.\n# If FILE-PATH is not replaced, the log file(.gc) would still be generated in the HBASE_LOG_DIR .\n# export CLIENT_GC_OPTS=\"-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -Xloggc:&lt;FILE-PATH&gt; -XX:+UseGCLogFileRotation -XX:NumberOfGCLogFiles=1 -XX:GCLogFileSize=512M\"\n\n# See the package documentation for org.apache.hadoop.hbase.io.hfile for other configurations\n# needed setting up off-heap block caching.\n\n# Uncomment and adjust to enable JMX exporting\n# See jmxremote.password and jmxremote.access in $JRE_HOME/lib/management to configure remote password access.\n# More details at: http://java.sun.com/javase/6/docs/technotes/guides/management/agent.html\n# NOTE: HBase provides an alternative JMX implementation to fix the random ports issue, please see JMX\n# section in HBase Reference Guide for instructions.\n\n# export HBASE_JMX_BASE=\"-Dcom.sun.management.jmxremote.ssl=false -Dcom.sun.management.jmxremote.authenticate=false\"\n# export HBASE_MASTER_OPTS=\"$HBASE_MASTER_OPTS $HBASE_JMX_BASE -Dcom.sun.management.jmxremote.port=10101\"\n# export HBASE_REGIONSERVER_OPTS=\"$HBASE_REGIONSERVER_OPTS $HBASE_JMX_BASE -Dcom.sun.management.jmxremote.port=10102\"\n# export HBASE_THRIFT_OPTS=\"$HBASE_THRIFT_OPTS $HBASE_JMX_BASE -Dcom.sun.management.jmxremote.port=10103\"\n# export HBASE_ZOOKEEPER_OPTS=\"$HBASE_ZOOKEEPER_OPTS $HBASE_JMX_BASE -Dcom.sun.management.jmxremote.port=10104\"\n# export HBASE_REST_OPTS=\"$HBASE_REST_OPTS $HBASE_JMX_BASE -Dcom.sun.management.jmxremote.port=10105\"\n\n# File naming hosts on which HRegionServers will run.  $HBASE_HOME/conf/regionservers by default.\nexport HBASE_REGIONSERVERS=$HBASE_CONF_DIR/regionservers\n\n# Uncomment and adjust to keep all the Region Server pages mapped to be memory resident\n#HBASE_REGIONSERVER_MLOCK=true\n#HBASE_REGIONSERVER_UID=\"hbase\"\n\n# File naming hosts on which backup HMaster will run.  $HBASE_HOME/conf/backup-masters by default.\nexport HBASE_BACKUP_MASTERS=$HBASE_CONF_DIR/backup-masters\n\n# Extra ssh options.  Empty by default.\n# export HBASE_SSH_OPTS=\"-o ConnectTimeout=1 -o SendEnv=HBASE_CONF_DIR\"\n\n# Where log files are stored.  $HBASE_HOME/logs by default.\nexport HBASE_LOG_DIR=/var/log/hbase\n\n# Enable remote JDWP debugging of major HBase processes. Meant for Core Developers\n# export HBASE_MASTER_OPTS=\"$HBASE_MASTER_OPTS -Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=8070\"\n# export HBASE_REGIONSERVER_OPTS=\"$HBASE_REGIONSERVER_OPTS -Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=8071\"\n# export HBASE_THRIFT_OPTS=\"$HBASE_THRIFT_OPTS -Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=8072\"\n# export HBASE_ZOOKEEPER_OPTS=\"$HBASE_ZOOKEEPER_OPTS -Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=8073\"\n# export HBASE_REST_OPTS=\"$HBASE_REST_OPTS -Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=8074\"\n\n# A string representing this instance of hbase. $USER by default.\n# export HBASE_IDENT_STRING=$USER\n\n# The scheduling priority for daemon processes.  See 'man nice'.\n# export HBASE_NICENESS=10\n\n# The directory where pid files are stored. /tmp by default.\n# export HBASE_PID_DIR=/var/hadoop/pids\n\n# Seconds to sleep between slave commands.  Unset by default.  This\n# can be useful in large clusters, where, e.g., slave rsyncs can\n# otherwise arrive faster than the master can service them.\n# export HBASE_SLAVE_SLEEP=0.1\n\n# Tell HBase whether it should manage it's own instance of ZooKeeper or not.\nexport HBASE_MANAGES_ZK=false\n\n# The default log rolling policy is RFA, where the log file is rolled as per the size defined for the\n# RFA appender. Please refer to the log4j2.properties file to see more details on this appender.\n# In case one needs to do log rolling on a date change, one should set the environment property\n# HBASE_ROOT_LOGGER to \"&lt;DESIRED_LOG LEVEL&gt;,DRFA\".\n# For example:\n# export HBASE_ROOT_LOGGER=INFO,DRFA\n# The reason for changing default to RFA is to avoid the boundary case of filling out disk space as\n# DRFA doesn't put any cap on the log size. Please refer to HBase-5655 for more context.\n\n# Tell HBase whether it should include Hadoop's lib when start up,\n# the default value is false,means that includes Hadoop's lib.\nexport HBASE_DISABLE_HADOOP_CLASSPATH_LOOKUP=\"true\"\n\n# Override text processing tools for use by these launch scripts.\n# export GREP=\"${GREP-grep}\"\n# export SED=\"${SED-sed}\"\n\n#\n## OpenTelemetry Tracing\n#\n# HBase is instrumented for tracing using OpenTelemetry. None of the other OpenTelemetry signals\n# are supported at this time. Configuring tracing involves setting several configuration points,\n# via environment variable or system property. This configuration prefers setting environment\n# variables whenever possible because they are picked up by all processes launched by `bin/hbase`.\n# Use system properties when you launch multiple processes from the same configuration directory --\n# when you need to specify different configuration values for different hbase processes that are\n# launched using the same HBase configuration (i.e., a single-host pseudo-distributed cluster or\n# launching the `bin/hbase shell` from a host that is also running an instance of the master). See\n# https://github.com/open-telemetry/opentelemetry-java/tree/v1.15.0/sdk-extensions/autoconfigure\n# for an inventory of configuration points and detailed explanations of each of them.\n#\n# Note also that as of this writing, the javaagent logs to stderr and is not configured along with\n# the rest of HBase's logging configuration.\n#\n# `HBASE_OTEL_TRACING_ENABLED`, required. Enable attaching the opentelemetry javaagent to the\n# process via support provided by `bin/hbase`. When this value us `false`, the agent is not added\n# to the process launch arguments and all further OpenTelemetry configuration is ignored.\n#export HBASE_OTEL_TRACING_ENABLED=true\n#\n# `OPENTELEMETRY_JAVAAGENT_PATH`, optional. Override the javaagent provided by HBase in `lib/trace`\n# with an alternate. Use when you need to upgrade the agent version or swap out the official one\n# for an alternative implementation.\n#export OPENTELEMETRY_JAVAAGENT_PATH=\"\"\n#\n# `OTEL_FOO_EXPORTER`, required. Specify an Exporter implementation per signal type. HBase only\n# makes explicit use of the traces signal at this time, so the important one is\n# `OTEL_TRACES_EXPORTER`. Specify its value based on the exporter required for your tracing\n# environment. The other two should be uncommented and specified as `none`, otherwise the agent\n# may report errors while attempting to export these other signals to an unconfigured destination.\n# https://github.com/open-telemetry/opentelemetry-java/tree/v1.15.0/sdk-extensions/autoconfigure#exporters\n#export OTEL_TRACES_EXPORTER=\"\"\n#export OTEL_METRICS_EXPORTER=\"none\"\n#export OTEL_LOGS_EXPORTER=\"none\"\n#\n# `OTEL_SERVICE_NAME`, required. Specify \"resource attributes\", and specifically the `service.name`,\n# as a unique value for each HBase process. OpenTelemetry allows for specifying this value in one\n# of two ways, via environment variables with the `OTEL_` prefix, or via system properties with the\n# `otel.` prefix. Which you use with HBase is decided based on whether this configuration file is\n# read by a single process or shared by multiple HBase processes. For the default standalone mode\n# or an environment where all processes share the same configuration file, use the `otel` system\n# properties by uncommenting all of the `HBASE_FOO_OPTS` exports below. When this configuration file\n# is being consumed by only a single process -- for example, from a systemd configuration or in a\n# container template -- replace use of `HBASE_FOO_OPTS` with the standard `OTEL_SERVICE_NAME` and/or\n# `OTEL_RESOURCE_ATTRIBUTES` environment variables. For further details, see\n# https://github.com/open-telemetry/opentelemetry-java/tree/v1.15.0/sdk-extensions/autoconfigure#opentelemetry-resource\n#export HBASE_CANARY_OPTS=\"${HBASE_CANARY_OPTS} -Dotel.resource.attributes=service.name=hbase-canary\"\n#export HBASE_HBCK_OPTS=\"${HBASE_HBCK_OPTS} -Dotel.resource.attributes=service.name=hbase-hbck\"\n#export HBASE_HBTOP_OPTS=\"${HBASE_HBTOP_OPTS} -Dotel.resource.attributes=service.name=hbase-hbtop\"\n#export HBASE_JSHELL_OPTS=\"${HBASE_JSHELL_OPTS} -Dotel.resource.attributes=service.name=hbase-jshell\"\n#export HBASE_LTT_OPTS=\"${HBASE_LTT_OPTS} -Dotel.resource.attributes=service.name=hbase-loadtesttool\"\n#export HBASE_MASTER_OPTS=\"${HBASE_MASTER_OPTS} -Dotel.resource.attributes=service.name=hbase-master\"\n#export HBASE_PE_OPTS=\"${HBASE_PE_OPTS} -Dotel.resource.attributes=service.name=hbase-performanceevaluation\"\n#export HBASE_REGIONSERVER_OPTS=\"${HBASE_REGIONSERVER_OPTS} -Dotel.resource.attributes=service.name=hbase-regionserver\"\n#export HBASE_REST_OPTS=\"${HBASE_REST_OPTS} -Dotel.resource.attributes=service.name=hbase-rest\"\n#export HBASE_SHELL_OPTS=\"${HBASE_SHELL_OPTS} -Dotel.resource.attributes=service.name=hbase-shell\"\n#export HBASE_THRIFT_OPTS=\"${HBASE_THRIFT_OPTS} -Dotel.resource.attributes=service.name=hbase-thrift\"\n#export HBASE_ZOOKEEPER_OPTS=\"${HBASE_ZOOKEEPER_OPTS} -Dotel.resource.attributes=service.name=hbase-zookeeper\"\n\n#\n# JDK11+ JShell\n#\n# Additional arguments passed to jshell invocation\n# export HBASE_JSHELL_ARGS=\"--startup DEFAULT --startup PRINTING --startup hbase_startup.jsh\"\n</code></pre> </li> <li> <p>\u4fee\u6539\u914d\u7f6e\u6587\u4ef6$HBASE_CONF_DIR/hbase-site.xml</p> <pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;?xml-stylesheet type=\"text/xsl\" href=\"configuration.xsl\"?&gt;\n&lt;!--\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*     http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n--&gt;\n&lt;configuration&gt;\n&lt;property&gt;\n    &lt;name&gt;hbase.cluster.distributed&lt;/name&gt;\n    &lt;value&gt;true&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;hbase.rootdir&lt;/name&gt;\n    &lt;value&gt;hdfs://xuwangwei/user/hbase&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;hbase.zookeeper.quorum&lt;/name&gt;\n    &lt;value&gt;machine1.xuwangwei.test:2181,machine2.xuwangwei.test:2181,machine3.xuwangwei.test:2181,machine4.xuwangwei.test:2181,machine5.xuwangwei.test:2181&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;hbase.security.authentication&lt;/name&gt;\n    &lt;value&gt;kerberos&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;hbase.rpc.protection&lt;/name&gt;\n    &lt;value&gt;authentication,integrity,privacy&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;hbase.master.keytab.file&lt;/name&gt;\n    &lt;value&gt;/etc/hbase/hbase.keytab&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;hbase.master.kerberos.principal&lt;/name&gt;\n    &lt;value&gt;hbase/_HOST@XUWANGWEI.TEST&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;hbase.regionserver.keytab.file&lt;/name&gt;\n    &lt;value&gt;/etc/hbase/hbase.keytab&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;hbase.regionserver.kerberos.principal&lt;/name&gt;\n    &lt;value&gt;hbase/_HOST@XUWANGWEI.TEST&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;hbase.tmp.dir&lt;/name&gt;\n    &lt;value&gt;/var/lib/hbase/hbase-${user.name}&lt;/value&gt;\n&lt;/property&gt;\n&lt;/configuration&gt;\n</code></pre> </li> <li> <p>\u4fee\u6539\u914d\u7f6e\u6587\u4ef6$HBASE_CONF_DIR/regionservers</p> <pre><code>echo 'machine3.xuwangwei.test' &gt; $HBASE_CONF_DIR/regionservers\necho 'machine4.xuwangwei.test' &gt;&gt; $HBASE_CONF_DIR/regionservers\necho 'machine5.xuwangwei.test' &gt;&gt; $HBASE_CONF_DIR/regionservers\n</code></pre> </li> <li> <p>\u521b\u5efa\u914d\u7f6e\u6587\u4ef6$HBASE_CONF_DIR/backup-masters</p> <pre><code>echo 'machine2.xuwangwei.test' &gt; $HBASE_CONF_DIR/backup-masters\n</code></pre> </li> <li> <p>\u521b\u5efa\u914d\u7f6e\u6587\u4ef6$HBASE_CONF_DIR/client-jaas.conf</p> <pre><code>Client {\ncom.sun.security.auth.module.Krb5LoginModule required\nuseKeyTab=false\nuseTicketCache=true;\n};\n</code></pre> </li> <li> <p>\u521b\u5efa\u914d\u7f6e\u6587\u4ef6$HBASE_CONF_DIR/server-jaas.conf</p> <pre><code>Client {\ncom.sun.security.auth.module.Krb5LoginModule required\nuseKeyTab=true\nuseTicketCache=false\nkeyTab=\"/etc/hbase/hbase.keytab\"\nprincipal=\"hbase\";\n};\n</code></pre> </li> <li> <p>\u4fee\u6539 3 \u4e2a\u65b0\u5efa\u6587\u4ef6\u7684\u5c5e\u4e3b\u5c5e\u7ec4</p> <pre><code>chown hbase:hadoop $HBASE_CONF_DIR/backup-masters\nchown hbase:hadoop $HBASE_CONF_DIR/client-jaas.conf\nchown hbase:hadoop $HBASE_CONF_DIR/server-jaas.conf\n</code></pre> </li> <li> <p>\u4fee\u6539\u914d\u7f6e\u6587\u4ef6 $HADOOP_CONF_DIR/core-site.xml</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;?xml-stylesheet type=\"text/xsl\" href=\"configuration.xsl\"?&gt;\n&lt;!--\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License. See accompanying LICENSE file.\n--&gt;\n\n&lt;!-- Put site-specific property overrides in this file. --&gt;\n\n&lt;configuration&gt;\n&lt;property&gt;\n    &lt;name&gt;fs.defaultFS&lt;/name&gt;\n    &lt;value&gt;hdfs://xuwangwei&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;hadoop.tmp.dir&lt;/name&gt;\n    &lt;value&gt;/var/lib/hadoop&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;hadoop.zk.address&lt;/name&gt;\n    &lt;value&gt;machine1.xuwangwei.test:2181,machine2.xuwangwei.test:2181,machine3.xuwangwei.test:2181,machine4.xuwangwei.test:2181,machine5.xuwangwei.test:2181&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;ha.zookeeper.quorum&lt;/name&gt;\n    &lt;value&gt;machine1.xuwangwei.test:2181,machine2.xuwangwei.test:2181,machine3.xuwangwei.test:2181,machine4.xuwangwei.test:2181,machine5.xuwangwei.test:2181&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;hadoop.security.authentication&lt;/name&gt;\n    &lt;value&gt;kerberos&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;hadoop.rpc.protection&lt;/name&gt;\n    &lt;value&gt;authentication,integrity,privacy&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;hadoop.proxyuser.hive.hosts&lt;/name&gt;\n    &lt;value&gt;*&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;hadoop.proxyuser.hive.groups&lt;/name&gt;\n    &lt;value&gt;*&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;hadoop.proxyuser.hbase.hosts&lt;/name&gt;\n    &lt;value&gt;*&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;hadoop.proxyuser.hbase.groups&lt;/name&gt;\n    &lt;value&gt;*&lt;/value&gt;\n&lt;/property&gt;\n&lt;/configuration&gt;\n</code></pre> </li> <li> <p>\u521b\u5efa\u522b\u540d\u3002$HADOOP_CONF_DIR/hdfs-site.xml \u27a1\ufe0f $HBASE_CONF_DIR/hdfs-site.xml</p> <pre><code>ln -s $HADOOP_CONF_DIR/hdfs-site.xml $HBASE_CONF_DIR/hdfs-site.xml\n</code></pre> </li> <li> <p>\u4fee\u6539 hbase \u7528\u6237\u53ef\u4ee5\u540c\u65f6\u6253\u5f00\u7684\u6587\u4ef6\u6570\u91cf</p> <pre><code>echo 'hbase  -  nofile  10240' &gt; /etc/security/limits.d/hbase.conf\n</code></pre> </li> <li> <p>\u4f7f core-site.xml \u4e2d\u521a\u4fee\u6539\u7684\u914d\u7f6e\u751f\u6548</p> <pre><code>su - hdfs -c \"kinit -kt /etc/hadoop/hdfs.keytab hdfs\"\nsu - hdfs -c \"hdfs dfsadmin -refreshSuperUserGroupsConfiguration\"\nsu - yarn -c \"kinit -kt /etc/hadoop/yarn.keytab yarn\"\nsu - yarn -c \"yarn rmadmin -refreshSuperUserGroupsConfiguration\"\n</code></pre> </li> </ol>"},{"location":"blog/2024/01/05/%E5%AE%89%E8%A3%85-hbase-%E9%9B%86%E7%BE%A4rocky-linux-92/#hbase_3","title":"\u542f\u52a8 HBase","text":"<ol> <li> <p>\u542f\u52a8</p> <pre><code>su - hbase -c 'start-hbase.sh'\n</code></pre> </li> </ol>"},{"location":"blog/2024/01/05/%E5%AE%89%E8%A3%85-hbase-%E9%9B%86%E7%BE%A4rocky-linux-92/#hbase-shell-hbase","title":"\u4f7f\u7528 HBase Shell \u8fde\u63a5 HBase \u670d\u52a1","text":"<ol> <li> <p>\u6dfb\u52a0 hbase \u7528\u6237\u7684\u73af\u5883\u53d8\u91cf</p> <pre><code>echo 'export KRB5CCNAME=FILE:/tmp/krb5cc_$UID' &gt;&gt; ~hbase/.bashrc\n</code></pre> </li> <li> <p>\u4f7f\u7528 hbase@XUWANGWEI.TEST \u5e10\u53f7\u8fdb\u884c Kerberos \u8ba4\u8bc1</p> <pre><code>su - hbase -c \"kinit -kt /etc/hbase/hbase.keytab hbase\"\n</code></pre> </li> <li> <p>\u4f7f\u7528 HBase Shell \u8fde\u63a5 HBase \u96c6\u7fa4</p> <pre><code>su - hbase -c \"hbase shell\"\n</code></pre> </li> <li> <p>\u8fde\u63a5\u6210\u529f\uff0c\u65e5\u5fd7\u5982\u4e0b\u6240\u793a</p> <pre><code>HBase Shell\nUse \"help\" to get list of supported commands.\nUse \"exit\" to quit this interactive shell.\nFor Reference, please visit: http://hbase.apache.org/2.0/book.html#shell\nVersion 2.5.7-hadoop3, r6788f98356dd70b4a7ff766ea7a8298e022e7b95, Thu Dec 14 16:16:10 PST 2023\nTook 0.0046 seconds  \n</code></pre> </li> </ol>"},{"location":"blog/2023/12/10/%E5%AE%89%E8%A3%85-hadoop-%E8%BF%87%E7%A8%8B%E4%B8%AD%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98%E4%B8%8E%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/","title":"\u5b89\u88c5 Hadoop \u8fc7\u7a0b\u4e2d\u9047\u5230\u7684\u95ee\u9898\u4e0e\u89e3\u51b3\u65b9\u6848","text":""},{"location":"blog/2023/12/10/%E5%AE%89%E8%A3%85-hadoop-%E8%BF%87%E7%A8%8B%E4%B8%AD%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98%E4%B8%8E%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/#nodemanager-libcryptoso11","title":"\u95ee\u9898\u4e00\uff1a\u542f\u52a8 NodeManager \u65f6\u62a5\u627e\u4e0d\u5230 libcrypto.so.1.1 \u6587\u4ef6\u3002","text":"<p>\u539f\u59cb\u62a5\u9519\u65e5\u5fd7\uff1a</p> <pre><code>2023-11-25 16:28:14,058 WARN org.apache.hadoop.yarn.server.nodemanager.containermanager.linux.privileged.PrivilegedOperationExecutor: Shell execution returned exit code: 127. Privil\neged Execution Operation Stderr: \n/opt/hadoop/bin/container-executor: error while loading shared libraries: libcrypto.so.1.1: cannot open shared object file: No such file or directory\n\nStdout: \nFull command array for failed execution: \n[/opt/hadoop/bin/container-executor, --checksetup]\n2023-11-25 16:28:14,061 WARN org.apache.hadoop.yarn.server.nodemanager.LinuxContainerExecutor: Exit code from container executor initialization is : 127\norg.apache.hadoop.yarn.server.nodemanager.containermanager.linux.privileged.PrivilegedOperationException: ExitCodeException exitCode=127: /opt/hadoop/bin/container-executor: \nerror while loading shared libraries: libcrypto.so.1.1: cannot open shared object file: No such file or directory\n</code></pre> <p>\u539f\u56e0\uff1acontainer-executor \u4f9d\u8d56 openssl 1.1 \u7248\u672c\u7684\u5e93\u3002</p> <p>\u89e3\u51b3\u65b9\u6848\uff1a</p> <ul> <li>\u5982\u679c\u662f Rocky Linux 9 \u64cd\u4f5c\u7cfb\u7edf\uff0c\u53ef\u4ee5\u901a\u8fc7<code>dnf install compat-openssl11</code>\u6765\u5b89\u88c5 openssl 1.1 \u7248\u672c\u7684\u5e93\u3002</li> <li>\u5982\u679c\u65e0\u6cd5\u901a\u8fc7\u5305\u7ba1\u7406\u5de5\u5177\u5b89\u88c5\uff0c\u90a3\u4e48\u53ef\u4ee5\u901a\u8fc7\u7f16\u8bd1\u5b89\u88c5\uff0c\u5982\u4e0b\u6240\u793a\uff1a</li> </ul> <pre><code>cd /opt\ncurl -O https://www.openssl.org/source/openssl-1.1.1w.tar.gz\ntar -zxf openssl-1.1.1w.tar.gz\ncd openssl-1.1.1w\ndnf install perl -y\n./config &amp;&amp; make &amp;&amp; make test\nmake install\nln -s /usr/local/lib64/libcrypto.so.1.1 /usr/lib64/libcrypto.so.1.1\nln -s /usr/local/lib64/libssl.so.1.1 /usr/lib64/libssl.so.1.1\n</code></pre>"},{"location":"blog/2023/12/10/%E5%AE%89%E8%A3%85-hadoop-%E8%BF%87%E7%A8%8B%E4%B8%AD%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98%E4%B8%8E%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/#nodemanager-yarnnodemanagerlinux-container-executorgroup","title":"\u95ee\u9898\u4e8c\uff1a\u542f\u52a8 NodeManager \u65f6\u62a5\u83b7\u53d6\u4e0d\u5230\u914d\u7f6e yarn.nodemanager.linux-container-executor.group\u3002","text":"<p>\u539f\u59cb\u62a5\u9519\u65e5\u5fd7\uff1a</p> <pre><code>Can't get configured value for yarn.nodemanager.linux-container-executor.group.\n</code></pre> <p>\u89e3\u51b3\u65b9\u6848\uff1a</p> <ol> <li> <p>\u5148\u786e\u8ba4 yarn-site.xml \u548c container-executor.cfg \u4e24\u4e2a\u914d\u7f6e\u6587\u4ef6\u4e2d\u786e\u5b9e\u8bbe\u7f6e\u4e86 yarn.nodemanager.linux-container-executor.group\u3002</p> </li> <li> <p>\u518d\u786e\u8ba4\u914d\u7f6e\u6587\u4ef6 container-executor.cfg \u7684\u4f4d\u7f6e\u3002container-executor \u53ea\u4f1a\u53bb $HADOOP_HOME/etc/hadoop \u76ee\u5f55\u4e0b\u8bfb\u53d6 container-executor.cfg\uff0c\u662f\u5199\u6b7b\u7684\u3002\u5982\u679c\u4f60\u548c\u6211\u4e00\u6837\u628a container-executor.cfg \u914d\u7f6e\u6587\u4ef6\u653e\u5728\u91cc/etc/hadoop \u76ee\u5f55\u4e0b\uff0c\u90a3\u4e48\u80af\u5b9a\u8bfb\u53d6\u4e0d\u5230\uff0c\u4e5f\u5c31\u51fa\u73b0\u4e86\u4e0a\u9762\u7684\u9519\u8bef\u3002\u4f60\u9700\u8981\u81ea\u5df1\u7f16\u8bd1 container-executor\uff0c\u5e76\u5728\u7f16\u8bd1\u65f6\u4f20\u5165\u4f60\u60f3\u653e\u7f6e container-executor.cfg \u7684\u76ee\u5f55\u3002\u4e0b\u9762\u5c31\u662f\u7f16\u8bd1\u65f6\u4f20\u5165<code>-Dcontainer-executor.conf.dir=/etc/hadoop/</code>\u53c2\u6570\u7684\u4f8b\u5b50\u3002</p> <pre><code>cd /usr/local/src\ncurl -O https://dlcdn.apache.org/hadoop/common/hadoop-3.3.6/hadoop-3.3.6-src.tar.gz\ntar -zxf hadoop-3.3.6-src.tar.gz\ncd hadoop-3.3.6-src/hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/\ndnf install cmake gcc gcc-c++ compat-openssl11 -y\nmvn package -Pnative -DskipTests=true -Dcontainer-executor.conf.dir=/etc/hadoop/\nll target/native/target/usr/local/bin/container-executor\n</code></pre> </li> <li> <p>\u786e\u8ba4\u53ef\u6267\u884c\u6587\u4ef6 container-executor \u7684\u6743\u9650\u662f\u4e0d\u662f 6050\uff0c\u5c5e\u4e8e root:hadoop\u3002\u5c5e\u7ec4 hadoop \u4e0d\u662f\u4e00\u5b9a\u7684\uff0c\u53d6\u51b3\u4e8e yarn.nodemanager.linux-container-executor.group \u914d\u7f6e\u9879\u7684\u53d6\u503c\u3002</p> </li> <li> <p>\u786e\u8ba4\u914d\u7f6e\u6587\u4ef6 container-executor.cfg \u7684\u6743\u9650\u662f\u4e0d\u662f 400\uff0c\u5c5e\u4e8e root:hadoop\u3002\u5c5e\u7ec4 hadoop \u4e0d\u662f\u4e00\u5b9a\u7684\uff0c\u53d6\u51b3\u4e8e yarn.nodemanager.linux-container-executor.group \u914d\u7f6e\u9879\u7684\u53d6\u503c\u3002</p> </li> </ol>"},{"location":"blog/2023/12/10/%E5%AE%89%E8%A3%85-hadoop-%E8%BF%87%E7%A8%8B%E4%B8%AD%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98%E4%B8%8E%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/#journalnode","title":"\u95ee\u9898\u4e09\uff1a\u542f\u52a8 JournalNode \u65f6\u62a5\u8eab\u4efd\u8ba4\u8bc1\u5931\u8d25\u3002","text":"<p>\u539f\u59cb\u62a5\u9519\u65e5\u5fd7\uff1a</p> <pre><code>2023-09-16 20:07:47,980 WARN SecurityLogger.org.apache.hadoop.ipc.Server: Auth failed for machine1.xuwangwei.test:41465 / 192.168.2.61:41465:null (GSS initiate failed) with true cause: (GSS initiate failed)\n</code></pre> <p>\u539f\u56e0\uff1aKerberos \u52a0\u5bc6\u7c7b\u578b\u4e0d\u5339\u914d\uff08Encryption Type Mismatches\uff09</p> <p>\u5206\u6790\uff1a\u6211\u4f7f\u7528 tcpdump \u5728\u4e3b\u673a machine1 \u4e0a\u8fdb\u884c\u4e86\u6293\u5305\u3002\u4e0b\u56fe\u662f\u6293\u53d6\u5230\u7684 TGS-REQ \u8bf7\u6c42\u5305\uff0c\u53ef\u4ee5\u770b\u5230 hdfs \u8fdb\u7a0b\u5728\u8bf7\u6c42\u65f6\u8868\u660e\u81ea\u5df1\u652f\u6301 4 \u79cd\u52a0\u5bc6\u7c7b\u578b\uff0c\u5206\u522b\u662f 18\u300117\u300116\u300123\u3002  \u63a5\u7740\u770b\u4e0b\u56fe\u7684 TGS-REP \u54cd\u5e94\u5305\u3002\u8fd9\u4e2a\u54cd\u5e94\u5305\u8bc1\u660e machine1 \u4e0a\u7684 hdfs \u8fdb\u7a0b\u83b7\u53d6\u5230\u4e86 ticket\uff0c\u8fd9\u4e2a ticket \u662f\u5b83\u4e0e\u670d\u52a1\u7aef\uff08machine3 \u4e0a\u7684 hdfs \u8fdb\u7a0b\uff09\u901a\u4fe1\u7684\u5173\u952e\u3002\u6211\u4eec\u53ef\u4ee5\u770b\u5230 ticket \u4e2d\u7684\u52a0\u5bc6\u7c7b\u578b\u662f 20\u3002\u4e0a\u4e00\u5f20\u56fe\u7247\u544a\u8bc9\u6211\u4eec hdfs \u652f\u6301 18\u300117\u300116\u300123 \u8fd9 4 \u79cd\u52a0\u5bc6\u7c7b\u578b\uff0c\u5e76\u4e0d\u652f\u6301 20\uff0c\u6240\u4ee5\u5f53\u8fd9\u4e2a ticket \u4ea4\u7ed9 machine3 \u4e0a\u7684 hdfs \u8fdb\u7a0b\u65f6\uff0c\u5b83\u662f\u89e3\u4e0d\u5f00\u7684\u3002  \u95ee\uff1a\u4e3a\u4ec0\u4e48\u4f1a\u51fa\u73b0\u8fd9\u79cd\u60c5\u51b5\uff1f\u96be\u9053 KDC \u4e0d\u77e5\u9053\u670d\u52a1\u7aef\u652f\u6301\u7684\u52a0\u5bc6\u7c7b\u578b\u5417\uff1f</p> <p>\u7b54\uff1a\u662f\u7684\uff0cKDC \u5c31\u662f\u4e0d\u77e5\u9053\u670d\u52a1\u7aef\u652f\u6301\u7684\u52a0\u5bc6\u7c7b\u578b\u3002\u5728\u6574\u4e2a Kerberos \u8ba4\u8bc1\u7684\u8fc7\u7a0b\u4e2d\uff0c\u670d\u52a1\u7aef\u662f\u4e0d\u4f1a\u548c KDC \u8fdb\u884c\u901a\u4fe1\u7684\u3002\u6240\u4ee5 KDC \u53ea\u80fd\u53bb\u6570\u636e\u5e93\u4e2d\u627e\u670d\u52a1\u7aef\u7684\u5bc6\u94a5\u6709\u51e0\u79cd\u52a0\u5bc6\u7c7b\u578b\uff0cKDC \u4f1a\u628a\u670d\u52a1\u7aef\u5bc6\u94a5\u4e2d\u52a0\u5bc6\u7b49\u7ea7\u6700\u9ad8\u7684\u52a0\u5bc6\u7c7b\u578b\u4f5c\u4e3a service ticket \u7684\u52a0\u5bc6\u7c7b\u578b\u3002</p> <p>\u89e3\u51b3\u65b9\u6848\uff1a\u5982\u679c\u4f60\u548c\u6211\u4e00\u6837\u4f7f\u7528 FreeIPA \u6765\u5b89\u88c5 KDC\uff0c\u90a3\u4e48\u53ef\u4ee5\u901a\u8fc7\u7ed9 ipa-getkeytab \u547d\u4ee4\u52a0\u4e00\u4e2a\u53c2\u6570 --enctypes=aes256-sha1,aes128-sha1 \u6765\u6307\u5b9a\u5bc6\u94a5\u7684\u52a0\u5bc6\u7c7b\u578b\u3002\u5982\u679c\u4f60\u662f\u76f4\u63a5\u5b89\u88c5\u7684 KDC\uff0c\u90a3\u4e48\u53ef\u4ee5\u5728\u521b\u5efa principal \u65f6\uff0c\u901a\u8fc7\u4f20\u5165\u53c2\u6570<code>-e aes256-sha1,aes128-sha1</code>\u6765\u6307\u5b9a\u5bc6\u94a5\u7684\u52a0\u5bc6\u7c7b\u578b\u3002</p> <p>\u95ee\uff1a\u4e3a\u4ec0\u4e48\u6211\u4f1a\u9009\u62e9 aes256-sha1(18)\u3001aes128-sha1(17) \u4f5c\u4e3a hdfs \u7684\u5bc6\u94a5\u52a0\u5bc6\u7c7b\u578b\uff1f</p> <p>\u7b54\uff1a\u4e0d\u540c\u7684\u5e94\u7528\u652f\u6301\u7684 Kerberos \u52a0\u5bc6\u7c7b\u578b\u662f\u4e0d\u540c\u7684\u3002\u6211\u4eec\u901a\u8fc7\u6293\u5305\u5df2\u7ecf\u77e5\u9053 Hadoop 3.3.6 \u7248\u672c\u652f\u6301 18\u300117\u300116\u300123 \u56db\u79cd\u52a0\u5bc6\u7c7b\u578b\u4e86\uff0c\u6240\u4ee5 18\u300117 \u4f5c\u4e3a hdfs \u7684\u5bc6\u94a5\u52a0\u5bc6\u7c7b\u578b\u7684\u8bdd\uff0cKDC \u5728\u6311\u9009 ticket \u52a0\u5bc6\u7c7b\u578b\u65f6\u53ea\u80fd\u9009 18\u300117 \u4e2d\u7684\u4e00\u79cd\uff0c\u800c\u8fd9\u4e24\u79cd\u662f Hadoop 3.3.6 \u7248\u672c\u652f\u6301\u7684\u3002</p> <p>\u95ee\uff1ades3-cbc-sha1(16)\u3001arcfour-hmac-md5(23) \u8fd9\u4e24\u79cd\u52a0\u5bc6\u7c7b\u578b Hadoop \u4e5f\u652f\u6301\uff0c\u600e\u4e48\u4e0d\u4f5c\u4e3a hdfs \u7684\u5bc6\u94a5\u52a0\u5bc6\u7c7b\u578b\uff1f</p> <p>\u7b54\uff1a\u4e0b\u56fe\u662f Kerberos \u6587\u6863\u4e2d\u5bf9\u5b83\u652f\u6301\u7684\u52a0\u5bc6\u7c7b\u578b\u7684\u63cf\u8ff0\uff0carcfour-hmac-md5(23) \u5df2 deprecated\uff0cdes3-cbc-sha1(16) \u6ca1\u6709\u88ab\u5217\u51fa\uff0c\u8bf4\u660e\u4e0d\u652f\u6301\u3002 </p>"},{"location":"blog/2023/12/10/%E5%AE%89%E8%A3%85-hadoop-%E9%9B%86%E7%BE%A4rocky-linux-92/","title":"\u5b89\u88c5 Hadoop \u96c6\u7fa4(Rocky Linux 9.2)","text":"<p>\u5b89\u88c5\u76ee\u6807</p> <ul> <li> Hadoop \u96c6\u7fa4\u542f\u7528 Kerberos \u8ba4\u8bc1\u3002</li> <li> HDFS \u7531 3 \u4e2a NameNode\u30015 \u4e2a DataNode \u7ec4\u6210\u9ad8\u53ef\u7528\uff08High Availability\uff09\u96c6\u7fa4\u3002</li> <li> MapReduce \u7531 1 \u4e2a JobHistory Server \u7ec4\u6210\u3002</li> <li> YARN \u7531 2 \u4e2a ResourceManager\u30015 \u4e2a NodeManager \u7ec4\u6210\u9ad8\u53ef\u7528\u96c6\u7fa4\u3002</li> <li> Hadoop \u7248\u672c\u662f 3.3.6\uff0cZooKeeper \u7248\u672c\u662f 3.7.1\u3002</li> </ul> <p>\u524d\u7f6e\u6761\u4ef6</p> <ul> <li> \u5df2\u5b89\u88c5JDK 8\u3002</li> <li> \u5df2\u5b89\u88c5 FreeIPA\u3002\u53ef\u4ee5\u53c2\u8003\u5b89\u88c5 FreeIPA(Rocky Linux 9.2)\u3002</li> <li> \u5df2\u7f16\u8bd1 container-executor\u3002\u53ef\u4ee5\u53c2\u8003\u5b89\u88c5 Hadoop \u8fc7\u7a0b\u4e2d\u9047\u5230\u7684\u95ee\u9898\u4e0e\u89e3\u51b3\u65b9\u6848\u3002</li> <li> \u5df2\u5b89\u88c5 openssl-1.1.1\u3002\u53ef\u4ee5\u53c2\u8003\u5b89\u88c5 Hadoop \u8fc7\u7a0b\u4e2d\u9047\u5230\u7684\u95ee\u9898\u4e0e\u89e3\u51b3\u65b9\u6848\u3002</li> </ul> ipa-server ipa-client namenode zkfc journalnode datanode jobhistory server resource manager node manager zookeeper ipa-server \u2714\ufe0f machine1 \u2714\ufe0f \u2714\ufe0f \u2714\ufe0f \u2714\ufe0f \u2714\ufe0f \u2714\ufe0f \u2714\ufe0f \u2714\ufe0f machine2 \u2714\ufe0f \u2714\ufe0f \u2714\ufe0f \u2714\ufe0f \u2714\ufe0f \u2714\ufe0f \u2714\ufe0f machine3 \u2714\ufe0f \u2714\ufe0f \u2714\ufe0f \u2714\ufe0f \u2714\ufe0f \u2714\ufe0f \u2714\ufe0f machine4 \u2714\ufe0f \u2714\ufe0f \u2714\ufe0f \u2714\ufe0f \u2714\ufe0f machine5 \u2714\ufe0f \u2714\ufe0f \u2714\ufe0f \u2714\ufe0f \u2714\ufe0f <p>\u76ee\u5f55\u5e03\u5c40</p> User:Group Permissions \u8bf4\u660e /opt/hadoop root:hadoop 755 \u73af\u5883\u53d8\u91cf HADOOP_HOME \u7684\u503c\uff0c\u662f Hadoop \u7684\u5bb6\u76ee\u5f55 /etc/hadoop root:hadoop 755 \u73af\u5883\u53d8\u91cf HADOOP_CONF_DIR \u7684\u503c\uff0c\u662f Hadoop \u7684\u914d\u7f6e\u76ee\u5f55 /var/lib/hadoop root:hadoop 770 core-site.xml \u4e2d hadoop.tmp.dir \u7684\u503c\uff0c\u662f Hadoop \u7684\u6570\u636e\u76ee\u5f55 /var/log/hadoop hdfs:hadoop 775 \u73af\u5883\u53d8\u91cf HADOOP_LOG_DIR \u7684\u503c\uff0c\u662f Hadoop \u7684\u65e5\u5fd7\u76ee\u5f55 /opt/zookeeper zookeeper:zookeeper 755 \u73af\u5883\u53d8\u91cf ZOO_KEEPER_HOME \u7684\u503c\uff0c\u662f ZooKeeper \u7684\u5bb6\u76ee\u5f55 /etc/zookeeper zookeeper:zookeeper 755 \u73af\u5883\u53d8\u91cf ZOOCFGDIR \u7684\u503c\uff0c\u662f ZooKeeper \u7684\u914d\u7f6e\u76ee\u5f55 /var/lib/zookeeper zookeeper:zookeeper 750 zoo.cfg \u4e2d dataDir \u7684\u503c\uff0c\u662f ZooKeeper \u7684\u6570\u636e\u76ee\u5f55 /var/log/zookeeper zookeeper:zookeeper 755 \u73af\u5883\u53d8\u91cf ZOO_LOG_DIR \u7684\u503c\uff0c\u662f ZooKeeper \u7684\u65e5\u5fd7\u76ee\u5f55"},{"location":"blog/2023/12/10/%E5%AE%89%E8%A3%85-hadoop-%E9%9B%86%E7%BE%A4rocky-linux-92/#_1","title":"\u51c6\u5907\u7528\u6237","text":"<p>Warning</p> <p>\u4e0b\u9762\u7684\u547d\u4ee4\u662f\u5728\u4e3b\u673aipa-server\u4e0a\u6267\u884c\u7684\u3002</p> <ol> <li> <p>\u8eab\u4efd\u8ba4\u8bc1</p> <pre><code>[root@ipa-server ~]# kinit admin\nPassword for admin@XUWANGWEI.TEST: \n</code></pre> </li> <li> <p>\u65b0\u589e\u7528\u6237\u7ec4hadoop</p> <pre><code>[root@ipa-server ~]# ipa group-add hadoop --gid=1532600004\n</code></pre> </li> <li> <p>\u65b0\u589e\u7528\u6237hdfs</p> <pre><code># \u6dfb\u52a0\u7528\u6237hdfs\n[root@ipa-server ~]# ipa user-add hdfs --first=hdfs --last=hadoop --shell=/bin/bash --gidnumber=1532600004\n# \u751f\u6210\u7528\u6237hdfs\u7684ssh\u516c\u94a5\u548c\u79c1\u94a5\n[root@ipa-server ~]# su - hdfs\n[hdfs@ipa-server ~]$ ssh-keygen -t rsa -P '' -f ~/.ssh/id_rsa\n[hdfs@ipa-server ~]$ cat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys\n[hdfs@ipa-server ~]$ chmod 0600 ~/.ssh/authorized_keys\n[hdfs@ipa-server ~]$ exit\n# \u4e0a\u4f20\u7528\u6237hdfs\u7684ssh\u516c\u94a5\n[root@ipa-server ~]# ipa user-mod hdfs --sshpubkey=\"$( cat ~hdfs/.ssh/id_rsa.pub )\"\n</code></pre> </li> <li> <p>\u65b0\u589e\u7528\u6237yarn</p> <pre><code>ipa user-add yarn --first=yarn --last=hadoop --shell=/bin/bash --gidnumber=1532600004\nsu - yarn\nssh-keygen -t rsa -P '' -f ~/.ssh/id_rsa\ncat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys\nchmod 0600 ~/.ssh/authorized_keys\nexit\nipa user-mod yarn --sshpubkey=\"$( cat ~yarn/.ssh/id_rsa.pub )\"\n</code></pre> </li> <li> <p>\u65b0\u589e\u7528\u6237mapred</p> <pre><code>ipa user-add mapred --first=mapred --last=hadoop --shell=/bin/bash --gidnumber=1532600004\nsu - mapred\nssh-keygen -t rsa -P '' -f ~/.ssh/id_rsa\ncat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys\nchmod 0600 ~/.ssh/authorized_keys\nexit\nipa user-mod mapred --sshpubkey=\"$( cat ~mapred/.ssh/id_rsa.pub )\"\n</code></pre> </li> <li> <p>\u65b0\u589e\u7528\u6237zookeeper</p> <pre><code>ipa user-add zookeeper --first=zookeeper --last=hadoop --shell=/bin/bash\nsu - zookeeper\nssh-keygen -t rsa -P '' -f ~/.ssh/id_rsa\ncat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys\nchmod 0600 ~/.ssh/authorized_keys\nexit\nipa user-mod zookeeper --sshpubkey=\"$( cat ~zookeeper/.ssh/id_rsa.pub )\"\n</code></pre> </li> </ol>"},{"location":"blog/2023/12/10/%E5%AE%89%E8%A3%85-hadoop-%E9%9B%86%E7%BE%A4rocky-linux-92/#hadoop-zookeeper","title":"\u5171\u4eab\u5bb6\u76ee\u5f55\u3001Hadoop \u548c ZooKeeper \u914d\u7f6e\u76ee\u5f55","text":"<p>Warning</p> <p>\u4e0b\u9762\u7684\u547d\u4ee4\u662f\u5728\u4e3b\u673aipa-server\u4e0a\u6267\u884c\u7684\u3002</p> <ol> <li> <p>\u8bbe\u7f6e\u9632\u706b\u5899</p> <pre><code>firewall-cmd --add-service={nfs,rpc-bind,mountd}\nfirewall-cmd --add-service={nfs,rpc-bind,mountd} --permanent\n</code></pre> </li> <li> <p>\u4fee\u6539NFS\u914d\u7f6e\u6587\u4ef6/etc/exports\uff0c\u4f7f\u5f97\u4e3b\u673aipa-server\u4e0a\u7684/home\u76ee\u5f55\u3001/etc/hadoop\u76ee\u5f55\u548c/etc/zookeeper\u76ee\u5f55\u5171\u4eab\u7ed9\u5176\u4ed6\u4e3b\u673a\u3002</p> <pre><code>/home    192.168.2.0/24(rw,sync,no_root_squash)\n/etc/hadoop    192.168.2.0/24(rw,sync,no_root_squash)\n/etc/zookeeper 192.168.2.0/24(rw,sync,no_root_squash)\n</code></pre> </li> <li> <p>\u521b\u5efa Hadoop \u548c ZooKeeper \u914d\u7f6e\u76ee\u5f55\u5e76\u8bbe\u7f6e\u5c5e\u4e3b\u5c5e\u7ec4</p> <pre><code>mkdir /etc/hadoop\nchown root:hadoop /etc/hadoop\nchmod 755 /etc/hadoop\nmkdir /etc/zookeeper\nchown zookeeper:zookeeper /etc/zookeeper\nchmod 755 /etc/zookeeper\n</code></pre> </li> <li> <p>\u542f\u52a8NFS\u670d\u52a1</p> <pre><code>systemctl restart rpcbind\nsystemctl restart nfs-server\nsystemctl enable rpcbind\nsystemctl enable nfs-server\n</code></pre> </li> <li> <p>\u5728IPA Server\u4e0a\u521b\u5efa\u6302\u8f7d\u914d\u7f6e</p> <pre><code>ipa automountkey-add default auto.direct --key=/home --info=\"-fstype=nfs4,rw ipa-server:/home\"\nipa automountkey-add default auto.direct --key=/etc/hadoop --info=\"-fstype=nfs4,rw ipa-server:/etc/hadoop\"\nipa automountkey-add default auto.direct --key=/etc/zookeeper --info=\"-fstype=nfs4,rw ipa-server:/etc/zookeeper\"\n</code></pre> </li> </ol>"},{"location":"blog/2023/12/10/%E5%AE%89%E8%A3%85-hadoop-%E9%9B%86%E7%BE%A4rocky-linux-92/#hadoopzookeeper","title":"\u5b89\u88c5Hadoop\u548cZooKeeper","text":"<p>Warning</p> <p>\u4e0b\u9762\u7684\u547d\u4ee4\u9700\u8981\u5728\u4e3b\u673amachine1~machine5\u4e0a\u6267\u884c\u3002</p> <ol> <li> <p>\u5173\u95ed\u9632\u706b\u5899</p> <pre><code>systemctl stop firewalld\nsystemctl disable firewalld\n</code></pre> </li> <li> <p>\u4e0b\u8f7d\u548c\u89e3\u538b</p> <pre><code>cd /opt\ncurl -O https://dlcdn.apache.org/zookeeper/zookeeper-3.7.1/apache-zookeeper-3.7.1-bin.tar.gz\ntar -zxf apache-zookeeper-3.7.1-bin.tar.gz\ncurl -O https://dlcdn.apache.org/hadoop/common/hadoop-3.3.6/hadoop-3.3.6.tar.gz\ntar -zxf hadoop-3.3.6.tar.gz\n</code></pre> </li> <li> <p>\u521b\u5efa\u522b\u540d</p> <pre><code>ln -s apache-zookeeper-3.7.1-bin zookeeper\nln -s hadoop-3.3.6 hadoop\n</code></pre> </li> <li> <p>\u6dfb\u52a0\u73af\u5883\u53d8\u91cf</p> <pre><code>echo 'export ZOO_KEEPER_HOME=/opt/zookeeper' &gt;&gt; /etc/profile.d/zookeeper.sh\necho 'export PATH=$PATH:$ZOO_KEEPER_HOME/bin' &gt;&gt; /etc/profile.d/zookeeper.sh\necho 'export ZOOCFGDIR=/etc/zookeeper' &gt;&gt; /etc/profile.d/zookeeper.sh\necho 'export ZOO_LOG_DIR=/var/log/zookeeper' &gt;&gt; /etc/profile.d/zookeeper.sh\nsource /etc/profile.d/zookeeper.sh\necho 'export HADOOP_HOME=/opt/hadoop' &gt;&gt; /etc/profile.d/hadoop.sh\necho 'export PATH=$PATH:$HADOOP_HOME/bin:$HADOOP_HOME/sbin' &gt;&gt; /etc/profile.d/hadoop.sh\necho 'export HADOOP_CONF_DIR=/etc/hadoop' &gt;&gt; /etc/profile.d/hadoop.sh\necho 'export HADOOP_LOG_DIR=/var/log/hadoop' &gt;&gt; /etc/profile.d/hadoop.sh\necho 'export HADOOP_OPTS=\"-Djava.security.auth.login.config=/etc/hadoop/jaas.conf\"' &gt;&gt; /etc/profile.d/hadoop.sh\nsource /etc/profile.d/hadoop.sh\n</code></pre> </li> <li> <p>\u521b\u5efa\u6570\u636e\u76ee\u5f55\u5e76\u8bbe\u7f6e\u5c5e\u4e3b\u5c5e\u7ec4</p> <pre><code>chown -R -H zookeeper:zookeeper $ZOO_KEEPER_HOME\nmkdir /var/lib/zookeeper\nchown zookeeper:zookeeper /var/lib/zookeeper\nchmod 750 /var/lib/zookeeper\nmkdir /var/log/zookeeper\nchown zookeeper:zookeeper /var/log/zookeeper\nchmod 755 /var/log/zookeeper\nchown -R -H root:hadoop $HADOOP_HOME\nchmod 755 $HADOOP_HOME\nchown root:hadoop $HADOOP_HOME/bin/container-executor\nchmod 6050 $HADOOP_HOME/bin/container-executor \nmkdir /var/lib/hadoop\nchown root:hadoop /var/lib/hadoop\nchmod 770 /var/lib/hadoop\nmkdir /var/log/hadoop\nchown hdfs:hadoop /var/log/hadoop\nchmod 775 /var/log/hadoop\n</code></pre> </li> <li> <p>\u521b\u5efa Hadoop \u548c ZooKeeper \u914d\u7f6e\u76ee\u5f55\u5e76\u8bbe\u7f6e\u5c5e\u4e3b\u5c5e\u7ec4</p> <pre><code>mkdir /etc/hadoop\nchown root:hadoop /etc/hadoop\nchmod 755 /etc/hadoop\nmkdir /etc/zookeeper\nchown zookeeper:zookeeper /etc/zookeeper\nchmod 755 /etc/zookeeper\n</code></pre> </li> <li> <p>\u5ba2\u6237\u7aef\u6302\u8f7d\u5bb6\u76ee\u5f55\u3001/etc/hadoop \u548c/etc/zookeeper \u76ee\u5f55</p> <pre><code>ipa-client-automount --location=default\n</code></pre> </li> <li> <p>\u590d\u5236\u914d\u7f6e\u6587\u4ef6\u81f3\u5171\u4eab\u76ee\u5f55</p> </li> </ol> <p>Warning</p> <p>\u4e0b\u9762\u7684\u547d\u4ee4\u662f\u5728\u4e3b\u673a machine1 \u4e0a\u6267\u884c\u7684\uff0c\u76ee\u7684\u662f\u628a\u9ed8\u8ba4\u914d\u7f6e\u6587\u4ef6\u590d\u5236\u5230\u5171\u4eab\u76ee\u5f55\u4e2d\u3002</p> <pre><code>cp -a -r /opt/hadoop/etc/hadoop/* /etc/hadoop\nchown root:hadoop /etc/hadoop/container-executor.cfg\nchmod 0400 /etc/hadoop/container-executor.cfg\ncp -a -r /opt/zookeeper/conf/* /etc/zookeeper\n</code></pre>"},{"location":"blog/2023/12/10/%E5%AE%89%E8%A3%85-hadoop-%E9%9B%86%E7%BE%A4rocky-linux-92/#kerberos-principalskeytab-files","title":"\u51c6\u5907Kerberos principals\u548ckeytab files","text":"<p>Warning</p> <p>\u4e0b\u9762\u7684\u547d\u4ee4\u662f\u5728\u4e3b\u673aipa-server\u4e0a\u6267\u884c\u7684\u3002</p> <ol> <li> <p>\u521b\u5efaprincipal</p> <pre><code>ipa service-add hdfs/machine1.xuwangwei.test@XUWANGWEI.TEST --requires-pre-auth=true\nipa service-add HTTP/machine1.xuwangwei.test@XUWANGWEI.TEST --requires-pre-auth=true\nipa service-add yarn/machine1.xuwangwei.test@XUWANGWEI.TEST --requires-pre-auth=true\nipa service-add mapred/machine1.xuwangwei.test@XUWANGWEI.TEST --requires-pre-auth=true\nipa service-add hdfs/machine2.xuwangwei.test@XUWANGWEI.TEST --requires-pre-auth=true\nipa service-add HTTP/machine2.xuwangwei.test@XUWANGWEI.TEST --requires-pre-auth=true\nipa service-add yarn/machine2.xuwangwei.test@XUWANGWEI.TEST --requires-pre-auth=true\nipa service-add hdfs/machine3.xuwangwei.test@XUWANGWEI.TEST --requires-pre-auth=true\nipa service-add HTTP/machine3.xuwangwei.test@XUWANGWEI.TEST --requires-pre-auth=true\nipa service-add yarn/machine3.xuwangwei.test@XUWANGWEI.TEST --requires-pre-auth=true\nipa service-add hdfs/machine4.xuwangwei.test@XUWANGWEI.TEST --requires-pre-auth=true\nipa service-add HTTP/machine4.xuwangwei.test@XUWANGWEI.TEST --requires-pre-auth=true\nipa service-add yarn/machine4.xuwangwei.test@XUWANGWEI.TEST --requires-pre-auth=true\nipa service-add hdfs/machine5.xuwangwei.test@XUWANGWEI.TEST --requires-pre-auth=true\nipa service-add HTTP/machine5.xuwangwei.test@XUWANGWEI.TEST --requires-pre-auth=true\nipa service-add yarn/machine5.xuwangwei.test@XUWANGWEI.TEST --requires-pre-auth=true\nipa service-add zookeeper/machine1.xuwangwei.test@XUWANGWEI.TEST --requires-pre-auth=true\nipa service-add zookeeper/machine2.xuwangwei.test@XUWANGWEI.TEST --requires-pre-auth=true\nipa service-add zookeeper/machine3.xuwangwei.test@XUWANGWEI.TEST --requires-pre-auth=true\nipa service-add zookeeper/machine4.xuwangwei.test@XUWANGWEI.TEST --requires-pre-auth=true\nipa service-add zookeeper/machine5.xuwangwei.test@XUWANGWEI.TEST --requires-pre-auth=true\n</code></pre> </li> <li> <p>\u5bfc\u51faprincipal\u7684\u5bc6\u94a5</p> <pre><code>ipa-getkeytab --principal=hdfs/machine1.xuwangwei.test@XUWANGWEI.TEST --keytab=/etc/hadoop/hdfs.keytab --enctypes=aes256-sha1,aes128-sha1\nipa-getkeytab --principal=HTTP/machine1.xuwangwei.test@XUWANGWEI.TEST --keytab=/etc/hadoop/hdfs.keytab --enctypes=aes256-sha1,aes128-sha1\nipa-getkeytab --principal=hdfs/machine2.xuwangwei.test@XUWANGWEI.TEST --keytab=/etc/hadoop/hdfs.keytab --enctypes=aes256-sha1,aes128-sha1\nipa-getkeytab --principal=HTTP/machine2.xuwangwei.test@XUWANGWEI.TEST --keytab=/etc/hadoop/hdfs.keytab --enctypes=aes256-sha1,aes128-sha1\nipa-getkeytab --principal=hdfs/machine3.xuwangwei.test@XUWANGWEI.TEST --keytab=/etc/hadoop/hdfs.keytab --enctypes=aes256-sha1,aes128-sha1\nipa-getkeytab --principal=HTTP/machine3.xuwangwei.test@XUWANGWEI.TEST --keytab=/etc/hadoop/hdfs.keytab --enctypes=aes256-sha1,aes128-sha1\nipa-getkeytab --principal=hdfs/machine4.xuwangwei.test@XUWANGWEI.TEST --keytab=/etc/hadoop/hdfs.keytab --enctypes=aes256-sha1,aes128-sha1\nipa-getkeytab --principal=HTTP/machine4.xuwangwei.test@XUWANGWEI.TEST --keytab=/etc/hadoop/hdfs.keytab --enctypes=aes256-sha1,aes128-sha1\nipa-getkeytab --principal=hdfs/machine5.xuwangwei.test@XUWANGWEI.TEST --keytab=/etc/hadoop/hdfs.keytab --enctypes=aes256-sha1,aes128-sha1\nipa-getkeytab --principal=HTTP/machine5.xuwangwei.test@XUWANGWEI.TEST --keytab=/etc/hadoop/hdfs.keytab --enctypes=aes256-sha1,aes128-sha1\nipa-getkeytab --principal=HTTP/machine1.xuwangwei.test@XUWANGWEI.TEST --keytab=/etc/hadoop/yarn.keytab --enctypes=aes256-sha1,aes128-sha1\nipa-getkeytab --principal=yarn/machine1.xuwangwei.test@XUWANGWEI.TEST --keytab=/etc/hadoop/yarn.keytab --enctypes=aes256-sha1,aes128-sha1\nipa-getkeytab --principal=HTTP/machine2.xuwangwei.test@XUWANGWEI.TEST --keytab=/etc/hadoop/yarn.keytab --enctypes=aes256-sha1,aes128-sha1\nipa-getkeytab --principal=yarn/machine2.xuwangwei.test@XUWANGWEI.TEST --keytab=/etc/hadoop/yarn.keytab --enctypes=aes256-sha1,aes128-sha1\nipa-getkeytab --principal=HTTP/machine3.xuwangwei.test@XUWANGWEI.TEST --keytab=/etc/hadoop/yarn.keytab --enctypes=aes256-sha1,aes128-sha1\nipa-getkeytab --principal=yarn/machine3.xuwangwei.test@XUWANGWEI.TEST --keytab=/etc/hadoop/yarn.keytab --enctypes=aes256-sha1,aes128-sha1\nipa-getkeytab --principal=HTTP/machine4.xuwangwei.test@XUWANGWEI.TEST --keytab=/etc/hadoop/yarn.keytab --enctypes=aes256-sha1,aes128-sha1\nipa-getkeytab --principal=yarn/machine4.xuwangwei.test@XUWANGWEI.TEST --keytab=/etc/hadoop/yarn.keytab --enctypes=aes256-sha1,aes128-sha1\nipa-getkeytab --principal=HTTP/machine5.xuwangwei.test@XUWANGWEI.TEST --keytab=/etc/hadoop/yarn.keytab --enctypes=aes256-sha1,aes128-sha1\nipa-getkeytab --principal=yarn/machine5.xuwangwei.test@XUWANGWEI.TEST --keytab=/etc/hadoop/yarn.keytab --enctypes=aes256-sha1,aes128-sha1\nipa-getkeytab --principal=mapred/machine1.xuwangwei.test@XUWANGWEI.TEST --keytab=/etc/hadoop/mapred.keytab --enctypes=aes256-sha1,aes128-sha1\nipa-getkeytab --principal=hdfs@XUWANGWEI.TEST --keytab=/etc/hadoop/hdfs.keytab --enctypes=aes256-sha1,aes128-sha1\nipa-getkeytab --principal=yarn@XUWANGWEI.TEST --keytab=/etc/hadoop/yarn.keytab --enctypes=aes256-sha1,aes128-sha1\nipa-getkeytab --principal=mapred@XUWANGWEI.TEST --keytab=/etc/hadoop/mapred.keytab --enctypes=aes256-sha1,aes128-sha1\nipa-getkeytab --principal=zookeeper/machine1.xuwangwei.test@XUWANGWEI.TEST --keytab=/etc/zookeeper/zookeeper.keytab --enctypes=aes256-sha1,aes128-sha1\nipa-getkeytab --principal=zookeeper/machine2.xuwangwei.test@XUWANGWEI.TEST --keytab=/etc/zookeeper/zookeeper.keytab --enctypes=aes256-sha1,aes128-sha1\nipa-getkeytab --principal=zookeeper/machine3.xuwangwei.test@XUWANGWEI.TEST --keytab=/etc/zookeeper/zookeeper.keytab --enctypes=aes256-sha1,aes128-sha1\nipa-getkeytab --principal=zookeeper/machine4.xuwangwei.test@XUWANGWEI.TEST --keytab=/etc/zookeeper/zookeeper.keytab --enctypes=aes256-sha1,aes128-sha1\nipa-getkeytab --principal=zookeeper/machine5.xuwangwei.test@XUWANGWEI.TEST --keytab=/etc/zookeeper/zookeeper.keytab --enctypes=aes256-sha1,aes128-sha1\nipa-getkeytab --principal=zookeeper@XUWANGWEI.TEST --keytab=/etc/zookeeper/zookeeper.keytab --enctypes=aes256-sha1,aes128-sha1\n</code></pre> </li> <li> <p>\u4fee\u6539keytab\u7684\u5c5e\u4e3b\u5c5e\u7ec4\u548c\u6743\u9650</p> <pre><code>chown root:hadoop /etc/hadoop/*.keytab\nchmod 640 /etc/hadoop/*.keytab\nchown root:zookeeper /etc/zookeeper/*.keytab\nchmod 640 /etc/zookeeper/*.keytab\n</code></pre> </li> </ol>"},{"location":"blog/2023/12/10/%E5%AE%89%E8%A3%85-hadoop-%E9%9B%86%E7%BE%A4rocky-linux-92/#ssltls","title":"\u751f\u6210\u81ea\u7b7e\u540d SSL/TLS \u8bc1\u4e66","text":"<p>Warning</p> <p>\u4e0b\u9762\u7684\u547d\u4ee4\u662f\u5728\u4e3b\u673aipa-server\u4e0a\u6267\u884c\u7684\u3002</p> <ol> <li> <p>\u5207\u6362\u81f3 root \u7528\u6237\u5bb6\u76ee\u5f55</p> <pre><code>cd /root\n</code></pre> </li> <li> <p>\u751f\u6210\u81ea\u7b7e\u540d\u8bc1\u4e66</p> <pre><code>openssl req -newkey rsa:2048 -keyout domain1.key -x509 -days 365 -out domain1.crt -subj=\"/C=CN/ST=Jiangsu/L=Changzhou/CN=machine1.xuwangwei.test\" -noenc\nopenssl req -newkey rsa:2048 -keyout domain2.key -x509 -days 365 -out domain2.crt -subj=\"/C=CN/ST=Jiangsu/L=Changzhou/CN=machine2.xuwangwei.test\" -noenc\nopenssl req -newkey rsa:2048 -keyout domain3.key -x509 -days 365 -out domain3.crt -subj=\"/C=CN/ST=Jiangsu/L=Changzhou/CN=machine3.xuwangwei.test\" -noenc\nopenssl req -newkey rsa:2048 -keyout domain4.key -x509 -days 365 -out domain4.crt -subj=\"/C=CN/ST=Jiangsu/L=Changzhou/CN=machine4.xuwangwei.test\" -noenc\nopenssl req -newkey rsa:2048 -keyout domain5.key -x509 -days 365 -out domain5.crt -subj=\"/C=CN/ST=Jiangsu/L=Changzhou/CN=machine5.xuwangwei.test\" -noenc\n</code></pre> </li> <li> <p>\u8f6c\u5316\u6210 PKCS12 \u683c\u5f0f</p> <pre><code>openssl pkcs12 -inkey domain1.key -in domain1.crt -export -out domain1.p12 -password pass:xuwangwei3306\nopenssl pkcs12 -inkey domain2.key -in domain2.crt -export -out domain2.p12 -password pass:xuwangwei3306\nopenssl pkcs12 -inkey domain3.key -in domain3.crt -export -out domain3.p12 -password pass:xuwangwei3306\nopenssl pkcs12 -inkey domain4.key -in domain4.crt -export -out domain4.p12 -password pass:xuwangwei3306\nopenssl pkcs12 -inkey domain5.key -in domain5.crt -export -out domain5.p12 -password pass:xuwangwei3306\n</code></pre> </li> <li> <p>\u901a\u8fc7keytool\u628a 5 \u4e2a\u8bc1\u4e66\u548c\u5bf9\u5e94\u79c1\u94a5\u5168\u90e8\u5bfc\u5165hadoop.p12</p> <pre><code>keytool -importkeystore -srckeystore domain1.p12 -srcstoretype pkcs12 -srcstorepass xuwangwei3306 -srcalias 1 -destkeystore hadoop.p12 -deststoretype pkcs12 -deststorepass xuwangwei3306 -destalias m1\nkeytool -importkeystore -srckeystore domain2.p12 -srcstoretype pkcs12 -srcstorepass xuwangwei3306 -srcalias 1 -destkeystore hadoop.p12 -deststoretype pkcs12 -deststorepass xuwangwei3306 -destalias m2\nkeytool -importkeystore -srckeystore domain3.p12 -srcstoretype pkcs12 -srcstorepass xuwangwei3306 -srcalias 1 -destkeystore hadoop.p12 -deststoretype pkcs12 -deststorepass xuwangwei3306 -destalias m3\nkeytool -importkeystore -srckeystore domain4.p12 -srcstoretype pkcs12 -srcstorepass xuwangwei3306 -srcalias 1 -destkeystore hadoop.p12 -deststoretype pkcs12 -deststorepass xuwangwei3306 -destalias m4\nkeytool -importkeystore -srckeystore domain5.p12 -srcstoretype pkcs12 -srcstorepass xuwangwei3306 -srcalias 1 -destkeystore hadoop.p12 -deststoretype pkcs12 -deststorepass xuwangwei3306 -destalias m5\n</code></pre> </li> <li> <p>\u590d\u5236\u5230\u914d\u7f6e\u76ee\u5f55</p> <pre><code>cp hadoop.p12 /etc/hadoop/\nchown root:hadoop /etc/hadoop/hadoop.p12\n</code></pre> </li> </ol>"},{"location":"blog/2023/12/10/%E5%AE%89%E8%A3%85-hadoop-%E9%9B%86%E7%BE%A4rocky-linux-92/#hadoop","title":"\u914d\u7f6eHadoop","text":"<p>Warning</p> <p>\u4e0b\u9762\u7684\u547d\u4ee4\u53ea\u9700\u5728\u4e3b\u673amachine1\u4e0a\u6267\u884c\u3002</p> <ol> <li> <p>\u4fee\u6539\u914d\u7f6e\u6587\u4ef6$HADOOP_CONF_DIR/core-site.xml</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;?xml-stylesheet type=\"text/xsl\" href=\"configuration.xsl\"?&gt;\n&lt;!--\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License. See accompanying LICENSE file.\n--&gt;\n\n&lt;!-- Put site-specific property overrides in this file. --&gt;\n\n&lt;configuration&gt;\n&lt;property&gt;\n    &lt;name&gt;fs.defaultFS&lt;/name&gt;\n    &lt;value&gt;hdfs://xuwangwei&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;hadoop.tmp.dir&lt;/name&gt;\n    &lt;value&gt;/var/lib/hadoop&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;hadoop.zk.address&lt;/name&gt;\n    &lt;value&gt;machine1.xuwangwei.test:2181,machine2.xuwangwei.test:2181,machine3.xuwangwei.test:2181,machine4.xuwangwei.test:2181,machine5.xuwangwei.test:2181&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;ha.zookeeper.quorum&lt;/name&gt;\n    &lt;value&gt;machine1.xuwangwei.test:2181,machine2.xuwangwei.test:2181,machine3.xuwangwei.test:2181,machine4.xuwangwei.test:2181,machine5.xuwangwei.test:2181&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;hadoop.security.authentication&lt;/name&gt;\n    &lt;value&gt;kerberos&lt;/value&gt;\n&lt;/property&gt;\n&lt;/configuration&gt;\n</code></pre> </li> <li> <p>\u4fee\u6539\u914d\u7f6e\u6587\u4ef6$HADOOP_CONF_DIR/hdfs-site.xml</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;?xml-stylesheet type=\"text/xsl\" href=\"configuration.xsl\"?&gt;\n&lt;!--\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License. See accompanying LICENSE file.\n--&gt;\n\n&lt;!-- Put site-specific property overrides in this file. --&gt;\n\n&lt;configuration&gt;\n&lt;property&gt;\n    &lt;name&gt;dfs.nameservices&lt;/name&gt;\n    &lt;value&gt;xuwangwei&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;dfs.ha.namenodes.xuwangwei&lt;/name&gt;\n    &lt;value&gt;nn1,nn2,nn3&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;dfs.namenode.rpc-address.xuwangwei.nn1&lt;/name&gt;\n    &lt;value&gt;machine1.xuwangwei.test:8020&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;dfs.namenode.rpc-address.xuwangwei.nn2&lt;/name&gt;\n    &lt;value&gt;machine2.xuwangwei.test:8020&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;dfs.namenode.rpc-address.xuwangwei.nn3&lt;/name&gt;\n    &lt;value&gt;machine3.xuwangwei.test:8020&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;dfs.namenode.http-address.xuwangwei.nn1&lt;/name&gt;\n    &lt;value&gt;machine1.xuwangwei.test:9870&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;dfs.namenode.http-address.xuwangwei.nn2&lt;/name&gt;\n    &lt;value&gt;machine2.xuwangwei.test:9870&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;dfs.namenode.http-address.xuwangwei.nn3&lt;/name&gt;\n    &lt;value&gt;machine3.xuwangwei.test:9870&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;dfs.client.failover.proxy.provider.xuwangwei&lt;/name&gt;\n    &lt;value&gt;org.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;dfs.ha.fencing.methods&lt;/name&gt;\n    &lt;value&gt;sshfence&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;dfs.ha.fencing.ssh.private-key-files&lt;/name&gt;\n    &lt;value&gt;/home/hdfs/.ssh/id_rsa&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;dfs.namenode.shared.edits.dir&lt;/name&gt;\n    &lt;value&gt;qjournal://machine1.xuwangwei.test:8485;machine2.xuwangwei.test:8485;machine3.xuwangwei.test:8485/xuwangwei&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;dfs.journalnode.edits.dir&lt;/name&gt;\n    &lt;value&gt;${hadoop.tmp.dir}/dfs/journalnode/&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;dfs.ha.nn.not-become-active-in-safemode&lt;/name&gt;\n    &lt;value&gt;true&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;dfs.ha.automatic-failover.enabled&lt;/name&gt;\n    &lt;value&gt;true&lt;/value&gt;\n&lt;/property&gt;\n&lt;!-- start for kerberos --&gt;\n&lt;property&gt;\n    &lt;name&gt;dfs.block.access.token.enable&lt;/name&gt;\n    &lt;value&gt;true&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;dfs.namenode.keytab.file&lt;/name&gt;\n    &lt;value&gt;/etc/hadoop/hdfs.keytab&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;dfs.namenode.kerberos.principal&lt;/name&gt;\n    &lt;value&gt;hdfs/_HOST@XUWANGWEI.TEST&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;dfs.namenode.kerberos.internal.spnego.principal&lt;/name&gt;\n    &lt;value&gt;HTTP/_HOST@XUWANGWEI.TEST&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;dfs.journalnode.keytab.file&lt;/name&gt;\n    &lt;value&gt;/etc/hadoop/hdfs.keytab&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;dfs.journalnode.kerberos.principal &lt;/name&gt;\n    &lt;value&gt;hdfs/_HOST@XUWANGWEI.TEST&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;dfs.journalnode.kerberos.internal.spnego.principal&lt;/name&gt;\n    &lt;value&gt;HTTP/_HOST@XUWANGWEI.TEST&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;dfs.data.transfer.protection&lt;/name&gt;\n    &lt;value&gt;authentication&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;dfs.http.policy&lt;/name&gt;\n    &lt;value&gt;HTTPS_ONLY&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;dfs.datanode.keytab.file&lt;/name&gt;\n    &lt;value&gt;/etc/hadoop/hdfs.keytab&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;dfs.datanode.kerberos.principal&lt;/name&gt;\n    &lt;value&gt;hdfs/_HOST@XUWANGWEI.TEST&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;dfs.web.authentication.kerberos.keytab&lt;/name&gt;\n    &lt;value&gt;/etc/hadoop/hdfs.keytab&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;dfs.web.authentication.kerberos.principal&lt;/name&gt;\n    &lt;value&gt;HTTP/_HOST@XUWANGWEI.TEST&lt;/value&gt;\n&lt;/property&gt;\n&lt;!-- end for kerberos --&gt;\n&lt;/configuration&gt;\n</code></pre> </li> <li> <p>\u4fee\u6539\u914d\u7f6e\u6587\u4ef6$HADOOP_CONF_DIR/yarn-site.xml</p> <pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;!--\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License. See accompanying LICENSE file.\n--&gt;\n&lt;configuration&gt;\n&lt;property&gt;\n    &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt;\n    &lt;value&gt;mapreduce_shuffle&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;yarn.nodemanager.env-whitelist&lt;/name&gt;\n    &lt;value&gt;JAVA_HOME,HADOOP_COMMON_HOME,HADOOP_HDFS_HOME,HADOOP_CONF_DIR,CLASSPATH_PREPEND_DISTCACHE,HADOOP_YARN_HOME,HADOOP_HOME,PATH,LANG,TZ,HADOOP_MAPRED_HOME&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;yarn.resourcemanager.ha.enabled&lt;/name&gt;\n    &lt;value&gt;true&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;yarn.resourcemanager.cluster-id&lt;/name&gt;\n    &lt;value&gt;xuwangwei&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;yarn.resourcemanager.ha.rm-ids&lt;/name&gt;\n    &lt;value&gt;rm1,rm2&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;yarn.resourcemanager.hostname.rm1&lt;/name&gt;\n    &lt;value&gt;machine4.xuwangwei.test&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;yarn.resourcemanager.hostname.rm2&lt;/name&gt;\n    &lt;value&gt;machine5.xuwangwei.test&lt;/value&gt;\n&lt;/property&gt;\n&lt;!-- start for kerberos --&gt;\n&lt;property&gt;\n    &lt;name&gt;yarn.resourcemanager.principal&lt;/name&gt;\n    &lt;value&gt;yarn/_HOST@XUWANGWEI.TEST&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;yarn.resourcemanager.webapp.spnego-principal&lt;/name&gt;\n    &lt;value&gt;HTTP/_HOST@XUWANGWEI.TEST&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;yarn.resourcemanager.keytab&lt;/name&gt;\n    &lt;value&gt;/etc/hadoop/yarn.keytab&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;yarn.resourcemanager.webapp.spnego-keytab-file&lt;/name&gt;\n    &lt;value&gt;/etc/hadoop/yarn.keytab&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;yarn.nodemanager.principal&lt;/name&gt;\n    &lt;value&gt;yarn/_HOST@XUWANGWEI.TEST&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;yarn.nodemanager.webapp.spnego-principal&lt;/name&gt;\n    &lt;value&gt;HTTP/_HOST@XUWANGWEI.TEST&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;yarn.nodemanager.keytab&lt;/name&gt;\n    &lt;value&gt;/etc/hadoop/yarn.keytab&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;yarn.nodemanager.webapp.spnego-keytab-file&lt;/name&gt;\n    &lt;value&gt;/etc/hadoop/yarn.keytab&lt;/value&gt;\n&lt;/property&gt;\n&lt;!-- end for kerberos --&gt;\n&lt;property&gt;\n    &lt;name&gt;yarn.nodemanager.container-executor.class&lt;/name&gt;\n    &lt;value&gt;org.apache.hadoop.yarn.server.nodemanager.LinuxContainerExecutor&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;yarn.nodemanager.linux-container-executor.group&lt;/name&gt;\n    &lt;value&gt;hadoop&lt;/value&gt;\n&lt;/property&gt;\n&lt;/configuration&gt;\n</code></pre> </li> <li> <p>\u4fee\u6539\u914d\u7f6e\u6587\u4ef6$HADOOP_CONF_DIR/container-executor.cfg</p> <pre><code>yarn.nodemanager.linux-container-executor.group=hadoop\nbanned.users=root\n#allowed.system.users=\nmin.user.id=1000\n</code></pre> </li> <li> <p>\u4fee\u6539\u914d\u7f6e\u6587\u4ef6$HADOOP_CONF_DIR/mapred-site.xml</p> <pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;?xml-stylesheet type=\"text/xsl\" href=\"configuration.xsl\"?&gt;\n&lt;!--\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License. See accompanying LICENSE file.\n--&gt;\n\n&lt;!-- Put site-specific property overrides in this file. --&gt;\n\n&lt;configuration&gt;\n&lt;property&gt;\n    &lt;name&gt;mapreduce.framework.name&lt;/name&gt;\n    &lt;value&gt;yarn&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;mapreduce.jobhistory.address&lt;/name&gt;\n    &lt;value&gt;machine1.xuwangwei.test:10020&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;mapreduce.jobhistory.webapp.address&lt;/name&gt;\n    &lt;value&gt;machine1.xuwangwei.test:19888&lt;/value&gt;\n&lt;/property&gt;\n&lt;!-- start for kerberos --&gt;\n&lt;property&gt;\n    &lt;name&gt;mapreduce.jobhistory.principal&lt;/name&gt;\n    &lt;value&gt;mapred/_HOST@XUWANGWEI.TEST&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;mapreduce.jobhistory.keytab&lt;/name&gt;\n    &lt;value&gt;/etc/hadoop/mapred.keytab&lt;/value&gt;\n&lt;/property&gt;\n&lt;!-- end for kerberos --&gt;\n&lt;/configuration&gt;\n</code></pre> </li> <li> <p>\u4fee\u6539\u914d\u7f6e\u6587\u4ef6$HADOOP_CONF_DIR/workers</p> <pre><code>machine1\nmachine2\nmachine3\nmachine4\nmachine5\n</code></pre> </li> <li> <p>\u521b\u5efa\u914d\u7f6e\u6587\u4ef6 ssl-client.xml</p> <pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;?xml-stylesheet type=\"text/xsl\" href=\"configuration.xsl\"?&gt;\n&lt;!--\nLicensed to the Apache Software Foundation (ASF) under one or more\ncontributor license agreements.  See the NOTICE file distributed with\nthis work for additional information regarding copyright ownership.\nThe ASF licenses this file to You under the Apache License, Version 2.0\n(the \"License\"); you may not use this file except in compliance with\nthe License.  You may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n--&gt;\n&lt;configuration&gt;\n\n    &lt;property&gt;\n        &lt;name&gt;ssl.client.truststore.location&lt;/name&gt;\n        &lt;value&gt;/etc/hadoop/hadoop.p12&lt;/value&gt;\n        &lt;description&gt;Truststore to be used by clients like distcp. Must be\n            specified.\n        &lt;/description&gt;\n    &lt;/property&gt;\n\n    &lt;property&gt;\n        &lt;name&gt;ssl.client.truststore.password&lt;/name&gt;\n        &lt;value&gt;xuwangwei3306&lt;/value&gt;\n        &lt;description&gt;Optional. Default value is \"\".\n        &lt;/description&gt;\n    &lt;/property&gt;\n\n    &lt;property&gt;\n        &lt;name&gt;ssl.client.truststore.type&lt;/name&gt;\n        &lt;value&gt;pkcs12&lt;/value&gt;\n        &lt;description&gt;Optional. The keystore file format, default value is \"jks\".\n        &lt;/description&gt;\n    &lt;/property&gt;\n\n    &lt;property&gt;\n        &lt;name&gt;ssl.client.truststore.reload.interval&lt;/name&gt;\n        &lt;value&gt;10000&lt;/value&gt;\n        &lt;description&gt;Truststore reload check interval, in milliseconds.\n            Default value is 10000 (10 seconds).\n        &lt;/description&gt;\n    &lt;/property&gt;\n\n    &lt;property&gt;\n        &lt;name&gt;ssl.client.keystore.location&lt;/name&gt;\n        &lt;value&gt;/etc/hadoop/hadoop.p12&lt;/value&gt;\n        &lt;description&gt;Keystore to be used by clients like distcp. Must be\n            specified.\n        &lt;/description&gt;\n    &lt;/property&gt;\n\n    &lt;property&gt;\n        &lt;name&gt;ssl.client.keystore.password&lt;/name&gt;\n        &lt;value&gt;xuwangwei3306&lt;/value&gt;\n        &lt;description&gt;Optional. Default value is \"\".\n        &lt;/description&gt;\n    &lt;/property&gt;\n\n    &lt;property&gt;\n        &lt;name&gt;ssl.client.keystore.keypassword&lt;/name&gt;\n        &lt;value&gt;xuwangwei3306&lt;/value&gt;\n        &lt;description&gt;Optional. Default value is \"\".\n        &lt;/description&gt;\n    &lt;/property&gt;\n\n    &lt;property&gt;\n        &lt;name&gt;ssl.client.keystore.type&lt;/name&gt;\n        &lt;value&gt;pkcs12&lt;/value&gt;\n        &lt;description&gt;Optional. The keystore file format, default value is \"jks\".\n        &lt;/description&gt;\n    &lt;/property&gt;\n\n&lt;/configuration&gt;\n</code></pre> </li> <li> <p>\u521b\u5efa\u914d\u7f6e\u6587\u4ef6 ssl-server.xml</p> <pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;?xml-stylesheet type=\"text/xsl\" href=\"configuration.xsl\"?&gt;\n&lt;!--\nLicensed to the Apache Software Foundation (ASF) under one or more\ncontributor license agreements.  See the NOTICE file distributed with\nthis work for additional information regarding copyright ownership.\nThe ASF licenses this file to You under the Apache License, Version 2.0\n(the \"License\"); you may not use this file except in compliance with\nthe License.  You may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n--&gt;\n&lt;configuration&gt;\n\n    &lt;property&gt;\n        &lt;name&gt;ssl.server.truststore.location&lt;/name&gt;\n        &lt;value&gt;/etc/hadoop/hadoop.p12&lt;/value&gt;\n        &lt;description&gt;Truststore to be used by NN and DN. Must be specified.\n        &lt;/description&gt;\n    &lt;/property&gt;\n\n    &lt;property&gt;\n        &lt;name&gt;ssl.server.truststore.password&lt;/name&gt;\n        &lt;value&gt;xuwangwei3306&lt;/value&gt;\n        &lt;description&gt;Optional. Default value is \"\".\n        &lt;/description&gt;\n    &lt;/property&gt;\n\n    &lt;property&gt;\n        &lt;name&gt;ssl.server.truststore.type&lt;/name&gt;\n        &lt;value&gt;pkcs12&lt;/value&gt;\n        &lt;description&gt;Optional. The keystore file format, default value is \"jks\".\n        &lt;/description&gt;\n    &lt;/property&gt;\n\n    &lt;property&gt;\n        &lt;name&gt;ssl.server.truststore.reload.interval&lt;/name&gt;\n        &lt;value&gt;10000&lt;/value&gt;\n        &lt;description&gt;Truststore reload check interval, in milliseconds.\n            Default value is 10000 (10 seconds).\n        &lt;/description&gt;\n    &lt;/property&gt;\n\n    &lt;property&gt;\n        &lt;name&gt;ssl.server.keystore.location&lt;/name&gt;\n        &lt;value&gt;/etc/hadoop/hadoop.p12&lt;/value&gt;\n        &lt;description&gt;Keystore to be used by NN and DN. Must be specified.\n        &lt;/description&gt;\n    &lt;/property&gt;\n\n    &lt;property&gt;\n        &lt;name&gt;ssl.server.keystore.password&lt;/name&gt;\n        &lt;value&gt;xuwangwei3306&lt;/value&gt;\n        &lt;description&gt;Must be specified.\n        &lt;/description&gt;\n    &lt;/property&gt;\n\n    &lt;property&gt;\n        &lt;name&gt;ssl.server.keystore.keypassword&lt;/name&gt;\n        &lt;value&gt;xuwangwei3306&lt;/value&gt;\n        &lt;description&gt;Must be specified.\n        &lt;/description&gt;\n    &lt;/property&gt;\n\n    &lt;property&gt;\n        &lt;name&gt;ssl.server.keystore.type&lt;/name&gt;\n        &lt;value&gt;pkcs12&lt;/value&gt;\n        &lt;description&gt;Optional. The keystore file format, default value is \"jks\".\n        &lt;/description&gt;\n    &lt;/property&gt;\n\n    &lt;property&gt;\n        &lt;name&gt;ssl.server.exclude.cipher.list&lt;/name&gt;\n        &lt;value&gt;TLS_ECDHE_RSA_WITH_RC4_128_SHA,SSL_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA,\n            SSL_RSA_WITH_DES_CBC_SHA,SSL_DHE_RSA_WITH_DES_CBC_SHA,\n            SSL_RSA_EXPORT_WITH_RC4_40_MD5,SSL_RSA_EXPORT_WITH_DES40_CBC_SHA,\n            SSL_RSA_WITH_RC4_128_MD5&lt;/value&gt;\n        &lt;description&gt;Optional. The weak security cipher suites that you want excluded\n            from SSL communication.&lt;/description&gt;\n    &lt;/property&gt;\n\n&lt;/configuration&gt;\n</code></pre> </li> <li> <p>\u521b\u5efa\u914d\u7f6e\u6587\u4ef6 jaas.conf</p> <pre><code>Client {\n    com.sun.security.auth.module.Krb5LoginModule required\n    useKeyTab=true\n    keyTab=\"/etc/hadoop/hdfs.keytab\"\n    storeKey=true\n    useTicketCache=false\n    principal=\"hdfs\";\n};\n</code></pre> </li> <li> <p>\u4fee\u6539\u914d\u7f6e\u6587\u4ef6$HADOOP_CONF_DIR/hadoop-env.sh</p> <pre><code>echo 'export HADOOP_OPTS=\"${HADOOP_OPTS} -Djava.net.preferIPv4Stack=true\"' &gt;&gt; $HADOOP_CONF_DIR/hadoop-env.sh\n</code></pre> </li> </ol>"},{"location":"blog/2023/12/10/%E5%AE%89%E8%A3%85-hadoop-%E9%9B%86%E7%BE%A4rocky-linux-92/#zookeeper","title":"\u914d\u7f6eZooKeeper","text":"<p>Warning</p> <p>\u4e0b\u9762\u7684\u547d\u4ee4\u53ea\u9700\u5728\u4e3b\u673amachine1\u4e0a\u6267\u884c\u3002</p> <ol> <li> <p>\u521b\u5efa\u914d\u7f6e\u6587\u4ef6$ZOOCFGDIR/zoo.cfg</p> <pre><code>mv $ZOOCFGDIR/zoo_sample.cfg $ZOOCFGDIR/zoo.cfg\n</code></pre> </li> <li> <p>\u4fee\u6539\u914d\u7f6e\u6587\u4ef6$ZOOCFGDIR/zoo.cfg</p> <pre><code># The number of milliseconds of each tick\ntickTime=2000\n# The number of ticks that the initial \n# synchronization phase can take\ninitLimit=10\n# The number of ticks that can pass between \n# sending a request and getting an acknowledgement\nsyncLimit=5\n# the directory where the snapshot is stored.\n# do not use /tmp for storage, /tmp here is just \n# example sakes.\ndataDir=/var/lib/zookeeper\n# the port at which the clients will connect\nclientPort=2181\n# the maximum number of client connections.\n# increase this if you need to handle more clients\n#maxClientCnxns=60\n#\n# Be sure to read the maintenance section of the \n# administrator guide before turning on autopurge.\n#\n# http://zookeeper.apache.org/doc/current/zookeeperAdmin.html#sc_maintenance\n#\n# The number of snapshots to retain in dataDir\n#autopurge.snapRetainCount=3\n# Purge task interval in hours\n# Set to \"0\" to disable auto purge feature\n#autopurge.purgeInterval=1\n\n## Metrics Providers\n#\n# https://prometheus.io Metrics Exporter\n#metricsProvider.className=org.apache.zookeeper.metrics.prometheus.PrometheusMetricsProvider\n#metricsProvider.httpPort=7000\n#metricsProvider.exportJvmInfo=true\n\nserver.1=machine1.xuwangwei.test:2888:3888\nserver.2=machine2.xuwangwei.test:2888:3888\nserver.3=machine3.xuwangwei.test:2888:3888\nserver.4=machine4.xuwangwei.test:2888:3888\nserver.5=machine5.xuwangwei.test:2888:3888\n\nenforce.auth.enabled=true\nenforce.auth.schemes=sasl\nauthProvider.1=org.apache.zookeeper.server.auth.SASLAuthenticationProvider \n# optional SASL related server-side properties:\n# you can instruct ZooKeeper to remove the host from the client principal name during authentication\n# (e.g. zk/myhost@EXAMPLE.COM client principal will be authenticated in ZooKeeper as zk@EXAMPLE.COM)\nkerberos.removeHostFromPrincipal=true\n# you can instruct ZooKeeper to remove the realm from the client principal name during authentication\n# (e.g. zk/myhost@EXAMPLE.COM client principal will be authenticated in ZooKeeper as zk/myhost)\nkerberos.removeRealmFromPrincipal=true\n</code></pre> </li> <li> <p>\u521b\u5efa\u914d\u7f6e\u6587\u4ef6/etc/zookeeper_no_share/jaas.conf\uff0c\u7531\u4e8e\u8be5\u914d\u7f6e\u6587\u4ef6\u65e0\u6cd5\u914d\u7f6e zookeeper/_HOST \u8fd9\u79cd\u7edf\u4e00\u7684\u670d\u52a1 principal\uff0c\u6240\u4ee5\u8fd9\u4e2a\u914d\u7f6e\u65e0\u6cd5\u5171\u4eab\uff0c\u5355\u72ec\u653e\u5728\u4e86\u4e00\u4e2a\u76ee\u5f55\u4e0b\u3002\u6bcf\u53f0\u673a\u5668\u4e0a\u7684\u6b64\u914d\u7f6e\u90fd\u8981\u4fee\u6539 Server \u4e0b principal\u3002</p> <pre><code>Server {\n    com.sun.security.auth.module.Krb5LoginModule required\n    useKeyTab=true\n    keyTab=\"/etc/zookeeper/zookeeper.keytab\"\n    storeKey=true\n    useTicketCache=false\n    principal=\"zookeeper/machine1.xuwangwei.test\";\n};\nClient {\n    com.sun.security.auth.module.Krb5LoginModule required\n    useKeyTab=true\n    keyTab=\"/etc/zookeeper/zookeeper.keytab\"\n    storeKey=true\n    useTicketCache=false\n    principal=\"zookeeper\";\n};\n</code></pre> </li> <li> <p>\u521b\u5efa\u914d\u7f6e\u6587\u4ef6$ZOOCFGDIR/java.env</p> <pre><code>SERVER_JVMFLAGS=\"${SERVER_JVMFLAGS} -Djava.security.auth.login.config=/etc/zookeeper_no_share/jaas.conf\"\nCLIENT_JVMFLAGS=\"${CLIENT_JVMFLAGS} -Djava.security.auth.login.config=/etc/zookeeper_no_share/jaas.conf\"\n</code></pre> </li> <li> <p>\u5728\u6570\u636e\u76ee\u5f55\uff08\u5373zoo.cfg\u4e2d\u914d\u7f6e\u7684dataDir\uff09\u4e0b\u521b\u5efamyid\u6587\u4ef6\u548cinitialize\u7a7a\u6587\u4ef6\uff0cmyid\u6587\u4ef6\u5185\u5bb9\u662f\u672c\u5b9e\u4f8b\u5728\u96c6\u7fa4\u4e2d\u7684id\u3002</p> <pre><code>su - zookeeper\nssh machine1 'echo 1 &gt; /var/lib/zookeeper/myid;touch /var/lib/zookeeper/initialize'\nssh machine2 'echo 2 &gt; /var/lib/zookeeper/myid;touch /var/lib/zookeeper/initialize'\nssh machine3 'echo 3 &gt; /var/lib/zookeeper/myid;touch /var/lib/zookeeper/initialize'\nssh machine4 'echo 4 &gt; /var/lib/zookeeper/myid;touch /var/lib/zookeeper/initialize'\nssh machine5 'echo 5 &gt; /var/lib/zookeeper/myid;touch /var/lib/zookeeper/initialize'\nexit\n</code></pre> </li> </ol>"},{"location":"blog/2023/12/10/%E5%AE%89%E8%A3%85-hadoop-%E9%9B%86%E7%BE%A4rocky-linux-92/#zookeeper_1","title":"\u542f\u52a8ZooKeeper","text":"<p>Warning</p> <p>\u4e0b\u9762\u7684\u547d\u4ee4\u53ea\u9700\u5728\u4e3b\u673amachine1\u4e0a\u6267\u884c\u3002</p> <pre><code>su - zookeeper\nssh machine1 'zkServer.sh start'\nssh machine2 'zkServer.sh start'\nssh machine3 'zkServer.sh start'\nssh machine4 'zkServer.sh start'\nssh machine5 'zkServer.sh start'\nexit\n</code></pre>"},{"location":"blog/2023/12/10/%E5%AE%89%E8%A3%85-hadoop-%E9%9B%86%E7%BE%A4rocky-linux-92/#hadoop_1","title":"\u542f\u52a8Hadoop","text":"<p>Warning</p> <p>\u4e0b\u9762\u7684\u547d\u4ee4\u53ea\u9700\u5728\u4e3b\u673amachine1\u4e0a\u6267\u884c\u3002</p> <ol> <li> <p>\u542f\u52a8 HDFS</p> <pre><code>su - hdfs -c \"ssh machine1 'hdfs --daemon start journalnode'\"\nsu - hdfs -c \"ssh machine2 'hdfs --daemon start journalnode'\"\nsu - hdfs -c \"ssh machine3 'hdfs --daemon start journalnode'\"\nsu - hdfs -c \"hdfs namenode -format\"\nsu - hdfs -c \"hdfs zkfc -formatZK\"\nsu - hdfs -c \"start-dfs.sh\"\nsu - hdfs -c \"ssh machine2 'hdfs namenode -bootstrapStandby'\"\nsu - hdfs -c \"ssh machine3 'hdfs namenode -bootstrapStandby'\"\nsu - hdfs -c \"stop-dfs.sh;start-dfs.sh\"\n</code></pre> </li> <li> <p>\u4fee\u6539\u7528\u6237 hdfs \u7684\u73af\u5883\u53d8\u91cf</p> <pre><code>echo 'export KRB5CCNAME=FILE:/tmp/krb5cc_$UID' &gt;&gt; ~hdfs/.bashrc\n</code></pre> <p>hadoop \u547d\u4ee4\u4e0d\u652f\u6301 FreeIPA \u5b89\u88c5\u540e\u7684<code>default_ccache_name</code>\u914d\u7f6e\u9879\uff08KCM\uff09\uff0c\u6240\u4ee5\u6211\u901a\u8fc7\u6539\u53d8 hdfs \u7528\u6237\u7684\u73af\u5883\u53d8\u91cf\uff0c\u4f7f\u5f97 hdfs \u7528\u6237\u4f7f\u7528 kinit \u547d\u4ee4\u8fdb\u884c Kerberos \u8eab\u4efd\u8ba4\u8bc1\u65f6\uff0c\u4f7f\u7528/tmp/krb5cc_$UID\u7684 credential cache\u3002</p> </li> <li> <p>\u4f7f\u7528 hdfs@XUWANGWEI.TEST \u5e10\u53f7\u8fdb\u884c Kerberos \u8ba4\u8bc1</p> <pre><code>su - hdfs -c \"kinit -kt /etc/hadoop/hdfs.keytab hdfs\"\n</code></pre> </li> <li> <p>\u521d\u59cb\u5316\u76ee\u5f55</p> <pre><code>su - hdfs -c \"hadoop fs -chown hdfs:hadoop /\"\nsu - hdfs -c \"hadoop fs -mkdir /tmp /user\"\nsu - hdfs -c \"hadoop fs -chmod 1777 /tmp\"\n</code></pre> </li> <li> <p>\u542f\u52a8 YARN</p> <pre><code>su - yarn -c \"start-yarn.sh\"\n</code></pre> </li> <li> <p>\u542f\u52a8 MapReduce</p> <pre><code>su - mapred -c \"mapred --daemon start historyserver\"\n</code></pre> </li> </ol>"},{"location":"blog/2024/01/03/%E5%AE%89%E8%A3%85-hive-%E9%9B%86%E7%BE%A4rocky-linux-92/","title":"\u5b89\u88c5 Hive \u96c6\u7fa4(Rocky Linux 9.2)","text":"<p>\u5b89\u88c5\u76ee\u6807</p> <ul> <li> Hive \u96c6\u7fa4\u542f\u7528 Kerberos \u8ba4\u8bc1\u3002</li> <li> Hive \u7531 2 \u4e2a HiveServer2 \u548c 2 \u4e2a MetaStore \u7ec4\u6210\u96c6\u7fa4\u3002</li> <li> Hive \u7248\u672c\u662f 3.1.3\u3002</li> </ul> <p>\u524d\u7f6e\u6761\u4ef6</p> <ul> <li> \u5df2\u6309\u7167\u5b89\u88c5 Hadoop \u96c6\u7fa4(Rocky Linux 9.2)\u5b89\u88c5 Hadoop\u3002</li> <li> \u5df2\u5b89\u88c5 MySQL\u3002</li> </ul>"},{"location":"blog/2024/01/03/%E5%AE%89%E8%A3%85-hive-%E9%9B%86%E7%BE%A4rocky-linux-92/#_1","title":"\u51c6\u5907\u7528\u6237","text":"<p>Warning</p> <p>\u4e0b\u9762\u7684\u547d\u4ee4\u662f\u5728\u4e3b\u673a ipa-server \u4e0a\u6267\u884c\u7684\u3002</p> <ol> <li> <p>\u8eab\u4efd\u8ba4\u8bc1</p> <pre><code>[root@ipa-server ~]# kinit admin\nPassword for admin@XUWANGWEI.TEST: \n</code></pre> </li> <li> <p>\u65b0\u589e\u7528\u6237 hive</p> <pre><code>ipa user-add hive --first=hive --last=hadoop --shell=/bin/bash --gidnumber=1532600004\nsu - hive\nssh-keygen -t rsa -P '' -f ~/.ssh/id_rsa\ncat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys\nchmod 0600 ~/.ssh/authorized_keys\nexit\nipa user-mod hive --sshpubkey=\"$( cat ~hive/.ssh/id_rsa.pub )\"\n</code></pre> </li> </ol>"},{"location":"blog/2024/01/03/%E5%AE%89%E8%A3%85-hive-%E9%9B%86%E7%BE%A4rocky-linux-92/#hive","title":"\u5171\u4eab Hive \u914d\u7f6e\u76ee\u5f55","text":"<p>Warning</p> <p>\u4e0b\u9762\u7684\u547d\u4ee4\u662f\u5728\u4e3b\u673a ipa-server \u4e0a\u6267\u884c\u7684\u3002</p> <ol> <li> <p>\u4fee\u6539 NFS \u914d\u7f6e\u6587\u4ef6/etc/exports\uff0c\u4f7f\u5f97\u4e3b\u673a ipa-server \u4e0a\u7684/etc/hive \u76ee\u5f55\u5171\u4eab\u7ed9\u5176\u4ed6\u4e3b\u673a\u3002</p> <pre><code>echo '/etc/hive 192.168.2.0/24(rw,sync,no_root_squash)' &gt;&gt; /etc/exports\n</code></pre> </li> <li> <p>\u521b\u5efa Hive \u914d\u7f6e\u76ee\u5f55\u5e76\u8bbe\u7f6e\u5c5e\u4e3b\u5c5e\u7ec4</p> <pre><code>mkdir /etc/hive\nchown hive:hadoop /etc/hive\nchmod 755 /etc/hive\n</code></pre> </li> <li> <p>\u5237\u65b0 NFS \u7684\u914d\u7f6e</p> <pre><code>exportfs -rv\n</code></pre> </li> <li> <p>\u5728 IPA Server \u4e0a\u521b\u5efa\u6302\u8f7d\u914d\u7f6e</p> <pre><code>ipa automountkey-add default auto.direct --key=/etc/hive --info=\"-fstype=nfs4,rw ipa-server:/etc/hive\"\n</code></pre> </li> </ol>"},{"location":"blog/2024/01/03/%E5%AE%89%E8%A3%85-hive-%E9%9B%86%E7%BE%A4rocky-linux-92/#hive_1","title":"\u5b89\u88c5 Hive","text":"<p>Warning</p> <p>\u4e0b\u9762\u7684\u547d\u4ee4\u9700\u8981\u5728\u4e3b\u673a machine1~machine5 \u4e0a\u6267\u884c\u3002</p> <ol> <li> <p>\u4e0b\u8f7d\u3001\u89e3\u538b\u3001\u521b\u5efa\u522b\u540d</p> <pre><code>cd /opt\ncurl -O https://dlcdn.apache.org/hive/hive-3.1.3/apache-hive-3.1.3-bin.tar.gz\ntar -zxf apache-hive-3.1.3-bin.tar.gz\nln -s apache-hive-3.1.3-bin hive\n</code></pre> </li> <li> <p>\u6dfb\u52a0\u73af\u5883\u53d8\u91cf</p> <pre><code>echo 'export HIVE_HOME=/opt/hive' &gt; /etc/profile.d/hive.sh\necho 'export PATH=$PATH:$HIVE_HOME/bin' &gt;&gt; /etc/profile.d/hive.sh\necho 'export HIVE_CONF_DIR=/etc/hive' &gt;&gt; /etc/profile.d/hive.sh\nsource /etc/profile.d/hive.sh\n</code></pre> </li> <li> <p>\u4e0b\u8f7d MySQL JDBC \u9a71\u52a8\u5230 $HIVE_HOME/lib \u76ee\u5f55\u4e0b</p> <pre><code>curl -O --output-dir $HIVE_HOME/lib https://repo1.maven.org/maven2/com/mysql/mysql-connector-j/8.0.33/mysql-connector-j-8.0.33.jar\n</code></pre> </li> <li> <p>\u521b\u5efa\u6570\u636e\u76ee\u5f55\u5e76\u8bbe\u7f6e\u5c5e\u4e3b\u5c5e\u7ec4</p> <pre><code>chown -R -H hive:hadoop $HIVE_HOME\nchmod 755 $HIVE_HOME\nmkdir /var/lib/hive\nchown hive:hadoop /var/lib/hive\nchmod 750 /var/lib/hive\n</code></pre> </li> <li> <p>\u521b\u5efa\u914d\u7f6e\u76ee\u5f55\u5e76\u8bbe\u7f6e\u5c5e\u4e3b\u5c5e\u7ec4</p> <pre><code>mkdir /etc/hive\nchown hive:hadoop /etc/hive\nchmod 755 /etc/hive\n</code></pre> </li> <li> <p>\u521b\u5efa\u65e5\u5fd7\u76ee\u5f55\u5e76\u8bbe\u7f6e\u5c5e\u4e3b\u5c5e\u7ec4</p> <pre><code>mkdir /var/log/hive\nchown hive:hadoop /var/log/hive\nchmod 755 /var/log/hive\n</code></pre> </li> <li> <p>\u5171\u4eab ipa-server \u7684/etc/hive \u76ee\u5f55</p> <pre><code>systemctl reload autofs\n</code></pre> </li> </ol>"},{"location":"blog/2024/01/03/%E5%AE%89%E8%A3%85-hive-%E9%9B%86%E7%BE%A4rocky-linux-92/#kerberos-principals-keytab-files","title":"\u51c6\u5907 Kerberos principals \u548c keytab files","text":"<p>Warning</p> <p>\u4e0b\u9762\u7684\u547d\u4ee4\u662f\u5728\u4e3b\u673a ipa-server \u4e0a\u6267\u884c\u7684\u3002</p> <ol> <li> <p>\u521b\u5efaprincipal</p> <pre><code>ipa service-add hive/machine1.xuwangwei.test@XUWANGWEI.TEST --requires-pre-auth=true\nipa service-add hive/machine2.xuwangwei.test@XUWANGWEI.TEST --requires-pre-auth=true\nipa service-add hive/machine3.xuwangwei.test@XUWANGWEI.TEST --requires-pre-auth=true\nipa service-add hive/machine4.xuwangwei.test@XUWANGWEI.TEST --requires-pre-auth=true\nipa service-add hive/machine5.xuwangwei.test@XUWANGWEI.TEST --requires-pre-auth=true\n</code></pre> </li> <li> <p>\u5bfc\u51faprincipal\u7684\u5bc6\u94a5</p> <pre><code>ipa-getkeytab --principal=HTTP/machine1.xuwangwei.test@XUWANGWEI.TEST --keytab=/etc/hive/hive.keytab --enctypes=aes256-sha1,aes128-sha1\nipa-getkeytab --principal=HTTP/machine2.xuwangwei.test@XUWANGWEI.TEST --keytab=/etc/hive/hive.keytab --enctypes=aes256-sha1,aes128-sha1\nipa-getkeytab --principal=HTTP/machine3.xuwangwei.test@XUWANGWEI.TEST --keytab=/etc/hive/hive.keytab --enctypes=aes256-sha1,aes128-sha1\nipa-getkeytab --principal=HTTP/machine4.xuwangwei.test@XUWANGWEI.TEST --keytab=/etc/hive/hive.keytab --enctypes=aes256-sha1,aes128-sha1\nipa-getkeytab --principal=HTTP/machine5.xuwangwei.test@XUWANGWEI.TEST --keytab=/etc/hive/hive.keytab --enctypes=aes256-sha1,aes128-sha1\nipa-getkeytab --principal=hive/machine1.xuwangwei.test@XUWANGWEI.TEST --keytab=/etc/hive/hive.keytab --enctypes=aes256-sha1,aes128-sha1\nipa-getkeytab --principal=hive/machine2.xuwangwei.test@XUWANGWEI.TEST --keytab=/etc/hive/hive.keytab --enctypes=aes256-sha1,aes128-sha1\nipa-getkeytab --principal=hive/machine3.xuwangwei.test@XUWANGWEI.TEST --keytab=/etc/hive/hive.keytab --enctypes=aes256-sha1,aes128-sha1\nipa-getkeytab --principal=hive/machine4.xuwangwei.test@XUWANGWEI.TEST --keytab=/etc/hive/hive.keytab --enctypes=aes256-sha1,aes128-sha1\nipa-getkeytab --principal=hive/machine5.xuwangwei.test@XUWANGWEI.TEST --keytab=/etc/hive/hive.keytab --enctypes=aes256-sha1,aes128-sha1\nipa-getkeytab --principal=hive@XUWANGWEI.TEST --keytab=/etc/hive/hive.keytab --enctypes=aes256-sha1,aes128-sha1\n</code></pre> </li> <li> <p>\u4fee\u6539keytab\u7684\u5c5e\u4e3b\u5c5e\u7ec4\u548c\u6743\u9650</p> <pre><code>chown hive:hadoop /etc/hive/*.keytab\nchmod 640 /etc/hive/*.keytab\n</code></pre> </li> </ol>"},{"location":"blog/2024/01/03/%E5%AE%89%E8%A3%85-hive-%E9%9B%86%E7%BE%A4rocky-linux-92/#hive_2","title":"\u914d\u7f6e Hive","text":"<p>Warning</p> <p>\u4e0b\u9762\u7684\u547d\u4ee4\u662f\u5728\u4e3b\u673a machine1 \u4e0a\u6267\u884c\u7684\u3002</p> <ol> <li> <p>\u5728MySQL\u6570\u636e\u5e93\u4e2d\u521b\u5efa\u7528\u6237hive\uff0c\u521b\u5efa\u6570\u636e\u5e93metastore_db\u3002\u8fd9\u4e9b\u4fe1\u606f\u4f1a\u653e\u5728\u914d\u7f6e\u6587\u4ef6hive-site.xml\u4e2d\u3002</p> <pre><code># \u5728\u5b89\u88c5MySQL\u7684\u4e3b\u673a\u4e0a\u8f93\u5165\nmysql -uroot -p\n# \u6210\u529f\u767b\u5f55\u540e\uff0c\u5148\u521b\u5efa\u6570\u636e\u5e93metastore_db\uff0c\u518d\u521b\u5efa\u7528\u6237hive\uff0c\u6700\u540e\u628ametastore_db\u7684\u6240\u6709\u6743\u9650\u90fd\u6388\u6743\u7ed9\u7528\u6237hive\nmysql&gt; CREATE DATABASE metastore_db CHARACTER SET utf8mb4;\nmysql&gt; CREATE USER 'hive'@'%' IDENTIFIED BY 'ifpx8#2c4Kv65';\nmysql&gt; GRANT ALL ON metastore_db.* TO 'hive'@'%';\nmysql&gt; quit;\n</code></pre> </li> <li> <p>\u5c06\u6570\u636e\u5e93 metastore_db \u7684\u5bc6\u7801\u5b58\u50a8\u5230/etc/hive/hive.jceks</p> <pre><code>[root@machine1 ~]# su - hive -c \"hadoop credential create javax.jdo.option.ConnectionPassword -provider jceks://file/etc/hive/hive.jceks\"\nWARNING: You have accepted the use of the default provider password\nby not configuring a password in one of the two following locations:\n    * In the environment variable HADOOP_CREDSTORE_PASSWORD\n    * In a file referred to by the configuration entry\n    hadoop.security.credstore.java-keystore-provider.password-file.\nPlease review the documentation regarding provider passwords in\nthe keystore passwords section of the Credential Provider API\nContinuing with the default provider password.\n\nEnter alias password: \nEnter alias password again: \njavax.jdo.option.ConnectionPassword has been successfully created.\nProvider jceks://file/etc/hive/hive.jceks was updated.\n</code></pre> </li> <li> <p>\u521b\u5efa hive-site.xml</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?&gt;\n&lt;?xml-stylesheet type=\"text/xsl\" href=\"configuration.xsl\"?&gt;\n&lt;!--\nLicensed to the Apache Software Foundation (ASF) under one or more\ncontributor license agreements.  See the NOTICE file distributed with\nthis work for additional information regarding copyright ownership.\nThe ASF licenses this file to You under the Apache License, Version 2.0\n(the \"License\"); you may not use this file except in compliance with\nthe License.  You may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n--&gt;\n&lt;configuration&gt;\n    &lt;property&gt;\n        &lt;name&gt;system:user.name&lt;/name&gt;\n        &lt;value&gt;${user.name}&lt;/value&gt;\n    &lt;/property&gt;\n    &lt;property&gt;\n        &lt;name&gt;system:java.io.tmpdir&lt;/name&gt;\n        &lt;value&gt;/var/lib/hive&lt;/value&gt;\n    &lt;/property&gt;\n\n    &lt;property&gt;\n        &lt;name&gt;hive.metastore.uris&lt;/name&gt;\n        &lt;value&gt;thrift://machine4.xuwangwei.test:9083,thrift://machine5.xuwangwei.test:9083&lt;/value&gt;\n    &lt;/property&gt;\n    &lt;property&gt;\n        &lt;name&gt;hive.metastore.kerberos.keytab.file&lt;/name&gt;\n        &lt;value&gt;/etc/hive/hive.keytab&lt;/value&gt;\n    &lt;/property&gt;\n    &lt;property&gt;\n        &lt;name&gt;hive.metastore.kerberos.principal&lt;/name&gt;\n        &lt;value&gt;hive/_HOST@XUWANGWEI.TEST&lt;/value&gt;\n    &lt;/property&gt;\n    &lt;property&gt;\n        &lt;name&gt;hive.metastore.client.kerberos.principal&lt;/name&gt;\n        &lt;value&gt;hive/_HOST@XUWANGWEI.TEST&lt;/value&gt;\n    &lt;/property&gt;\n    &lt;property&gt;\n        &lt;name&gt;hive.metastore.sasl.enabled&lt;/name&gt;\n        &lt;value&gt;true&lt;/value&gt;\n    &lt;/property&gt;\n    &lt;property&gt;\n        &lt;name&gt;hive.metastore.db.type&lt;/name&gt;\n        &lt;value&gt;mysql&lt;/value&gt;\n    &lt;/property&gt;\n    &lt;property&gt;\n        &lt;name&gt;javax.jdo.option.ConnectionDriverName&lt;/name&gt;\n        &lt;value&gt;com.mysql.cj.jdbc.Driver&lt;/value&gt;\n    &lt;/property&gt;\n    &lt;property&gt;\n        &lt;name&gt;javax.jdo.option.ConnectionURL&lt;/name&gt;\n        &lt;value&gt;jdbc:mysql://mysql.xuwangwei.test:3306/metastore_db?characterEncoding=UTF-8&amp;amp;characterSetResults=UTF-8&amp;amp;connectionTimeZone=Asia/Shanghai&lt;/value&gt;\n    &lt;/property&gt;\n    &lt;property&gt;\n        &lt;name&gt;javax.jdo.option.ConnectionUserName&lt;/name&gt;\n        &lt;value&gt;hive&lt;/value&gt;\n    &lt;/property&gt;\n    &lt;property&gt;\n        &lt;name&gt;hadoop.security.credential.provider.path&lt;/name&gt;\n        &lt;value&gt;jceks://file/etc/hive/hive.jceks&lt;/value&gt;\n    &lt;/property&gt;\n    &lt;property&gt;\n        &lt;name&gt;hive.metastore.port&lt;/name&gt;\n        &lt;value&gt;9083&lt;/value&gt;\n    &lt;/property&gt;\n    &lt;property&gt;\n        &lt;name&gt;hive.metastore.schema.verification&lt;/name&gt;\n        &lt;value&gt;false&lt;/value&gt;\n    &lt;/property&gt;\n    &lt;property&gt;\n        &lt;name&gt;hive.metastore.schema.verification.record.version&lt;/name&gt;\n        &lt;value&gt;false&lt;/value&gt;\n    &lt;/property&gt;\n    &lt;property&gt;\n        &lt;name&gt;hive.metastore.warehouse.dir&lt;/name&gt;\n        &lt;value&gt;/user/hive/warehouse&lt;/value&gt;\n    &lt;/property&gt;\n\n    &lt;property&gt;\n        &lt;name&gt;hive.server2.webui.port&lt;/name&gt;\n        &lt;value&gt;10002&lt;/value&gt;\n        &lt;description&gt;The port the HiveServer2 WebUI will listen on. This can beset to 0 or a negative integer to disable the web UI&lt;/description&gt;\n    &lt;/property&gt;\n    &lt;property&gt;\n        &lt;name&gt;hive.server2.webui.use.spnego&lt;/name&gt;\n        &lt;value&gt;false&lt;/value&gt;\n    &lt;/property&gt;\n    &lt;property&gt;\n        &lt;name&gt;hive.server2.webui.spnego.keytab&lt;/name&gt;\n        &lt;value&gt;/etc/hive/hive.keytab&lt;/value&gt;\n    &lt;/property&gt;\n    &lt;property&gt;\n        &lt;name&gt;hive.server2.webui.spnego.principal&lt;/name&gt;\n        &lt;value&gt;HTTP/_HOST@XUWANGWEI.TEST&lt;/value&gt;\n    &lt;/property&gt;\n\n    &lt;property&gt;\n        &lt;name&gt;hive.server2.authentication&lt;/name&gt;\n        &lt;value&gt;kerberos&lt;/value&gt;\n    &lt;/property&gt;\n    &lt;property&gt;\n        &lt;name&gt;hive.server2.thrift.sasl.qop&lt;/name&gt;\n        &lt;value&gt;auth-conf&lt;/value&gt;\n    &lt;/property&gt;\n    &lt;property&gt;\n        &lt;name&gt;hive.server2.thrift.port&lt;/name&gt;\n        &lt;value&gt;10000&lt;/value&gt;\n        &lt;description&gt;Port number of HiveServer2 Thrift interface when hive.server2.transport.mode is 'binary'.&lt;/description&gt;\n    &lt;/property&gt;\n    &lt;property&gt;\n        &lt;name&gt;hive.server2.authentication.kerberos.keytab&lt;/name&gt;\n        &lt;value&gt;/etc/hive/hive.keytab&lt;/value&gt;\n    &lt;/property&gt;\n    &lt;property&gt;\n        &lt;name&gt;hive.server2.authentication.kerberos.principal&lt;/name&gt;\n        &lt;value&gt;hive/_HOST@XUWANGWEI.TEST&lt;/value&gt;\n    &lt;/property&gt;\n    &lt;property&gt;\n        &lt;name&gt;hive.server2.authentication.client.kerberos.principal&lt;/name&gt;\n        &lt;value&gt;hive/_HOST@XUWANGWEI.TEST&lt;/value&gt;\n    &lt;/property&gt;\n    &lt;property&gt;\n        &lt;name&gt;hive.server2.authentication.spnego.keytab&lt;/name&gt;\n        &lt;value&gt;/etc/hive/hive.keytab&lt;/value&gt;\n    &lt;/property&gt;\n    &lt;property&gt;\n        &lt;name&gt;hive.server2.authentication.spnego.principal&lt;/name&gt;\n        &lt;value&gt;HTTP/_HOST@XUWANGWEI.TEST&lt;/value&gt;\n    &lt;/property&gt;\n    &lt;property&gt;\n        &lt;name&gt;hive.compute.query.using.stats&lt;/name&gt;\n        &lt;value&gt;false&lt;/value&gt;\n    &lt;/property&gt;\n    &lt;property&gt;\n        &lt;name&gt;hive.exec.parallel&lt;/name&gt;\n        &lt;value&gt;true&lt;/value&gt;\n        &lt;description&gt;Whether to execute jobs in parallel&lt;/description&gt;\n    &lt;/property&gt;\n    &lt;property&gt;\n        &lt;name&gt;hive.execution.engine&lt;/name&gt;\n        &lt;value&gt;mr&lt;/value&gt;\n        &lt;description&gt;\n            Expects one of [mr, tez, spark].\n            Chooses execution engine. Options are: mr (Map reduce, default), tez, spark. While MR\n            remains the default engine for historical reasons, it is itself a historical engine\n            and is deprecated in Hive 2 line. It may be removed without further warning.\n        &lt;/description&gt;\n    &lt;/property&gt;\n\n    &lt;property&gt;\n        &lt;name&gt;hive.server2.support.dynamic.service.discovery&lt;/name&gt;\n        &lt;value&gt;true&lt;/value&gt;\n    &lt;/property&gt;\n    &lt;property&gt;\n        &lt;name&gt;hive.server2.zookeeper.namespace&lt;/name&gt;\n        &lt;value&gt;hiveserver2&lt;/value&gt;\n    &lt;/property&gt;\n    &lt;property&gt;\n        &lt;name&gt;hive.zookeeper.quorum&lt;/name&gt;\n        &lt;value&gt;machine1.xuwangwei.test:2181,machine2.xuwangwei.test:2181,machine3.xuwangwei.test:2181,machine4.xuwangwei.test:2181,machine5.xuwangwei.test:2181&lt;/value&gt;\n    &lt;/property&gt;\n&lt;/configuration&gt;\n</code></pre> </li> <li> <p>\u4fee\u6539\u914d\u7f6e\u6587\u4ef6 $HADOOP_CONF_DIR/core-site.xml</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;?xml-stylesheet type=\"text/xsl\" href=\"configuration.xsl\"?&gt;\n&lt;!--\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License. See accompanying LICENSE file.\n--&gt;\n\n&lt;!-- Put site-specific property overrides in this file. --&gt;\n\n&lt;configuration&gt;\n&lt;property&gt;\n    &lt;name&gt;fs.defaultFS&lt;/name&gt;\n    &lt;value&gt;hdfs://xuwangwei&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;hadoop.tmp.dir&lt;/name&gt;\n    &lt;value&gt;/var/lib/hadoop&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;hadoop.zk.address&lt;/name&gt;\n    &lt;value&gt;machine1.xuwangwei.test:2181,machine2.xuwangwei.test:2181,machine3.xuwangwei.test:2181,machine4.xuwangwei.test:2181,machine5.xuwangwei.test:2181&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;ha.zookeeper.quorum&lt;/name&gt;\n    &lt;value&gt;machine1.xuwangwei.test:2181,machine2.xuwangwei.test:2181,machine3.xuwangwei.test:2181,machine4.xuwangwei.test:2181,machine5.xuwangwei.test:2181&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;hadoop.security.authentication&lt;/name&gt;\n    &lt;value&gt;kerberos&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;hadoop.proxyuser.hive.hosts&lt;/name&gt;\n    &lt;value&gt;*&lt;/value&gt;\n&lt;/property&gt;\n&lt;property&gt;\n    &lt;name&gt;hadoop.proxyuser.hive.groups&lt;/name&gt;\n    &lt;value&gt;*&lt;/value&gt;\n&lt;/property&gt;\n&lt;/configuration&gt;\n</code></pre> </li> <li> <p>\u4f7f\u7528 hdfs@XUWANGWEI.TEST \u5e10\u53f7\u8fdb\u884c Kerberos \u8ba4\u8bc1</p> <pre><code>su - hdfs -c \"kinit -kt /etc/hadoop/hdfs.keytab hdfs\"\n</code></pre> </li> <li> <p>\u5728 HDFS \u4e0a\u521b\u5efa\u76ee\u5f55</p> <pre><code>su - hdfs -c 'hadoop fs -mkdir -p /user/hive/warehouse'\nsu - hdfs -c 'hadoop fs -chown -R hive:hadoop /user/hive'\nsu - hdfs -c 'hadoop fs -chmod 755 /user/hive'\nsu - hdfs -c 'hadoop fs -chmod 775 /user/hive/warehouse'\n</code></pre> </li> <li> <p>\u521d\u59cb\u5316 MetaStore \u4f7f\u7528\u7684\u6570\u636e\u5e93</p> <pre><code>su - hive -c 'schematool -dbType mysql -initSchema'\n</code></pre> </li> <li> <p>\u4f7f core-silte \u4e2d\u521a\u4fee\u6539\u7684\u914d\u7f6e\u751f\u6548</p> <pre><code>su - hdfs -c \"hdfs dfsadmin -refreshSuperUserGroupsConfiguration\"\necho 'export KRB5CCNAME=FILE:/tmp/krb5cc_$UID' &gt;&gt; ~yarn/.bashrc\nsu - yarn -c \"kinit -kt /etc/hadoop/yarn.keytab yarn\"\nsu - yarn -c \"yarn rmadmin -refreshSuperUserGroupsConfiguration\"\n</code></pre> </li> </ol>"},{"location":"blog/2024/01/03/%E5%AE%89%E8%A3%85-hive-%E9%9B%86%E7%BE%A4rocky-linux-92/#hive_3","title":"\u542f\u52a8 Hive","text":"<ol> <li> <p>\u542f\u52a8 MetaStore</p> <pre><code>su - hive -c \"ssh machine4 'nohup hive --service metastore 1&gt;/dev/null 2&gt;&amp;1 &amp;'\"\nsu - hive -c \"ssh machine5 'nohup hive --service metastore 1&gt;/dev/null 2&gt;&amp;1 &amp;'\"\n</code></pre> </li> <li> <p>\u542f\u52a8 HiveServer2</p> <pre><code>su - hive -c \"ssh machine4 'nohup hive --service hiveserver2 1&gt;/dev/null 2&gt;&amp;1 &amp;'\"\nsu - hive -c \"ssh machine5 'nohup hive --service hiveserver2 1&gt;/dev/null 2&gt;&amp;1 &amp;'\"\n</code></pre> </li> </ol>"},{"location":"blog/2024/01/03/%E5%AE%89%E8%A3%85-hive-%E9%9B%86%E7%BE%A4rocky-linux-92/#beeline-hive","title":"\u4f7f\u7528 Beeline \u8fde\u63a5 Hive \u670d\u52a1","text":"<ol> <li> <p>\u6dfb\u52a0 hive \u7528\u6237\u7684\u73af\u5883\u53d8\u91cf</p> <pre><code>echo 'export KRB5CCNAME=FILE:/tmp/krb5cc_$UID' &gt;&gt; ~hive/.bashrc\n</code></pre> </li> <li> <p>\u4f7f\u7528 hive@XUWANGWEI.TEST \u5e10\u53f7\u8fdb\u884c Kerberos \u8ba4\u8bc1</p> <pre><code>su - hive -c \"kinit -kt /etc/hive/hive.keytab hive\"\n</code></pre> </li> <li> <p>\u4f7f\u7528 Beeline \u8fde\u63a5 Hive \u96c6\u7fa4</p> <pre><code>su - hive -c \"beeline\"\nbeeline&gt; !connect jdbc:hive2://machine1.xuwangwei.test:2181,machine2.xuwangwei.test:2181,machine3.xuwangwei.test:2181,machine4.xuwangwei.test:2181,machine5.xuwangwei.test:2181/;serviceDiscoveryMode=zooKeeper;zooKeeperNamespace=hiveserver2;saslQop=auth-conf;auth=KERBEROS;principal=hive/_HOST@XUWANGWEI.TEST;\n</code></pre> </li> <li> <p>\u8fde\u63a5\u6210\u529f\uff0c\u65e5\u5fd7\u5982\u4e0b\u6240\u793a</p> <pre><code>Connecting to jdbc:hive2://machine1.xuwangwei.test:2181,machine2.xuwangwei.test:2181,machine3.xuwangwei.test:2181,machine4.xuwangwei.test:2181,machine5.xuwangwei.test:2181/;serviceDiscoveryMode=zooKeeper;zooKeeperNamespace=hiveserver2;saslQop=auth-conf;auth=KERBEROS;principal=hive/_HOST@XUWANGWEI.TEST;\n24/01/03 15:12:56 [main]: INFO jdbc.HiveConnection: Connected to machine4.xuwangwei.test:10000\nConnected to: Apache Hive (version 3.1.3)\nDriver: Hive JDBC (version 3.1.3)\nTransaction isolation: TRANSACTION_REPEATABLE_READ\n</code></pre> </li> </ol>"},{"location":"blog/2024/01/22/%E6%88%91%E9%98%85%E8%AF%BB%E7%9A%84%E7%AC%AC%E4%B8%80%E6%9C%AC%E8%8B%B1%E8%AF%AD%E4%B9%A6kerberos-the-definitive-guide/","title":"\u6211\u9605\u8bfb\u7684\u7b2c\u4e00\u672c\u82f1\u8bed\u4e66\u300aKerberos: The Definitive Guide\u300b","text":"<p>\u6211\u524d\u9635\u5b50\u5728\u5de5\u4f5c\u4e2d\u603b\u662f\u9047\u5230\u5173\u4e8e Kerberos \u534f\u8bae\u7684\u95ee\u9898\uff0c\u65e0\u8bba\u662f\u5728\u516c\u53f8\u540c\u4e8b\u642d\u5efa\u7684\u73af\u5883\u4e2d\u8fd8\u662f\u5ba2\u6237\u7684\u73af\u5883\u4e2d\u90fd\u4f1a\u9047\u5230\u3002\u6bcf\u5f53\u6211\u9047\u5230\u8fd9\u79cd\u95ee\u9898\u5c31\u5934\u75bc\uff0c\u56e0\u4e3a\u6211\u5728\u7f51\u4e0a\u641c\u7d22\u8fc7\u76f8\u5173\u7684\u95ee\u9898\uff0c\u627e\u6765\u627e\u53bb\u90fd\u627e\u4e0d\u5230\u60f3\u8981\u7684\u7b54\u6848\u3002\u8fd8\u597d\u6211\u8fd0\u6c14\u6bd4\u8f83\u597d\uff0c\u603b\u662f\u5728\u5c1d\u8bd5\u591a\u4e2a\u65b9\u6848\u540e\u5c31\u89e3\u51b3\u4e86\u95ee\u9898\u3002</p> <p>\u5f53\u7136\uff0c\u6211\u4e0d\u786e\u5b9a\u95ee\u9898\u6709\u88ab\u89e3\u51b3\uff0c\u53ef\u80fd\u53ea\u662f\u89c4\u907f\u4e86\uff0c\u56e0\u4e3a\u6211\u5b8c\u5168\u4e0d\u61c2\uff0c\u53ea\u662f\u6309\u7167\u7f51\u4e0a\u7684\u8bf4\u6cd5\u7a00\u91cc\u7cca\u6d82\u5730\u6539\u6765\u6539\u53bb\u3002\u6211\u5fc3\u60f3\uff0c\u8fd9\u4e48\u4e0b\u53bb\u53ef\u4e0d\u884c\uff0c\u4e8e\u662f\u5728 google \u4e0a\u641c\u7d22\u5bf9\u4e8e\u8fd9\u4e2a\u534f\u8bae\u7684\u89e3\u91ca\u3002\u4e4b\u524d\u5462\uff0c\u6211\u662f\u641c\u7d22\u89e3\u51b3\u95ee\u9898\u7684\u65b9\u6848\uff0c\u8fd9\u6b21\u6362\u6210\u4e86\u60f3\u8981\u7406\u89e3\u8fd9\u4e2a\u534f\u8bae\u3002</p> <p>\u7f51\u4e0a\u5173\u4e8e\u8fd9\u4e2a\u534f\u8bae\u7684\u89e3\u91ca\u5927\u90fd\u5dee\u4e0d\u591a\uff0c\u6211\u770b\u4e86\u51e0\u7bc7\u770b\u5f97\u4e91\u91cc\u96fe\u91cc\uff0c\u53c8\u627e\u4e86\u51e0\u7bc7\u82f1\u6587\u7684\uff0c\u7ed3\u679c\u4e00\u6837\u3002</p> <p>\u7f51\u7edc\u4e0a\u627e\u4e0d\u5230\u6ee1\u610f\u7684\uff0c\u6211\u5c31\u53bb\u7ffb\u4e66\uff0c\u6211\u5206\u522b\u5728\u8c22\u5e0c\u4ec1\u6240\u8457\u7684\u300a\u8ba1\u7b97\u673a\u7f51\u7edc\u300b\u548c\u6797\u6c9b\u6ee1\u6240\u8457\u7684\u300aWireshark \u7f51\u7edc\u5206\u6790\u5c31\u8fd9\u4e48\u7b80\u5355\u300b\u4e2d\u627e\u5230\u4e86\u5173\u4e8e Kerberos \u534f\u8bae\u7684\u5185\u5bb9\u3002\u8fd9\u4e24\u672c\u4e66\u6211\u66fe\u7ecf\u90fd\u9605\u8bfb\u8fc7\uff0c\u4f46\u6211\u5f53\u65f6\u5e94\u8be5\u6ca1\u770b\u61c2\u8fd9\u4e24\u672c\u4e66\u4e2d\u5173\u4e8e Kerberos \u534f\u8bae\u7684\u90e8\u5206\u3002\u300a\u8ba1\u7b97\u673a\u7f51\u7edc\u300b\u4e00\u4e66\u4ecb\u7ecd\u7684\u662f\u7b2c\u56db\u7248\u7684 Kerberos \u534f\u8bae\uff0c\u4e3b\u8981\u5185\u5bb9\u662f\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u7684\u4e00\u4e2a\u4ea4\u4e92\u6d41\u7a0b\u3002\u300aWireshark \u7f51\u7edc\u5206\u6790\u5c31\u8fd9\u4e48\u7b80\u5355\u300b\u628a\u8fd9\u4e2a\u4ea4\u4e92\u6d41\u7a0b\u5177\u50cf\u5316\u4e86\uff0c\u56e0\u4e3a\u5b83\u901a\u8fc7\u6293\u5305\u5de5\u5177 Wireshark \u76f4\u63a5\u628a\u4ea4\u4e92\u8fc7\u7a0b\u5c55\u793a\u4e86\u51fa\u6765\u3002\u4e24\u672c\u4e66\u4e92\u4e3a\u8865\u5145\uff0c\u6211\u770b\u5b8c\u540e\u5fc3\u60f3\uff0c\u8fd9\u4e0b\u4e0d\u6015\u9047\u5230\u95ee\u9898\u4e86\u3002</p> <p>\u540e\u6765\uff0c\u53ea\u8981\u6211\u9047\u5230 Kerberos \u8ba4\u8bc1\u4e0d\u6210\u529f\uff0c\u6211\u5c31\u4f1a\u7528 tcpdump \u6293\u5305\u7136\u540e\u7528 Wireshark \u5206\u6790\u7f51\u7edc\u5305\uff0c\u8fd9\u65b9\u6cd5\u771f\u662f\u4e00\u62db\u9c9c\u5403\u904d\u5929\u3002\u6b63\u5982\u6797\u6c9b\u6ee1\u8001\u5e08\u6240\u8bf4\uff0c</p> <p>Life is tough, Wireshark makes it easy. </p> <p>\u6211\u5bf9 Kerberos \u534f\u8bae\u7684\u597d\u5947\u4fc3\u4f7f\u6211\u7ee7\u7eed\u5728\u7f51\u4e0a\u641c\u7d22\u5b83\u7684\u8d44\u6599\uff08\u641c\u4e86\uff0c\u4f46\u4e0d\u770b\ud83d\ude01\uff09\uff0c\u7136\u540e\u5c31\u770b\u5230\u4e86\u6807\u9898\u63d0\u5230\u7684\u4e66\u300aKerberos: The Definitive Guide\u300b\u3002  \u8fd9\u672c\u4e66\u662f\u4e00\u672c\u5b8c\u5168\u5173\u4e8e Kerberos \u534f\u8bae\u7684\u4e66\u7c4d\uff0c200 \u591a\u9875\u7684\u5185\u5bb9\u3002\u6211\u7ec8\u4e8e\u660e\u767d\u7f51\u4e0a\u4e3a\u4ec0\u4e48\u6ca1\u6709\u8d44\u6599\u8bb2\u597d\u8fd9\u4e2a\u534f\u8bae\u4e86\uff0c\u56e0\u4e3a\u8981\u628a\u4e00\u4e2a\u7528 200 \u591a\u9875\u8bb2\u8ff0\u7684\u5185\u5bb9\u6d53\u7f29\u6210\u7f51\u7edc\u4e0a\u7684\u51e0\u767e\u81f3\u51e0\u5343\u5b57\u8fd8\u8981\u8bb2\u660e\u767d\uff0c\u5b9e\u5728\u662f\u56f0\u96be\u3002</p> <p>\u6211\u5df2\u4e0d\u8bb0\u5f97\u5f53\u65f6\u6211\u662f\u600e\u4e48\u60f3\u7684\uff0c\u56e0\u4e3a\u6211\u4ece\u6765\u6ca1\u6709\u9605\u8bfb\u8fc7\u82f1\u8bed\u4e66\uff0c\u5b66\u751f\u65f6\u4ee3\u7684\u82f1\u8bed\u8bfe\u672c\u9664\u5916\u3002\u8fd9\u4e48\u4e00\u672c 200 \u591a\u9875\u7684\u82f1\u8bed\u6280\u672f\u4e66\uff0c\u6211\u5c45\u7136\u4e0b\u5355\u4e86\u3002\u597d\u5728\u6211\u4e70\u56de\u6765\u540e\u6ca1\u6709\u6254\u4e00\u8fb9\uff0c\u800c\u662f\u5b8c\u6574\u5730\u9605\u8bfb\u4e86\u3002</p> <p>\u5982\u679c\u4f60\u5728\u5de5\u4f5c\u4e2d\u9047\u5230\u4e86 Kerberos \u534f\u8bae\u7684\u95ee\u9898\uff0c\u4e0d\u59a8\u4e70\u4e00\u672c\u300aKerberos: The Definitive Guide\u300b\uff0c\u72d7\u4e1c\u6709\u552e\uff0c\u5c31\u662f\u8981\u7b49 1 \u4e2a\u6708\u624d\u4f1a\u9001\u5230\u624b\u91cc\uff0c\u56e0\u4e3a\u662f\u4ece\u7f8e\u56fd\u53d1\u8d27\u7684\u3002\u9605\u8bfb\u5b8c\u8fd9\u672c\u4e66\uff0c\u76f8\u4fe1\u4f60\u5728\u9047\u5230\u5173\u4e8e Kerberos \u534f\u8bae\u7684\u95ee\u9898\u65f6\u4f1a\u66f4\u52a0\u4ece\u5bb9\u3002\u9605\u8bfb\u8fd9\u672c\u4e66\u8fd8\u7ed9\u6211\u5e26\u6765\u4e86\u989d\u5916\u7684\u6536\u83b7\uff0c\u90a3\u5c31\u662f\u4e0d\u518d\u5bb3\u6015\u9605\u8bfb\u82f1\u8bed\u4e66\u3002\u6211\u60f3\u5927\u90e8\u5206\u4e2d\u56fd\u4eba\u548c\u6211\u4e00\u6837\u90fd\u4f1a\u5bb3\u6015\u9605\u8bfb\u82f1\u8bed\u4e66\uff0c\u8868\u73b0\u4e4b\u4e00\u5c31\u662f\u6297\u62d2\u9605\u8bfb\u7eaf\u82f1\u8bed\u7684\u8d44\u6599\uff0c\u8bfb\u5b8c\u4e00\u672c\u540e\u5c31\u4f1a\u89c9\u5f97\u6ca1\u4ec0\u4e48\u3002\u5982\u679c\u4f60\u60f3\u63d0\u9ad8\u82f1\u8bed\u9605\u8bfb\u80fd\u529b\uff0c\u76f4\u63a5\u627e\u672c\u4e66\u770b\uff0c\u8fd9\u662f\u6700\u5feb\u7684\u65b9\u6cd5\u3002</p>"},{"location":"blog/2023/10/07/%E7%AE%80%E5%8D%95%E4%B8%94%E5%85%8D%E8%B4%B9%E7%9A%84%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%E6%96%B9%E6%A1%88tailscale/","title":"\u7b80\u5355\u4e14\u514d\u8d39\u7684\u5185\u7f51\u7a7f\u900f\u65b9\u6848\u2014\u2014Tailscale","text":"<p>\u5982\u679c\u4f60\u6709\u5728\u5916\u5730\u8bbf\u95ee\u5bb6\u4e2d\u7535\u5b50\u8bbe\u5907\u7684\u9700\u6c42\uff0c\u6bd4\u5982\u4f60\u5728\u516c\u53f8\u529e\u516c\uff0c\u9700\u8981\u8bbf\u95ee\u5bb6\u91cc\u7684\u7535\u8111\u3001\u6253\u5370\u673a\u3001\u8def\u7531\u5668\u3001\u865a\u62df\u673a\u7b49\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u5185\u7f51\u7a7f\u900f\u3002</p> <p>\u7f51\u4e0a\u6709\u5173\u4e8e\u5185\u7f51\u7a7f\u900f\u7684\u6559\u7a0b\uff0c\u6bd4\u5982\u6559\u4f60\u914d\u7f6e\u8def\u7531\u5668\uff0c\u8fd9\u79cd\u65b9\u6848\u9700\u8981\u4f60\u7684\u8def\u7531\u5668\u62e8\u53f7\u4e0a\u7f51\u80fd\u83b7\u53d6\u5230\u52a8\u6001\u516c\u7f51 IP \u5730\u5740\u3001\u8bbe\u7f6e DDNS\u3001\u8bbe\u7f6e\u7aef\u53e3\u8f6c\u53d1\uff0c\u4e00\u4e2a\u8bcd\u9ebb\u70e6\u3002\u8fd8\u6709\u6559\u4f60\u4e70\u8bbe\u5907\u5b9e\u73b0\u7684\uff0c\u4e00\u4e2a\u8bcd\u8d35\u3002</p> <p>\u6211\u6559\u4f60\u4e00\u4e2a\u53ea\u8981 3 \u6b65\u5c31\u80fd\u5b9e\u73b0\u9ad8\u5e26\u5bbd\u3001\u4f4e\u5ef6\u8fdf\u7684\u5185\u7f51\u7a7f\u900f\u65b9\u6848\uff0c\u4e0d\u7528\u78b0\u8def\u7531\u5668\u3001\u4e0d\u7528\u82b1\u94b1\u3002</p> <p>\u4f18\u70b9\uff1a - [x] \u514d\u8d39 - [x] \u652f\u6301\u5b89\u88c5\u5728 macOS\u3001Windows\u3001iOS\u3001\u5b89\u5353\u3001Linux \u4e0a - [x] \u652f\u6301 100 \u53f0\u8bbe\u5907\uff0c\u5982\u679c\u4f60\u6709\u8d85\u8fc7 100 \u53f0\u8bbe\u5907\u7684\u573a\u666f\uff0c\u90a3\u4e48\u53ef\u4ee5\u82b1\u94b1\u5f00\u4f1a\u5458 - [x] \u652f\u6301\u5171\u4eab\u5b50\u7f51\uff0c100 \u53f0\u8bbe\u5907\u53ef\u4ee5\u5171\u4eab\u51fa 100 \u4e2a\u5b50\u7f51\uff0c\u6bcf\u4e2a\u5b50\u7f51\u91cc\u6ca1\u6709\u8bbe\u5907\u7684\u9650\u5236\uff0c\u76f8\u5f53\u4e8e\u4f60\u53ef\u4ee5\u6709 \uff08100 X \u5b50\u7f51\u8bbe\u5907\u6570\uff09\u53f0\u8bbe\u5907</p>"},{"location":"blog/2023/10/07/%E7%AE%80%E5%8D%95%E4%B8%94%E5%85%8D%E8%B4%B9%E7%9A%84%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%E6%96%B9%E6%A1%88tailscale/#_1","title":"\u6b65\u9aa4\u4e00\uff1a\u6ce8\u518c","text":"<p>\u4f7f\u7528\u6d4f\u89c8\u5668\u6253\u5f00https://tailscale.com/\uff0c\u70b9\u51fb\u53f3\u4e0a\u89d2 Try for free\uff0c\u5176\u5b9e\u5c31\u662f\u6ce8\u518c\u8d26\u53f7\u3002  \u5f53\u524d Tailscale \u652f\u6301\u4ee5\u4e0b\u51e0\u79cd\u65b9\u5f0f\u6ce8\u518c\u8d26\u53f7\u3002\u6211\u5efa\u8bae\u4f60\u4f7f\u7528\u5fae\u8f6f\u8d26\u53f7\uff0c\u5982\u679c\u4f60\u7f51\u7edc\u6ca1\u6709\u95ee\u9898\uff0c\u4e5f\u53ef\u4ee5\u7528\u8c37\u6b4c\u8d26\u53f7\u3002 </p>"},{"location":"blog/2023/10/07/%E7%AE%80%E5%8D%95%E4%B8%94%E5%85%8D%E8%B4%B9%E7%9A%84%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%E6%96%B9%E6%A1%88tailscale/#_2","title":"\u6b65\u9aa4\u4e8c\uff1a\u4e0b\u8f7d","text":"<p>\u6ce8\u518c\u5b8c\u6210\u540e\u4f1a\u6709\u4e0b\u8f7d\u5730\u5740\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u6253\u5f00https://tailscale.com/download/\u4e0b\u8f7d\u3002</p> <p>\u6ce8\u610f\u26a0\ufe0f\uff1a\u82f9\u679c\u8bbe\u5907\u9700\u8981\u4f7f\u7528\u56fd\u5916 Apple ID \u8d26\u53f7\u767b\u5f55\u82f9\u679c\u5e94\u7528\u5546\u5e97\u624d\u53ef\u4ee5\u4e0b\u8f7d\u3002</p> <p></p>"},{"location":"blog/2023/10/07/%E7%AE%80%E5%8D%95%E4%B8%94%E5%85%8D%E8%B4%B9%E7%9A%84%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%E6%96%B9%E6%A1%88tailscale/#_3","title":"\u6b65\u9aa4\u4e09\uff1a\u5b89\u88c5","text":"<p>\u5b89\u88c5\u5b8c\u6210\u540e\u4f7f\u7528\u7b2c\u4e00\u6b65\u6ce8\u518c\u7684\u8d26\u53f7\u767b\u5f55\u5373\u53ef\u3002\u4f60\u5982\u679c\u8981\u4ece\u516c\u53f8\u7684\u7535\u8111\u8bbf\u95ee\u5bb6\u91cc\u7684\u7535\u8111\uff0c\u90a3\u4e48\u4f60\u8981\u5728\u8fd9 2 \u53f0\u7535\u8111\u4e0a\u5b89\u88c5 Tailscale\u3002</p>"},{"location":"blog/2023/10/07/%E7%AE%80%E5%8D%95%E4%B8%94%E5%85%8D%E8%B4%B9%E7%9A%84%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%E6%96%B9%E6%A1%88tailscale/#_4","title":"\u5b9e\u9645\u4f7f\u7528","text":"<p> \u767b\u5f55\u540e\u8f6f\u4ef6\u5c31\u957f\u8fd9\u6837\u3002\u6211\u4eec\u5f53\u524d\u9700\u8981\u5173\u6ce8\u7684\u5c31\u662f Network Devices\uff0c\u6bd4\u5982\u6211\u73b0\u5728\u60f3\u4ece\u516c\u53f8\u7684\u7535\u8111\u8bbf\u95ee\u5bb6\u91cc\u7684\u7535\u8111\uff0c\u90a3\u4e48\u53ef\u4ee5\u70b9\u51fb Network Devices \u770b\u5230\u6709\u4e00\u53f0\u540d\u5b57\u53eb intel-nuc \u7684\u8bbe\u5907\uff0c\u5355\u51fb\u8bbe\u5907\u540d\u5c31\u53ef\u4ee5\u83b7\u5f97\u8fd9\u53f0\u8bbe\u5907\u7684 IP \u5730\u5740\uff08\u975e\u516c\u7f51\u5730\u5740\uff09\u3002  \u4e0b\u9762\u6211\u5206\u522b\u7528 ping \u547d\u4ee4\u6d4b\u8bd5\u5230 intel-nuc \u8fd9\u53f0\u8bbe\u5907\u7684\u5ef6\u8fdf\u548c\u5230 www.baidu.com \u7684\u5ef6\u8fdf\u3002\u53ef\u4ee5\u4ece\u4e0b\u65b9\u56fe\u7247\u7684\u5de6\u534a\u90e8\u5206\u770b\u51fa\u516c\u53f8\u7535\u8111\u5230\u5bb6\u91cc intel-nuc \u7684\u5e73\u5747\u5ef6\u8fdf\u5728 24 \u6beb\u79d2\uff0c\u53f3\u534a\u90e8\u5206\u663e\u793a\u516c\u53f8\u7535\u8111\u5230 www.baidu.com \u7684\u5e73\u5747\u5ef6\u8fdf\u5728 17 \u6beb\u79d2\uff0c\u4e24\u8005\u5dee\u522b\u4e0d\u5927\u300224\u6beb\u7c73\u7684\u5ef6\u8fdf\u53ef\u4ee5\u8bf4\u5f88\u4f4e\u4e86\u3002 </p>"},{"location":"blog/2023/10/07/%E7%AE%80%E5%8D%95%E4%B8%94%E5%85%8D%E8%B4%B9%E7%9A%84%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%E6%96%B9%E6%A1%88tailscale/#_5","title":"\u5171\u4eab\u5b50\u7f51","text":"<p>Tailscale \u8fd8\u6709\u4e00\u4e2a\u7279\u522b\u65b9\u4fbf\u7684\u529f\u80fd\uff0c\u5c31\u662f\u53ea\u8981\u5bb6\u4e2d\u7684\u4e00\u53f0\u8bbe\u5907\u5b89\u88c5\u4e86 Tailscale\uff0c\u5c31\u53ef\u4ee5\u628a\u5bb6\u4e2d\u6574\u4e2a\u7f51\u7edc\u5171\u4eab\u51fa\u53bb\uff0c\u76f8\u5f53\u4e8e\u5bb6\u4e2d\u6240\u6709\u8bbe\u5907\u90fd\u5b89\u88c5\u4e86 Tailscale\u3002 \u901a\u8fc7\u70b9\u51fb\u5934\u50cf-&gt;Admin Console \u8fdb\u5165\u7ba1\u7406\u9875\u9762\u3002  \u5728\u7ba1\u7406\u9875\u9762\u7684\u8bbe\u5907\u5217\u8868\u4e2d\u627e\u5230 intel-nuc\uff0c\u70b9\u51fb Machine settings-&gt;Edit route settings\u3002  \u6211\u5bb6\u4e2d\u7684\u5b50\u7f51\u662f 192.168.2.0/24\uff0c\u6240\u4ee5\u4e0b\u56fe\u663e\u793a\u6211\u5171\u4eab\u4e86 192.168.2.0/24\u3002  \u4e0b\u9762\u4e24\u5f20\u56fe\u7247\u662f\u6211\u5206\u522b\u7528 ping \u547d\u4ee4\u548c scp \u547d\u4ee4\u4e0e\u5bb6\u4e2d\u6ca1\u6709\u5b89\u88c5 Tailscale \u8f6f\u4ef6\u7684\u673a\u5668\u8fdb\u884c\u901a\u4fe1\u7684\u7ed3\u679c\u3002\u8fd9\u53f0\u8bbe\u5907\u5728\u6211\u5bb6\u4e2d\u7684 IP \u5730\u5740\u662f 192.168.2.60\uff0c\u88c5\u6709 Rocky Linux 9.2 \u64cd\u4f5c\u7cfb\u7edf\u3002\u53ef\u4ee5\u770b\u5230\u5ef6\u8fdf\u5728 41 \u6beb\u79d2\uff0c\u5e26\u5bbd\u5927\u7ea6 6.8 \u5146\u5b57\u8282/\u79d2\u3002  </p>"},{"location":"blog/2023/10/07/%E7%AE%80%E5%8D%95%E4%B8%94%E5%85%8D%E8%B4%B9%E7%9A%84%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%E6%96%B9%E6%A1%88tailscale/#_6","title":"\u5199\u5728\u6700\u540e","text":"<p>Tailscale \u4f5c\u4e3a\u4e00\u6b3e\u514d\u8d39\u8f6f\u4ef6\uff0c\u63d0\u4f9b\u4e86\u4f4e\u5ef6\u8fdf\u548c\u6bd4\u8f83\u9ad8\u7684\u5e26\u5bbd\uff0c\u5e76\u4e14\u9664\u4e86\u5171\u4eab\u5b50\u7f51\u529f\u80fd\u8fd8\u6709\u5176\u4ed6\u4fbf\u5229\u7684\u529f\u80fd\u3002\u4f60\u53ef\u4ee5\u901a\u8fc7\u5b83\u548c\u8fdc\u7a0b\u684c\u9762\u8f6f\u4ef6\u64cd\u4f5c\u5bb6\u4e2d\u7684 Windows \u6216 Mac \u7535\u8111\uff0c\u4e5f\u53ef\u4ee5\u7ed3\u5408 ssh \u5ba2\u6237\u7aef\u8fdc\u7a0b\u767b\u5f55\u5bb6\u4e2d\u7684 Linux \u865a\u62df\u673a\u3002</p>"},{"location":"blog/2025/01/04/%E9%80%9A%E8%BF%87-ansible-%E7%BB%99%E6%96%B0-macbook-%E5%BC%80%E5%85%89/","title":"\u901a\u8fc7 Ansible \u7ed9\u65b0 Macbook \u5f00\u5149","text":"<p>Abstract</p> <p>\u8bf4\u662f\u5f00\u5149\uff0c\u5b9e\u9645\u5c31\u662f\u7ed9\u65b0\u7535\u8111\u5b89\u88c5\u5404\u79cd\u547d\u4ee4\u884c\u5de5\u5177\u548c\u8f6f\u4ef6\uff0c\u4f46\u53c8\u4e0d\u60f3\u4e00\u4e2a\u4e00\u4e2a\u4e0b\u8f7d\u5b89\u88c5\uff0c\u6240\u4ee5\u5c31\u901a\u8fc7 Ansible \u4e00\u952e\u5b89\u88c5\u6240\u6709\u7684\u8f6f\u4ef6\u3002 \u5f00\u5149\u4e00\u8bcd\u662f\u6211\u4ece\u7f51\u4e0a\u5b66\u6765\u7684\uff0c\u5fd8\u4e86\u662f\u54ea\u4e2a\u4eba\u7b2c\u4e00\u4e2a\u63d0\u51fa\u3002 \u901a\u8fc7 Ansible \u7ed9 Mac \u5b89\u88c5\u8f6f\u4ef6\u662f\u4ece\u300aAnsible for DevOps\u300b\u4e66\u91cc\u5b66\u6765\u7684\u3002</p>","tags":["macOS","Ansible","Tart","Homebrew"]},{"location":"blog/2025/01/04/%E9%80%9A%E8%BF%87-ansible-%E7%BB%99%E6%96%B0-macbook-%E5%BC%80%E5%85%89/#_1","title":"\u5f00\u5149","text":"<ol> <li> <p>\u5b89\u88c5 Homebrew</p> <pre><code>/bin/bash -c \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)\"\n</code></pre> </li> <li> <p>\u5b89\u88c5 Ansible</p> <pre><code>brew install ansible\n</code></pre> </li> <li> <p>\u521b\u5efa\u5de5\u4f5c\u76ee\u5f55 <code>~/dev/repo/setup-mac-by-ansible</code></p> <p>\u6309\u4f60\u7684\u547d\u540d\u76ee\u5f55\u7684\u4e60\u60ef\u521b\u5efa\u5de5\u4f5c\u76ee\u5f55\u5373\u53ef\uff0c\u2191\u8fd9\u662f\u6211\u7684\u4e60\u60ef\u3002</p> <pre><code>mkdir -p ~/dev/repo/setup-mac-by-ansible &amp;&amp; cd ~/dev/repo/setup-mac-by-ansible\n</code></pre> </li> <li> <p>\u521b\u5efa playbook<sup>1</sup></p> <p>\u6211\u5728\u8fd9\u91cc\u4f7f\u7528 vim \u521b\u5efa\u5e76\u7f16\u8f91\u540d\u4e3a <code>setup-macos.yml</code> \u7684 playbook\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u7684\u6587\u672c\u7f16\u8f91\u5668\u3002</p> <pre><code>vim setup-macos.yml\n</code></pre> setup-macos.yml<pre><code>---\n- hosts: localhost\n  connection: local\n  tasks:\n    - name: Install Homebrew Formulae (CLI tools and utilities)\n      community.general.homebrew:\n        name:\n          - hugo\n          - mas\n          - telnet\n          - wget\n          - zsh-autocomplete\n          - zsh-syntax-highlighting\n        state: present\n\n    - name: Install Homebrew Casks (GUI apps)\n      community.general.homebrew_cask:\n        name:\n          - adobe-acrobat-reader\n          - aldente\n          - appcleaner\n          - beyond-compare\n          - forklift\n          - google-chrome\n          - handbrake\n          - imageoptim\n          - jetbrains-toolbox\n          - keka\n          - mqttx\n          - one-switch\n          - popclip\n          - shottr\n          - tableplus\n          - tailscale\n          - vagrant\n          - vagrant-vmware-utility\n          - visual-studio-code\n          - vmware-fusion\n          - wireshark\n        state: present\n\n    - name: Install Mac App Store Applications\n      community.general.mas:\n        id:\n          - 1355679052 # Dropover - Easier Drag &amp; Drop\n          - 1552536109 # PasteNow\n          - 1443749478 # WPS\n          - 441258766 # Magnet\n          - 836500024 # WeChat\n          - 1327661892 # Xmind\n          - 1295203466 # Windows App\n          - 425424353 # The Unarchiver\n          - 524141863 # Jump Desktop\n          - 1518036000 # Sequel Ace\n        state: present\n\n    - name: Configure zsh-syntax-highlighting in .zshrc\n      ansible.builtin.blockinfile:\n        path: ~/.zshrc\n        create: true\n        append_newline: true\n        prepend_newline: true\n        insertafter: EOF\n        marker: \"# {mark} ZSH-SYNTAX-HIGHLIGHTING\"\n        block: |\n          if [ -f $HOMEBREW_PREFIX/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh ]; then\n            source $HOMEBREW_PREFIX/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh\n          fi\n\n    - name: Configure zsh-autocomplete in .zshrc\n      ansible.builtin.blockinfile:\n        path: ~/.zshrc\n        create: true\n        append_newline: true\n        prepend_newline: true\n        insertbefore: BOF\n        marker: \"# {mark} ZSH-AUTOCOMPLETE\"\n        block: |\n          if [ -f $HOMEBREW_PREFIX/share/zsh-autocomplete/zsh-autocomplete.plugin.zsh ]; then\n            source $HOMEBREW_PREFIX/share/zsh-autocomplete/zsh-autocomplete.plugin.zsh\n          fi\n\n    - name: Add gi() function to .zshrc for generating gitignore files\n      ansible.builtin.lineinfile:\n        path: ~/.zshrc\n        create: true\n        line: function gi() { curl -sLw \"\\n\" https://www.toptal.com/developers/gitignore/api/$@ ;}\n\n    - name: Generate global gitignore file using gi() function\n      ansible.builtin.shell:\n        cmd: source ~/.zshrc &amp;&amp; gi macos,jetbrains,visualstudiocode &gt;&gt; ~/.gitignore_global &amp;&amp; git config --global core.excludesfile ~/.gitignore_global\n        creates: ~/.gitignore_global\n\n    - name: Install Vagrant VMware Desktop plugin\n      ansible.builtin.shell:\n        cmd: vagrant plugin install vagrant-vmware-desktop\n</code></pre> </li> <li> <p>\u4e00\u952e\u5b89\u88c5</p> <pre><code>ansible-playbook setup-macos.yml -v\n</code></pre> </li> </ol> <p>Tip</p> <p>\u811a\u672c\u5199\u5b8c\u540e\uff0c\u6700\u597d\u5148\u6d4b\u8bd5\u4e0b\uff0c\u786e\u5b9a\u6ca1\u95ee\u9898\u540e\uff0c\u518d\u5728\u65b0\u7535\u8111\u4e0a\u6267\u884c\u3002</p> <p>\u6211\u662f\u7528\u865a\u62df\u673a+\u8001 Mac \u6d4b\u8bd5\u7684\uff0c\u56e0\u4e3a\u865a\u62df\u673a\u6ca1\u6cd5\u6d4b\u8bd5<code>Install Mac App Store Applications</code>\u8fd9\u4e2a task\uff0c\u8fd9\u4e2a task \u662f\u5b89\u88c5 Mac App Store \u4e2d\u7684\u5e94\u7528\uff0c\u5fc5\u987b\u8981\u767b\u5f55\u82f9\u679c\u8d26\u53f7\uff0c\u800c\u865a\u62df\u673a\u4e0d\u652f\u6301\uff0c\u6240\u4ee5\u8fd9\u4e2a task \u5355\u72ec\u5728\u8001 Mac \u4e0a\u8dd1\u7684\u3002\u5982\u679c\u4f60\u6709\u66f4\u597d\u7684\u6d4b\u8bd5\u65b9\u6cd5\uff0c\u522b\u5fd8\u4e86\u544a\u8bc9\u6211\u3002</p>","tags":["macOS","Ansible","Tart","Homebrew"]},{"location":"blog/2025/01/04/%E9%80%9A%E8%BF%87-ansible-%E7%BB%99%E6%96%B0-macbook-%E5%BC%80%E5%85%89/#macos","title":"\u4f7f\u7528 macOS \u865a\u62df\u673a\u6d4b\u8bd5","text":"<ol> <li> <p>\u5b89\u88c5 Tart<sup>2</sup></p> <pre><code>brew install cirruslabs/cli/tart\n</code></pre> </li> <li> <p>\u4e0b\u8f7d macOS \u955c\u50cf</p> <pre><code>tart clone ghcr.io/cirruslabs/macos-sequoia-base:latest sequoia-base\n</code></pre> </li> <li> <p>\u542f\u52a8 macOS \u865a\u62df\u673a</p> <pre><code>tart run sequoia-base\n</code></pre> </li> <li> <p>\u7ed9 macOS \u865a\u62df\u673a\u5f00\u5149</p> <p>\u6309\u7167\u4e0a\u9762\u5199\u7684\u5f00\u5149\u6b65\u9aa4\u4e00\u6b65\u4e00\u6b65\u505a\u5c31\u597d\u4e86\uff0c\u6709\u4e24\u70b9\u9700\u8981\u6ce8\u610f\uff1a\u4e00\u662f macOS \u865a\u62df\u673a\u4e2d\u5df2\u7ecf\u5b89\u88c5\u4e86 Homebrew\uff0c\u6240\u4ee5\u8981\u8df3\u8fc7\u5f00\u5149\u7b2c\u4e00\u6b65\uff1b\u4e8c\u662f\u6ce8\u91ca\u6389<code>Install Mac App Store Applications</code>\u8fd9\u4e2a task\u3002</p> <p>\u811a\u672c\u8dd1\u5b8c\u540e\u67e5\u770b\u8f6f\u4ef6\u662f\u4e0d\u662f\u90fd\u88c5\u597d\u4e86\uff0c\u4e0b\u9762\u662f\u6211\u7684\u811a\u672c\u5728\u865a\u62df\u673a\u63a7\u5236\u53f0\u7684\u65e5\u5fd7\uff1a</p> Success <pre><code>admin@admins-Virtual-Machine ~ % brew install ansible\n==&gt; Downloading https://ghcr.io/v2/homebrew/core/ansible/manifests/10.5.0-1\n####################################################################################################################################################### 100.0%\n==&gt; Fetching dependencies for ansible: certifi, libsodium and libssh\n==&gt; Downloading https://ghcr.io/v2/homebrew/core/certifi/manifests/2024.8.30_1\n####################################################################################################################################################### 100.0%\n==&gt; Fetching certifi\n==&gt; Downloading https://ghcr.io/v2/homebrew/core/certifi/blobs/sha256:1f1fc985a1c89bd40c73b17e3dfbf5483cb0417c8d4d12e2be66158a503ab169\n####################################################################################################################################################### 100.0%\n==&gt; Downloading https://ghcr.io/v2/homebrew/core/libsodium/manifests/1.0.20\n####################################################################################################################################################### 100.0%\n==&gt; Fetching libsodium\n==&gt; Downloading https://ghcr.io/v2/homebrew/core/libsodium/blobs/sha256:e8ba0aafe8fe7266d68630ff7ab11d7357af35dbf5113bb648a1e02bed397970\n####################################################################################################################################################### 100.0%\n==&gt; Downloading https://ghcr.io/v2/homebrew/core/libssh/manifests/0.11.1\n####################################################################################################################################################### 100.0%\n==&gt; Fetching libssh\n==&gt; Downloading https://ghcr.io/v2/homebrew/core/libssh/blobs/sha256:ef7a07e8b469c92123e7b81ee8356820e1e6866d8e05b278cdd544d1c7d4bf97\n####################################################################################################################################################### 100.0%\n==&gt; Fetching ansible\n==&gt; Downloading https://ghcr.io/v2/homebrew/core/ansible/blobs/sha256:4135e4faf541afc2ae9886420fc109037701e1b961fb06495f642af7d3d9844a\n####################################################################################################################################################### 100.0%\n==&gt; Installing dependencies for ansible: certifi, libsodium and libssh\n==&gt; Installing ansible dependency: certifi\n==&gt; Downloading https://ghcr.io/v2/homebrew/core/certifi/manifests/2024.8.30_1\nAlready downloaded: /Users/admin/Library/Caches/Homebrew/downloads/154ded4253bebd18cc03e7ed1d9a397ebad761afee0abdc83fc952c7586a49d6--certifi-2024.8.30_1.bottle_manifest.json\n==&gt; Pouring certifi--2024.8.30_1.arm64_sequoia.bottle.tar.gz\n\ud83c\udf7a  /opt/homebrew/Cellar/certifi/2024.8.30_1: 38 files, 34.6KB\n==&gt; Installing ansible dependency: libsodium\n==&gt; Downloading https://ghcr.io/v2/homebrew/core/libsodium/manifests/1.0.20\nAlready downloaded: /Users/admin/Library/Caches/Homebrew/downloads/a9a9a2e1207e214070682a14f6470fb686cbb6ba7c24c2c747c0ca0663f42557--libsodium-1.0.20.bottle_manifest.json\n==&gt; Pouring libsodium--1.0.20.arm64_sequoia.bottle.tar.gz\n\ud83c\udf7a  /opt/homebrew/Cellar/libsodium/1.0.20: 78 files, 883.4KB\n==&gt; Installing ansible dependency: libssh\n==&gt; Downloading https://ghcr.io/v2/homebrew/core/libssh/manifests/0.11.1\nAlready downloaded: /Users/admin/Library/Caches/Homebrew/downloads/3591f41514c0ebe698a36753dce13e71fa33363993429a04af0da249f1eea04c--libssh-0.11.1.bottle_manifest.json\n==&gt; Pouring libssh--0.11.1.arm64_sequoia.bottle.tar.gz\n\ud83c\udf7a  /opt/homebrew/Cellar/libssh/0.11.1: 25 files, 1.4MB\n==&gt; Installing ansible\n==&gt; Pouring ansible--10.5.0.arm64_sequoia.bottle.1.tar.gz\n\ud83c\udf7a  /opt/homebrew/Cellar/ansible/10.5.0: 32,696 files, 371.2MB\nadmin@admins-Virtual-Machine ~ % ansible-galaxy collection install community.general\nStarting galaxy collection install process\nNothing to do. All requested collections are already installed. If you want to reinstall them, consider using `--force`.\nadmin@admins-Virtual-Machine ~ % mkdir -p ~/dev/repo/setup-mac-by-ansible &amp;&amp; cd ~/dev/repo/setup-mac-by-ansible\nadmin@admins-Virtual-Machine setup-mac-by-ansible % vim setup-macos.yml\nadmin@admins-Virtual-Machine setup-mac-by-ansible % ansible-playbook setup-macos.yml -v\nNo config file found; using defaults\n[WARNING]: No inventory was parsed, only implicit localhost is available\n[WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'\n\nPLAY [localhost] *********************************************************************************************************************************************\n\nTASK [Gathering Facts] ***************************************************************************************************************************************\nok: [localhost]\n\nTASK [Install Homebrew Formulae (CLI tools and utilities)] ***************************************************************************************************\nchanged: [localhost] =&gt; {\"changed\": true, \"changed_pkgs\": [\"hugo\", \"mas\", \"telnet\", \"zsh-autocomplete\", \"zsh-syntax-highlighting\"], \"msg\": \"Changed: 5, Unchanged: 1\", \"unchanged_pkgs\": [\"wget\"]}\n\nTASK [Install Homebrew Casks (GUI apps)] *********************************************************************************************************************\nchanged: [localhost] =&gt; {\"changed\": true, \"msg\": \"Changed: 21, Unchanged: 0\"}\n\nTASK [Configure zsh-syntax-highlighting in .zshrc] ***********************************************************************************************************\nchanged: [localhost] =&gt; {\"changed\": true, \"msg\": \"File created\"}\n\nTASK [Configure zsh-autocomplete in .zshrc] ******************************************************************************************************************\nchanged: [localhost] =&gt; {\"changed\": true, \"msg\": \"Block inserted\"}\n\nTASK [Add gi() function to .zshrc for generating gitignore files] ********************************************************************************************\nchanged: [localhost] =&gt; {\"backup\": \"\", \"changed\": true, \"msg\": \"line added\"}\n\nTASK [Generate global gitignore file using gi() function] ****************************************************************************************************\nchanged: [localhost] =&gt; {\"changed\": true, \"cmd\": \"source ~/.zshrc &amp;&amp; gi macos,jetbrains,visualstudiocode &gt;&gt; ~/.gitignore_global &amp;&amp; git config --global core.excludesfile ~/.gitignore_global\", \"delta\": \"0:00:00.530349\", \"end\": \"2025-01-03 18:49:07.134589\", \"msg\": \"\", \"rc\": 0, \"start\": \"2025-01-03 18:49:06.604240\", \"stderr\": \"/opt/homebrew/share/zsh-autocomplete/zsh-autocomplete.plugin.zsh: line 2: unsetopt: command not found\\n/opt/homebrew/share/zsh-autocomplete/zsh-autocomplete.plugin.zsh: line 4: syntax error near unexpected token `)'\\n/opt/homebrew/share/zsh-autocomplete/zsh-autocomplete.plugin.zsh: line 4: `() {'\\n/opt/homebrew/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh: line 31: alias: -L: invalid option\\nalias: usage: alias [-p] [name[=value] ... ]\\n/opt/homebrew/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh: line 36: unalias: -m: invalid option\\nunalias: usage: unalias [-a] name [name ...]\\n/opt/homebrew/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh: line 39: 0=${(%):-%N}: bad substitution\\n/opt/homebrew/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh: line 42: /.version: No such file or directory\\n/opt/homebrew/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh: line 42: typeset: -g: invalid option\\ntypeset: usage: typeset [-afFirtx] [-p] name[=value] ...\\n/opt/homebrew/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh: line 43: /.revision-hash: No such file or directory\\n/opt/homebrew/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh: line 43: typeset: -g: invalid option\\ntypeset: usage: typeset [-afFirtx] [-p] name[=value] ...\\n/opt/homebrew/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh: line 104: autoload: command not found\\n/opt/homebrew/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh: line 105: is-at-least: command not found\\n/opt/homebrew/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh: line 108: typeset: -g: invalid option\\ntypeset: usage: typeset [-afFirtx] [-p] name[=value] ...\\n/opt/homebrew/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh: line 112: typeset: -g: invalid option\\ntypeset: usage: typeset [-afFirtx] [-p] name[=value] ...\\n/opt/homebrew/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh: line 144: syntax error near unexpected token `;'\\n/opt/homebrew/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh: line 144: `      (\\\" 0 0 fg=red, memo=zsh-syntax-highlighting\\\") ;&amp;'\", \"stderr_lines\": [\"/opt/homebrew/share/zsh-autocomplete/zsh-autocomplete.plugin.zsh: line 2: unsetopt: command not found\", \"/opt/homebrew/share/zsh-autocomplete/zsh-autocomplete.plugin.zsh: line 4: syntax error near unexpected token `)'\", \"/opt/homebrew/share/zsh-autocomplete/zsh-autocomplete.plugin.zsh: line 4: `() {'\", \"/opt/homebrew/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh: line 31: alias: -L: invalid option\", \"alias: usage: alias [-p] [name[=value] ... ]\", \"/opt/homebrew/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh: line 36: unalias: -m: invalid option\", \"unalias: usage: unalias [-a] name [name ...]\", \"/opt/homebrew/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh: line 39: 0=${(%):-%N}: bad substitution\", \"/opt/homebrew/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh: line 42: /.version: No such file or directory\", \"/opt/homebrew/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh: line 42: typeset: -g: invalid option\", \"typeset: usage: typeset [-afFirtx] [-p] name[=value] ...\", \"/opt/homebrew/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh: line 43: /.revision-hash: No such file or directory\", \"/opt/homebrew/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh: line 43: typeset: -g: invalid option\", \"typeset: usage: typeset [-afFirtx] [-p] name[=value] ...\", \"/opt/homebrew/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh: line 104: autoload: command not found\", \"/opt/homebrew/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh: line 105: is-at-least: command not found\", \"/opt/homebrew/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh: line 108: typeset: -g: invalid option\", \"typeset: usage: typeset [-afFirtx] [-p] name[=value] ...\", \"/opt/homebrew/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh: line 112: typeset: -g: invalid option\", \"typeset: usage: typeset [-afFirtx] [-p] name[=value] ...\", \"/opt/homebrew/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh: line 144: syntax error near unexpected token `;'\", \"/opt/homebrew/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh: line 144: `      (\\\" 0 0 fg=red, memo=zsh-syntax-highlighting\\\") ;&amp;'\"], \"stdout\": \"\", \"stdout_lines\": []}\n\nTASK [Install Vagrant VMware Desktop plugin] *****************************************************************************************************************\nchanged: [localhost] =&gt; {\"changed\": true, \"cmd\": \"vagrant plugin install vagrant-vmware-desktop\", \"delta\": \"0:00:29.408146\", \"end\": \"2025-01-03 18:49:36.746833\", \"msg\": \"\", \"rc\": 0, \"start\": \"2025-01-03 18:49:07.338687\", \"stderr\": \"==&gt; vagrant: A new version of Vagrant is available: 2.4.3 (installed version: 2.4.1)!\\n==&gt; vagrant: To upgrade visit: https://www.vagrantup.com/downloads.html\", \"stderr_lines\": [\"==&gt; vagrant: A new version of Vagrant is available: 2.4.3 (installed version: 2.4.1)!\", \"==&gt; vagrant: To upgrade visit: https://www.vagrantup.com/downloads.html\"], \"stdout\": \"Installing the 'vagrant-vmware-desktop' plugin. This can take a few minutes...\\nInstalled the plugin 'vagrant-vmware-desktop (3.0.4)'!\", \"stdout_lines\": [\"Installing the 'vagrant-vmware-desktop' plugin. This can take a few minutes...\", \"Installed the plugin 'vagrant-vmware-desktop (3.0.4)'!\"]}\n\nPLAY RECAP ***************************************************************************************************************************************************\nlocalhost                  : ok=8    changed=7    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \n</code></pre> </li> </ol>","tags":["macOS","Ansible","Tart","Homebrew"]},{"location":"blog/2025/01/04/%E9%80%9A%E8%BF%87-ansible-%E7%BB%99%E6%96%B0-macbook-%E5%BC%80%E5%85%89/#_2","title":"\u8865\u5145","text":"","tags":["macOS","Ansible","Tart","Homebrew"]},{"location":"blog/2025/01/04/%E9%80%9A%E8%BF%87-ansible-%E7%BB%99%E6%96%B0-macbook-%E5%BC%80%E5%85%89/#ssh","title":"\u5bbf\u4e3b\u673a ssh \u767b\u5f55\u865a\u62df\u673a","text":"<p>\u865a\u62df\u673a\u7684\u8d26\u53f7\u548c\u5bc6\u7801\u90fd\u662f admin</p> <pre><code>ssh admin@$(tart ip sequoia-base)\n</code></pre>","tags":["macOS","Ansible","Tart","Homebrew"]},{"location":"blog/2025/01/04/%E9%80%9A%E8%BF%87-ansible-%E7%BB%99%E6%96%B0-macbook-%E5%BC%80%E5%85%89/#_3","title":"\u91cd\u7f6e\u865a\u62df\u673a","text":"<pre><code>tart delete sequoia-base\ntart clone ghcr.io/cirruslabs/macos-sequoia-base:latest sequoia-base\n</code></pre>","tags":["macOS","Ansible","Tart","Homebrew"]},{"location":"blog/2025/01/04/%E9%80%9A%E8%BF%87-ansible-%E7%BB%99%E6%96%B0-macbook-%E5%BC%80%E5%85%89/#mac","title":"\u6211\u6ca1\u6709\u65b0 Mac","text":"<p>\u6ca1\u4e70\u5462\uff0c\u63d0\u524d\u51c6\u5907\u597d\u811a\u672c\uff0c\u672a\u6765\u54ea\u5929\u4e70\u4e86\uff0c\u5c31\u80fd\u76f4\u63a5\u7528\u4e86\u3002</p> <ol> <li> <p>playbook \u662f Ansible \u4e16\u754c\u4e2d\u7684\u811a\u672c\uff0c\u7528\u4e8e\u63cf\u8ff0\u4f60\u5e0c\u671b\u8bbe\u5907\u6700\u7ec8\u8fbe\u5230\u7684\u72b6\u6001\u3002\u00a0\u21a9</p> </li> <li> <p>Tart \u662f macOS \u4e0a\u865a\u62df macOS \u7684\u8f6f\u4ef6\uff0c\u4e14\u8981\u6c42\u5bbf\u4e3b\u673a\u642d\u8f7d Apple M1/2/3/4 \u7cfb\u5217\u82af\u7247\u3002\u00a0\u21a9</p> </li> </ol>","tags":["macOS","Ansible","Tart","Homebrew"]},{"location":"mysql/build-env1/","title":"\u642d\u5efa MySQL \u6e90\u7801\u9605\u8bfb\u548c\u8c03\u8bd5\u73af\u5883","text":"<p>Abstract</p> <p>\u6559\u4f60 10 \u5206\u949f\u642d\u5efa\u4e00\u4e2a\u53ef\u4ee5\u65ad\u70b9\u8c03\u8bd5\u548c\u9605\u8bfb MySQL 8.0 \u6e90\u4ee3\u7801\u7684\u73af\u5883\u3002</p> <p>\u4f60\u9700\u8981\u6709\u4e00\u4e2a\u8fd0\u884c Rocky Linux 9 \u64cd\u4f5c\u7cfb\u7edf\u7684\u865a\u62df\u673a\uff08\u4e0b\u6587\u4e2d\u6211\u90fd\u79f0\u5b83\u4e3a\u8fdc\u7a0b\u4e3b\u673a\uff09\uff0c\u548c\u4e00\u53f0\u5b89\u88c5\u4e86 Visual Studio Code \u7684\u4e2a\u4eba\u7535\u8111\u3002\u6211\u4eec\u4f1a\u628a MySQL \u7a0b\u5e8f\u548c\u6e90\u4ee3\u7801\u5b89\u88c5\u5728\u8fdc\u7a0b\u4e3b\u673a\u4e0a\uff0c\u4e2a\u4eba\u7535\u8111\u53ea\u5b89\u88c5 VS Code \u63d2\u4ef6\uff0c\u8fdc\u7a0b\u65ad\u70b9\u8c03\u8bd5\u3002</p> <p>\u4e3a\u4ec0\u4e48\u4f7f\u7528 Ansible \u642d\u5efa</p> <p>\u56e0\u4e3a Ansible \u53ef\u4ee5\u4fdd\u8bc1\u5e42\u7b49\u6027\uff0c\u5373\u65e0\u8bba\u6267\u884c\u591a\u5c11\u6b21 Ansible \u811a\u672c\uff0c\u670d\u52a1\u5668\u7684\u6700\u7ec8\u72b6\u6001\u662f\u4e00\u81f4\u7684\u3002Ansible \u811a\u672c\u91c7\u7528 YAML \u8bed\u6cd5\uff0c\u63cf\u8ff0\u6211\u4eec\u5e0c\u671b\u670d\u52a1\u5668\u8fbe\u5230\u7684\u72b6\u6001\u3002\u5373\u4f7f\u4f60\u4e0d\u61c2 Ansible \u811a\u672c\u4e5f\u6ca1\u5173\u7cfb\uff0c\u56e0\u4e3a\u6211\u4eec\u7684\u76ee\u6807\u662f\u642d\u5efa\u73af\u5883\uff0c\u4e0d\u662f\u5f04\u61c2 Ansible \u811a\u672c\uff0c\u6240\u4ee5\u76f4\u63a5\u590d\u5236\u4f7f\u7528\u5373\u53ef\u3002</p>"},{"location":"mysql/build-env1/#_1","title":"\u51c6\u5907\u5de5\u4f5c","text":"<p>\u5b89\u88c5 Ansible</p> <pre><code>[root@localhost ~]# dnf install ansible-core -yq\n</code></pre> \u63a7\u5236\u53f0\u8f93\u51fa <pre><code>Importing GPG key 0x350D275D:\nUserid     : \"Rocky Enterprise Software Foundation - Release key 2022 &lt;releng@rockylinux.org&gt;\"\nFingerprint: 21CB 256A E16F C54C 6E65 2949 702D 426D 350D 275D\nFrom       : /etc/pki/rpm-gpg/RPM-GPG-KEY-Rocky-9\n\nInstalled:\nansible-core-1:2.14.17-1.el9.x86_64                                             \ngit-core-2.43.5-2.el9_5.x86_64                                                  \npython3-cffi-1.14.5-5.el9.x86_64                                                \npython3-cryptography-36.0.1-4.el9.x86_64                                        \npython3-packaging-20.9-5.el9.noarch                                             \npython3-ply-3.11-14.el9.0.1.noarch                                              \npython3-pycparser-2.20-6.el9.noarch                                             \npython3-pyparsing-2.4.7-9.el9.noarch                                            \npython3-pyyaml-5.4.1-6.el9.x86_64                                               \npython3-resolvelib-0.5.4-5.el9.noarch                                           \npython3-setuptools-53.0.0-13.el9.noarch                                         \nsshpass-1.09-4.el9.x86_64                                                       \n</code></pre> <p>\u5b89\u88c5 Ansible collections</p> <pre><code>[root@localhost ~]# ansible-galaxy collection install community.general:9.5.5 community.mysql:3.13.0 ansible.posix:1.5.4\n</code></pre> \u63a7\u5236\u53f0\u8f93\u51fa <pre><code>Starting galaxy collection install process\nProcess install dependency map\nStarting collection install process\nDownloading https://galaxy.ansible.com/api/v3/plugin/ansible/content/published/collections/artifacts/community-general-9.5.5.tar.gz to /root/.ansible/tmp/ansible-local-11487a47h3w9c/tmpuc5lb3g_/community-general-9.5.5-c_80a_m1\nInstalling 'community.general:9.5.5' to '/root/.ansible/collections/ansible_collections/community/general'\nDownloading https://galaxy.ansible.com/api/v3/plugin/ansible/content/published/collections/artifacts/community-mysql-3.13.0.tar.gz to /root/.ansible/tmp/ansible-local-11487a47h3w9c/tmpuc5lb3g_/community-mysql-3.13.0-xhndeqn5\ncommunity.general:9.5.5 was installed successfully\nInstalling 'community.mysql:3.13.0' to '/root/.ansible/collections/ansible_collections/community/mysql'\nDownloading https://galaxy.ansible.com/api/v3/plugin/ansible/content/published/collections/artifacts/ansible-posix-1.5.4.tar.gz to /root/.ansible/tmp/ansible-local-11487a47h3w9c/tmpuc5lb3g_/ansible-posix-1.5.4-7i4qmhu_\ncommunity.mysql:3.13.0 was installed successfully\nInstalling 'ansible.posix:1.5.4' to '/root/.ansible/collections/ansible_collections/ansible/posix'\nansible.posix:1.5.4 was installed successfully\n</code></pre> <p>\u521b\u5efa Ansible \u811a\u672c</p> <pre><code>[root@localhost ~]# vi build_mysql.yml\n</code></pre> <p>\u5c06\u4e0b\u9762\u7684\u811a\u672c\u5185\u5bb9\u76f4\u63a5\u590d\u5236\u7c98\u8d34</p> build_mysql.yml<pre><code>---\n- name: Build MySQL debug environment\n  hosts: localhost\n  become: true\n  vars:\n    mysql_root_password: MyNewPass4!\n  tasks:\n    - name: Install MySQL official yum repo\n      ansible.builtin.dnf:\n        name: https://repo.mysql.com/mysql80-community-release-el9.rpm\n        state: present\n        disable_gpg_check: true\n\n    - name: Install dependencies\n      ansible.builtin.dnf:\n        name:\n          - gcc-c++\n          - gdb\n          - tar\n          - python3-PyMySQL\n          - python3-firewall\n          - mysql-selinux\n          - mysql-community-server-debug\n          - mysql-community-server-debug-debuginfo\n        state: present\n        enablerepo:\n          - mysql80-community\n          - mysql80-community-debuginfo\n        disable_gpg_check: true\n\n    - name: Edit my.cnf\n      community.general.ini_file:\n        path: /etc/my.cnf\n        owner: root\n        group: root\n        mode: \"0644\"\n        section: mysqld\n        option: log_timestamps\n        value: SYSTEM\n\n    - name: Ensure /var/lib/mysql is absent\n      ansible.builtin.file:\n        path: /var/lib/mysql\n        state: absent\n\n    - name: Initialize database\n      ansible.builtin.shell:\n        cmd: /usr/sbin/mysqld --initialize-insecure --user=mysql\n\n    - name: Start service temporarily\n      ansible.builtin.systemd_service:\n        name: mysqld\n        state: started\n        enabled: false\n        daemon_reload: true\n\n    - name: Set root password\n      community.mysql.mysql_user:\n        name: root\n        plugin: caching_sha2_password\n        plugin_auth_string: \"{{ mysql_root_password }}\"\n        password_expire: never\n\n    - name: Create user 'example'@'%'\n      community.mysql.mysql_user:\n        login_user: root\n        login_password: \"{{ mysql_root_password }}\"\n        name: example\n        plugin: caching_sha2_password\n        plugin_auth_string: \"{{ mysql_root_password }}\"\n        host: \"%\"\n        priv: \"*.*:ALL\"\n\n    - name: Stop service\n      ansible.builtin.systemd_service:\n        name: mysqld\n        state: stopped\n        enabled: false\n\n    - name: Enable mysql service in firewalld if firewalld is running\n      ansible.posix.firewalld:\n        service: mysql\n        state: enabled\n        permanent: true\n        immediate: true\n        offline: true\n</code></pre> <p>\u6267\u884c\u811a\u672c\uff0c\u9759\u9759\u7b49\u5f85\u5b8c\u6210\u5373\u53ef\uff0c\u7f51\u901f\u5feb\u7684\u8bdd\u5927\u7ea6 3 \u5206\u949f\u5c31\u597d\u4e86\u3002</p> <pre><code>[root@localhost ~]# ansible-playbook build_mysql.yml\n</code></pre> \u63a7\u5236\u53f0\u8f93\u51fa <pre><code>[WARNING]: provided hosts list is empty, only localhost is available. Note that\nthe implicit localhost does not match 'all'\n\nPLAY [Build MySQL debug environment] *********************************************\n\nTASK [Gathering Facts] ***********************************************************\nok: [localhost]\n\nTASK [Install MySQL official yum repo] *******************************************\nchanged: [localhost]\n\nTASK [Install dependencies] ******************************************************\nchanged: [localhost]\n\nTASK [Edit my.cnf] ***************************************************************\nchanged: [localhost]\n\nTASK [Ensure /var/lib/mysql is absent] *******************************************\nchanged: [localhost]\n\nTASK [Initialize database] *******************************************************\nchanged: [localhost]\n\nTASK [Start service temporarily] *************************************************\nchanged: [localhost]\n\nTASK [Set root password] *********************************************************\n[WARNING]: Option column_case_sensitive is not provided. The default is now\nfalse, so the column's name will be uppercased. The default will be changed to\ntrue in community.mysql 4.0.0.\nchanged: [localhost]\n\nTASK [Create user 'example'@'%'] *************************************************\nchanged: [localhost]\n\nTASK [Stop service] **************************************************************\nchanged: [localhost]\n\nTASK [Enable mysql service in firewalld if firewalld is running] *****************\nchanged: [localhost]\n\nPLAY RECAP ***********************************************************************\nlocalhost                  : ok=11   changed=10   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \n</code></pre>"},{"location":"mysql/build-env1/#visual-studio-code","title":"\u914d\u7f6e Visual Studio Code","text":""},{"location":"mysql/build-env1/#remote-development","title":"\u5b89\u88c5 Remote Development \u63d2\u4ef6","text":""},{"location":"mysql/build-env1/#_2","title":"\u8fdc\u7a0b\u767b\u5f55","text":"\u60a8\u7684\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u89c6\u9891\u6807\u7b7e\u3002  <p>\u6211\u4eec\u4f7f\u7528\u4e0a\u4e00\u6b65\u5b89\u88c5\u597d\u7684 Remote Development \u63d2\u4ef6\u6253\u5f00\u8fdc\u7a0b\u4e3b\u673a\u7684\u6e90\u4ee3\u7801\u76ee\u5f55\uff0c\u4f5c\u4e3a VS Code \u7684\u5de5\u4f5c\u533a\u3002MySQL \u6e90\u4ee3\u7801\u5728\u6211\u4eec\u6267\u884c Ansible \u811a\u672c\u7684\u65f6\u5019\u5b89\u88c5\u597d\u4e86\uff0c\u4e0d\u7528\u62c5\u5fc3\u3002</p>"},{"location":"mysql/build-env1/#cc-extension-pack","title":"\u5b89\u88c5 C/C++ Extension Pack \u63d2\u4ef6","text":"<p>\u5b8c\u6210\u4e0a\u4e00\u6b65\u7684\u64cd\u4f5c\u540e\uff0c\u6211\u4eec\u5c31\u628a\u8fdc\u7a0b\u4e3b\u673a\u7684\u6e90\u4ee3\u7801\u76ee\u5f55\u4f5c\u4e3a\u4e86 VS Code \u7684\u5de5\u4f5c\u533a\u3002\u73b0\u5728\u6211\u4eec\u8981\u5728\u8fdc\u7a0b\u4e3b\u673a\u4e0a\u5b89\u88c5 C/C++ Extension Pack \u63d2\u4ef6\u3002\u5728\u63d2\u4ef6\u5e02\u573a\u641c\u7d22\u5230\u8be5\u63d2\u4ef6\u540e\uff0c\u4f1a\u663e\u793a\u4e0a\u56fe\u6240\u793a\u7684\u5b89\u88c5\u5728\u8fdc\u7a0b\u4e3b\u673a\u7684\u6309\u94ae\u3002</p>"},{"location":"mysql/build-env1/#_3","title":"\u914d\u7f6e\u6587\u4ef6","text":"<p>\u6700\u540e\uff0c\u5728\u5de5\u4f5c\u533a\u6839\u76ee\u5f55\u4e0b\u65b0\u5efa .vscode \u76ee\u5f55\uff0c\u7136\u540e\u5728\u76ee\u5f55\u4e0b\u65b0\u5efa 2 \u4e2a json \u914d\u7f6e\u6587\u4ef6\uff0c\u6587\u4ef6\u5185\u5bb9\u6309\u7167\u6211\u5199\u7684\u590d\u5236\u7c98\u8d34\u5373\u53ef\u3002\u5b8c\u6210\u8fd9\u4e00\u6b65\u540e\uff0c\u7acb\u523b\u5c31\u80fd\u8c03\u8bd5\u4e86\u3002</p> .vscode/launch.json<pre><code>{\n    \"version\": \"0.2.0\",\n    \"configurations\": [\n        {\n            \"name\": \"Debug MySQL\",\n            \"type\": \"cppdbg\",\n            \"request\": \"launch\",\n            \"program\": \"/usr/sbin/mysqld-debug\",\n            \"args\": [\n                \"--defaults-file=/etc/my.cnf\",\n                \"--user=mysql\"\n            ],\n            \"stopAtEntry\": true,\n            \"cwd\": \"${workspaceFolder}\",\n            \"environment\": [],\n            \"externalConsole\": false,\n            \"MIMode\": \"gdb\",\n            \"setupCommands\": [\n                {\n                    \"description\": \"Enable pretty-printing\",\n                    \"text\": \"-enable-pretty-printing\",\n                    \"ignoreFailures\": true\n                }\n            ]\n        }\n    ]\n}\n</code></pre> .vscode/settings.json<pre><code>{\n    \"C_Cpp.default.compilerPath\": \"/usr/bin/c++\",\n    \"C_Cpp.errorSquiggles\": \"disabled\"\n}\n</code></pre> <p></p> <p>\u76ee\u5f55\u7ed3\u6784</p>"},{"location":"mysql/build-env1/#_4","title":"\u542f\u52a8\u8c03\u8bd5","text":"\u60a8\u7684\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u89c6\u9891\u6807\u7b7e\u3002  <p>\u770b\uff0c\u662f\u4e0d\u662f\u975e\u5e38\u7b80\u5355\u3002\u6211\u4eec\u542f\u52a8\u8c03\u8bd5\u540e\uff0c\u7a0b\u5e8f\u4f1a\u5728\u5165\u53e3\u51fd\u6570 main \u5904\u505c\u4e0b\uff0c\u7b49\u5f85\u6211\u4eec\u7684\u6307\u4ee4\u3002\u4f60\u53ef\u4ee5\u5355\u51fb F7 \u8fdb\u5165 main \u51fd\u6570\uff0c\u7136\u540e\u4f7f\u7528 F8 \u4e00\u6b65\u4e00\u6b65\u5f80\u4e0b\u8d70\u3002\u5982\u679c\u4f60\u4e0d\u5e0c\u671b\u6bcf\u6b21\u542f\u52a8\u8c03\u8bd5\u65f6\uff0c\u7a0b\u5e8f\u90fd\u505c\u5728 main \u51fd\u6570\u5904\uff0c\u90a3\u4e48\u53ef\u4ee5\u4fee\u6539 <code>.vscode/launch.json</code> \u4e2d\u7684 stopAtEntry \u5c5e\u6027\u4e3a false\u3002</p> <p>\u4e0b\u4e00\u7bc7\uff0c\u6211\u4eec\u5f00\u59cb\u6b63\u5f0f\u9605\u8bfb MySQL \u6e90\u7801\u3002</p>"},{"location":"mysql/build-env2/","title":"\u642d\u5efa MySQL \u6e90\u7801\u9605\u8bfb\u548c\u8c03\u8bd5\u73af\u5883","text":"<p>Abstract</p> <p>\u6559\u4f60 10 \u5206\u949f\u642d\u5efa\u4e00\u4e2a\u53ef\u4ee5\u65ad\u70b9\u8c03\u8bd5\u548c\u9605\u8bfb MySQL 8.0 \u6e90\u4ee3\u7801\u7684\u73af\u5883\u3002</p> <p>\u4f60\u9700\u8981\u6709\u4e00\u4e2a\u8fd0\u884c Debian 12 \u64cd\u4f5c\u7cfb\u7edf\u7684\u865a\u62df\u673a\uff08\u4e0b\u6587\u4e2d\u6211\u90fd\u79f0\u5b83\u4e3a\u8fdc\u7a0b\u4e3b\u673a\uff09\uff0c\u548c\u4e00\u53f0\u5b89\u88c5\u4e86 Visual Studio Code \u7684\u4e2a\u4eba\u7535\u8111\u3002\u6211\u4eec\u4f1a\u628a MySQL \u7a0b\u5e8f\u548c\u6e90\u4ee3\u7801\u5b89\u88c5\u5728\u8fdc\u7a0b\u4e3b\u673a\u4e0a\uff0c\u4e2a\u4eba\u7535\u8111\u53ea\u5b89\u88c5 VS Code \u63d2\u4ef6\uff0c\u8fdc\u7a0b\u65ad\u70b9\u8c03\u8bd5\u3002</p> <p>\u4e3a\u4ec0\u4e48\u4f7f\u7528 Ansible \u642d\u5efa</p> <p>\u56e0\u4e3a Ansible \u53ef\u4ee5\u4fdd\u8bc1\u5e42\u7b49\u6027\uff0c\u5373\u65e0\u8bba\u6267\u884c\u591a\u5c11\u6b21 Ansible \u811a\u672c\uff0c\u670d\u52a1\u5668\u7684\u6700\u7ec8\u72b6\u6001\u662f\u4e00\u81f4\u7684\u3002Ansible \u811a\u672c\u91c7\u7528 YAML \u8bed\u6cd5\uff0c\u63cf\u8ff0\u6211\u4eec\u5e0c\u671b\u670d\u52a1\u5668\u8fbe\u5230\u7684\u72b6\u6001\u3002\u5373\u4f7f\u4f60\u4e0d\u61c2 Ansible \u811a\u672c\u4e5f\u6ca1\u5173\u7cfb\uff0c\u56e0\u4e3a\u6211\u4eec\u7684\u76ee\u6807\u662f\u642d\u5efa\u73af\u5883\uff0c\u4e0d\u662f\u5f04\u61c2 Ansible \u811a\u672c\uff0c\u6240\u4ee5\u76f4\u63a5\u590d\u5236\u4f7f\u7528\u5373\u53ef\u3002</p>"},{"location":"mysql/build-env2/#_1","title":"\u51c6\u5907\u5de5\u4f5c","text":"<p>\u5b89\u88c5 Ansible</p> <pre><code>root@debian:~# apt install ansible\n</code></pre> <p>\u521b\u5efa Ansible \u811a\u672c</p> <pre><code>root@debian:~# vi build_mysql.yml\n</code></pre> <p>\u5c06\u4e0b\u9762\u7684\u811a\u672c\u5185\u5bb9\u76f4\u63a5\u590d\u5236\u7c98\u8d34</p> build_mysql.yml<pre><code>---\n- name: Build MySQL debug environment\n  hosts: localhost\n  become: true\n  vars:\n    mysql_root_password: MyNewPass4!\n  tasks:\n    - name: Install mysql-apt-config dependencies\n      ansible.builtin.apt:\n        name:\n          - lsb-release\n          - wget\n          - gnupg\n          - debconf-utils\n        update_cache: true\n\n    - name: Configure mysql-apt-config\n      ansible.builtin.debconf:\n        name: mysql-apt-config\n        question: \"{{ item.question }}\"\n        value: \"{{ item.value }}\"\n        vtype: \"{{ item.vtype }}\"\n      loop:\n        - question: mysql-apt-config/select-connectors\n          value: Disabled\n          vtype: select\n        - question: mysql-apt-config/select-server\n          value: mysql-8.0\n          vtype: select\n        - question: mysql-apt-config/select-product\n          value: Ok\n          vtype: select\n\n    - name: Install MySQL official repo\n      ansible.builtin.apt:\n        deb: https://repo.mysql.com/mysql-apt-config_0.8.33-1_all.deb\n\n    - name: Configure mysql-community-server\n      ansible.builtin.debconf:\n        name: mysql-community-server\n        question: \"{{ item.question }}\"\n        value: \"{{ item.value }}\"\n        vtype: \"{{ item.vtype }}\"\n      loop:\n        - question: mysql-community-server/root-pass\n          value: \"{{ mysql_root_password }}\"\n          vtype: password\n        - question: mysql-community-server/re-root-pass\n          value: \"{{ mysql_root_password }}\"\n          vtype: password\n        - question: mysql-server/default-auth-override\n          value: Use Strong Password Encryption (RECOMMENDED)\n          vtype: select\n\n    - name: Install dependencies\n      ansible.builtin.apt:\n        name:\n          - g++\n          - gdb\n          - tar\n          - python3-pymysql\n          - mysql-community-server-debug\n          - mysql-community-server-debug-dbgsym\n        update_cache: true\n\n    - name: Edit my.cnf\n      community.general.ini_file:\n        path: /etc/mysql/mysql.conf.d/mysqld.cnf\n        owner: root\n        group: root\n        mode: \"0644\"\n        section: mysqld\n        option: log_timestamps\n        value: SYSTEM\n\n    - name: Start service temporarily\n      ansible.builtin.systemd_service:\n        name: mysql\n        state: started\n        enabled: false\n        daemon_reload: true\n\n    - name: Create user 'example'@'%'\n      community.mysql.mysql_user:\n        login_user: root\n        login_password: \"{{ mysql_root_password }}\"\n        name: example\n        plugin: caching_sha2_password\n        plugin_auth_string: \"{{ mysql_root_password }}\"\n        host: \"%\"\n        priv: \"*.*:ALL\"\n\n    - name: Stop service\n      ansible.builtin.systemd_service:\n        name: mysql\n        state: stopped\n        enabled: false\n\n    - name: Get MySQL version\n      ansible.builtin.shell: apt-cache show mysql-community-server-debug | grep '^Version:' | awk '{print $2}' | cut -d'-' -f1\n      register: mysql_version\n      changed_when: false\n\n    - name: Get source\n      ansible.builtin.shell: \n        cmd: wget -P /usr/src https://dev.mysql.com/get/Downloads/MySQL-8.0/mysql-{{ mysql_version.stdout }}.tar.gz\n        creates: /usr/src/mysql-{{ mysql_version.stdout }}.tar.gz\n\n    - name: Decompress source\n      ansible.builtin.unarchive:\n        src: /usr/src/mysql-{{ mysql_version.stdout }}.tar.gz\n        dest: /usr/src/\n        copy: false\n        decrypt: false\n</code></pre> <p>\u6267\u884c\u811a\u672c\uff0c\u9759\u9759\u7b49\u5f85\u5b8c\u6210\u5373\u53ef\uff0c\u7f51\u901f\u5feb\u7684\u8bdd\u5927\u7ea6 3 \u5206\u949f\u5c31\u597d\u4e86\u3002</p> <pre><code>root@debian:~# ansible-playbook build_mysql.yml \n</code></pre> \u63a7\u5236\u53f0\u8f93\u51fa <pre><code>[WARNING]: No inventory was parsed, only implicit localhost is available\n[WARNING]: provided hosts list is empty, only localhost is available. Note that\nthe implicit localhost does not match 'all'\n\nPLAY [Build MySQL debug environment] *********************************************\n\nTASK [Gathering Facts] ***********************************************************\nok: [localhost]\n\nTASK [Install mysql-apt-config dependencies] *************************************\nchanged: [localhost]\n\nTASK [Configure mysql-apt-config] ************************************************\nchanged: [localhost] =&gt; (item={'question': 'mysql-apt-config/select-connectors', 'value': 'Disabled', 'vtype': 'select'})\nchanged: [localhost] =&gt; (item={'question': 'mysql-apt-config/select-server', 'value': 'mysql-8.0', 'vtype': 'select'})\nchanged: [localhost] =&gt; (item={'question': 'mysql-apt-config/select-product', 'value': 'Ok', 'vtype': 'select'})\n\nTASK [Install MySQL official repo] ***********************************************\nchanged: [localhost]\n\nTASK [Configure mysql-community-server] ******************************************\nchanged: [localhost] =&gt; (item={'question': 'mysql-community-server/root-pass', 'value': 'MyNewPass4!', 'vtype': 'password'})\nchanged: [localhost] =&gt; (item={'question': 'mysql-community-server/re-root-pass', 'value': 'MyNewPass4!', 'vtype': 'password'})\nchanged: [localhost] =&gt; (item={'question': 'mysql-server/default-auth-override', 'value': 'Use Strong Password Encryption (RECOMMENDED)', 'vtype': 'select'})\n\nTASK [Install dependencies] ******************************************************\nchanged: [localhost]\n\nTASK [Edit my.cnf] ***************************************************************\nchanged: [localhost]\n\nTASK [Start service temporarily] *************************************************\nchanged: [localhost]\n\nTASK [Create user 'example'@'%'] *************************************************\nchanged: [localhost]\n\nTASK [Stop service] **************************************************************\nchanged: [localhost]\n\nTASK [Get MySQL version] *********************************************************\nok: [localhost]\n\nTASK [Get source] ****************************************************************\nchanged: [localhost]\n\nTASK [Decompress source] *********************************************************\nchanged: [localhost]\n\nPLAY RECAP ***********************************************************************\nlocalhost                  : ok=13   changed=11   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \n</code></pre>"},{"location":"mysql/build-env2/#visual-studio-code","title":"\u914d\u7f6e Visual Studio Code","text":""},{"location":"mysql/build-env2/#remote-development","title":"\u5b89\u88c5 Remote Development \u63d2\u4ef6","text":""},{"location":"mysql/build-env2/#_2","title":"\u8fdc\u7a0b\u767b\u5f55","text":"\u60a8\u7684\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u89c6\u9891\u6807\u7b7e\u3002  <p>\u6211\u4eec\u4f7f\u7528\u4e0a\u4e00\u6b65\u5b89\u88c5\u597d\u7684 Remote Development \u63d2\u4ef6\u6253\u5f00\u8fdc\u7a0b\u4e3b\u673a\u7684\u6e90\u4ee3\u7801\u76ee\u5f55\uff0c\u4f5c\u4e3a VS Code \u7684\u5de5\u4f5c\u533a\u3002MySQL \u6e90\u4ee3\u7801\u5728\u6211\u4eec\u6267\u884c Ansible \u811a\u672c\u7684\u65f6\u5019\u5b89\u88c5\u597d\u4e86\uff0c\u4e0d\u7528\u62c5\u5fc3\u3002</p>"},{"location":"mysql/build-env2/#cc-extension-pack","title":"\u5b89\u88c5 C/C++ Extension Pack \u63d2\u4ef6","text":"<p>\u5b8c\u6210\u4e0a\u4e00\u6b65\u7684\u64cd\u4f5c\u540e\uff0c\u6211\u4eec\u5c31\u628a\u8fdc\u7a0b\u4e3b\u673a\u7684\u6e90\u4ee3\u7801\u76ee\u5f55\u4f5c\u4e3a\u4e86 VS Code \u7684\u5de5\u4f5c\u533a\u3002\u73b0\u5728\u6211\u4eec\u8981\u5728\u8fdc\u7a0b\u4e3b\u673a\u4e0a\u5b89\u88c5 C/C++ Extension Pack \u63d2\u4ef6\u3002\u5728\u63d2\u4ef6\u5e02\u573a\u641c\u7d22\u5230\u8be5\u63d2\u4ef6\u540e\uff0c\u4f1a\u663e\u793a\u4e0a\u56fe\u6240\u793a\u7684\u5b89\u88c5\u5728\u8fdc\u7a0b\u4e3b\u673a\u7684\u6309\u94ae\u3002</p>"},{"location":"mysql/build-env2/#_3","title":"\u914d\u7f6e\u6587\u4ef6","text":"<p>\u6700\u540e\uff0c\u5728\u5de5\u4f5c\u533a\u6839\u76ee\u5f55\u4e0b\u65b0\u5efa .vscode \u76ee\u5f55\uff0c\u7136\u540e\u5728\u76ee\u5f55\u4e0b\u65b0\u5efa 2 \u4e2a json \u914d\u7f6e\u6587\u4ef6\uff0c\u6587\u4ef6\u5185\u5bb9\u6309\u7167\u6211\u5199\u7684\u590d\u5236\u7c98\u8d34\u5373\u53ef\u3002\u5b8c\u6210\u8fd9\u4e00\u6b65\u540e\uff0c\u7acb\u523b\u5c31\u80fd\u8c03\u8bd5\u4e86\u3002</p> .vscode/launch.json<pre><code>{\n    \"version\": \"0.2.0\",\n    \"configurations\": [\n        {\n            \"name\": \"Debug MySQL\",\n            \"type\": \"cppdbg\",\n            \"request\": \"launch\",\n            \"program\": \"/usr/sbin/mysqld-debug\",\n            \"args\": [\n                \"--user=mysql\"\n            ],\n            \"stopAtEntry\": true,\n            \"cwd\": \"${workspaceFolder}\",\n            \"environment\": [],\n            \"externalConsole\": false,\n            \"MIMode\": \"gdb\",\n            \"setupCommands\": [\n                {\n                    \"description\": \"Enable pretty-printing\",\n                    \"text\": \"-enable-pretty-printing\",\n                    \"ignoreFailures\": true\n                }\n            ]\n        }\n    ]\n}\n</code></pre> .vscode/settings.json<pre><code>{\n    \"C_Cpp.default.compilerPath\": \"/usr/bin/c++\",\n    \"C_Cpp.errorSquiggles\": \"disabled\"\n}\n</code></pre> <p></p> <p>\u76ee\u5f55\u7ed3\u6784</p>"},{"location":"mysql/build-env2/#_4","title":"\u542f\u52a8\u8c03\u8bd5","text":"\u60a8\u7684\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u89c6\u9891\u6807\u7b7e\u3002  <p>\u770b\uff0c\u662f\u4e0d\u662f\u975e\u5e38\u7b80\u5355\u3002\u6211\u4eec\u542f\u52a8\u8c03\u8bd5\u540e\uff0c\u7a0b\u5e8f\u4f1a\u5728\u5165\u53e3\u51fd\u6570 main \u5904\u505c\u4e0b\uff0c\u7b49\u5f85\u6211\u4eec\u7684\u6307\u4ee4\u3002\u4f60\u53ef\u4ee5\u5355\u51fb F7 \u8fdb\u5165 main \u51fd\u6570\uff0c\u7136\u540e\u4f7f\u7528 F8 \u4e00\u6b65\u4e00\u6b65\u5f80\u4e0b\u8d70\u3002\u5982\u679c\u4f60\u4e0d\u5e0c\u671b\u6bcf\u6b21\u542f\u52a8\u8c03\u8bd5\u65f6\uff0c\u7a0b\u5e8f\u90fd\u505c\u5728 main \u51fd\u6570\u5904\uff0c\u90a3\u4e48\u53ef\u4ee5\u4fee\u6539 <code>.vscode/launch.json</code> \u4e2d\u7684 stopAtEntry \u5c5e\u6027\u4e3a false\u3002</p> <p>\u4e0b\u4e00\u7bc7\uff0c\u6211\u4eec\u5f00\u59cb\u6b63\u5f0f\u9605\u8bfb MySQL \u6e90\u7801\u3002</p>"},{"location":"mysql/connect1/","title":"\u5f53\u5ba2\u6237\u7aef\u8f93\u5165 mysql -h x.x.x.x -u root -p \u65f6\uff0c\u670d\u52a1\u7aef\u5728\u505a\u4ec0\u4e48\uff08\u4e0a\uff09","text":"<p>Conventions</p> <ul> <li> \u6bcf\u4e00\u4e2a\u4ee3\u7801\u5757\u7684\u9876\u90e8\u90fd\u6709\u5b83\u6240\u5c5e\u7684\u6587\u4ef6\uff08\u76f8\u5bf9\uff09\u8def\u5f84\uff0c\u5982\u679c\u4ee3\u7801\u5757\u5c5e\u4e8e\u67d0\u4e2a\u51fd\u6570\uff08\u65b9\u6cd5\uff09\uff0c\u90a3\u4e48\u9876\u90e8\u4f1a\u6709\u51fd\u6570\uff08\u65b9\u6cd5\uff09\u7684\u58f0\u660e\u3002</li> <li> \u4ee3\u7801\u5757\u4e2d\u7684\u5bf9\u8c61\uff0c\u5982\u679c\u5f88\u91cd\u8981\uff0c\u4f1a\u5728\u884c\u5c3e\u8865\u5145\u8be5\u5bf9\u8c61\u7684\u58f0\u660e\u3002</li> <li> \u6211\u4f7f\u7528\u7684MySQL \u7248\u672c\u662f 8.0.41\u3002\u4f60\u770b\u5230\u8fd9\u7bc7\u65f6\uff0c\u53ef\u80fd\u6709\u4e86\u66f4\u65b0\u7684\u7248\u672c\uff0c\u6bd4\u5982 8.0.42\uff0c\u533a\u522b\u4e0d\u5927\u7684\u3002</li> </ul>"},{"location":"mysql/connect1/#_1","title":"\u7b49\u5f85\u5ba2\u6237\u7aef\u8fde\u63a5","text":"<p>\u670d\u52a1\u7aef\u5728\u542f\u52a8\u540e\u76d1\u542c 3306 \u7aef\u53e3\uff0c\u5e76\u4e14\u4e00\u76f4\u7b49\u5f85\u5ba2\u6237\u7aef\u8fde\u63a5\u3002\u5bf9\u5e94\u5230\u6e90\u4ee3\u7801\u662f\u4ec0\u4e48\u6837\u5b50\u7684\uff1f</p> sql/main.cc<pre><code>extern int mysqld_main(int argc, char **argv);\n\nint main(int argc, char **argv) { return mysqld_main(argc, argv); }\n</code></pre> <p>\u9996\u5148\uff0cmain \u51fd\u6570\u76f4\u63a5\u8c03\u7528 mysqld_main \u51fd\u6570\uff0c\u591f\u7b80\u5355\u5427\uff0c\u90a3\u5c31\u53bb\u770b\u770b mysqld_main \u51fd\u6570\u3002</p> <p>sql/mysqld.cc int mysqld_main(int argc, char **argv)<pre><code>  mysqld_socket_acceptor-&gt;connection_event_loop(); // (1)!\n</code></pre> mysqld_main \u51fd\u6570\u592a\u590d\u6742\u4e86\uff0c\u522b\u6015\uff0c\u5927\u90e8\u5206\u6211\u4eec\u90fd\u4e0d\u5173\u5fc3\uff0c\u6211\u4eec\u53ea\u6293\u4e3b\u8981\u77db\u76fe\u3002\u76f4\u63a5\u770b 8286 \u884c\uff0cmysqld_socket_acceptor \u8c03\u7528 connection_event_loop \u51fd\u6570\u8d1f\u8d23\u7b49\u5f85\u5ba2\u6237\u7aef\u7684\u8fde\u63a5\u4e8b\u4ef6\u3002</p> <ol> <li>static Connection_acceptor *mysqld_socket_acceptor sql/conn_handler/connection_acceptor.h<pre><code>  /**\n    Connection acceptor loop to accept connections from clients.\n  */\n  void connection_event_loop() {\n    Connection_handler_manager *mgr =\n        Connection_handler_manager::get_instance();\n    while (!connection_events_loop_aborted()) {\n      Channel_info *channel_info = m_listener-&gt;listen_for_connection_event(); // (1)!\n      if (channel_info != nullptr) mgr-&gt;process_new_connection(channel_info);\n    }\n  }\n</code></pre> <ol> <li>Mysqld_socket_listener *m_listener</li> </ol> <p>connection_event_loop() \u51fd\u6570\u6ca1\u51e0\u884c\uff0c\u4ece\u7b2c 65 \u884c\u770b\u51fa\uff0cmysqld_socket_acceptor \u7684\u6210\u5458 m_listener \u624d\u662f\u771f\u6b63\u5e72\u6d3b\u7684\u2014\u2014\u2014\u7b49\u5f85\u8fde\u63a5\u4e8b\u4ef6\u3002\u7b2c 66 \u884c\u5c06\uff08\u5c01\u88c5\u597d\u7684\uff09\u8fde\u63a5\u5bf9\u8c61 channel_info \u4ea4\u7ed9 mgr \u5bf9\u8c61\uff0cmgr \u5bf9\u8c61\u8c03\u7528 process_new_connection() \u51fd\u6570\u5904\u7406\u8fde\u63a5\uff0c\u5c31\u50cf\u5b83\u7684\u540d\u5b57 Connection_handler_manager \u6240\u8bf4\u7684\uff0c\u5b83\u662f\u8fde\u63a5\u53e5\u67c4\u7684\u7ba1\u7406\u8005\u3002</p> sql/conn_handler/socket_connection.cc<pre><code>Channel_info *Mysqld_socket_listener::listen_for_connection_event() {\n#ifdef HAVE_POLL\n  int retval = poll(&amp;m_poll_info.m_fds[0], m_socket_vector.size(), -1);\n#else\n  m_select_info.m_read_fds = m_select_info.m_client_fds;\n  int retval = select((int)m_select_info.m_max_used_connection,\n                      &amp;m_select_info.m_read_fds, 0, 0, 0);\n#endif\n</code></pre> <p>\u82e6\u529b m_listener \u4f7f\u7528 POLL \u7cfb\u7edf\u8c03\u7528\uff0c\u76d1\u542c POLLIN \u4e8b\u4ef6\u3002</p> sql/conn_handler/socket_connection.cc Channel_info *listen_for_connection_event()<pre><code>  Channel_info *channel_info = nullptr;\n  if (listen_socket-&gt;m_socket_type == Socket_type::UNIX_SOCKET)\n    channel_info = new (std::nothrow) Channel_info_local_socket(connect_sock);\n  else\n    channel_info = new (std::nothrow) Channel_info_tcpip_socket(\n        connect_sock, (listen_socket-&gt;m_socket_interface ==\n                       Socket_interface_type::ADMIN_INTERFACE));\n#endif\n</code></pre> <p>\u63a5\u7740\uff0cPOLLIN \u4e8b\u4ef6\u53d1\u751f\u540e\uff0cnew \u4e00\u4e2a channel_info \u5bf9\u8c61\uff0c\u7c7b\u578b Channel_info_tcpip_socket\uff0clisten_for_connection_event \u51fd\u6570\u8fd4\u56de\u7684\u5c31\u662f\u8fd9\u4e2a\u5bf9\u8c61\u3002</p> sql/conn_handler/connection_handler_manager.cc<pre><code>void Connection_handler_manager::process_new_connection(\n    Channel_info *channel_info) {\n  if (connection_events_loop_aborted() ||\n      !check_and_incr_conn_count(channel_info-&gt;is_admin_connection())) {\n    channel_info-&gt;send_error_and_close_channel(ER_CON_COUNT_ERROR, 0, true);\n    delete channel_info;\n    return;\n  }\n\n  if (m_connection_handler-&gt;add_connection(channel_info)) { // (1)!\n    inc_aborted_connects();\n    delete channel_info;\n  }\n}\n</code></pre> <ol> <li>Connection_handler *m_connection_handler</li> </ol>"},{"location":"mysql/connect1/#_2","title":"\u5904\u7406\u8fde\u63a5","text":"<p>\u524d\u9762\u8bf4\u5230 mgr \u8c03\u7528 process_new_connection() \u51fd\u6570\u5904\u7406\u5177\u4f53\u7684\u8fde\u63a5\u5bf9\u8c61 channel_info\uff0c\u4e0a\u9762\u5c31\u662f\u8be5\u51fd\u6570\u7684\u5168\u90e8\u4ee3\u7801\uff0c\u76f4\u63a5\u770b\u7b2c 263 \u884c\uff0c\u5b83\u628a\u8fde\u63a5\u5bf9\u8c61 channel_info \u4ea4\u7ed9\u4e86 m_connection_handler\uff0cm_connection_handler \u662f mgr \u7684\u6210\u5458\uff0c\u5bf9\u5e94\u7c7b\u578b Connection_handler\u3002</p> sql/conn_handler/connection_handler_per_thread.cc bool Per_thread_connection_handler::add_connection(Channel_info *channel_info)<pre><code>  if (!check_idle_thread_and_enqueue_connection(channel_info)) return false;\n\n  /*\n    There are no idle threads available to take up the new\n    connection. Create a new thread to handle the connection\n  */\n  channel_info-&gt;set_prior_thr_create_utime();\n  error =\n      mysql_thread_create(key_thread_one_connection, &amp;id, &amp;connection_attrib,\n                          handle_connection, (void *)channel_info);\n</code></pre> <p>add_connection \u51fd\u6570\u53ea\u9700\u8981\u5173\u6ce8\u4e0a\u9762\u51e0\u884c\u4ee3\u7801\u3002</p> <p>Connection_handler \u6709\u4e24\u4e2a\u5b50\u7c7b\uff0c\u4e00\u662f Per_thread_connection_handler\uff0c\u53e6\u4e00\u4e2a\u662f One_thread_connection_handler\u3002\u987e\u540d\u601d\u4e49\uff0cPer_thread_connection_handler \u662f\u4e00\u4e2a\u8fde\u63a5\u4e00\u4e2a\u7ebf\u7a0b\uff0cOne_thread_connection_handler \u662f\u6240\u6709\u8fde\u63a5\u4e00\u4e2a\u7ebf\u7a0b\u3002\u6211\u4eec\u770b Per_thread_connection_handler \u5c31\u53ef\u4ee5\u4e86\uff0c\u56e0\u4e3a\u8fd9\u662f\u9ed8\u8ba4\u4e5f\u662f\u6b63\u5e38\u60c5\u51b5\u4e0b\u7528\u7684\uff0c\u5982\u679c\u4f60\u4e00\u5b9a\u8981\u7528 One_thread_connection_handler\uff0c\u90a3\u4e48\u53ef\u4ee5\u4fee\u6539 MySQL \u914d\u7f6e thread_handling=no-threads \u5373\u53ef\u3002</p> <p>\u4ece\u8fd9\u91cc\u6211\u4eec\u77e5\u9053\u4e86\uff0cMySQL \u670d\u52a1\u7aef\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u5ba2\u6237\u7aef\u8fde\u63a5\uff0c\u90fd\u4f1a\u521b\u5efa\u4e00\u4e2a\u7ebf\u7a0b\u6765\u5904\u7406\u3002\u6309\u7167\u5957\u8def\uff0c\u80af\u5b9a\u5f97\u6709\u7ebf\u7a0b\u6c60\uff0c\u7b2c 407 \u884c\u7684\u51fd\u6570\u540d check_idle_thread_and_enqueue_connection \u5c31\u5728\u63d0\u793a\u6211\u4eec\uff0c\u68c0\u67e5\u6709\u6ca1\u6709\u7a7a\u95f2\u7684\u7ebf\u7a0b\uff0c\u5982\u679c\u6709\u90a3\u4e48\u5c31\u628a\u8fde\u63a5\u5bf9\u8c61 channel_info \u6254\u8fdb\u53bb\u3002</p> <p>\u6211\u5f88\u81ea\u7136\u5730\u60f3\u5230\u4e86\u7ebf\u7a0b\u6c60\u6700\u5927\u7ebf\u7a0b\u6570\u7684\u914d\u7f6e\uff0c\u4e8e\u662f\u67e5\u627e\u5b98\u65b9\u6587\u6863\uff0c\u627e\u5230\u4e86 thread_cache_size\u3002</p> <p>\u626f\u8fdc\u4e86\uff0c\u6211\u4eec\u63a5\u7740\u770b\u4e0a\u9762\u8fd9\u4e2a\u51fd\u6570\uff0c\u7531\u4e8e\u6211\u4eec\u662f\u670d\u52a1\u7aef\u542f\u52a8\u540e\u7b2c\u4e00\u6b21\u8fde\u63a5\uff0c\u6240\u4ee5 check_idle_thread_and_enqueue_connection \u4f1a\u8fd4\u56de true \u8868\u793a\u6ca1\u6709\u7a7a\u95f2\u7ebf\u7a0b\uff0c\u7a0b\u5e8f\u4f1a\u8d70\u5230\u7b2c 415\u3001416 \u884c\uff0cmysql_thread_create \u51fd\u6570\u521b\u5efa\u7ebf\u7a0b\uff08\u5185\u90e8\u4f7f\u7528 pthread API\uff09\uff0c\u5e76\u4e14\u5c06 handle_connection \u51fd\u6570\u6307\u793a\u7b26\u4f5c\u4e3a\u53c2\u6570\uff0c\u8fd9\u6837\u7ebf\u7a0b\u5c31\u4f1a\u6267\u884c handle_connection \u51fd\u6570\uff0c\u800c (void *)channel_info \u6700\u7ec8\u4f1a\u4f5c\u4e3a handle_connection \u51fd\u6570\u7684\u5165\u53c2\u3002</p> sql/conn_handler/connection_handler_per_thread.cc static void *handle_connection(void *arg)<pre><code>    if (thd_prepare_connection(thd))\n      handler_manager-&gt;inc_aborted_connects();\n    else {\n      while (thd_connection_alive(thd)) {\n        if (do_command(thd)) break;\n      }\n      end_connection(thd);\n    }\n</code></pre> <p>\u7ebf\u7a0b\u6267\u884c\u7684 handle_connection \u51fd\u6570\u5982\u4e0a\u6240\u793a\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5173\u6ce8\u8fd9\u4e48\u4e00\u5c0f\u5757\u5c31\u884c\u4e86\u3002\u7b2c 299 \u884c thd_prepare_connection \u4f1a\u9a8c\u8bc1\u7528\u6237\u540d\u548c\u5bc6\u7801\uff0c\u5982\u679c\u6b63\u786e\uff0c\u90a3\u4e48\u8fd4\u56de false\uff0c\u5426\u5219\u8fd4\u56de true\u3002</p> <p>\u5047\u8bbe\u7528\u6237\u540d\u5bc6\u7801\u6b63\u786e\uff0c\u5373 thd_prepare_connection \u8fd4\u56de false\uff0c\u7a0b\u5e8f\u4f1a\u8fdb\u5165 else \u5206\u652f\u3002else \u5206\u652f\u4e2d\u662f\u4e00\u4e2a while \u5faa\u73af\uff0cwhile \u5224\u65ad\u5f53\u8fde\u63a5\u5b58\u6d3b\u65f6\uff0c\u8c03\u7528 do_command \u51fd\u6570\uff1b\u8fde\u63a5\u4e0d\u5b58\u6d3b\u65f6\uff0c\u8df3\u51fa\u5faa\u73af\uff0c\u8c03\u7528 end_connection \u51fd\u6570\u3002</p> <p>do_command \u51fd\u6570\u4f1a\u963b\u585e\u7b49\u5f85\u5ba2\u6237\u7aef\u7684\u4e0b\u4e00\u6761\u547d\u4ee4\u3002</p> <p>Tip</p> <p>MySQL \u6e90\u4ee3\u7801\u4e2d\u5f88\u591a\u51fd\u6570\u6210\u529f\u65f6\u8fd4\u56de false\uff0c\u5931\u8d25\u65f6\u8fd4\u56de true\uff0c\u8981\u770b\u6ce8\u91ca\u3002 </p>"},{"location":"mysql/connect1/#_3","title":"\u5c0f\u7ed3","text":"<ul> <li>\u7c7b <code>Connection_acceptor&lt;Mysqld_socket_listener&gt;</code> \u8d1f\u8d23\u76d1\u542c 3306 \u7aef\u53e3\uff0c\u4e0e\u5ba2\u6237\u7aef\u5efa\u7acb\u8fde\u63a5\u3002</li> <li>\u7c7b <code>Mysqld_socket_listener</code> \u662f\u5b9e\u9645\u4e0e\u5ba2\u6237\u7aef\u5efa\u7acb\u7f51\u7edc\uff08TCP/IP\uff09\u8fde\u63a5\u7684\u725b\u9a6c\u3002</li> <li>\u7c7b <code>Channel_info</code> \u5c01\u88c5\u8fde\u63a5\u4fe1\u606f\uff0c\u5b50\u7c7b <code>Channel_info_tcpip_socket</code> \u8868\u793a TCP/IP \u8fde\u63a5\u3002</li> <li>\u7c7b <code>Connection_handler</code> \u8d1f\u8d23\u5904\u7406\u8fde\u63a5\uff0c\u5b50\u7c7b <code>Per_thread_connection_handler</code> \u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u5ba2\u6237\u7aef\u8fde\u63a5\uff0c\u90fd\u4f1a\u65b0\u5efa\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u5904\u7406\u903b\u8f91\u5728 <code>handle_connection</code> \u65b9\u6cd5\u4e2d\u3002</li> </ul>"},{"location":"blog/archive/2025/","title":"2025","text":""},{"location":"blog/archive/2024/","title":"2024","text":""},{"location":"blog/archive/2023/","title":"2023","text":""},{"location":"blog/category/%E5%85%B6%E4%BB%96/","title":"\u5176\u4ed6","text":""},{"location":"blog/category/%E5%AE%89%E8%A3%85/","title":"\u5b89\u88c5","text":""},{"location":"blog/category/%E5%A5%BD%E7%89%A9%E5%88%86%E4%BA%AB/","title":"\u597d\u7269\u5206\u4eab","text":""},{"location":"blog/page/2/","title":"\u535a\u5ba2","text":""},{"location":"blog/category/%E5%AE%89%E8%A3%85/page/2/","title":"\u5b89\u88c5","text":""}]}